{"meta":{"version":1,"warehouse":"3.0.2"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.jpg","path":"images/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/wechatpay.jpg","path":"images/wechatpay.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/js/bookmark.js","path":"js/bookmark.js","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/anime.min.js","path":"lib/anime.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/alipay.jpg","path":"images/alipay.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/local-search.js","path":"js/local-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/schemes/pisces.js","path":"js/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1}],"Cache":[{"_id":"themes/next/.gitignore","hash":"7b68ca7a46104cf9aa84ec0541a4856ab1836eca","modified":1585668906000},{"_id":"themes/next/.gitattributes","hash":"a54f902957d49356376b59287b894b1a3d7a003f","modified":1585668906000},{"_id":"themes/next/.eslintrc.json","hash":"cc5f297f0322672fe3f684f823bc4659e4a54c41","modified":1585668906000},{"_id":"themes/next/.stylintrc","hash":"2cf4d637b56d8eb423f59656a11f6403aa90f550","modified":1585668906000},{"_id":"themes/next/_config.yml","hash":"9e6ce071a2171c22bec7671e51a557c48969dfaf","modified":1591275285114},{"_id":"themes/next/.travis.yml","hash":"ecca3b919a5b15886e3eca58aa84aafc395590da","modified":1585668906000},{"_id":"themes/next/package.json","hash":"62fad6de02adbbba9fb096cbe2dcc15fe25f2435","modified":1585668906000},{"_id":"themes/next/.editorconfig","hash":"8570735a8d8d034a3a175afd1dd40b39140b3e6a","modified":1585668906000},{"_id":"themes/next/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1585668906000},{"_id":"themes/next/LICENSE.md","hash":"18144d8ed58c75af66cb419d54f3f63374cd5c5b","modified":1585668906000},{"_id":"themes/next/languages/default.yml","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1587872950713},{"_id":"source/_posts/go-study-notes-basis.md","hash":"afcd4ee49eb64c17331c0cf1fce0d9a3b9d790a4","modified":1588378526945},{"_id":"themes/next/README.md","hash":"9b4b7d66aca47f9c65d6321b14eef48d95c4dff1","modified":1585668906000},{"_id":"source/_posts/go-study-notes-data-type.md","hash":"0545351b98e830de0f9815c54d8115480a97c559","modified":1588378540285},{"_id":"source/_posts/go-study-notes-concurrency.md","hash":"e1e129a34baa67d3c80fc4997228b78e38c8a3f8","modified":1588378698325},{"_id":"themes/next/gulpfile.js","hash":"1b4fc262b89948937b9e3794de812a7c1f2f3592","modified":1585668906000},{"_id":"source/_posts/go-study-notes-expression.md","hash":"d491289c08556b7f2c3a147a41125b2028813cb1","modified":1588564468956},{"_id":"source/_posts/go-study-notes-maybe-trap.md","hash":"2f1957ae0e67c61f464126558f7204fffd432ddf","modified":1589727246271},{"_id":"source/_posts/go-study-notes-go-command.md","hash":"caf0a7fa3a65412f260cfb60b402e2739c392db9","modified":1588378551313},{"_id":"source/_posts/go-study-notes-func.md","hash":"d6a44e9035a448ffd2ed685ea49d0134a5163718","modified":1588378546905},{"_id":"source/_posts/go-study-notes-interface.md","hash":"0b7138b6b5b41b19af7b65150dac578fde8d2cb4","modified":1588378554769},{"_id":"source/_posts/go-study-notes-method.md","hash":"de36654e08e6e978229cdec111fcab14dfa8ad8e","modified":1588378558944},{"_id":"source/_posts/go-study-notes-package-context.md","hash":"611c85a3fa8a8ec20043595b70a52e2414be32c8","modified":1588670483525},{"_id":"source/_posts/go-study-notes-package-bufio.md","hash":"d67a2d6372d8ee07a6fbebb8b0468a461a2d1f48","modified":1588686155179},{"_id":"source/_posts/go-study-notes-package-encoding.md","hash":"4cd7bbc6dc975f6ee5fa48e617710157aa8631f3","modified":1590154146149},{"_id":"source/_posts/go-study-notes-package-fmt.md","hash":"fe85180c37f70247c82fe49d37e9995db208b07e","modified":1589687819114},{"_id":"source/_posts/go-study-notes-package-crypto.md","hash":"75936741f091bb71d280dd887d845dc6be943d0e","modified":1588671942435},{"_id":"source/_posts/go-study-notes-package-io.md","hash":"a43f455c43df258e3fe13ac65f116b135151ad97","modified":1588663501768},{"_id":"source/_posts/go-study-notes-package-http.md","hash":"2acae2aa77dd36b5550e40db3a56c55eaa4feb67","modified":1589110777375},{"_id":"source/_posts/go-study-notes-package-ioutil.md","hash":"8ccce2b60edaf7236657db447b085c82847dd34d","modified":1588599040018},{"_id":"source/_posts/go-study-notes-package-net.md","hash":"1a4270de30251a39f8eaeb6290dae8352fff8023","modified":1589110746774},{"_id":"source/_posts/go-study-notes-package-os.md","hash":"ec23c920ea6d38e98b05a012c72535f2ecd9ed65","modified":1588599478659},{"_id":"source/_posts/go-study-notes-package-runtime.md","hash":"4b989e3223144e53ec7fbfceabd23bf743085109","modified":1588599647523},{"_id":"source/_posts/go-study-notes-package-sort.md","hash":"3f1127435a7068ec53d9995a2e4eb505fb68dec6","modified":1589687819122},{"_id":"source/_posts/go-study-notes-package-sql.md","hash":"96fe55397c2ee3bb36a9653baea8e07973be19ef","modified":1589110850878},{"_id":"source/_posts/go-study-notes-package-strings.md","hash":"91501eb1722dd9baa8cf1d5756f3bbceac131b36","modified":1588599986811},{"_id":"source/_posts/go-study-notes-package-strconv.md","hash":"b00b7ff53f43123e75cd26ee9b07e46f4aabdcf7","modified":1588599792017},{"_id":"source/_posts/go-study-notes-package-sync.md","hash":"b4658b496abdc37a05bae8a82294f0e12184e17b","modified":1588670483531},{"_id":"source/_posts/go-study-notes-package-time.md","hash":"3c930c0bf1e615615645d7c530ecc2f17c87b1f4","modified":1589094617548},{"_id":"source/_posts/go-study-notes-package.md","hash":"8e14b76ccfd545ce0582446e547bab2308ffa3cd","modified":1588600521930},{"_id":"source/_posts/istio-adapter-configuration.md","hash":"22e70c4aac8aeb56d288261a2e8bc670b9c7e3fc","modified":1588244509966},{"_id":"source/_posts/istio-first-step.md","hash":"a8ca39e5bed859423a78a6aa71eac316c52ca3b7","modified":1588213795696},{"_id":"source/_posts/go-study-notes-reflect.md","hash":"4fc85a06b554907d4125896a18c685faa8756aa0","modified":1589594603632},{"_id":"source/_posts/istio-security-service.md","hash":"5f165ff578e8b05b2e04ee340aa3fb496c0cdae4","modified":1588247331140},{"_id":"source/_posts/istio-sidecar.md","hash":"fe652f3746b4d0a3356313a723f06a2cc7e3ab2d","modified":1588247714446},{"_id":"source/_posts/istio-traffic-control.md","hash":"cdc9f17ff828949d2fc4b3b4195e4d787654500a","modified":1587890816021},{"_id":"source/_posts/k8s-errors-and-resolve.md","hash":"8abbf2e20b61c29f7ea4160200292224f370b763","modified":1588378648658},{"_id":"source/categories/index.md","hash":"93f617516b4eb820eeaa942f04ba69b89f569f04","modified":1587879245881},{"_id":"source/tags/index.md","hash":"82bd5617c6bef3c37dc8f043d7b2711b132bc05f","modified":1587879056940},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"1a435c20ae8fa183d49bbf96ac956f7c6c25c8af","modified":1585668906000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"e554931b98f251fd49ff1d2443006d9ea2c20461","modified":1585668906000},{"_id":"themes/next/.github/issue_label_bot.yaml","hash":"fca600ddef6f80c5e61aeed21722d191e5606e5b","modified":1585668906000},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"aa4cb7aff595ca628cb58160ee1eee117989ec4e","modified":1585668906000},{"_id":"themes/next/.github/issue-close-app.yml","hash":"7cba457eec47dbfcfd4086acd1c69eaafca2f0cd","modified":1585668906000},{"_id":"themes/next/.github/config.yml","hash":"1d3f4e8794986817c0fead095c74f756d45f91ed","modified":1585668906000},{"_id":"themes/next/.github/lock.yml","hash":"61173b9522ebac13db2c544e138808295624f7fd","modified":1585668906000},{"_id":"source/_posts/monitor-etcd-with-kube-prometheus.md","hash":"73aaf3201ffcb8e2d1ad53589b3a668ec9f44e63","modified":1587890839246},{"_id":"themes/next/.github/mergeable.yml","hash":"0ee56e23bbc71e1e76427d2bd255a9879bd36e22","modified":1585668906000},{"_id":"themes/next/.github/release-drafter.yml","hash":"3cc10ce75ecc03a5ce86b00363e2a17eb65d15ea","modified":1585668906000},{"_id":"themes/next/.github/support.yml","hash":"d75db6ffa7b4ca3b865a925f9de9aef3fc51925c","modified":1585668906000},{"_id":"themes/next/.github/stale.yml","hash":"fdf82de9284f8bc8e0b0712b4cc1cb081a94de59","modified":1585668906000},{"_id":"themes/next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1585668906000},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"c7a994b9542040317d8f99affa1405c143a94a38","modified":1585668906000},{"_id":"themes/next/docs/DATA-FILES.md","hash":"cddbdc91ee9e65c37a50bec12194f93d36161616","modified":1585668906000},{"_id":"themes/next/docs/AUTHORS.md","hash":"10135a2f78ac40e9f46b3add3e360c025400752f","modified":1585668906000},{"_id":"themes/next/docs/INSTALLATION.md","hash":"af88bcce035780aaa061261ed9d0d6c697678618","modified":1585668906000},{"_id":"themes/next/docs/LICENSE.txt","hash":"368bf2c29d70f27d8726dd914f1b3211cae4bbab","modified":1585668906000},{"_id":"themes/next/languages/de.yml","hash":"74c59f2744217003b717b59d96e275b54635abf5","modified":1585668906000},{"_id":"themes/next/languages/en.yml","hash":"45bc5118828bdc72dcaa25282cd367c8622758cb","modified":1585668906000},{"_id":"themes/next/languages/ar.yml","hash":"9815e84e53d750c8bcbd9193c2d44d8d910e3444","modified":1585668906000},{"_id":"themes/next/languages/es.yml","hash":"c64cf05f356096f1464b4b1439da3c6c9b941062","modified":1585668906000},{"_id":"themes/next/languages/fa.yml","hash":"3676b32fda37e122f3c1a655085a1868fb6ad66b","modified":1585668906000},{"_id":"themes/next/languages/fr.yml","hash":"752bf309f46a2cd43890b82300b342d7218d625f","modified":1585668906000},{"_id":"themes/next/languages/hu.yml","hash":"b1ebb77a5fd101195b79f94de293bcf9001d996f","modified":1585668906000},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"94dc3404ccb0e5f663af2aa883c1af1d6eae553d","modified":1585668906000},{"_id":"themes/next/languages/id.yml","hash":"572ed855d47aafe26f58c73b1394530754881ec2","modified":1585668906000},{"_id":"themes/next/languages/it.yml","hash":"44759f779ce9c260b895532de1d209ad4bd144bf","modified":1585668906000},{"_id":"themes/next/languages/ja.yml","hash":"0cf0baa663d530f22ff380a051881216d6adcdd8","modified":1585668906000},{"_id":"themes/next/languages/ko.yml","hash":"0feea9e43cd399f3610b94d755a39fff1d371e97","modified":1585668906000},{"_id":"themes/next/languages/nl.yml","hash":"5af3473d9f22897204afabc08bb984b247493330","modified":1585668906000},{"_id":"themes/next/languages/pt-BR.yml","hash":"67555b1ba31a0242b12fc6ce3add28531160e35b","modified":1585668906000},{"_id":"themes/next/languages/pt.yml","hash":"718d131f42f214842337776e1eaddd1e9a584054","modified":1585668906000},{"_id":"themes/next/languages/ru.yml","hash":"e993d5ca072f7f6887e30fc0c19b4da791ca7a88","modified":1585668906000},{"_id":"themes/next/languages/tr.yml","hash":"fe793f4c2608e3f85f0b872fd0ac1fb93e6155e2","modified":1585668906000},{"_id":"themes/next/languages/uk.yml","hash":"3a6d635b1035423b22fc86d9455dba9003724de9","modified":1585668906000},{"_id":"themes/next/languages/vi.yml","hash":"93393b01df148dcbf0863f6eee8e404e2d94ef9e","modified":1585668906000},{"_id":"themes/next/languages/zh-CN.yml","hash":"a1f15571ee7e1e84e3cc0985c3ec4ba1a113f6f8","modified":1585668906000},{"_id":"themes/next/languages/zh-HK.yml","hash":"3789f94010f948e9f23e21235ef422a191753c65","modified":1585668906000},{"_id":"themes/next/languages/zh-TW.yml","hash":"8c09da7c4ec3fca2c6ee897b2eea260596a2baa1","modified":1585668906000},{"_id":"themes/next/layout/_layout.swig","hash":"6a6e92a4664cdb981890a27ac11fd057f44de1d5","modified":1585668906000},{"_id":"themes/next/layout/archive.swig","hash":"e4e31317a8df68f23156cfc49e9b1aa9a12ad2ed","modified":1585668906000},{"_id":"themes/next/layout/category.swig","hash":"1bde61cf4d2d171647311a0ac2c5c7933f6a53b0","modified":1585668906000},{"_id":"themes/next/layout/index.swig","hash":"7f403a18a68e6d662ae3e154b2c1d3bbe0801a23","modified":1585668906000},{"_id":"themes/next/layout/page.swig","hash":"db581bdeac5c75fabb0f17d7c5e746e47f2a9168","modified":1585668906000},{"_id":"themes/next/layout/post.swig","hash":"2f6d992ced7e067521fdce05ffe4fd75481f41c5","modified":1585668906000},{"_id":"themes/next/layout/tag.swig","hash":"0dfb653bd5de980426d55a0606d1ab122bd8c017","modified":1585668906000},{"_id":"themes/next/scripts/renderer.js","hash":"49a65df2028a1bc24814dc72fa50d52231ca4f05","modified":1585668906000},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"8b6e4b2c9cfcb969833092bdeaed78534082e3e6","modified":1585668906000},{"_id":"themes/next/docs/MATH.md","hash":"d645b025ec7fb9fbf799b9bb76af33b9f5b9ed93","modified":1585668906000},{"_id":"source/_posts/istio-first-step/service_discovery_on_pilot.png","hash":"46b00fe42d047d8c38070ee0de032060f5973462","modified":1583730556958},{"_id":"source/_posts/go-study-notes-package/package_initialization_process_in_go.jpg","hash":"69857f1397e0af617a1a211516e68233b415a865","modified":1588083567622},{"_id":"themes/next/.github/ISSUE_TEMPLATE/other.md","hash":"d3efc0df0275c98440e69476f733097916a2d579","modified":1585668906000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"12d99fb8b62bd9e34d9672f306c9ae4ace7e053e","modified":1585668906000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"c3e6b8196c983c40fd140bdeca012d03e6e86967","modified":1585668906000},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"34b88784ec120dfdc20fa82aadeb5f64ef614d14","modified":1585668906000},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"ca1030efdfca5e20f9db2e7a428998e66a24c0d0","modified":1585668906000},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"fb23b85db6f7d8279d73ae1f41631f92f64fc864","modified":1585668906000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/question.md","hash":"53df7d537e26aaf062d70d86835c5fd8f81412f3","modified":1585668906000},{"_id":"source/_posts/go-study-notes-reflect/conversion_between_actual_type_and_reflection.jpg","hash":"93d6a05aa23ee5655bee3cd88acba5f66e6307a6","modified":1588234932416},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"d3f03be036b75dc71cf3c366cd75aee7c127c874","modified":1585668906000},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"579c7bd8341873fb8be4732476d412814f1a3df7","modified":1585668906000},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"b92585d251f1f9ebe401abb5d932cb920f9b8b10","modified":1585668906000},{"_id":"themes/next/docs/zh-CN/README.md","hash":"c038629ff8f3f24e8593c4c8ecf0bef3a35c750d","modified":1585668906000},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"0bd2d696f62a997a11a7d84fec0130122234174e","modified":1585668906000},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"8b18f84503a361fc712b0fe4d4568e2f086ca97d","modified":1585668906000},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"d9ce7331c1236bbe0a551d56cef2405e47e65325","modified":1585668906000},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"c4ec5822d644ddcedf2401837e6f6e6d3b63fbcd","modified":1585668906000},{"_id":"themes/next/layout/_macro/post.swig","hash":"75422781aa1413ed1783e77ae757677b12b2e6bf","modified":1588247165627},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"9c4fe2873123bf9ceacab5c50d17d8a0f1baef27","modified":1585668906000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"53bff2242aae25ad95afd41d88f3f123b65b9a01","modified":1587889317934},{"_id":"themes/next/layout/_partials/comments.swig","hash":"db6ab5421b5f4b7cb32ac73ad0e053fdf065f83e","modified":1585668906000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"af2d688f688923080aaf8f20be33cfda629797ea","modified":1585668906000},{"_id":"themes/next/layout/_partials/languages.swig","hash":"ba9e272f1065b8f0e8848648caa7dea3f02c6be1","modified":1585668906000},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9876dbfc15713c7a47d4bcaa301f4757bd978269","modified":1585668906000},{"_id":"themes/next/layout/_partials/widgets.swig","hash":"83a40ce83dfd5cada417444fb2d6f5470aae6bb0","modified":1585668906000},{"_id":"themes/next/layout/_scripts/index.swig","hash":"cea942b450bcb0f352da78d76dc6d6f1d23d5029","modified":1585668906000},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"d1f2bfde6f1da51a2b35a7ab9e7e8eb6eefd1c6b","modified":1585668906000},{"_id":"themes/next/layout/_scripts/pjax.swig","hash":"4d2c93c66e069852bb0e3ea2e268d213d07bfa3f","modified":1585668906000},{"_id":"themes/next/layout/_scripts/three.swig","hash":"a4f42f2301866bd25a784a2281069d8b66836d0b","modified":1585668906000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"ef38c213679e7b6d2a4116f56c9e55d678446069","modified":1585668906000},{"_id":"themes/next/layout/_third-party/baidu-push.swig","hash":"8627c8c8b031ecee16c522433b66fa4d6979b8ea","modified":1585668906000},{"_id":"themes/next/layout/_third-party/index.swig","hash":"70c3c01dd181de81270c57f3d99b6d8f4c723404","modified":1585668906000},{"_id":"themes/next/layout/_third-party/quicklink.swig","hash":"311e5eceec9e949f1ea8d623b083cec0b8700ff2","modified":1585668906000},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"2731e262a6b88eaee2a3ca61e6a3583a7f594702","modified":1585668906000},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"aec50ed57b9d5d3faf2db3c88374f107203617e0","modified":1585668906000},{"_id":"themes/next/scripts/filters/front-matter.js","hash":"703bdd142a671b4b67d3d9dfb4a19d1dd7e7e8f7","modified":1585668906000},{"_id":"themes/next/scripts/filters/locals.js","hash":"b193a936ee63451f09f8886343dcfdca577c0141","modified":1585668906000},{"_id":"themes/next/scripts/filters/minify.js","hash":"19985723b9f677ff775f3b17dcebf314819a76ac","modified":1585668906000},{"_id":"themes/next/scripts/filters/post.js","hash":"d86849559ae54a4098aef4e2ab9dc8f99a1d186c","modified":1585668906000},{"_id":"themes/next/scripts/events/index.js","hash":"bf5e93f9209d111a014a7a6a17e86c05be552d13","modified":1585668906000},{"_id":"themes/next/scripts/helpers/engine.js","hash":"22d77bd511fc7c1bbd12339d65004ed5bfb0713c","modified":1585668906000},{"_id":"themes/next/scripts/helpers/font.js","hash":"40cf00e9f2b7aa6e5f33d412e03ed10304b15fd7","modified":1585668906000},{"_id":"themes/next/scripts/helpers/next-config.js","hash":"5e11f30ddb5093a88a687446617a46b048fa02e5","modified":1585668906000},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"958e86b2bd24e4fdfcbf9ce73e998efe3491a71f","modified":1585668906000},{"_id":"themes/next/scripts/tags/button.js","hash":"946dd7beede408d1f090d5e9774d74763828b97c","modified":1585668906000},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"94e0bbc7999b359baa42fa3731bdcf89c79ae2b3","modified":1585668906000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"0f133f27b61e8351cfd0959ba8a1b8551a9a8cc6","modified":1585668906000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"d902fd313e8d35c3cc36f237607c2a0536c9edf1","modified":1585668906000},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"983c6c4adea86160ecc0ba2204bc312aa338121d","modified":1585668906000},{"_id":"themes/next/scripts/tags/label.js","hash":"fc5b267d903facb7a35001792db28b801cccb1f8","modified":1585668906000},{"_id":"themes/next/scripts/tags/note.js","hash":"0a02bb4c15aec41f6d5f1271cdb5c65889e265d9","modified":1585668906000},{"_id":"themes/next/scripts/tags/pdf.js","hash":"8c613b39e7bff735473e35244b5629d02ee20618","modified":1585668906000},{"_id":"themes/next/scripts/tags/tabs.js","hash":"00ca6340d4fe0ccdae7525373e4729117775bbfa","modified":1585668906000},{"_id":"themes/next/scripts/tags/video.js","hash":"e5ff4c44faee604dd3ea9db6b222828c4750c227","modified":1585668906000},{"_id":"themes/next/source/css/_colors.styl","hash":"19c836f367977fb712b9868f3281ff5d757a8d5c","modified":1585668906000},{"_id":"themes/next/source/css/_mixins.styl","hash":"b79ff3debd5709397b122292fc7e551ae9d40782","modified":1585668906000},{"_id":"themes/next/source/css/main.styl","hash":"a3a3bbb5a973052f0186b3523911cb2539ff7b88","modified":1585668906000},{"_id":"themes/next/source/images/avatar.jpg","hash":"85b6e6718e1c3e3f4695b52323682e79f621da96","modified":1585878101235},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1585668906000},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1585668906000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1585668906000},{"_id":"themes/next/docs/ru/README.md","hash":"85dd68ed1250897a8e4a444a53a68c1d49eb7e11","modified":1585668906000},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"5237a368ab99123749d724b6c379415f2c142a96","modified":1585668906000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1585668906000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1585668906000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1585668906000},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1585668906000},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1585668906000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1585668906000},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1585668906000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1585668906000},{"_id":"themes/next/source/images/wechatpay.jpg","hash":"087de2089444fea40ce1d3bb00ce971e7ac02d72","modified":1585878809471},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1585668906000},{"_id":"themes/next/source/js/bookmark.js","hash":"a00945ff886e9f6f835731cdaf29a3a3727c8877","modified":1585668906000},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1585668906000},{"_id":"themes/next/source/js/motion.js","hash":"72df86f6dfa29cce22abeff9d814c9dddfcf13a9","modified":1585668906000},{"_id":"themes/next/source/js/next-boot.js","hash":"a22eeb6048ddd6b9224c8a671cbcfa303a2f7a1a","modified":1585668906000},{"_id":"themes/next/source/js/utils.js","hash":"95c5d37aa06521675afcf8619cfc5dbba3d2e18a","modified":1585668906000},{"_id":"themes/next/source/lib/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1585668906000},{"_id":"source/_posts/go-study-notes-basis/difference_between_valueType_and_referenceType.jpg","hash":"e5ec24d824375c6a42d9244dc0b421602c26e948","modified":1588299809086},{"_id":"source/_posts/istio-sidecar/istio_traffic_flow.png","hash":"85b4bda23e96bc7758cdc94acdb19bd4f400059b","modified":1583904367293},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1585668906000},{"_id":"themes/next/source/images/alipay.jpg","hash":"e59fd5af6a3f698e3bfa2eee7c722dec8d2dd728","modified":1585878853200},{"_id":"themes/next/source/js/algolia-search.js","hash":"23cc3c013185eb97ef347c3b4c92d928f2f3398f","modified":1585668906000},{"_id":"themes/next/source/js/local-search.js","hash":"b42bd1c883ce91db8632d96e0f0e062cb6b73adc","modified":1585668906000},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"000bad572d76ee95d9c0a78f9ccdc8d97cc7d4b4","modified":1585668906000},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"1ea12d4b9490d9065ebf1b8739b90ce5defd6398","modified":1585668906000},{"_id":"themes/next/layout/_partials/header/brand.swig","hash":"c70f8e71e026e878a4e9d5ab3bbbf9b0b23c240c","modified":1585668906000},{"_id":"themes/next/layout/_partials/header/index.swig","hash":"7dbe93b8297b746afb89700b4d29289556e85267","modified":1585668906000},{"_id":"themes/next/layout/_partials/header/menu-item.swig","hash":"12aeb9ee0d1d49d347f82a91e6bab568e1b59037","modified":1585668906000},{"_id":"themes/next/layout/_partials/header/menu.swig","hash":"958e097790551c9520426a1233add03515034f35","modified":1585668906000},{"_id":"themes/next/layout/_partials/header/sub-menu.swig","hash":"ae2261bea836581918a1c2b0d1028a78718434e0","modified":1585668906000},{"_id":"themes/next/layout/_partials/page/breadcrumb.swig","hash":"c851717497ca64789f2176c9ecd1dedab237b752","modified":1585668906000},{"_id":"themes/next/layout/_partials/page/page-header.swig","hash":"9b7a66791d7822c52117fe167612265356512477","modified":1585668906000},{"_id":"themes/next/layout/_partials/search/index.swig","hash":"2be50f9bfb1c56b85b3b6910a7df27f51143632c","modified":1585668906000},{"_id":"themes/next/layout/_partials/search/algolia-search.swig","hash":"48430bd03b8f19c9b8cdb2642005ed67d56c6e0b","modified":1585668906000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"f48a6a8eba04eb962470ce76dd731e13074d4c45","modified":1585668906000},{"_id":"themes/next/layout/_partials/post/post-copyright.swig","hash":"94d54b0c65d504f772af1e62424952e092b6c21d","modified":1585668906000},{"_id":"themes/next/layout/_partials/post/post-followme.swig","hash":"12cd9adb0c33adc484201f9e8a4e64ccf3011bae","modified":1585668906000},{"_id":"themes/next/layout/_partials/post/post-footer.swig","hash":"8f14f3f8a1b2998d5114cc56b680fb5c419a6b07","modified":1585668906000},{"_id":"themes/next/layout/_partials/post/post-related.swig","hash":"f79c44692451db26efce704813f7a8872b7e63a0","modified":1585668906000},{"_id":"themes/next/layout/_partials/post/post-reward.swig","hash":"54a65307512b9cd73a362594f5e6cc71a72474b2","modified":1587889767805},{"_id":"themes/next/layout/_partials/sidebar/site-overview.swig","hash":"ec20ff43845723e0ac2a245047c7a7e5aead6e88","modified":1585668906000},{"_id":"themes/next/layout/_scripts/pages/schedule.swig","hash":"077b5d66f6309f2e7dcf08645058ff2e03143e6c","modified":1585668906000},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"1c910fc066c06d5fbbe9f2b0c47447539e029af7","modified":1585668906000},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"7f14ef43d9e82bc1efc204c5adf0b1dbfc919a9f","modified":1585668906000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"7f14ef43d9e82bc1efc204c5adf0b1dbfc919a9f","modified":1585668906000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"1c910fc066c06d5fbbe9f2b0c47447539e029af7","modified":1585668906000},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"4790058691b7d36cf6d2d6b4e93795a7b8d608ad","modified":1585668906000},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"2fa2b51d56bfac6a1ea76d651c93b9c20b01c09b","modified":1585668906000},{"_id":"themes/next/layout/_third-party/analytics/growingio.swig","hash":"5adea065641e8c55994dd2328ddae53215604928","modified":1585668906000},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"1472cabb0181f60a6a0b7fec8899a4d03dfb2040","modified":1585668906000},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"f39a5bf3ce9ee9adad282501235e0c588e4356ec","modified":1585668906000},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"b14908644225d78c864cd0a9b60c52407de56183","modified":1585668906000},{"_id":"themes/next/layout/_third-party/comments/disqusjs.swig","hash":"82f5b6822aa5ec958aa987b101ef860494c6cf1f","modified":1585668906000},{"_id":"themes/next/layout/_third-party/comments/gitalk.swig","hash":"d6ceb70648555338a80ae5724b778c8c58d7060d","modified":1585668906000},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"f7a9eca599a682479e8ca863db59be7c9c7508c8","modified":1585668906000},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"be0a8eccf1f6dc21154af297fc79555343031277","modified":1585668906000},{"_id":"themes/next/layout/_third-party/chat/chatra.swig","hash":"f910618292c63871ca2e6c6e66c491f344fa7b1f","modified":1585668906000},{"_id":"themes/next/layout/_third-party/chat/tidio.swig","hash":"cba0e6e0fad08568a9e74ba9a5bee5341cfc04c1","modified":1585668906000},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"6c5976621efd5db5f7c4c6b4f11bc79d6554885f","modified":1585668906000},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"4791c977a730f29c846efcf6c9c15131b9400ead","modified":1585668906000},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"ecf751321e799f0fb3bf94d049e535130e2547aa","modified":1585668906000},{"_id":"themes/next/layout/_third-party/search/algolia-search.swig","hash":"d35a999d67f4c302f76fdf13744ceef3c6506481","modified":1585668906000},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"767b6c714c22588bcd26ba70b0fc19b6810cbacd","modified":1585668906000},{"_id":"themes/next/layout/_third-party/search/swiftype.swig","hash":"ba0dbc06b9d244073a1c681ff7a722dcbf920b51","modified":1585668906000},{"_id":"themes/next/layout/_third-party/statistics/busuanzi-counter.swig","hash":"d7258d02bcf0dac6c0fd8377c0909ddecb09d1d4","modified":1585668906000},{"_id":"themes/next/layout/_third-party/statistics/cnzz-analytics.swig","hash":"a17ace37876822327a2f9306a472974442c9005d","modified":1585668906000},{"_id":"themes/next/layout/_third-party/statistics/firestore.swig","hash":"b26ac2bfbe91dd88267f8b96aee6bb222b265b7a","modified":1585668906000},{"_id":"themes/next/layout/_third-party/statistics/index.swig","hash":"5f6a966c509680dbfa70433f9d658cee59c304d7","modified":1585668906000},{"_id":"themes/next/layout/_third-party/statistics/lean-analytics.swig","hash":"d56d5af427cdfecc33a0f62ee62c056b4e33d095","modified":1585668906000},{"_id":"themes/next/layout/_third-party/tags/mermaid.swig","hash":"f3c43664a071ff3c0b28bd7e59b5523446829576","modified":1585668906000},{"_id":"themes/next/layout/_third-party/tags/pdf.swig","hash":"d30b0e255a8092043bac46441243f943ed6fb09b","modified":1585668906000},{"_id":"themes/next/scripts/filters/comment/changyan.js","hash":"1f20213af8da3127701e6bb9da995e5c91be2051","modified":1585668906000},{"_id":"themes/next/scripts/filters/comment/common.js","hash":"0803d4f4d3d02c24417c163ad0b27b60fda79250","modified":1585668906000},{"_id":"themes/next/scripts/filters/comment/default-config.js","hash":"7f2d93af012c1e14b8596fecbfc7febb43d9b7f5","modified":1585668906000},{"_id":"themes/next/scripts/filters/comment/disqus.js","hash":"19cbd24880d0fbbd4d5698cd54da598f03b942da","modified":1585668906000},{"_id":"themes/next/scripts/filters/comment/disqusjs.js","hash":"7f8b92913d21070b489457fa5ed996d2a55f2c32","modified":1585668906000},{"_id":"themes/next/scripts/filters/comment/gitalk.js","hash":"e51dc3072c1ba0ea3008f09ecae8b46242ec6021","modified":1585668906000},{"_id":"themes/next/scripts/filters/comment/livere.js","hash":"d5fefc31fba4ab0188305b1af1feb61da49fdeb0","modified":1585668906000},{"_id":"themes/next/scripts/filters/comment/valine.js","hash":"6a72b5928cdab9526a288177991e4b2aedd028cf","modified":1585668906000},{"_id":"themes/next/scripts/events/lib/config.js","hash":"d34c6040b13649714939f59be5175e137de65ede","modified":1585668906000},{"_id":"themes/next/scripts/events/lib/injects-point.js","hash":"6661c1c91c7cbdefc6a5e6a034b443b8811235a1","modified":1585668906000},{"_id":"themes/next/scripts/events/lib/injects.js","hash":"f233d8d0103ae7f9b861344aa65c1a3c1de8a845","modified":1585668906000},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"f4e694e5db81e57442c7e34505a416d818b3044a","modified":1585668906000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"799fdf4f258a51d45d1e2b02fb59b337e46b5b3c","modified":1585668906000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"dae390efcb5da9c021ad7f25fe2d39ff36938cc6","modified":1585668906000},{"_id":"themes/next/source/js/schemes/pisces.js","hash":"3d9d3c14b77044d66be1898a9a934696e9127c82","modified":1585668906000},{"_id":"themes/next/source/js/schemes/muse.js","hash":"47c4f60eb7f7dc3303e84914b611dc34827069e1","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1585668906000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"62df49459d552bbf73841753da8011a1f5e875c8","modified":1585668906000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"f70be8e229da7e1715c11dd0e975a2e71e453ac8","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1585668906000},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1585668906000},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"ca5e70662dcfb261c25191cc5db5084dcf661c76","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"8e7b57a72e757cf95278239641726bb2d5b869d1","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/reading-progress.styl","hash":"2e3bf7baf383c9073ec5e67f157d3cb3823c0957","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"a1690e035b505d28bdef2b4424c13fc6312ab049","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"220da37051ed5dac9cf7bd126451f6aba4f94d21","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/buttons.styl","hash":"a2e9e00962e43e98ec2614d6d248ef1773bb9b78","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/comments.styl","hash":"b1f0fab7344a20ed6748b04065b141ad423cf4d9","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"b56367ea676ea8e8783ea89cd4ab150c7da7a060","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/pagination.styl","hash":"8f58570a1bbc34c4989a47a1b7d42a8030f38b06","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"523fb7b653b87ae37fc91fc8813e4ffad87b0d7e","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"b3bea92eef0e1fe2e7e294dac2184d16b5b8d666","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/toggles.styl","hash":"179e33b8ac7f4d8a8e76736a7e4f965fe9ab8b42","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"7785bd756e0c4acede3a47fec1ed7b55988385a5","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"a47725574e1bee3bc3b63b0ff2039cc982b17eff","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/mobile.styl","hash":"681d33e3bc85bdca407d93b134c089264837378c","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"f6516d0f7d89dc7b6c6e143a5af54b926f585d82","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Mist/_layout.styl","hash":"bb7ace23345364eb14983e860a7172e1683a4c94","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"7104b9cef90ca3b140d7a7afcf15540a250218fc","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expand.styl","hash":"6136da4bbb7e70cec99f5c7ae8c7e74f5e7c261a","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Muse/_header.styl","hash":"f0131db6275ceaecae7e1a6a3798b8f89f6c850d","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"4d1c17345d2d39ef7698f7acf82dfc0f59308c34","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"a717969829fa6ef88225095737df3f8ee86c286b","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Muse/_sub-menu.styl","hash":"c48ccd8d6651fe1a01faff8f01179456d39ba9b1","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Muse/_sidebar.styl","hash":"2b2e7b5cea7783c9c8bb92655e26a67c266886f0","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"5e644b1303ab6dcd1b65ee0fd6b91309b04ce64d","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Pisces/_header.styl","hash":"e282df938bd029f391c466168d0e68389978f120","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"70a4324b70501132855b5e59029acfc5d3da1ebd","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"ccb71d732b12acd02ac26ed6bbda4861d027857d","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"e4f958677a75de87ee1caf7e22ba46a0602f22dd","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"82025c3ad7af12e532e2e81be98deb0a74ff23ac","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1585668906000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1585668906000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"89f76380091f1be49936c69bac02e984dae5ff87","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f49ca072b5a800f735e8f01fc3518f885951dd8e","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"902569a9dea90548bec21a823dd3efd94ff7c133","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-header.styl","hash":"66211794e4ed47e779ca81150cef588e0b4f2fc5","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"ded41fd9d20a5e8db66aaff7cc50f105f5ef2952","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"72d495a88f7d6515af425c12cbc67308a57d88ea","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"796eb941ba0ca03fd5ca6d15a1f6a56afd9aa174","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"eca4d80dd0df1c3b1bc06bd39e6a4bd6c56198df","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"f5c2788a78790aca1a2f37f7149d6058afb539e0","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"99e12c9ce3d14d4837e3d3f12fc867ba9c565317","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"5b5649b9749e3fd8b63aef22ceeece0a6e1df605","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"a760ee83ba6216871a9f14c5e56dc9bd0d9e2103","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"fafc96c86926b22afba8bb9418c05e6afbc05a57","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"2bd0eb1512415325653b26d62a4463e6de83c5ac","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"7504dbc5c70262b048143b2c37d2b5aa2809afa2","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"c1daeb60c23945f745703ac2c3f4bf99d0ea3d95","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"7ddb7453bf9b85b01bff136e9d10a7f06baac9e8","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"8a7fc03a568b95be8d3337195e38bc7ec5ba2b23","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"b49e9fbd3c182b8fc066b8c2caf248e3eb748619","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"9a878d0119785a2316f42aebcceaa05a120b9a7a","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/footer/footer.styl","hash":"454a4aebfabb4469b92a8cbb49f46c49ac9bf165","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/header/github-banner.styl","hash":"e7a9fdb6478b8674b1cdf94de4f8052843fb71d9","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/post/post-followme.styl","hash":"1e4190c10c9e0c9ce92653b0dbcec21754b0b69d","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/header/header.styl","hash":"a793cfff86ad4af818faef04c18013077873f8f0","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/header/headerband.styl","hash":"0caf32492692ba8e854da43697a2ec8a41612194","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/header/site-meta.styl","hash":"45a239edca44acecf971d99b04f30a1aafbf6906","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/header/menu.styl","hash":"555762730f1f31451113e8fdc84ec438ea738d90","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/header/site-nav.styl","hash":"b2fc519828fe89a1f8f03ff7b809ad68cd46f3d7","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"2cb1876e9e0c9ac32160888af27b1178dbcb0616","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"fa0222197b5eee47e18ac864cdc6eac75678b8fe","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"44487d9ab290dc97871fa8dd4487016deb56e123","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"a237c290e8934d1a8cbbf22b3f30503d9663021d","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-dimmer.styl","hash":"9b479c2f9a9bfed77885e5093b8245cc5d768ec7","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"a960a2dd587b15d3b3fe1b59525d6fa971c6a6ec","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/third-party/search.styl","hash":"9f0b93d109c9aec79450c8a0cf4a4eab717d674d","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"a05a4031e799bc864a4536f9ef61fe643cd421af","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"b3220db827e1adbca7880c2bb23e78fa7cbe95cb","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/header/bookmark.styl","hash":"e02b1097a72a7d2ddc45ea8d53aa6d77c25ac407","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar.styl","hash":"a9cd93c36bae5af9223e7804963096274e8a4f03","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"f71a3e86c05ea668b008cf05a81f67d92b6d65e4","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/diff.styl","hash":"d3f73688bb7423e3ab0de1efdf6db46db5e34f80","modified":1585668906000},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"e2992846b39bf3857b5104675af02ba73e72eed5","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/highlight.styl","hash":"35c871a809afa8306c8cde13651010e282548bc6","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/theme.styl","hash":"3b3acc5caa0b95a2598bef4eeacb21bab21bea56","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"7213e3d0ad7c95717ecd4e701d6ee9248ef2bf9f","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"709d10f763e357e1472d6471f8be384ec9e2d983","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/tags/label.styl","hash":"d7fce4b51b5f4b7c31d93a9edb6c6ce740aa0d6b","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/tags/note.styl","hash":"9b3cce30c58e57b59e45d3f668a71a4129d3a8e4","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/tags/tabs.styl","hash":"f23670f1d8e749f3e83766d446790d8fd9620278","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/tags/tags.styl","hash":"9e4c0653cfd3cc6908fa0d97581bcf80861fb1e7","modified":1585668906000},{"_id":"themes/next/source/css/_common/outline/sidebar/site-state.styl","hash":"2a47f8a6bb589c2fb635e6c1e4a2563c7f63c407","modified":1585668906000},{"_id":"themes/next/source/css/_common/scaffolding/tags/pdf.styl","hash":"b49c64f8e9a6ca1c45c0ba98febf1974fdd03616","modified":1585668906000},{"_id":"source/_posts/istio-first-step/istio_working_mechanism_and_architecture.jpg","hash":"4a13c1130c993b51f91df270089d71095288ec57","modified":1583905017922},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1585668906000},{"_id":"public/search.xml","hash":"58960560824d09d00148c85093f46a503ba6d144","modified":1590759898258},{"_id":"public/categories/index.html","hash":"522c17918096f8d8757419c85b3527d2573eb0f2","modified":1591282503924},{"_id":"public/tags/index.html","hash":"c31d5129c58a080775015ba780e632f193fe04ec","modified":1591282503924},{"_id":"public/categories//prometheus/index.html","hash":"c023540449aefeaedc45144651351665b13ac162","modified":1591282503924},{"_id":"public/tags/kubernetes/index.html","hash":"ac0b18c27de1d28693821d56a00402c01f1c8aa2","modified":1591282503924},{"_id":"public/tags/etcd/index.html","hash":"0c5775d8a3bab036ed597461d094239c909d1700","modified":1591282503924},{"_id":"public/2020/05/17/go-study-notes-maybe-trap/index.html","hash":"af0ec440db50121ab4d6990acf660e1190a3ddf6","modified":1591282503924},{"_id":"public/2020/05/16/go-study-notes-package-sort/index.html","hash":"9c4c6f735e49cc11a99ed8cf939b817a10243570","modified":1591282503924},{"_id":"public/2020/05/16/go-study-notes-package-fmt/index.html","hash":"4c47ce998072e9289b5766c99ff89143fcb7236a","modified":1591282503924},{"_id":"public/2020/05/15/go-study-notes-package-encoding/index.html","hash":"eb0a760deb0165f6b61b0f0a33e8de05fed41926","modified":1591282503924},{"_id":"public/2020/05/10/go-study-notes-package-http/index.html","hash":"5f3de3bd0cb94e29fb2d5606eaa0bfc3ac651722","modified":1591282503924},{"_id":"public/2020/05/10/go-study-notes-package-net/index.html","hash":"3db80762bfb6401029bfd23c653a9f9631eb2e3b","modified":1591282503924},{"_id":"public/2020/05/06/go-study-notes-package-sql/index.html","hash":"487bb731672626abcae05a5e4a5127d465871878","modified":1591282503924},{"_id":"public/2020/05/05/go-study-notes-package-crypto/index.html","hash":"66819779fc3013c8fbf98bb71b9fd65407c01765","modified":1591282503924},{"_id":"public/2020/05/04/go-study-notes-package-context/index.html","hash":"ffb53b874bd021cd3f63ad05e81699bb49a7190d","modified":1591282503924},{"_id":"public/2020/05/04/go-study-notes-package-sync/index.html","hash":"6a224928f2f71129c90ba3cb62ed0581e5db2ba0","modified":1591282503924},{"_id":"public/2020/05/03/go-study-notes-package-runtime/index.html","hash":"6020c9a0375448fdb54167540b9f843cad09a8c1","modified":1591282503924},{"_id":"public/2020/05/03/go-study-notes-package-ioutil/index.html","hash":"243f1503935342272b839f9d459f69e091561041","modified":1591282503924},{"_id":"public/2020/05/03/go-study-notes-package-strconv/index.html","hash":"f02d6d4ecf44a5f344c44e45c70f7e88fd15d8af","modified":1591282503924},{"_id":"public/2020/05/02/go-study-notes-package-bufio/index.html","hash":"810ab2b6d830803855e551a0cc92e014dfecf540","modified":1591282503924},{"_id":"public/2020/05/02/go-study-notes-package-io/index.html","hash":"0085dcfccf0418c2d46f2c2f2d4397bc2b462c48","modified":1591282503924},{"_id":"public/2020/05/02/go-study-notes-package-os/index.html","hash":"eaec9770b2792eab9fa74fb21a670cf176efced4","modified":1591282503924},{"_id":"public/2020/05/01/go-study-notes-package-strings/index.html","hash":"b27e7b01099524353707f93ff57be3e65517fcf9","modified":1591282503924},{"_id":"public/2020/05/01/go-study-notes-package-time/index.html","hash":"0a33be0943cd60bccbfc1b2295cf7d016d7a3495","modified":1591282503924},{"_id":"public/2020/04/30/istio-sidecar/index.html","hash":"d6487fbcd27f7903db24974f0f14fdefccbda203","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-reflect/index.html","hash":"e5670719c27ea0c3abe278e861e091915e938f45","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-package/index.html","hash":"b9eabecf144227ec76e780138e6b0284e2e3f2f7","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-go-command/index.html","hash":"1e94e3aae3f1d754409f13f8b24db3d17497c0b4","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-concurrency/index.html","hash":"58a31d115e5bc7dcc265007ae03714283631406a","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-interface/index.html","hash":"eb235ee37504e167878049472ec471ce083eb20c","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-method/index.html","hash":"dcc1fcfce25ecea547e279edb7b0fd6db873c049","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-data-type/index.html","hash":"9edc1e578034801a4c588f5ad9bd130a6a50817a","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-func/index.html","hash":"215a8e3a3505b8ea9c9582c7b81023ecd306fd2c","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-expression/index.html","hash":"81cec1ba5526111ea7610baab0c04823873d63a8","modified":1591282503924},{"_id":"public/2020/04/30/go-study-notes-basis/index.html","hash":"8ead1d9df06353545990b7c34e1dbb8658807528","modified":1591282503924},{"_id":"public/2020/04/30/istio-security-service/index.html","hash":"5fbdb1aca81a464013a0c0d47218ff0061f6c0cd","modified":1591282503924},{"_id":"public/2020/04/03/istio-adapter-configuration/index.html","hash":"b8f4fd349d9a99232f37236225b001f5c70e1636","modified":1591282503924},{"_id":"public/2020/04/03/istio-traffic-control/index.html","hash":"9f3fbe3ac9cbc5d57e70022a6210adfe83d0abf9","modified":1591282503924},{"_id":"public/2020/04/03/istio-first-step/index.html","hash":"145ff5c432d8e750d138ce1e25820290beadd65d","modified":1591282503924},{"_id":"public/2020/04/03/monitor-etcd-with-kube-prometheus/index.html","hash":"9d15cd5882985945c07fdf3cf218d959f1dd32de","modified":1591282503924},{"_id":"public/2020/04/03/k8s-errors-and-resolve/index.html","hash":"fbe5da8b7baf29891812dc3efa3550619ecdf62c","modified":1591282503924},{"_id":"public/categories/go/index.html","hash":"1cba99eb3b61b6b2e86e4924e7efebcbf5743222","modified":1591282503924},{"_id":"public/categories/go/page/2/index.html","hash":"d5c996412804157f7ecffbe7747bfa4144f3d513","modified":1591282503924},{"_id":"public/categories/go/page/3/index.html","hash":"f8af18c85ab4f05c4754226c474a77f042afcf7a","modified":1591282503924},{"_id":"public/categories//index.html","hash":"59a07f9178efc3f5f3971fb562554f07a05c39e8","modified":1591282503924},{"_id":"public/categories//istio/index.html","hash":"d5bda15b66cc8f0467160e6bf652afc079f57aa5","modified":1591282503924},{"_id":"public/index.html","hash":"e69be9c2c63df30d5387e7dcd58b06efbf302a0b","modified":1591282503924},{"_id":"public/page/2/index.html","hash":"9b964ef3a295da7df3de9e9ec642cc1bd1432d4c","modified":1591282503924},{"_id":"public/page/3/index.html","hash":"a023a987aafbf82e7b3bb96841b8a9cb72a7ea3f","modified":1591282503924},{"_id":"public/page/4/index.html","hash":"19932c6a29c07a7e2d4b98505f79621dea38289d","modified":1591282503924},{"_id":"public/archives/index.html","hash":"d9289711448bc6800de8e12e7dfa5a3726859037","modified":1591282503924},{"_id":"public/archives/page/2/index.html","hash":"7701468fdb1fec4a8b3bf35d503c08bddf5766f1","modified":1591282503924},{"_id":"public/archives/page/3/index.html","hash":"8f07f022c34bf1c506da17d50d87df839fb679d1","modified":1591282503924},{"_id":"public/archives/page/4/index.html","hash":"f684a69bf61a178862ee730cd61fcb9ff18a8863","modified":1591282503924},{"_id":"public/archives/2020/index.html","hash":"03b9ee79fb34cddcb86db2cb4e1d79022f041a5a","modified":1591282503924},{"_id":"public/archives/2020/page/2/index.html","hash":"82a2377b359085491b7b7f7f7ba01e8dddf0ee97","modified":1591282503924},{"_id":"public/archives/2020/page/3/index.html","hash":"e649785fc4911dc81f2103aaceffd379bb7f10ea","modified":1591282503924},{"_id":"public/archives/2020/page/4/index.html","hash":"59b113ffa9cd38ee946714c6b465b915c337f923","modified":1591282503924},{"_id":"public/archives/2020/04/index.html","hash":"8252cfbbefd5d46372b97750a60a990b75f83848","modified":1591282503924},{"_id":"public/archives/2020/04/page/2/index.html","hash":"14cc584203a1f87052fa6855f39e91e36c0eff34","modified":1591282503924},{"_id":"public/archives/2020/05/index.html","hash":"e36ba8bc934925906dd910de460c08838234e2f3","modified":1591282503924},{"_id":"public/archives/2020/05/page/2/index.html","hash":"81845efa61010762c9771b581e75de595e7e4976","modified":1591282503924},{"_id":"public/tags/go/index.html","hash":"332ec878e111a52480d762fb59e45bab851ad663","modified":1591282503924},{"_id":"public/tags/go/page/2/index.html","hash":"cce5d480de44dacd986d325a1fbd91f05a0ce4c6","modified":1591282503924},{"_id":"public/tags/go/page/3/index.html","hash":"40eac16ed6199ab59e458d0abda0eb527dd739dd","modified":1591282503924},{"_id":"public/tags//index.html","hash":"221e9fc7dad647621af056023b5f948e4f0c9ac4","modified":1591282503924},{"_id":"public/tags//page/2/index.html","hash":"b106dd8b8371e9ce24f6e67ab301928b1a332891","modified":1591282503924},{"_id":"public/tags//page/3/index.html","hash":"115c4a4e283ca0cc240d357c1bcf55c29fbe1e92","modified":1591282503924},{"_id":"public/tags/istio/index.html","hash":"a59d731b3ef52ca704583a5d49e7624b7c3a8301","modified":1591282503924},{"_id":"public/tags//index.html","hash":"8c1098c4dddcd05bc3375b3bdc0b11a5f74258c6","modified":1591282503924},{"_id":"public/tags/prometheus/index.html","hash":"a7c7fece57188ea158476729df0633065205ff41","modified":1591282503924},{"_id":"public/images/avatar.jpg","hash":"85b6e6718e1c3e3f4695b52323682e79f621da96","modified":1589730532282},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1589730532282},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1589730532282},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1589730532282},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1589730532282},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1589730532282},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1589730532282},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1589730532282},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1589730532282},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1589730532282},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1589730532282},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1589730532282},{"_id":"public/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1589730532282},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1589730532282},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1589730532282},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1589730532282},{"_id":"public/2020/04/30/go-study-notes-package/package_initialization_process_in_go.jpg","hash":"69857f1397e0af617a1a211516e68233b415a865","modified":1589730532282},{"_id":"public/2020/04/30/go-study-notes-reflect/conversion_between_actual_type_and_reflection.jpg","hash":"93d6a05aa23ee5655bee3cd88acba5f66e6307a6","modified":1589730532282},{"_id":"public/2020/04/03/istio-first-step/service_discovery_on_pilot.png","hash":"46b00fe42d047d8c38070ee0de032060f5973462","modified":1589730532282},{"_id":"public/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1589730532282},{"_id":"public/images/wechatpay.jpg","hash":"087de2089444fea40ce1d3bb00ce971e7ac02d72","modified":1589730532282},{"_id":"public/images/alipay.jpg","hash":"e59fd5af6a3f698e3bfa2eee7c722dec8d2dd728","modified":1589730532282},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1589730532282},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1589730532282},{"_id":"public/2020/04/30/istio-sidecar/istio_traffic_flow.png","hash":"85b4bda23e96bc7758cdc94acdb19bd4f400059b","modified":1589730532282},{"_id":"public/js/bookmark.js","hash":"a00945ff886e9f6f835731cdaf29a3a3727c8877","modified":1589730532282},{"_id":"public/js/motion.js","hash":"72df86f6dfa29cce22abeff9d814c9dddfcf13a9","modified":1589730532282},{"_id":"public/js/next-boot.js","hash":"a22eeb6048ddd6b9224c8a671cbcfa303a2f7a1a","modified":1589730532282},{"_id":"public/js/utils.js","hash":"95c5d37aa06521675afcf8619cfc5dbba3d2e18a","modified":1589730532282},{"_id":"public/js/algolia-search.js","hash":"23cc3c013185eb97ef347c3b4c92d928f2f3398f","modified":1589730532282},{"_id":"public/js/schemes/pisces.js","hash":"3d9d3c14b77044d66be1898a9a934696e9127c82","modified":1589730532282},{"_id":"public/js/local-search.js","hash":"b42bd1c883ce91db8632d96e0f0e062cb6b73adc","modified":1589730532282},{"_id":"public/js/schemes/muse.js","hash":"47c4f60eb7f7dc3303e84914b611dc34827069e1","modified":1589730532282},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1589730532282},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1589730532282},{"_id":"public/css/main.css","hash":"c0227fb543d3bdf33f7e63ed4c0075b73946b0a2","modified":1589730532282},{"_id":"public/lib/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1589730532282},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1589730532282},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1589730532282},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1589730532282},{"_id":"public/2020/04/30/go-study-notes-basis/difference_between_valueType_and_referenceType.jpg","hash":"e5ec24d824375c6a42d9244dc0b421602c26e948","modified":1589730532282},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1589730532282},{"_id":"public/2020/04/03/istio-first-step/istio_working_mechanism_and_architecture.jpg","hash":"4a13c1130c993b51f91df270089d71095288ec57","modified":1589730532282},{"_id":"source/_posts/data-structure.md","hash":"5c3123d4d502bf99912c3d61b6db596b408ce7d0","modified":1590153992387},{"_id":"source/_posts/ELK-Stack.md","hash":"f73f21c45fe59db68ef682c8276220243ac08654","modified":1590194900280},{"_id":"source/_posts/ELK-Stack-Logstash-plugins.md","hash":"e0b7e931a5835f26cb1e831db695a73b13f68685","modified":1590195235374},{"_id":"source/_posts/gitlab-ci-pipeline-configuration.md","hash":"6089d971ac59b059a7fceb395696100ba59035a7","modified":1590153992404},{"_id":"source/_posts/go-study-notes-package-x509.md","hash":"0d0de594a9f2454abd678a48fe4a3c19ecdc4706","modified":1590153992411},{"_id":"source/_posts/go-study-notes-package-tls.md","hash":"10d0d434800f432b924d4e0952c9ee9a3649a631","modified":1590153992417},{"_id":"source/_posts/ELK-Stack-Elasticsearch-search.md","hash":"277ff444dc4888475fcc529e520d5650ccd9641e","modified":1590153992422},{"_id":"source/_posts/ELK-Stack/beat-for-data-collection.png","hash":"9dee31f4b0cf7797f9f993eb8eb30bd5445a8062","modified":1589865057131},{"_id":"source/_posts/ELK-Stack/introduce-message-queue.png","hash":"75c1e0ba27b0439ee1ff4f5fea75a396345a3aba","modified":1589869572914},{"_id":"public/categories//index.html","hash":"75755210db1bdc82cd581dd18321dd03a9a7c583","modified":1591282503924},{"_id":"public/categories/ELK/index.html","hash":"ec078cfff49c76e3edac2ff3c09c14444b2ffd56","modified":1591282503924},{"_id":"public/categories/CI-CD/index.html","hash":"706de48d2feeca86117fa49bc5d2233eecb501a4","modified":1591282503924},{"_id":"public/archives/page/5/index.html","hash":"c09739245e9536558f32b4e29eea3b662dcfd87f","modified":1591282503924},{"_id":"public/archives/2020/page/5/index.html","hash":"c1feb7df0ac14dc50b76086d420bd5705c58185a","modified":1591282503924},{"_id":"public/2020/05/22/go-study-notes-package-tls/index.html","hash":"ac78420c094391a81221fe8684127e519a2f4b81","modified":1591282503924},{"_id":"public/2020/05/22/gitlab-ci-pipeline-configuration/index.html","hash":"de93123cbce8abe4adff686bce7283afa53bdde1","modified":1591282503924},{"_id":"public/2020/05/22/ELK-Stack/index.html","hash":"a810eaf43ce0ddc2495e25dab66bc78aff1eb01a","modified":1591282503924},{"_id":"public/2020/05/22/ELK-Stack-Logstash-plugins/index.html","hash":"de4ddd6b0862f2be4fac91441097d9c7c03ca793","modified":1591282503924},{"_id":"public/2020/05/22/ELK-Stack-Elasticsearch-search/index.html","hash":"7127e82d653179724935ca2cdb795080b35c84f8","modified":1591282503924},{"_id":"public/2020/05/22/go-study-notes-package-x509/index.html","hash":"8ae4b3ec4a1693343f0de2505879f93c9d843bde","modified":1591282503924},{"_id":"public/2020/05/17/data-structure/index.html","hash":"78337cec238e1edbfd51be95bbe2997a846a84ae","modified":1591282503924},{"_id":"public/tags//index.html","hash":"d7808aa7007340ab5fd85d12b88462cc13e8be27","modified":1591282503924},{"_id":"public/tags/GitLab/index.html","hash":"b428fa2b97ee280fcdddcf96c87e8326ebafe898","modified":1591282503924},{"_id":"public/tags/ELK/index.html","hash":"d4774ecf59dddaa3d1c0796c18f28e1989f267c8","modified":1591282503924},{"_id":"public/tags//index.html","hash":"32040e738d3f0a4ef66ea87f94bd3fe74f5ee746","modified":1591282503924},{"_id":"public/tags//index.html","hash":"07f1b4ce11d7b08c6be4a9bcd05f69e5c5c6566b","modified":1591282503924},{"_id":"public/tags/CI-CD/index.html","hash":"7e16ff26806967c20f9b45b602ff02813d5776a3","modified":1591282503924},{"_id":"public/archives/2020/05/page/3/index.html","hash":"c6896b66cbb81b0c3617f7694620f05d8b08752b","modified":1591282503924},{"_id":"public/page/5/index.html","hash":"688d1e44a6e80d7dd8af70d42da2a36bcb2ec897","modified":1591282503924},{"_id":"public/2020/05/22/ELK-Stack/beat-for-data-collection.png","hash":"9dee31f4b0cf7797f9f993eb8eb30bd5445a8062","modified":1590154180622},{"_id":"public/2020/05/22/ELK-Stack/introduce-message-queue.png","hash":"75c1e0ba27b0439ee1ff4f5fea75a396345a3aba","modified":1590154180622},{"_id":"source/_posts/ELK-Stack/multi-logstash.png","hash":"331af8a54fc63330b59c44d03127765dbbe3e0cb","modified":1590194604939},{"_id":"source/_posts/ELK-Stack/the-simplest-architecture.png","hash":"68efd415075e8bc83e7d996624ca5c1b0386a36d","modified":1590194618129},{"_id":"public/2020/05/22/ELK-Stack/multi-logstash.png","hash":"331af8a54fc63330b59c44d03127765dbbe3e0cb","modified":1590194963176},{"_id":"public/2020/05/22/ELK-Stack/the-simplest-architecture.png","hash":"68efd415075e8bc83e7d996624ca5c1b0386a36d","modified":1590194963176},{"_id":"source/_posts/docker-need-to-know.md","hash":"e6e4a3daa4d33405d869855cc391eda3ee1f16e3","modified":1590759856959},{"_id":"public/categories/docker/index.html","hash":"c5b868a9ee5a45103413cddb3454a71cd30006e2","modified":1591282503924},{"_id":"public/tags/docker/index.html","hash":"346ffcc6f3e095ea44af5313f59c3abe493aa3cd","modified":1591282503924},{"_id":"public/2020/05/29/docker-need-to-know/index.html","hash":"0aca45af9b9934a5f3a045298cecd4f6d6594ae2","modified":1591282503924}],"Category":[{"name":"go","_id":"ckab8ihuv0004k8u75s6getlk"},{"name":"","_id":"ckab8ihvw002fk8u7cn0s6lq8"},{"name":"istio","parent":"ckab8ihvw002fk8u7cn0s6lq8","_id":"ckab8ihw1002xk8u79gefgeu4"},{"name":"prometheus","parent":"ckab8ihvw002fk8u7cn0s6lq8","_id":"ckab8ihx8004rk8u781oq15zn"},{"name":"","_id":"ckai8moxl0001gcu718jr2szh"},{"name":"ELK","_id":"ckai8moy60009gcu7cn5hhn56"},{"name":"CI/CD","_id":"ckai8moyd000kgcu7bnnh8wt9"},{"name":"docker","_id":"ckas9752j0001dwu7htrq3883"}],"Data":[],"Page":[{"title":"","date":"2020-04-26T05:33:27.000Z","type":"categories","layout":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: \ndate: 2020-04-26 13:33:27\ntype: categories\nlayout: categories\ncomments: false\n---\n","updated":"2020-04-26T05:34:05.881Z","path":"categories/index.html","_id":"ckab8ihut0001k8u70vi5aqje","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"","date":"2020-04-26T05:28:12.000Z","type":"tags","layout":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: \ndate: 2020-04-26 13:28:12\ntype: tags\nlayout: tags\ncomments: false\n---\n","updated":"2020-04-26T05:30:56.940Z","path":"tags/index.html","_id":"ckab8ihuu0003k8u75jj5cg8k","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"go ","abbrlink":14282,"description":" Go , ,  Go  , iota , .","_content":"\n\n# Go ?\n\n |  |  | \n:---: | :---: | :---: | :---:\nbool | 1 | false | \nbyte | 1 | 0 | uint8 (alias for uint8)\nint, uint | 4,8 | 0 | , 32  64 \nint8, uint8 | 1 | 0 | -127 ~ 128, 0 ~ 255\nint16, uint16 | 2 | 0 | -32768 ~ 32767, 0 ~ 65535\nint32, uint32 | 4 | 0 | -2^31 ~ 2^31 -1, 0~2^32\nint64, uint64 | 8 | 0 |\nfloat32 | 4 | 0.0 | \nfloat64 | 8 | 0.0 | \ncomplex64 | 8 |  |\ncomplex128 | 16 |  |\nrune | 4 | 0 | int32 (alias for uint8)\nuintptr | 4, 8 | 0 |  uint\nstring |  | \"\" | , ,  nil\narray | | | \nstruct | | | \nfunction | | nil | \ninterface | | nil | \nmap | | nil | , \nslice | | nil | , \nchannel | | nil | , \n\n# \n\n- \n- . , \"\"\n-  `bool`, (int, float ), `string` \n- , , , \n\n```go\nimport (\n    \"fmt\"\n)\n\nconst name string = \"name\"\nfunc main() {\n    age := 1\n    fmt.Printf(\"%p\", &name)  // cannot take the address of name \n    fmt.Printf(\"%v\", &age)  // ok\n}\n```\n\n# `iota` ? ?\n\n`iota`  Go ,  `const` ,  `const` (`const ()` ). :\n\n- `iota`  `const`  0\n- `const` **** `iota` ( 1).\n\n `iota` , . :\n\n-  `const` , `iota` 0\n\n```go\nconst a = iota // a = 0 \nconst (\n\tb = iota // b = 0 \n\tc        // c = 1    c = iota\n)\n```\n\n- **** 1\n\n```go\nconst (\n    a = iota  // iota = 0, a = 0\n    b         // iota = 1, b = iota,  b = 1\n    c = 100   // iota = 2, c = 100\n    d = iota  // iota = 3, d = 3\n)\nconst (\n\tA, B = iota + 1, iota + 2 // iota = 0, A = 1, B = 2\n\tC, D                      // iota = 1, C, D = iota + 1, iota + 2, C, D = 2, 3\n\tE, F                      // iota = 2, E, F = iota + 1, iota + 2, E, F = 3, 4\n)\n```\n\n- \n\n```go\ntype color int\n\nconst (\n    red color = iota\n    yellow\n    blue\n)\n\n// \ntype ByteSize float64\n\nconst (\n\t_           = iota             // ignore first value by assigning to blank identifier\n\tKB ByteSize = 1 << (10 * iota) // 1 << (10*1)\n\tMB                             // 1 << (10*2)\n\tGB                             // 1 << (10*3)\n\tTB                             // 1 << (10*4)\n\tPB                             // 1 << (10*5)\n\tEB                             // 1 << (10*6)\n\tZB                             // 1 << (10*7)\n\tYB                             // 1 << (10*8)\n)\n\nconst (\n\tSunday = iota\n\tMonday\n\tTuesday\n\tWednesday\n\tThursday\n\tFriday\n\tSaturday\n\tnumberOfDays // \n)\n```\n\n# \n\n `slice`, `map`, `channel`  3 \n\n, , . , , , , , .\n\n `make()` , .\n\n, . , , , , \n\n,, , , \n\n![](go-study-notes-basis/difference_between_valueType_and_referenceType.jpg)\n\n, , , , . , , , .\n\n# \n\n `type` , , , .\n\n,  `type integer int`, , , .\n, (). , , .\n\n# ()\n\n `bool`, `int`, `string` , `array`, `slice`, `map`, `channel` , \n\n, :\n\n- \n- \n- \n- \n- \n- (,,,)\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var a struct {\n        x int\n        y int\n    }\n    var b struct {\n        x int\n        y int\n    }\n    var a func(int, string)\n    fmt.Println(a == b)  // true\n}\n```","source":"_posts/go-study-notes-basis.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 14282\ndescription: ' Go , ,  Go  , iota , .'\n---\n\n\n# Go ?\n\n |  |  | \n:---: | :---: | :---: | :---:\nbool | 1 | false | \nbyte | 1 | 0 | uint8 (alias for uint8)\nint, uint | 4,8 | 0 | , 32  64 \nint8, uint8 | 1 | 0 | -127 ~ 128, 0 ~ 255\nint16, uint16 | 2 | 0 | -32768 ~ 32767, 0 ~ 65535\nint32, uint32 | 4 | 0 | -2^31 ~ 2^31 -1, 0~2^32\nint64, uint64 | 8 | 0 |\nfloat32 | 4 | 0.0 | \nfloat64 | 8 | 0.0 | \ncomplex64 | 8 |  |\ncomplex128 | 16 |  |\nrune | 4 | 0 | int32 (alias for uint8)\nuintptr | 4, 8 | 0 |  uint\nstring |  | \"\" | , ,  nil\narray | | | \nstruct | | | \nfunction | | nil | \ninterface | | nil | \nmap | | nil | , \nslice | | nil | , \nchannel | | nil | , \n\n# \n\n- \n- . , \"\"\n-  `bool`, (int, float ), `string` \n- , , , \n\n```go\nimport (\n    \"fmt\"\n)\n\nconst name string = \"name\"\nfunc main() {\n    age := 1\n    fmt.Printf(\"%p\", &name)  // cannot take the address of name \n    fmt.Printf(\"%v\", &age)  // ok\n}\n```\n\n# `iota` ? ?\n\n`iota`  Go ,  `const` ,  `const` (`const ()` ). :\n\n- `iota`  `const`  0\n- `const` **** `iota` ( 1).\n\n `iota` , . :\n\n-  `const` , `iota` 0\n\n```go\nconst a = iota // a = 0 \nconst (\n\tb = iota // b = 0 \n\tc        // c = 1    c = iota\n)\n```\n\n- **** 1\n\n```go\nconst (\n    a = iota  // iota = 0, a = 0\n    b         // iota = 1, b = iota,  b = 1\n    c = 100   // iota = 2, c = 100\n    d = iota  // iota = 3, d = 3\n)\nconst (\n\tA, B = iota + 1, iota + 2 // iota = 0, A = 1, B = 2\n\tC, D                      // iota = 1, C, D = iota + 1, iota + 2, C, D = 2, 3\n\tE, F                      // iota = 2, E, F = iota + 1, iota + 2, E, F = 3, 4\n)\n```\n\n- \n\n```go\ntype color int\n\nconst (\n    red color = iota\n    yellow\n    blue\n)\n\n// \ntype ByteSize float64\n\nconst (\n\t_           = iota             // ignore first value by assigning to blank identifier\n\tKB ByteSize = 1 << (10 * iota) // 1 << (10*1)\n\tMB                             // 1 << (10*2)\n\tGB                             // 1 << (10*3)\n\tTB                             // 1 << (10*4)\n\tPB                             // 1 << (10*5)\n\tEB                             // 1 << (10*6)\n\tZB                             // 1 << (10*7)\n\tYB                             // 1 << (10*8)\n)\n\nconst (\n\tSunday = iota\n\tMonday\n\tTuesday\n\tWednesday\n\tThursday\n\tFriday\n\tSaturday\n\tnumberOfDays // \n)\n```\n\n# \n\n `slice`, `map`, `channel`  3 \n\n, , . , , , , , .\n\n `make()` , .\n\n, . , , , , \n\n,, , , \n\n![](go-study-notes-basis/difference_between_valueType_and_referenceType.jpg)\n\n, , , , . , , , .\n\n# \n\n `type` , , , .\n\n,  `type integer int`, , , .\n, (). , , .\n\n# ()\n\n `bool`, `int`, `string` , `array`, `slice`, `map`, `channel` , \n\n, :\n\n- \n- \n- \n- \n- \n- (,,,)\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var a struct {\n        x int\n        y int\n    }\n    var b struct {\n        x int\n        y int\n    }\n    var a func(int, string)\n    fmt.Println(a == b)  // true\n}\n```","slug":"go-study-notes-basis","published":1,"date":"2020-04-30T09:57:48.604Z","updated":"2020-05-02T00:15:26.945Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihuo0000k8u7at72964z","content":"<h1 id=\"Go-\"><a href=\"#Go-\" class=\"headerlink\" title=\"Go ?\"></a>Go ?</h1><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">bool</td>\n<td align=\"center\">1</td>\n<td align=\"center\">false</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">byte</td>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">uint8 (alias for uint8)</td>\n</tr>\n<tr>\n<td align=\"center\">int, uint</td>\n<td align=\"center\">4,8</td>\n<td align=\"center\">0</td>\n<td align=\"center\">, 32  64 </td>\n</tr>\n<tr>\n<td align=\"center\">int8, uint8</td>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">-127 ~ 128, 0 ~ 255</td>\n</tr>\n<tr>\n<td align=\"center\">int16, uint16</td>\n<td align=\"center\">2</td>\n<td align=\"center\">0</td>\n<td align=\"center\">-32768 ~ 32767, 0 ~ 65535</td>\n</tr>\n<tr>\n<td align=\"center\">int32, uint32</td>\n<td align=\"center\">4</td>\n<td align=\"center\">0</td>\n<td align=\"center\">-2^31 ~ 2^31 -1, 0~2^32</td>\n</tr>\n<tr>\n<td align=\"center\">int64, uint64</td>\n<td align=\"center\">8</td>\n<td align=\"center\">0</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">float32</td>\n<td align=\"center\">4</td>\n<td align=\"center\">0.0</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">float64</td>\n<td align=\"center\">8</td>\n<td align=\"center\">0.0</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">complex64</td>\n<td align=\"center\">8</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">complex128</td>\n<td align=\"center\">16</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">rune</td>\n<td align=\"center\">4</td>\n<td align=\"center\">0</td>\n<td align=\"center\">int32 (alias for uint8)</td>\n</tr>\n<tr>\n<td align=\"center\">uintptr</td>\n<td align=\"center\">4, 8</td>\n<td align=\"center\">0</td>\n<td align=\"center\"> uint</td>\n</tr>\n<tr>\n<td align=\"center\">string</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">, ,  nil</td>\n</tr>\n<tr>\n<td align=\"center\">array</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">struct</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">function</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">interface</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">map</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\">, </td>\n</tr>\n<tr>\n<td align=\"center\">slice</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\">, </td>\n</tr>\n<tr>\n<td align=\"center\">channel</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\">, </td>\n</tr>\n</tbody></table>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li>. , </li>\n<li> <code>bool</code>, (int, float ), <code>string</code> </li>\n<li>, , , </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> name <span class=\"keyword\">string</span> = <span class=\"string\">\"name\"</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    age := <span class=\"number\">1</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%p\"</span>, &amp;name)  <span class=\"comment\">// cannot take the address of name </span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v\"</span>, &amp;age)  <span class=\"comment\">// ok</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"iota--\"><a href=\"#iota--\" class=\"headerlink\" title=\"iota ? ?\"></a><code>iota</code> ? ?</h1><p><code>iota</code>  Go ,  <code>const</code> ,  <code>const</code> (<code>const ()</code> ). :</p>\n<ul>\n<li><code>iota</code>  <code>const</code>  0</li>\n<li><code>const</code> <strong></strong> <code>iota</code> ( 1).</li>\n</ul>\n<p> <code>iota</code> , . :</p>\n<ul>\n<li> <code>const</code> , <code>iota</code> 0</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> a = <span class=\"literal\">iota</span> <span class=\"comment\">// a = 0 </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\tb = <span class=\"literal\">iota</span> <span class=\"comment\">// b = 0 </span></span><br><span class=\"line\">\tc        <span class=\"comment\">// c = 1    c = iota</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong> 1</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    a = <span class=\"literal\">iota</span>  <span class=\"comment\">// iota = 0, a = 0</span></span><br><span class=\"line\">    b         <span class=\"comment\">// iota = 1, b = iota,  b = 1</span></span><br><span class=\"line\">    c = <span class=\"number\">100</span>   <span class=\"comment\">// iota = 2, c = 100</span></span><br><span class=\"line\">    d = <span class=\"literal\">iota</span>  <span class=\"comment\">// iota = 3, d = 3</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\tA, B = <span class=\"literal\">iota</span> + <span class=\"number\">1</span>, <span class=\"literal\">iota</span> + <span class=\"number\">2</span> <span class=\"comment\">// iota = 0, A = 1, B = 2</span></span><br><span class=\"line\">\tC, D                      <span class=\"comment\">// iota = 1, C, D = iota + 1, iota + 2, C, D = 2, 3</span></span><br><span class=\"line\">\tE, F                      <span class=\"comment\">// iota = 2, E, F = iota + 1, iota + 2, E, F = 3, 4</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> color <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    red color = <span class=\"literal\">iota</span></span><br><span class=\"line\">    yellow</span><br><span class=\"line\">    blue</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByteSize <span class=\"keyword\">float64</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\t_           = <span class=\"literal\">iota</span>             <span class=\"comment\">// ignore first value by assigning to blank identifier</span></span><br><span class=\"line\">\tKB ByteSize = <span class=\"number\">1</span> &lt;&lt; (<span class=\"number\">10</span> * <span class=\"literal\">iota</span>) <span class=\"comment\">// 1 &lt;&lt; (10*1)</span></span><br><span class=\"line\">\tMB                             <span class=\"comment\">// 1 &lt;&lt; (10*2)</span></span><br><span class=\"line\">\tGB                             <span class=\"comment\">// 1 &lt;&lt; (10*3)</span></span><br><span class=\"line\">\tTB                             <span class=\"comment\">// 1 &lt;&lt; (10*4)</span></span><br><span class=\"line\">\tPB                             <span class=\"comment\">// 1 &lt;&lt; (10*5)</span></span><br><span class=\"line\">\tEB                             <span class=\"comment\">// 1 &lt;&lt; (10*6)</span></span><br><span class=\"line\">\tZB                             <span class=\"comment\">// 1 &lt;&lt; (10*7)</span></span><br><span class=\"line\">\tYB                             <span class=\"comment\">// 1 &lt;&lt; (10*8)</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\tSunday = <span class=\"literal\">iota</span></span><br><span class=\"line\">\tMonday</span><br><span class=\"line\">\tTuesday</span><br><span class=\"line\">\tWednesday</span><br><span class=\"line\">\tThursday</span><br><span class=\"line\">\tFriday</span><br><span class=\"line\">\tSaturday</span><br><span class=\"line\">\tnumberOfDays <span class=\"comment\">// </span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>slice</code>, <code>map</code>, <code>channel</code>  3 </p>\n<p>, , . , , , , , .</p>\n<p> <code>make()</code> , .</p>\n<p>, . , , , , </p>\n<p>,, , , </p>\n<p><img src=\"/2020/04/30/go-study-notes-basis/difference_between_valueType_and_referenceType.jpg\" alt=\"\"></p>\n<p>, , , , . , , , .</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>type</code> , , , .</p>\n<p>,  <code>type integer int</code>, , , .<br>, (). , , .</p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"()\"></a>()</h1><p> <code>bool</code>, <code>int</code>, <code>string</code> , <code>array</code>, <code>slice</code>, <code>map</code>, <code>channel</code> , </p>\n<p>, :</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>(,,,)</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> a <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        x <span class=\"keyword\">int</span></span><br><span class=\"line\">        y <span class=\"keyword\">int</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> b <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        x <span class=\"keyword\">int</span></span><br><span class=\"line\">        y <span class=\"keyword\">int</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> a <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(<span class=\"keyword\">int</span>, <span class=\"keyword\">string</span>)</span></span></span><br><span class=\"line\">    fmt.Println(a == b)  <span class=\"comment\">// true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Go-\"><a href=\"#Go-\" class=\"headerlink\" title=\"Go ?\"></a>Go ?</h1><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">bool</td>\n<td align=\"center\">1</td>\n<td align=\"center\">false</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">byte</td>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">uint8 (alias for uint8)</td>\n</tr>\n<tr>\n<td align=\"center\">int, uint</td>\n<td align=\"center\">4,8</td>\n<td align=\"center\">0</td>\n<td align=\"center\">, 32  64 </td>\n</tr>\n<tr>\n<td align=\"center\">int8, uint8</td>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">-127 ~ 128, 0 ~ 255</td>\n</tr>\n<tr>\n<td align=\"center\">int16, uint16</td>\n<td align=\"center\">2</td>\n<td align=\"center\">0</td>\n<td align=\"center\">-32768 ~ 32767, 0 ~ 65535</td>\n</tr>\n<tr>\n<td align=\"center\">int32, uint32</td>\n<td align=\"center\">4</td>\n<td align=\"center\">0</td>\n<td align=\"center\">-2^31 ~ 2^31 -1, 0~2^32</td>\n</tr>\n<tr>\n<td align=\"center\">int64, uint64</td>\n<td align=\"center\">8</td>\n<td align=\"center\">0</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">float32</td>\n<td align=\"center\">4</td>\n<td align=\"center\">0.0</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">float64</td>\n<td align=\"center\">8</td>\n<td align=\"center\">0.0</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">complex64</td>\n<td align=\"center\">8</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">complex128</td>\n<td align=\"center\">16</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">rune</td>\n<td align=\"center\">4</td>\n<td align=\"center\">0</td>\n<td align=\"center\">int32 (alias for uint8)</td>\n</tr>\n<tr>\n<td align=\"center\">uintptr</td>\n<td align=\"center\">4, 8</td>\n<td align=\"center\">0</td>\n<td align=\"center\"> uint</td>\n</tr>\n<tr>\n<td align=\"center\">string</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">, ,  nil</td>\n</tr>\n<tr>\n<td align=\"center\">array</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">struct</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">function</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">interface</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">map</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\">, </td>\n</tr>\n<tr>\n<td align=\"center\">slice</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\">, </td>\n</tr>\n<tr>\n<td align=\"center\">channel</td>\n<td align=\"center\"></td>\n<td align=\"center\">nil</td>\n<td align=\"center\">, </td>\n</tr>\n</tbody></table>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li>. , </li>\n<li> <code>bool</code>, (int, float ), <code>string</code> </li>\n<li>, , , </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> name <span class=\"keyword\">string</span> = <span class=\"string\">\"name\"</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    age := <span class=\"number\">1</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%p\"</span>, &amp;name)  <span class=\"comment\">// cannot take the address of name </span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v\"</span>, &amp;age)  <span class=\"comment\">// ok</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"iota--\"><a href=\"#iota--\" class=\"headerlink\" title=\"iota ? ?\"></a><code>iota</code> ? ?</h1><p><code>iota</code>  Go ,  <code>const</code> ,  <code>const</code> (<code>const ()</code> ). :</p>\n<ul>\n<li><code>iota</code>  <code>const</code>  0</li>\n<li><code>const</code> <strong></strong> <code>iota</code> ( 1).</li>\n</ul>\n<p> <code>iota</code> , . :</p>\n<ul>\n<li> <code>const</code> , <code>iota</code> 0</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> a = <span class=\"literal\">iota</span> <span class=\"comment\">// a = 0 </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\tb = <span class=\"literal\">iota</span> <span class=\"comment\">// b = 0 </span></span><br><span class=\"line\">\tc        <span class=\"comment\">// c = 1    c = iota</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong> 1</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    a = <span class=\"literal\">iota</span>  <span class=\"comment\">// iota = 0, a = 0</span></span><br><span class=\"line\">    b         <span class=\"comment\">// iota = 1, b = iota,  b = 1</span></span><br><span class=\"line\">    c = <span class=\"number\">100</span>   <span class=\"comment\">// iota = 2, c = 100</span></span><br><span class=\"line\">    d = <span class=\"literal\">iota</span>  <span class=\"comment\">// iota = 3, d = 3</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\tA, B = <span class=\"literal\">iota</span> + <span class=\"number\">1</span>, <span class=\"literal\">iota</span> + <span class=\"number\">2</span> <span class=\"comment\">// iota = 0, A = 1, B = 2</span></span><br><span class=\"line\">\tC, D                      <span class=\"comment\">// iota = 1, C, D = iota + 1, iota + 2, C, D = 2, 3</span></span><br><span class=\"line\">\tE, F                      <span class=\"comment\">// iota = 2, E, F = iota + 1, iota + 2, E, F = 3, 4</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> color <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    red color = <span class=\"literal\">iota</span></span><br><span class=\"line\">    yellow</span><br><span class=\"line\">    blue</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByteSize <span class=\"keyword\">float64</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\t_           = <span class=\"literal\">iota</span>             <span class=\"comment\">// ignore first value by assigning to blank identifier</span></span><br><span class=\"line\">\tKB ByteSize = <span class=\"number\">1</span> &lt;&lt; (<span class=\"number\">10</span> * <span class=\"literal\">iota</span>) <span class=\"comment\">// 1 &lt;&lt; (10*1)</span></span><br><span class=\"line\">\tMB                             <span class=\"comment\">// 1 &lt;&lt; (10*2)</span></span><br><span class=\"line\">\tGB                             <span class=\"comment\">// 1 &lt;&lt; (10*3)</span></span><br><span class=\"line\">\tTB                             <span class=\"comment\">// 1 &lt;&lt; (10*4)</span></span><br><span class=\"line\">\tPB                             <span class=\"comment\">// 1 &lt;&lt; (10*5)</span></span><br><span class=\"line\">\tEB                             <span class=\"comment\">// 1 &lt;&lt; (10*6)</span></span><br><span class=\"line\">\tZB                             <span class=\"comment\">// 1 &lt;&lt; (10*7)</span></span><br><span class=\"line\">\tYB                             <span class=\"comment\">// 1 &lt;&lt; (10*8)</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\tSunday = <span class=\"literal\">iota</span></span><br><span class=\"line\">\tMonday</span><br><span class=\"line\">\tTuesday</span><br><span class=\"line\">\tWednesday</span><br><span class=\"line\">\tThursday</span><br><span class=\"line\">\tFriday</span><br><span class=\"line\">\tSaturday</span><br><span class=\"line\">\tnumberOfDays <span class=\"comment\">// </span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>slice</code>, <code>map</code>, <code>channel</code>  3 </p>\n<p>, , . , , , , , .</p>\n<p> <code>make()</code> , .</p>\n<p>, . , , , , </p>\n<p>,, , , </p>\n<p><img src=\"/2020/04/30/go-study-notes-basis/difference_between_valueType_and_referenceType.jpg\" alt=\"\"></p>\n<p>, , , , . , , , .</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>type</code> , , , .</p>\n<p>,  <code>type integer int</code>, , , .<br>, (). , , .</p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"()\"></a>()</h1><p> <code>bool</code>, <code>int</code>, <code>string</code> , <code>array</code>, <code>slice</code>, <code>map</code>, <code>channel</code> , </p>\n<p>, :</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>(,,,)</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> a <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        x <span class=\"keyword\">int</span></span><br><span class=\"line\">        y <span class=\"keyword\">int</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> b <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        x <span class=\"keyword\">int</span></span><br><span class=\"line\">        y <span class=\"keyword\">int</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> a <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(<span class=\"keyword\">int</span>, <span class=\"keyword\">string</span>)</span></span></span><br><span class=\"line\">    fmt.Println(a == b)  <span class=\"comment\">// true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go ","abbrlink":16200,"description":" Go , ,  Go , , , , ","_content":"\n#  `string`\n\n `string`  Go ,  UTF-8 (byte).\n\n:\n\n-  `nil`,  `\"\"`\n- , \n- (\\`), \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main(){\n    var str string\n    fmt.Println(str) // \"\"\n    str = \"string\"\n    fmt.Print(str[1:3])       // tr\n    // fmt.Printf(\"%p\", &str[1]) //  cannot take the address of 'str[1]',  str[1] \n    // str[1] = 'x'              // , cannot assign to str[1], , \n    multiLine := `line \\n\n    \t    line2`\n    fmt.Println(multiLine)    //   multiLine ,\n}\n```\n\n-  for ,  `byte`  `rune` \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main(){\n    str := \"Hello !\"\n    \n    for i := 0; i < len(str); i++ {\n    \tfmt.Printf(\"%v: %v\\n\", i, str[i])\n    }\n    for i, v := range str {\n        fmt.Printf(\"%v: %v\\n\", i, v)\n    }\n}\n//  for-range (rune),  for-i (byte)\n```\n\n- ,  `[]rune`  `[]byte` ,  `string()` .\n\n#  `array`\n\n:\n\n```go\nvar name [len]Type = [len]Type{element1, element2, element3...}\n```\n\n:\n\n- , . .\n- \n- ,  `[...]Type` , , . ,  `...`\n-  `len()`, `cap()` \n- ,  `arr := [3]*int{&x, &y}` , , `&arr`. \n- , , ,\n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test1(x [2]int) {\n\tfmt.Printf(\"x: %p, %v\\n\", &x, x)\n}\n\nfunc test2(p *[2]int) {\n    fmt.Printf(\"p: %p, %v\\n\", p, *p)\n    p[1] += 100\n}\n\nfunc main() {\n\ta := [2]int{1, 2}\n\tb := a\n\tfmt.Printf(\"a: %p, %v\\n\", &a, a)\n\tfmt.Printf(\"b: %p, %v\\n\", &b, b)\n\ttest1(a)\n    test2(&a)\n    fmt.Printf(\"a: %p, %v\\n\", &a, a)\n}\n// a: 0xc00000a0d0, [1 2]\n// b: 0xc00000a0e0, [1 2]\n// x: 0xc00000a130, [1 2]\n// p: 0xc00000a0d0, [1 2]\n// a: 0xc00000a0d0, [1 102]\n```\n\n#  `slice`\n\n\n\n```go\nvar sliceName []Type = []Type{element1, element2, element3...}\n```\n\n:\n\n\n-  `make([]Type, len, cap)`  `len` ,  `cap` .  `cap` , ( `len`),  `len`. , \n- ****, \n- , . \n-  `var s []int`  `nil` \n- \n- `append()` , ,  `append`  `cap` , .  `cap`  `cap` \n- `copy(dst, src []Type)` , .\n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var nilSli []int\n\tfmt.Println(nilArr == nil)  // true\n\tsli := make([]int, 2, 5)\n\tfmt.Printf(\"%p,%v,%v,%p\\n\", &sli, len(sli), cap(sli), &sli[0])\n\tarr = append(arr, []int{1, 2, 3, 4, 5, 6}...)\n\tfmt.Printf(\"%p,%v,%v,%p\\n\", &sli, len(sli), cap(sli), &sli[0])  \n    //  append  `&arr` ,  `cap(arr)  2 ,()\n\tp := &sli\n\tp0 := &sli[0]\n\tp1 := &sli[1]\n\tfmt.Printf(\"%p,%p,%p\\n\", p, p0, p1)\n\t(*p)[0] += 100\n\t*p1 += 100\n\tfmt.Printf(\"%v\\n\", sli) // [100 100 1 2 3 4 5 6]\n}\n// \n// true\n// 0xc0000044c0,2,5,0xc00000c300\n// 0xc0000044c0,8,10,0xc000014190\n// 0xc0000044c0,0xc000014190,0xc000014198\n// [100 100 1 2 3 4 5 6]\n```\n\n```go\nimport \"fmt\"\n\nfunc change(s []int) {\n    s[0] += 100\n    fmt.Printf(\"%v,%p\\n\", s, &s)\n}\n\nfunc main() {\n    s := []int{1, 20, 32}  //  var s = make([]int, 3, 3); s = []int{1, 20, 32}\n    fmt.Printf(\"%v,%p\\n\", s, &s)\n    change(s)\n    fmt.Printf(\"%v,%p\\n\", s, &s)\n}\n// \n// [1 20 32],0xc0000044c0\n// [101 20 32],0xc000004520\n// [101 20 32],0xc0000044c0\n```\n\n#  `map`\n\n:\n\n```go\nvar mapName map[KeyType]ValueType = map[KeyType]ValueType{\n    KeyType: ValueType,\n    // ...\n}\n```\n\n:\n\n- ,  `make(map[KeyType]ValueType, size)` . ,  `nil` \n-  `len()` \n- Key (`==`, `!=`), ,,,,,.\n- ,  `v, ok := m[key]` .  `ok` . , `ok`  `true`; ,  `false`\n- ,  for-range , \n- ,  \"not addressable\",  `value` ().  `value`, . \n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var nilMap map[string]string\n\tfmt.Println(nilMap == nil)\n\tm := make(map[string]user, 2)\n\tfmt.Printf(\"%p,%v\\n\", &m, m)\n\tm[\"tom\"] = user{\"tom\", 20}\n\tm[\"jack\"] = user{\"jack\", 21}\n\tm[\"lucy\"] = user{\"lucy\", 19}\n\tv, ok := m[\"liming\"]\n\tif ok {\n\t\tfmt.Println(v)\n\t}\n\tfmt.Printf(\"%p,%v\\n\", &m, m)\n\tfor k, v := range m {\n\t\tfmt.Println(k, v)  // \n\t}\n\t//m[\"lucy\"].age += 1 // , cannot assign to `m[\"lucy\"].age`, \n\tlucy := m[\"lucy\"]\n\tlucy.age += 1\n\tm[\"lucy\"] = lucy\n\tfmt.Println(m)\n}\n// \n// true\n// 0xc000006030,map[]\n// 0xc000006030,map[jack:{jack 21} lucy:{tom 19} tom:{tom 20}]\n// tom {tom 20}\n// jack {jack 21}\n// lucy {tom 19}\n// map[jack:{jack 21} lucy:{tom 20} tom:{tom 20}]\n```\n\n#  `struct`\n\n`struct` , ``. \n\n```go\ntype structName struct{\n    fieldName fieldType\n    // ...\n}\n```\n\n:\n\n- ,  `_` (). , , \n-  `structName.fieldName` . ,  `structName.fieldType` \n-  Go ,  ,  `p := &structName`,  `*(p).fieldName`  `p.fieldName`\n- , :****.\n- **, (innerStructName)(outerStructName) `fieldName`,  `outerStructName.fieldName` .  `fieldName`  `outerStructName.innerStructFieldName.fieldName` .\n`innerFieldName`,  `outerStructName.innerFieldName`  `innerFieldName` .**\n- , ,\n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\ntype test struct {\n\tName string\n\tAge  int\n\t_    string\n\t_    string\n\tint\n\t//int  // ,  int\n}\ntype user struct {\n\tname string\n\tinneruser1\n\tinneruser2\n}\ntype inneruser1 struct {\n\tname string\n\tage  int\n}\ntype inneruser2 struct {\n\tname  string\n\tage   int\n\tscore float64\n}\n\nfunc main() {\n\tt := test{\n\t\tName: \"test\",\n\t\tAge:  20,\n\t\tint:  4,\n\t}\n    fmt.Println(t)\n\tu := user{\n\t\tname:       \"outeruser\",\n\t\tinneruser1: inneruser1{\"inneruser1\", 10},\n\t\tinneruser2: inneruser2{\"inneruser2\", 20, 89.5},\n\t}\n\tfmt.Println(u.name)\n\t// fmt.Println(u.age) // , Ambiguous reference 'age',  age\n\tfmt.Println(u.inneruser1.age)\n\tfmt.Println(u.score)\n}\n// \n// {test 20   4}\n// outeruser\n// 10\n// 89.5\n```\n\n## \n\n, . \n\n- , , , .\n-  Go . ,  json \n\n: \n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"encoding/json\"\n)\n\ntype user struct {\n\tName string `json:\"name\"` // ``  tag \n\tAge  int    `json:\"age\"`\n}\n\nfunc main() {\n\tu := user{\n\t\tName: \"tom\",\n\t\tAge:  10,\n\t}\n\tval := reflect.ValueOf(u)\n\tvalType := val.Type()\n\tfor i := 0; i < val.NumField(); i++ {\n\t\tfmt.Printf(\"%v: %v\\n\", valType.Field(i).Tag.Get(\"json\"), val.Field(i))\n\t}\n    \n    str, err := json.Marshal(u)\n    if err != nil {\n    \tfmt.Println(\"\")\n    }\n    fmt.Println(string(str))\n\n}\n// :\n// name: tom\n// age: 10\n// {\"name\":\"tom\",\"age\":10}\n```","source":"_posts/go-study-notes-data-type.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 16200\ndescription: ' Go , ,  Go , , , , '\n---\n\n#  `string`\n\n `string`  Go ,  UTF-8 (byte).\n\n:\n\n-  `nil`,  `\"\"`\n- , \n- (\\`), \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main(){\n    var str string\n    fmt.Println(str) // \"\"\n    str = \"string\"\n    fmt.Print(str[1:3])       // tr\n    // fmt.Printf(\"%p\", &str[1]) //  cannot take the address of 'str[1]',  str[1] \n    // str[1] = 'x'              // , cannot assign to str[1], , \n    multiLine := `line \\n\n    \t    line2`\n    fmt.Println(multiLine)    //   multiLine ,\n}\n```\n\n-  for ,  `byte`  `rune` \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main(){\n    str := \"Hello !\"\n    \n    for i := 0; i < len(str); i++ {\n    \tfmt.Printf(\"%v: %v\\n\", i, str[i])\n    }\n    for i, v := range str {\n        fmt.Printf(\"%v: %v\\n\", i, v)\n    }\n}\n//  for-range (rune),  for-i (byte)\n```\n\n- ,  `[]rune`  `[]byte` ,  `string()` .\n\n#  `array`\n\n:\n\n```go\nvar name [len]Type = [len]Type{element1, element2, element3...}\n```\n\n:\n\n- , . .\n- \n- ,  `[...]Type` , , . ,  `...`\n-  `len()`, `cap()` \n- ,  `arr := [3]*int{&x, &y}` , , `&arr`. \n- , , ,\n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test1(x [2]int) {\n\tfmt.Printf(\"x: %p, %v\\n\", &x, x)\n}\n\nfunc test2(p *[2]int) {\n    fmt.Printf(\"p: %p, %v\\n\", p, *p)\n    p[1] += 100\n}\n\nfunc main() {\n\ta := [2]int{1, 2}\n\tb := a\n\tfmt.Printf(\"a: %p, %v\\n\", &a, a)\n\tfmt.Printf(\"b: %p, %v\\n\", &b, b)\n\ttest1(a)\n    test2(&a)\n    fmt.Printf(\"a: %p, %v\\n\", &a, a)\n}\n// a: 0xc00000a0d0, [1 2]\n// b: 0xc00000a0e0, [1 2]\n// x: 0xc00000a130, [1 2]\n// p: 0xc00000a0d0, [1 2]\n// a: 0xc00000a0d0, [1 102]\n```\n\n#  `slice`\n\n\n\n```go\nvar sliceName []Type = []Type{element1, element2, element3...}\n```\n\n:\n\n\n-  `make([]Type, len, cap)`  `len` ,  `cap` .  `cap` , ( `len`),  `len`. , \n- ****, \n- , . \n-  `var s []int`  `nil` \n- \n- `append()` , ,  `append`  `cap` , .  `cap`  `cap` \n- `copy(dst, src []Type)` , .\n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var nilSli []int\n\tfmt.Println(nilArr == nil)  // true\n\tsli := make([]int, 2, 5)\n\tfmt.Printf(\"%p,%v,%v,%p\\n\", &sli, len(sli), cap(sli), &sli[0])\n\tarr = append(arr, []int{1, 2, 3, 4, 5, 6}...)\n\tfmt.Printf(\"%p,%v,%v,%p\\n\", &sli, len(sli), cap(sli), &sli[0])  \n    //  append  `&arr` ,  `cap(arr)  2 ,()\n\tp := &sli\n\tp0 := &sli[0]\n\tp1 := &sli[1]\n\tfmt.Printf(\"%p,%p,%p\\n\", p, p0, p1)\n\t(*p)[0] += 100\n\t*p1 += 100\n\tfmt.Printf(\"%v\\n\", sli) // [100 100 1 2 3 4 5 6]\n}\n// \n// true\n// 0xc0000044c0,2,5,0xc00000c300\n// 0xc0000044c0,8,10,0xc000014190\n// 0xc0000044c0,0xc000014190,0xc000014198\n// [100 100 1 2 3 4 5 6]\n```\n\n```go\nimport \"fmt\"\n\nfunc change(s []int) {\n    s[0] += 100\n    fmt.Printf(\"%v,%p\\n\", s, &s)\n}\n\nfunc main() {\n    s := []int{1, 20, 32}  //  var s = make([]int, 3, 3); s = []int{1, 20, 32}\n    fmt.Printf(\"%v,%p\\n\", s, &s)\n    change(s)\n    fmt.Printf(\"%v,%p\\n\", s, &s)\n}\n// \n// [1 20 32],0xc0000044c0\n// [101 20 32],0xc000004520\n// [101 20 32],0xc0000044c0\n```\n\n#  `map`\n\n:\n\n```go\nvar mapName map[KeyType]ValueType = map[KeyType]ValueType{\n    KeyType: ValueType,\n    // ...\n}\n```\n\n:\n\n- ,  `make(map[KeyType]ValueType, size)` . ,  `nil` \n-  `len()` \n- Key (`==`, `!=`), ,,,,,.\n- ,  `v, ok := m[key]` .  `ok` . , `ok`  `true`; ,  `false`\n- ,  for-range , \n- ,  \"not addressable\",  `value` ().  `value`, . \n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var nilMap map[string]string\n\tfmt.Println(nilMap == nil)\n\tm := make(map[string]user, 2)\n\tfmt.Printf(\"%p,%v\\n\", &m, m)\n\tm[\"tom\"] = user{\"tom\", 20}\n\tm[\"jack\"] = user{\"jack\", 21}\n\tm[\"lucy\"] = user{\"lucy\", 19}\n\tv, ok := m[\"liming\"]\n\tif ok {\n\t\tfmt.Println(v)\n\t}\n\tfmt.Printf(\"%p,%v\\n\", &m, m)\n\tfor k, v := range m {\n\t\tfmt.Println(k, v)  // \n\t}\n\t//m[\"lucy\"].age += 1 // , cannot assign to `m[\"lucy\"].age`, \n\tlucy := m[\"lucy\"]\n\tlucy.age += 1\n\tm[\"lucy\"] = lucy\n\tfmt.Println(m)\n}\n// \n// true\n// 0xc000006030,map[]\n// 0xc000006030,map[jack:{jack 21} lucy:{tom 19} tom:{tom 20}]\n// tom {tom 20}\n// jack {jack 21}\n// lucy {tom 19}\n// map[jack:{jack 21} lucy:{tom 20} tom:{tom 20}]\n```\n\n#  `struct`\n\n`struct` , ``. \n\n```go\ntype structName struct{\n    fieldName fieldType\n    // ...\n}\n```\n\n:\n\n- ,  `_` (). , , \n-  `structName.fieldName` . ,  `structName.fieldType` \n-  Go ,  ,  `p := &structName`,  `*(p).fieldName`  `p.fieldName`\n- , :****.\n- **, (innerStructName)(outerStructName) `fieldName`,  `outerStructName.fieldName` .  `fieldName`  `outerStructName.innerStructFieldName.fieldName` .\n`innerFieldName`,  `outerStructName.innerFieldName`  `innerFieldName` .**\n- , ,\n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\ntype test struct {\n\tName string\n\tAge  int\n\t_    string\n\t_    string\n\tint\n\t//int  // ,  int\n}\ntype user struct {\n\tname string\n\tinneruser1\n\tinneruser2\n}\ntype inneruser1 struct {\n\tname string\n\tage  int\n}\ntype inneruser2 struct {\n\tname  string\n\tage   int\n\tscore float64\n}\n\nfunc main() {\n\tt := test{\n\t\tName: \"test\",\n\t\tAge:  20,\n\t\tint:  4,\n\t}\n    fmt.Println(t)\n\tu := user{\n\t\tname:       \"outeruser\",\n\t\tinneruser1: inneruser1{\"inneruser1\", 10},\n\t\tinneruser2: inneruser2{\"inneruser2\", 20, 89.5},\n\t}\n\tfmt.Println(u.name)\n\t// fmt.Println(u.age) // , Ambiguous reference 'age',  age\n\tfmt.Println(u.inneruser1.age)\n\tfmt.Println(u.score)\n}\n// \n// {test 20   4}\n// outeruser\n// 10\n// 89.5\n```\n\n## \n\n, . \n\n- , , , .\n-  Go . ,  json \n\n: \n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"encoding/json\"\n)\n\ntype user struct {\n\tName string `json:\"name\"` // ``  tag \n\tAge  int    `json:\"age\"`\n}\n\nfunc main() {\n\tu := user{\n\t\tName: \"tom\",\n\t\tAge:  10,\n\t}\n\tval := reflect.ValueOf(u)\n\tvalType := val.Type()\n\tfor i := 0; i < val.NumField(); i++ {\n\t\tfmt.Printf(\"%v: %v\\n\", valType.Field(i).Tag.Get(\"json\"), val.Field(i))\n\t}\n    \n    str, err := json.Marshal(u)\n    if err != nil {\n    \tfmt.Println(\"\")\n    }\n    fmt.Println(string(str))\n\n}\n// :\n// name: tom\n// age: 10\n// {\"name\":\"tom\",\"age\":10}\n```","slug":"go-study-notes-data-type","published":1,"date":"2020-04-30T10:37:32.164Z","updated":"2020-05-02T00:15:40.285Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihut0002k8u72pbb0z9o","content":"<h1 id=\"-string\"><a href=\"#-string\" class=\"headerlink\" title=\" string\"></a> <code>string</code></h1><p> <code>string</code>  Go ,  UTF-8 (byte).</p>\n<p>:</p>\n<ul>\n<li> <code>nil</code>,  <code>&quot;&quot;</code></li>\n<li>, </li>\n<li>(`), </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> str <span class=\"keyword\">string</span></span><br><span class=\"line\">    fmt.Println(str) <span class=\"comment\">// \"\"</span></span><br><span class=\"line\">    str = <span class=\"string\">\"string\"</span></span><br><span class=\"line\">    fmt.Print(str[<span class=\"number\">1</span>:<span class=\"number\">3</span>])       <span class=\"comment\">// tr</span></span><br><span class=\"line\">    <span class=\"comment\">// fmt.Printf(\"%p\", &amp;str[1]) //  cannot take the address of 'str[1]',  str[1] </span></span><br><span class=\"line\">    <span class=\"comment\">// str[1] = 'x'              // , cannot assign to str[1], , </span></span><br><span class=\"line\">    multiLine := <span class=\"string\">`line \\n</span></span><br><span class=\"line\"><span class=\"string\">    \t    line2`</span></span><br><span class=\"line\">    fmt.Println(multiLine)    <span class=\"comment\">//   multiLine ,</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> for ,  <code>byte</code>  <code>rune</code> </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    str := <span class=\"string\">\"Hello !\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">len</span>(str); i++ &#123;</span><br><span class=\"line\">    \tfmt.Printf(<span class=\"string\">\"%v: %v\\n\"</span>, i, str[i])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i, v := <span class=\"keyword\">range</span> str &#123;</span><br><span class=\"line\">        fmt.Printf(<span class=\"string\">\"%v: %v\\n\"</span>, i, v)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//  for-range (rune),  for-i (byte)</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>,  <code>[]rune</code>  <code>[]byte</code> ,  <code>string()</code> .</li>\n</ul>\n<h1 id=\"-array\"><a href=\"#-array\" class=\"headerlink\" title=\" array\"></a> <code>array</code></h1><p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> name [<span class=\"built_in\">len</span>]Type = [<span class=\"built_in\">len</span>]Type&#123;element1, element2, element3...&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>, . .</li>\n<li></li>\n<li>,  <code>[...]Type</code> , , . ,  <code>...</code></li>\n<li> <code>len()</code>, <code>cap()</code> </li>\n<li>,  <code>arr := [3]*int{&amp;x, &amp;y}</code> , , <code>&amp;arr</code>. </li>\n<li>, , ,</li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test1</span><span class=\"params\">(x [2]<span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"x: %p, %v\\n\"</span>, &amp;x, x)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test2</span><span class=\"params\">(p *[2]<span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"p: %p, %v\\n\"</span>, p, *p)</span><br><span class=\"line\">    p[<span class=\"number\">1</span>] += <span class=\"number\">100</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ta := [<span class=\"number\">2</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;</span><br><span class=\"line\">\tb := a</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"a: %p, %v\\n\"</span>, &amp;a, a)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"b: %p, %v\\n\"</span>, &amp;b, b)</span><br><span class=\"line\">\ttest1(a)</span><br><span class=\"line\">    test2(&amp;a)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"a: %p, %v\\n\"</span>, &amp;a, a)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// a: 0xc00000a0d0, [1 2]</span></span><br><span class=\"line\"><span class=\"comment\">// b: 0xc00000a0e0, [1 2]</span></span><br><span class=\"line\"><span class=\"comment\">// x: 0xc00000a130, [1 2]</span></span><br><span class=\"line\"><span class=\"comment\">// p: 0xc00000a0d0, [1 2]</span></span><br><span class=\"line\"><span class=\"comment\">// a: 0xc00000a0d0, [1 102]</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-slice\"><a href=\"#-slice\" class=\"headerlink\" title=\" slice\"></a> <code>slice</code></h1><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> sliceName []Type = []Type&#123;element1, element2, element3...&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li> <code>make([]Type, len, cap)</code>  <code>len</code> ,  <code>cap</code> .  <code>cap</code> , ( <code>len</code>),  <code>len</code>. , </li>\n<li><strong></strong>, </li>\n<li>, . </li>\n<li> <code>var s []int</code>  <code>nil</code> </li>\n<li></li>\n<li><code>append()</code> , ,  <code>append</code>  <code>cap</code> , .  <code>cap</code>  <code>cap</code> </li>\n<li><code>copy(dst, src []Type)</code> , .</li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> nilSli []<span class=\"keyword\">int</span></span><br><span class=\"line\">\tfmt.Println(nilArr == <span class=\"literal\">nil</span>)  <span class=\"comment\">// true</span></span><br><span class=\"line\">\tsli := <span class=\"built_in\">make</span>([]<span class=\"keyword\">int</span>, <span class=\"number\">2</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%v,%v,%p\\n\"</span>, &amp;sli, <span class=\"built_in\">len</span>(sli), <span class=\"built_in\">cap</span>(sli), &amp;sli[<span class=\"number\">0</span>])</span><br><span class=\"line\">\tarr = <span class=\"built_in\">append</span>(arr, []<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>&#125;...)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%v,%v,%p\\n\"</span>, &amp;sli, <span class=\"built_in\">len</span>(sli), <span class=\"built_in\">cap</span>(sli), &amp;sli[<span class=\"number\">0</span>])  </span><br><span class=\"line\">    <span class=\"comment\">//  append  `&amp;arr` ,  `cap(arr)  2 ,()</span></span><br><span class=\"line\">\tp := &amp;sli</span><br><span class=\"line\">\tp0 := &amp;sli[<span class=\"number\">0</span>]</span><br><span class=\"line\">\tp1 := &amp;sli[<span class=\"number\">1</span>]</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%p,%p\\n\"</span>, p, p0, p1)</span><br><span class=\"line\">\t(*p)[<span class=\"number\">0</span>] += <span class=\"number\">100</span></span><br><span class=\"line\">\t*p1 += <span class=\"number\">100</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%v\\n\"</span>, sli) <span class=\"comment\">// [100 100 1 2 3 4 5 6]</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc0000044c0,2,5,0xc00000c300</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc0000044c0,8,10,0xc000014190</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc0000044c0,0xc000014190,0xc000014198</span></span><br><span class=\"line\"><span class=\"comment\">// [100 100 1 2 3 4 5 6]</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">change</span><span class=\"params\">(s []<span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    s[<span class=\"number\">0</span>] += <span class=\"number\">100</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v,%p\\n\"</span>, s, &amp;s)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    s := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">20</span>, <span class=\"number\">32</span>&#125;  <span class=\"comment\">//  var s = make([]int, 3, 3); s = []int&#123;1, 20, 32&#125;</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v,%p\\n\"</span>, s, &amp;s)</span><br><span class=\"line\">    change(s)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v,%p\\n\"</span>, s, &amp;s)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// [1 20 32],0xc0000044c0</span></span><br><span class=\"line\"><span class=\"comment\">// [101 20 32],0xc000004520</span></span><br><span class=\"line\"><span class=\"comment\">// [101 20 32],0xc0000044c0</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-map\"><a href=\"#-map\" class=\"headerlink\" title=\" map\"></a> <code>map</code></h1><p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> mapName <span class=\"keyword\">map</span>[KeyType]ValueType = <span class=\"keyword\">map</span>[KeyType]ValueType&#123;</span><br><span class=\"line\">    KeyType: ValueType,</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>,  <code>make(map[KeyType]ValueType, size)</code> . ,  <code>nil</code> </li>\n<li> <code>len()</code> </li>\n<li>Key (<code>==</code>, <code>!=</code>), ,,,,,.</li>\n<li>,  <code>v, ok := m[key]</code> .  <code>ok</code> . , <code>ok</code>  <code>true</code>; ,  <code>false</code></li>\n<li>,  for-range , </li>\n<li>,  not addressable,  <code>value</code> ().  <code>value</code>, . </li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> nilMap <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span></span><br><span class=\"line\">\tfmt.Println(nilMap == <span class=\"literal\">nil</span>)</span><br><span class=\"line\">\tm := <span class=\"built_in\">make</span>(<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]user, <span class=\"number\">2</span>)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%v\\n\"</span>, &amp;m, m)</span><br><span class=\"line\">\tm[<span class=\"string\">\"tom\"</span>] = user&#123;<span class=\"string\">\"tom\"</span>, <span class=\"number\">20</span>&#125;</span><br><span class=\"line\">\tm[<span class=\"string\">\"jack\"</span>] = user&#123;<span class=\"string\">\"jack\"</span>, <span class=\"number\">21</span>&#125;</span><br><span class=\"line\">\tm[<span class=\"string\">\"lucy\"</span>] = user&#123;<span class=\"string\">\"lucy\"</span>, <span class=\"number\">19</span>&#125;</span><br><span class=\"line\">\tv, ok := m[<span class=\"string\">\"liming\"</span>]</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ok &#123;</span><br><span class=\"line\">\t\tfmt.Println(v)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%v\\n\"</span>, &amp;m, m)</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> k, v := <span class=\"keyword\">range</span> m &#123;</span><br><span class=\"line\">\t\tfmt.Println(k, v)  <span class=\"comment\">// </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//m[\"lucy\"].age += 1 // , cannot assign to `m[\"lucy\"].age`, </span></span><br><span class=\"line\">\tlucy := m[<span class=\"string\">\"lucy\"</span>]</span><br><span class=\"line\">\tlucy.age += <span class=\"number\">1</span></span><br><span class=\"line\">\tm[<span class=\"string\">\"lucy\"</span>] = lucy</span><br><span class=\"line\">\tfmt.Println(m)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc000006030,map[]</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc000006030,map[jack:&#123;jack 21&#125; lucy:&#123;tom 19&#125; tom:&#123;tom 20&#125;]</span></span><br><span class=\"line\"><span class=\"comment\">// tom &#123;tom 20&#125;</span></span><br><span class=\"line\"><span class=\"comment\">// jack &#123;jack 21&#125;</span></span><br><span class=\"line\"><span class=\"comment\">// lucy &#123;tom 19&#125;</span></span><br><span class=\"line\"><span class=\"comment\">// map[jack:&#123;jack 21&#125; lucy:&#123;tom 20&#125; tom:&#123;tom 20&#125;]</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-struct\"><a href=\"#-struct\" class=\"headerlink\" title=\" struct\"></a> <code>struct</code></h1><p><code>struct</code> , <code></code>. </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> structName <span class=\"keyword\">struct</span>&#123;</span><br><span class=\"line\">    fieldName fieldType</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>,  <code>_</code> (). , , </li>\n<li> <code>structName.fieldName</code> . ,  <code>structName.fieldType</code> </li>\n<li> Go ,  ,  <code>p := &amp;structName</code>,  <code>*(p).fieldName</code>  <code>p.fieldName</code></li>\n<li>, :<strong></strong>.</li>\n<li><strong>, (innerStructName)(outerStructName) <code>fieldName</code>,  <code>outerStructName.fieldName</code> .  <code>fieldName</code>  <code>outerStructName.innerStructFieldName.fieldName</code> .<br><code>innerFieldName</code>,  <code>outerStructName.innerFieldName</code>  <code>innerFieldName</code> .</strong></li>\n<li>, ,</li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> test <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge  <span class=\"keyword\">int</span></span><br><span class=\"line\">\t_    <span class=\"keyword\">string</span></span><br><span class=\"line\">\t_    <span class=\"keyword\">string</span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span></span><br><span class=\"line\">\t<span class=\"comment\">//int  // ,  int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> user <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tname <span class=\"keyword\">string</span></span><br><span class=\"line\">\tinneruser1</span><br><span class=\"line\">\tinneruser2</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> inneruser1 <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tname <span class=\"keyword\">string</span></span><br><span class=\"line\">\tage  <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> inneruser2 <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tname  <span class=\"keyword\">string</span></span><br><span class=\"line\">\tage   <span class=\"keyword\">int</span></span><br><span class=\"line\">\tscore <span class=\"keyword\">float64</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tt := test&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"test\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">20</span>,</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>:  <span class=\"number\">4</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    fmt.Println(t)</span><br><span class=\"line\">\tu := user&#123;</span><br><span class=\"line\">\t\tname:       <span class=\"string\">\"outeruser\"</span>,</span><br><span class=\"line\">\t\tinneruser1: inneruser1&#123;<span class=\"string\">\"inneruser1\"</span>, <span class=\"number\">10</span>&#125;,</span><br><span class=\"line\">\t\tinneruser2: inneruser2&#123;<span class=\"string\">\"inneruser2\"</span>, <span class=\"number\">20</span>, <span class=\"number\">89.5</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Println(u.name)</span><br><span class=\"line\">\t<span class=\"comment\">// fmt.Println(u.age) // , Ambiguous reference 'age',  age</span></span><br><span class=\"line\">\tfmt.Println(u.inneruser1.age)</span><br><span class=\"line\">\tfmt.Println(u.score)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// &#123;test 20   4&#125;</span></span><br><span class=\"line\"><span class=\"comment\">// outeruser</span></span><br><span class=\"line\"><span class=\"comment\">// 10</span></span><br><span class=\"line\"><span class=\"comment\">// 89.5</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>, . </p>\n<ul>\n<li>, , , .</li>\n<li> Go . ,  json </li>\n</ul>\n<p>: </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> user <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName <span class=\"keyword\">string</span> <span class=\"string\">`json:\"name\"`</span> <span class=\"comment\">// ``  tag </span></span><br><span class=\"line\">\tAge  <span class=\"keyword\">int</span>    <span class=\"string\">`json:\"age\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tu := user&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">10</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tval := reflect.ValueOf(u)</span><br><span class=\"line\">\tvalType := val.Type()</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; val.NumField(); i++ &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%v: %v\\n\"</span>, valType.Field(i).Tag.Get(<span class=\"string\">\"json\"</span>), val.Field(i))</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    str, err := json.Marshal(u)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">    \tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Println(<span class=\"keyword\">string</span>(str))</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">// name: tom</span></span><br><span class=\"line\"><span class=\"comment\">// age: 10</span></span><br><span class=\"line\"><span class=\"comment\">// &#123;\"name\":\"tom\",\"age\":10&#125;</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"-string\"><a href=\"#-string\" class=\"headerlink\" title=\" string\"></a> <code>string</code></h1><p> <code>string</code>  Go ,  UTF-8 (byte).</p>\n<p>:</p>\n<ul>\n<li> <code>nil</code>,  <code>&quot;&quot;</code></li>\n<li>, </li>\n<li>(`), </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> str <span class=\"keyword\">string</span></span><br><span class=\"line\">    fmt.Println(str) <span class=\"comment\">// \"\"</span></span><br><span class=\"line\">    str = <span class=\"string\">\"string\"</span></span><br><span class=\"line\">    fmt.Print(str[<span class=\"number\">1</span>:<span class=\"number\">3</span>])       <span class=\"comment\">// tr</span></span><br><span class=\"line\">    <span class=\"comment\">// fmt.Printf(\"%p\", &amp;str[1]) //  cannot take the address of 'str[1]',  str[1] </span></span><br><span class=\"line\">    <span class=\"comment\">// str[1] = 'x'              // , cannot assign to str[1], , </span></span><br><span class=\"line\">    multiLine := <span class=\"string\">`line \\n</span></span><br><span class=\"line\"><span class=\"string\">    \t    line2`</span></span><br><span class=\"line\">    fmt.Println(multiLine)    <span class=\"comment\">//   multiLine ,</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> for ,  <code>byte</code>  <code>rune</code> </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    str := <span class=\"string\">\"Hello !\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">len</span>(str); i++ &#123;</span><br><span class=\"line\">    \tfmt.Printf(<span class=\"string\">\"%v: %v\\n\"</span>, i, str[i])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i, v := <span class=\"keyword\">range</span> str &#123;</span><br><span class=\"line\">        fmt.Printf(<span class=\"string\">\"%v: %v\\n\"</span>, i, v)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//  for-range (rune),  for-i (byte)</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>,  <code>[]rune</code>  <code>[]byte</code> ,  <code>string()</code> .</li>\n</ul>\n<h1 id=\"-array\"><a href=\"#-array\" class=\"headerlink\" title=\" array\"></a> <code>array</code></h1><p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> name [<span class=\"built_in\">len</span>]Type = [<span class=\"built_in\">len</span>]Type&#123;element1, element2, element3...&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>, . .</li>\n<li></li>\n<li>,  <code>[...]Type</code> , , . ,  <code>...</code></li>\n<li> <code>len()</code>, <code>cap()</code> </li>\n<li>,  <code>arr := [3]*int{&amp;x, &amp;y}</code> , , <code>&amp;arr</code>. </li>\n<li>, , ,</li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test1</span><span class=\"params\">(x [2]<span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"x: %p, %v\\n\"</span>, &amp;x, x)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test2</span><span class=\"params\">(p *[2]<span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"p: %p, %v\\n\"</span>, p, *p)</span><br><span class=\"line\">    p[<span class=\"number\">1</span>] += <span class=\"number\">100</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ta := [<span class=\"number\">2</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;</span><br><span class=\"line\">\tb := a</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"a: %p, %v\\n\"</span>, &amp;a, a)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"b: %p, %v\\n\"</span>, &amp;b, b)</span><br><span class=\"line\">\ttest1(a)</span><br><span class=\"line\">    test2(&amp;a)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"a: %p, %v\\n\"</span>, &amp;a, a)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// a: 0xc00000a0d0, [1 2]</span></span><br><span class=\"line\"><span class=\"comment\">// b: 0xc00000a0e0, [1 2]</span></span><br><span class=\"line\"><span class=\"comment\">// x: 0xc00000a130, [1 2]</span></span><br><span class=\"line\"><span class=\"comment\">// p: 0xc00000a0d0, [1 2]</span></span><br><span class=\"line\"><span class=\"comment\">// a: 0xc00000a0d0, [1 102]</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-slice\"><a href=\"#-slice\" class=\"headerlink\" title=\" slice\"></a> <code>slice</code></h1><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> sliceName []Type = []Type&#123;element1, element2, element3...&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li> <code>make([]Type, len, cap)</code>  <code>len</code> ,  <code>cap</code> .  <code>cap</code> , ( <code>len</code>),  <code>len</code>. , </li>\n<li><strong></strong>, </li>\n<li>, . </li>\n<li> <code>var s []int</code>  <code>nil</code> </li>\n<li></li>\n<li><code>append()</code> , ,  <code>append</code>  <code>cap</code> , .  <code>cap</code>  <code>cap</code> </li>\n<li><code>copy(dst, src []Type)</code> , .</li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> nilSli []<span class=\"keyword\">int</span></span><br><span class=\"line\">\tfmt.Println(nilArr == <span class=\"literal\">nil</span>)  <span class=\"comment\">// true</span></span><br><span class=\"line\">\tsli := <span class=\"built_in\">make</span>([]<span class=\"keyword\">int</span>, <span class=\"number\">2</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%v,%v,%p\\n\"</span>, &amp;sli, <span class=\"built_in\">len</span>(sli), <span class=\"built_in\">cap</span>(sli), &amp;sli[<span class=\"number\">0</span>])</span><br><span class=\"line\">\tarr = <span class=\"built_in\">append</span>(arr, []<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>&#125;...)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%v,%v,%p\\n\"</span>, &amp;sli, <span class=\"built_in\">len</span>(sli), <span class=\"built_in\">cap</span>(sli), &amp;sli[<span class=\"number\">0</span>])  </span><br><span class=\"line\">    <span class=\"comment\">//  append  `&amp;arr` ,  `cap(arr)  2 ,()</span></span><br><span class=\"line\">\tp := &amp;sli</span><br><span class=\"line\">\tp0 := &amp;sli[<span class=\"number\">0</span>]</span><br><span class=\"line\">\tp1 := &amp;sli[<span class=\"number\">1</span>]</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%p,%p\\n\"</span>, p, p0, p1)</span><br><span class=\"line\">\t(*p)[<span class=\"number\">0</span>] += <span class=\"number\">100</span></span><br><span class=\"line\">\t*p1 += <span class=\"number\">100</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%v\\n\"</span>, sli) <span class=\"comment\">// [100 100 1 2 3 4 5 6]</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc0000044c0,2,5,0xc00000c300</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc0000044c0,8,10,0xc000014190</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc0000044c0,0xc000014190,0xc000014198</span></span><br><span class=\"line\"><span class=\"comment\">// [100 100 1 2 3 4 5 6]</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">change</span><span class=\"params\">(s []<span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    s[<span class=\"number\">0</span>] += <span class=\"number\">100</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v,%p\\n\"</span>, s, &amp;s)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    s := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">20</span>, <span class=\"number\">32</span>&#125;  <span class=\"comment\">//  var s = make([]int, 3, 3); s = []int&#123;1, 20, 32&#125;</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v,%p\\n\"</span>, s, &amp;s)</span><br><span class=\"line\">    change(s)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v,%p\\n\"</span>, s, &amp;s)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// [1 20 32],0xc0000044c0</span></span><br><span class=\"line\"><span class=\"comment\">// [101 20 32],0xc000004520</span></span><br><span class=\"line\"><span class=\"comment\">// [101 20 32],0xc0000044c0</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-map\"><a href=\"#-map\" class=\"headerlink\" title=\" map\"></a> <code>map</code></h1><p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> mapName <span class=\"keyword\">map</span>[KeyType]ValueType = <span class=\"keyword\">map</span>[KeyType]ValueType&#123;</span><br><span class=\"line\">    KeyType: ValueType,</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>,  <code>make(map[KeyType]ValueType, size)</code> . ,  <code>nil</code> </li>\n<li> <code>len()</code> </li>\n<li>Key (<code>==</code>, <code>!=</code>), ,,,,,.</li>\n<li>,  <code>v, ok := m[key]</code> .  <code>ok</code> . , <code>ok</code>  <code>true</code>; ,  <code>false</code></li>\n<li>,  for-range , </li>\n<li>,  not addressable,  <code>value</code> ().  <code>value</code>, . </li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> nilMap <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span></span><br><span class=\"line\">\tfmt.Println(nilMap == <span class=\"literal\">nil</span>)</span><br><span class=\"line\">\tm := <span class=\"built_in\">make</span>(<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]user, <span class=\"number\">2</span>)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%v\\n\"</span>, &amp;m, m)</span><br><span class=\"line\">\tm[<span class=\"string\">\"tom\"</span>] = user&#123;<span class=\"string\">\"tom\"</span>, <span class=\"number\">20</span>&#125;</span><br><span class=\"line\">\tm[<span class=\"string\">\"jack\"</span>] = user&#123;<span class=\"string\">\"jack\"</span>, <span class=\"number\">21</span>&#125;</span><br><span class=\"line\">\tm[<span class=\"string\">\"lucy\"</span>] = user&#123;<span class=\"string\">\"lucy\"</span>, <span class=\"number\">19</span>&#125;</span><br><span class=\"line\">\tv, ok := m[<span class=\"string\">\"liming\"</span>]</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ok &#123;</span><br><span class=\"line\">\t\tfmt.Println(v)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p,%v\\n\"</span>, &amp;m, m)</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> k, v := <span class=\"keyword\">range</span> m &#123;</span><br><span class=\"line\">\t\tfmt.Println(k, v)  <span class=\"comment\">// </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//m[\"lucy\"].age += 1 // , cannot assign to `m[\"lucy\"].age`, </span></span><br><span class=\"line\">\tlucy := m[<span class=\"string\">\"lucy\"</span>]</span><br><span class=\"line\">\tlucy.age += <span class=\"number\">1</span></span><br><span class=\"line\">\tm[<span class=\"string\">\"lucy\"</span>] = lucy</span><br><span class=\"line\">\tfmt.Println(m)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc000006030,map[]</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc000006030,map[jack:&#123;jack 21&#125; lucy:&#123;tom 19&#125; tom:&#123;tom 20&#125;]</span></span><br><span class=\"line\"><span class=\"comment\">// tom &#123;tom 20&#125;</span></span><br><span class=\"line\"><span class=\"comment\">// jack &#123;jack 21&#125;</span></span><br><span class=\"line\"><span class=\"comment\">// lucy &#123;tom 19&#125;</span></span><br><span class=\"line\"><span class=\"comment\">// map[jack:&#123;jack 21&#125; lucy:&#123;tom 20&#125; tom:&#123;tom 20&#125;]</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-struct\"><a href=\"#-struct\" class=\"headerlink\" title=\" struct\"></a> <code>struct</code></h1><p><code>struct</code> , <code></code>. </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> structName <span class=\"keyword\">struct</span>&#123;</span><br><span class=\"line\">    fieldName fieldType</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>,  <code>_</code> (). , , </li>\n<li> <code>structName.fieldName</code> . ,  <code>structName.fieldType</code> </li>\n<li> Go ,  ,  <code>p := &amp;structName</code>,  <code>*(p).fieldName</code>  <code>p.fieldName</code></li>\n<li>, :<strong></strong>.</li>\n<li><strong>, (innerStructName)(outerStructName) <code>fieldName</code>,  <code>outerStructName.fieldName</code> .  <code>fieldName</code>  <code>outerStructName.innerStructFieldName.fieldName</code> .<br><code>innerFieldName</code>,  <code>outerStructName.innerFieldName</code>  <code>innerFieldName</code> .</strong></li>\n<li>, ,</li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> test <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge  <span class=\"keyword\">int</span></span><br><span class=\"line\">\t_    <span class=\"keyword\">string</span></span><br><span class=\"line\">\t_    <span class=\"keyword\">string</span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span></span><br><span class=\"line\">\t<span class=\"comment\">//int  // ,  int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> user <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tname <span class=\"keyword\">string</span></span><br><span class=\"line\">\tinneruser1</span><br><span class=\"line\">\tinneruser2</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> inneruser1 <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tname <span class=\"keyword\">string</span></span><br><span class=\"line\">\tage  <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> inneruser2 <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tname  <span class=\"keyword\">string</span></span><br><span class=\"line\">\tage   <span class=\"keyword\">int</span></span><br><span class=\"line\">\tscore <span class=\"keyword\">float64</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tt := test&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"test\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">20</span>,</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>:  <span class=\"number\">4</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    fmt.Println(t)</span><br><span class=\"line\">\tu := user&#123;</span><br><span class=\"line\">\t\tname:       <span class=\"string\">\"outeruser\"</span>,</span><br><span class=\"line\">\t\tinneruser1: inneruser1&#123;<span class=\"string\">\"inneruser1\"</span>, <span class=\"number\">10</span>&#125;,</span><br><span class=\"line\">\t\tinneruser2: inneruser2&#123;<span class=\"string\">\"inneruser2\"</span>, <span class=\"number\">20</span>, <span class=\"number\">89.5</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Println(u.name)</span><br><span class=\"line\">\t<span class=\"comment\">// fmt.Println(u.age) // , Ambiguous reference 'age',  age</span></span><br><span class=\"line\">\tfmt.Println(u.inneruser1.age)</span><br><span class=\"line\">\tfmt.Println(u.score)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// &#123;test 20   4&#125;</span></span><br><span class=\"line\"><span class=\"comment\">// outeruser</span></span><br><span class=\"line\"><span class=\"comment\">// 10</span></span><br><span class=\"line\"><span class=\"comment\">// 89.5</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>, . </p>\n<ul>\n<li>, , , .</li>\n<li> Go . ,  json </li>\n</ul>\n<p>: </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> user <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName <span class=\"keyword\">string</span> <span class=\"string\">`json:\"name\"`</span> <span class=\"comment\">// ``  tag </span></span><br><span class=\"line\">\tAge  <span class=\"keyword\">int</span>    <span class=\"string\">`json:\"age\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tu := user&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">10</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tval := reflect.ValueOf(u)</span><br><span class=\"line\">\tvalType := val.Type()</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; val.NumField(); i++ &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%v: %v\\n\"</span>, valType.Field(i).Tag.Get(<span class=\"string\">\"json\"</span>), val.Field(i))</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    str, err := json.Marshal(u)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">    \tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Println(<span class=\"keyword\">string</span>(str))</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">// name: tom</span></span><br><span class=\"line\"><span class=\"comment\">// age: 10</span></span><br><span class=\"line\"><span class=\"comment\">// &#123;\"name\":\"tom\",\"age\":10&#125;</span></span><br></pre></td></tr></table></figure>"},{"title":"go ","abbrlink":9125,"description":" Go , ,  Go  goroutine ,  sync.WaitGroup ,  channel ","_content":"\n# \n\n(concurrency) (parallesim)\n\n- : , ()/, /, CPU , /\n- : , ,  CPU,  CPU \n\n\n, . ,, ,  CPU . , , . \n\n, . .\n\nGo  `goroutine` , `goroutine` , . , . `goroutine`  2KB,  MB \n\n Go  `goroutine` ,  `go` .\n\n```go\ngo func()  // \n```\n\n, `go` , . , . , , .\n\n `defer` , `go`  `goroutine` , .\n\n```go\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nvar c int\n\nfunc counter() int {\n\tc++\n\treturn c\n}\n\nfunc main() {\n\ta := 100\n\tfmt.Printf(\"main: %p,%v\\n\", &a, a)\n\tgo func(x, y int) {\n\t\ttime.Sleep(time.Second)                //  goroutine  mian \n\t\tfmt.Printf(\"go: %p,%v,%v\\n\", &x, x, y) // \n\t}(a, counter())\n\n\ta += 100\n\tfmt.Printf(\"main: %p,%v,%v\\n\", &a, a, counter())\n\ttime.Sleep(time.Second * 3) //  goroutine \n}\n// \n// main: 0xc000062090,100\n// main: 0xc000062090,200,2\n// go: 0xc00000a038,100,1\n//  goroutine  a  main ,  goroutine  \n```\n\n `time.sleep()`  `goroutine` ,  `goroutine` , `main`  `sleep` .\n\n## \n\n,  `channel`  `main` , \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\texit := make(chan struct{}) //  channel\n\tgo func() {\n\t\ttime.Sleep(time.Second)\n\t\tfmt.Println(\"goroutine done\")\n\t\tclose(exit) //  channel, \n\t}()\n\tfmt.Println(\"main...\")\n\t<-exit //  channel , \n\tfmt.Println(\"main exit...\")\n}\n```\n \n,  `sync.WaitGroup`. ,  goroutine ,  0 .\n\n ```go\nimport (\n    \"fmt\"\n    \"time\"\n    \"sync\"\n)\n\nfunc main() {\n\tvar wg sync.WaitGroup\n\n\tfor i := 0; i < 10; i++ {\n\t\twg.Add(1) //  goroutine,  1\n\t\tgo func(id int) {\n\t\t\tdefer wg.Done() //  goroutine ,  1\n\t\t\ttime.Sleep(time.Second)\n\t\t\tfmt.Printf(\"goroutine %v done\\n\", id)\n\t\t}(i)\n\t}\n\n\tfmt.Println(\"main...\")\n\twg.Wait() // ,  0\n\tfmt.Println(\"main exit...\")\n}\n```\n\n`WaitGroup.Add` ,  goroutine , (Add), (Wait)\n\n# `channel`\n\n## \n\nGo  CSP(Communicating Sequential Process) channel, , .\n\n> Don't communicate by sharing memory, share memory by communicating. , .\n\n CSP , channel , , . , .\n\nchannel :\n\n```go\nvar channelName = make(chan Type, cap)  //  cap  channel,  Type \n```\n\n:\n\n- , . channel ,  nil\n-  cap()  len() .  0, (0)(0).\n-  goroutine , \n-  ok-idom  for-range . ok-idom  channel, for-range  channel,  `fatal error: all goroutines are asleep - deadlock`\n-  channel ,  panic.\n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc putNum(intChan chan int) {\n    defer close(intChan)  //  intChan\n\tfor i := 2; i <= 1000; i++ {\n\t\tintChan <- i  //  intChan \n\t}\n}\n\nfunc isPrime(value int) bool {\n\tif value <= 3 {\n\t\treturn value >= 2\n\t}\n\tif value%2 == 0 || value%3 == 0 {\n\t\treturn false\n\t}\n\tfor i := 5; i*i <= value; i += 6 {\n\t\tif value%i == 0 || value%(i+2) == 0 {\n\t\t\treturn false\n\t\t}\n\t}\n\treturn true\n}\n\nfunc getNum(intChan chan int, outChan chan int, wg *sync.WaitGroup) {\n    defer wg.Done()\n\tfor value := range intChan {  //  for-range  intChan \n\t\tif isPrime(value) {\n\t\t\toutChan <- value  //  outChan \n\t\t}\n\t}\n}\n\nfunc main() {\n\tvar inChannel = make(chan int, 10)\n\tvar outChannel = make(chan int, 1000)\n\tvar wg sync.WaitGroup\n\n\tgo putNum(inChannel)\n\tfor i := 0; i < 10; i++ {\n\t\twg.Add(1)\n\t\tgo getNum(inChannel, outChannel, &wg)\n\t}\n\twg.Wait()\n\tclose(outChannel)\n\tfor x := range outChannel {\n\t\tfmt.Println(x)\n\t}\n}\n```\n\n##  channel\n\nchannel , . ,  channel,  channel \n\n```go\nvar send chan<- int = make(chan int, 10)\nvar recv <-chan int = make(chan int, 10)\n// <-send // , invalid operation: <-send (recevice from send-only type chan<- int), \n// recv <- 1\n```\n\n### `select` \n\n channel,  `select` . \n\n`select`  `switch` ,  case , .  case.  case ,  default \n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n\tvar wg sync.WaitGroup\n\twg.Add(2)\n\ta, b := make(chan int), make(chan int)\n    \n\tgo func() {\n\t\tdefer wg.Done()\n\t\tfor {\n\t\t\tvar (\n\t\t\t\tname string\n\t\t\t\tx    int\n\t\t\t\tok   bool\n\t\t\t)\n\t\t\tselect {\n\t\t\tcase x, ok = <-a:\n\t\t\t\tname = \"a\"\n\t\t\tcase x, ok = <-b:\n\t\t\t\tname = \"b\"\n\t\t\t}\n\t\t\tif !ok {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tfmt.Println(name, x)\n\t\t}\n\t}()\n\tgo func() {\n\t\tdefer wg.Done()\n\t\tdefer close(a)\n\t\tdefer close(b)\n\t\tfor i := 0; i < 10; i++ {\n\t\t\tselect {\n\t\t\tcase a <- i:\n\t\t\tcase b <- i * 10:\n\t\t\t}\n\t\t}\n\t}()\n\twg.Wait()\n}\n```\n\ndefault  ,  channel .\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\tdone := make(chan int)\n\tdata := []chan int{make(chan int, 3)}\n\n\tgo func() {\n\t\tdefer close(done)\n\t\tfor i := 0; i < 10; i++ {\n\t\t\tselect {\n\t\t\tcase data[len(data)-1] <- i:\n\t\t\tdefault:\n\t\t\t\tdata = append(data, make(chan int, 3))  // default  channel .\n\t\t\t}\n\t\t}\n\t}()\n\t<-done // ,  goroutine \n\tfor i := 0; i < len(data); i++ {\n\t\tc := data[i]\n\t\tclose(c)\n\t\tfor x := range c {\n\t\t\tfmt.Println(x)\n\t\t}\n\t}\n}\n```\n\n## \n\nchannel ,  ID , Pool \n\n Pool :\n\n```go\nimport (\n    \"fmt\"\n)\n \n type pool chan []byte\n \n func newPool(cap int) pool {\n \treturn make(chan []byte, cap)\n }\n \n func (p pool) get() []byte {\n \tvar bytes []byte\n \tselect {\n \tcase bytes = <-p:\n \t\tfmt.Println(\"\")\n \tdefault:\n \t\tfmt.Println(\", \")\n \t\tbytes = make([]byte, 10)\n \t}\n \treturn bytes\n }\n func (p pool) put(bytes []byte) {\n \tselect {\n \tcase p <- bytes:\n \t\tfmt.Println(\"\")\n \tdefault:\n \t\tfmt.Println(\"\")\n \t}\n }\n```","source":"_posts/go-study-notes-concurrency.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 9125\ndescription: >-\n   Go , ,  Go  goroutine ,  sync.WaitGroup\n  ,  channel \n---\n\n# \n\n(concurrency) (parallesim)\n\n- : , ()/, /, CPU , /\n- : , ,  CPU,  CPU \n\n\n, . ,, ,  CPU . , , . \n\n, . .\n\nGo  `goroutine` , `goroutine` , . , . `goroutine`  2KB,  MB \n\n Go  `goroutine` ,  `go` .\n\n```go\ngo func()  // \n```\n\n, `go` , . , . , , .\n\n `defer` , `go`  `goroutine` , .\n\n```go\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nvar c int\n\nfunc counter() int {\n\tc++\n\treturn c\n}\n\nfunc main() {\n\ta := 100\n\tfmt.Printf(\"main: %p,%v\\n\", &a, a)\n\tgo func(x, y int) {\n\t\ttime.Sleep(time.Second)                //  goroutine  mian \n\t\tfmt.Printf(\"go: %p,%v,%v\\n\", &x, x, y) // \n\t}(a, counter())\n\n\ta += 100\n\tfmt.Printf(\"main: %p,%v,%v\\n\", &a, a, counter())\n\ttime.Sleep(time.Second * 3) //  goroutine \n}\n// \n// main: 0xc000062090,100\n// main: 0xc000062090,200,2\n// go: 0xc00000a038,100,1\n//  goroutine  a  main ,  goroutine  \n```\n\n `time.sleep()`  `goroutine` ,  `goroutine` , `main`  `sleep` .\n\n## \n\n,  `channel`  `main` , \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\texit := make(chan struct{}) //  channel\n\tgo func() {\n\t\ttime.Sleep(time.Second)\n\t\tfmt.Println(\"goroutine done\")\n\t\tclose(exit) //  channel, \n\t}()\n\tfmt.Println(\"main...\")\n\t<-exit //  channel , \n\tfmt.Println(\"main exit...\")\n}\n```\n \n,  `sync.WaitGroup`. ,  goroutine ,  0 .\n\n ```go\nimport (\n    \"fmt\"\n    \"time\"\n    \"sync\"\n)\n\nfunc main() {\n\tvar wg sync.WaitGroup\n\n\tfor i := 0; i < 10; i++ {\n\t\twg.Add(1) //  goroutine,  1\n\t\tgo func(id int) {\n\t\t\tdefer wg.Done() //  goroutine ,  1\n\t\t\ttime.Sleep(time.Second)\n\t\t\tfmt.Printf(\"goroutine %v done\\n\", id)\n\t\t}(i)\n\t}\n\n\tfmt.Println(\"main...\")\n\twg.Wait() // ,  0\n\tfmt.Println(\"main exit...\")\n}\n```\n\n`WaitGroup.Add` ,  goroutine , (Add), (Wait)\n\n# `channel`\n\n## \n\nGo  CSP(Communicating Sequential Process) channel, , .\n\n> Don't communicate by sharing memory, share memory by communicating. , .\n\n CSP , channel , , . , .\n\nchannel :\n\n```go\nvar channelName = make(chan Type, cap)  //  cap  channel,  Type \n```\n\n:\n\n- , . channel ,  nil\n-  cap()  len() .  0, (0)(0).\n-  goroutine , \n-  ok-idom  for-range . ok-idom  channel, for-range  channel,  `fatal error: all goroutines are asleep - deadlock`\n-  channel ,  panic.\n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc putNum(intChan chan int) {\n    defer close(intChan)  //  intChan\n\tfor i := 2; i <= 1000; i++ {\n\t\tintChan <- i  //  intChan \n\t}\n}\n\nfunc isPrime(value int) bool {\n\tif value <= 3 {\n\t\treturn value >= 2\n\t}\n\tif value%2 == 0 || value%3 == 0 {\n\t\treturn false\n\t}\n\tfor i := 5; i*i <= value; i += 6 {\n\t\tif value%i == 0 || value%(i+2) == 0 {\n\t\t\treturn false\n\t\t}\n\t}\n\treturn true\n}\n\nfunc getNum(intChan chan int, outChan chan int, wg *sync.WaitGroup) {\n    defer wg.Done()\n\tfor value := range intChan {  //  for-range  intChan \n\t\tif isPrime(value) {\n\t\t\toutChan <- value  //  outChan \n\t\t}\n\t}\n}\n\nfunc main() {\n\tvar inChannel = make(chan int, 10)\n\tvar outChannel = make(chan int, 1000)\n\tvar wg sync.WaitGroup\n\n\tgo putNum(inChannel)\n\tfor i := 0; i < 10; i++ {\n\t\twg.Add(1)\n\t\tgo getNum(inChannel, outChannel, &wg)\n\t}\n\twg.Wait()\n\tclose(outChannel)\n\tfor x := range outChannel {\n\t\tfmt.Println(x)\n\t}\n}\n```\n\n##  channel\n\nchannel , . ,  channel,  channel \n\n```go\nvar send chan<- int = make(chan int, 10)\nvar recv <-chan int = make(chan int, 10)\n// <-send // , invalid operation: <-send (recevice from send-only type chan<- int), \n// recv <- 1\n```\n\n### `select` \n\n channel,  `select` . \n\n`select`  `switch` ,  case , .  case.  case ,  default \n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n\tvar wg sync.WaitGroup\n\twg.Add(2)\n\ta, b := make(chan int), make(chan int)\n    \n\tgo func() {\n\t\tdefer wg.Done()\n\t\tfor {\n\t\t\tvar (\n\t\t\t\tname string\n\t\t\t\tx    int\n\t\t\t\tok   bool\n\t\t\t)\n\t\t\tselect {\n\t\t\tcase x, ok = <-a:\n\t\t\t\tname = \"a\"\n\t\t\tcase x, ok = <-b:\n\t\t\t\tname = \"b\"\n\t\t\t}\n\t\t\tif !ok {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tfmt.Println(name, x)\n\t\t}\n\t}()\n\tgo func() {\n\t\tdefer wg.Done()\n\t\tdefer close(a)\n\t\tdefer close(b)\n\t\tfor i := 0; i < 10; i++ {\n\t\t\tselect {\n\t\t\tcase a <- i:\n\t\t\tcase b <- i * 10:\n\t\t\t}\n\t\t}\n\t}()\n\twg.Wait()\n}\n```\n\ndefault  ,  channel .\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\tdone := make(chan int)\n\tdata := []chan int{make(chan int, 3)}\n\n\tgo func() {\n\t\tdefer close(done)\n\t\tfor i := 0; i < 10; i++ {\n\t\t\tselect {\n\t\t\tcase data[len(data)-1] <- i:\n\t\t\tdefault:\n\t\t\t\tdata = append(data, make(chan int, 3))  // default  channel .\n\t\t\t}\n\t\t}\n\t}()\n\t<-done // ,  goroutine \n\tfor i := 0; i < len(data); i++ {\n\t\tc := data[i]\n\t\tclose(c)\n\t\tfor x := range c {\n\t\t\tfmt.Println(x)\n\t\t}\n\t}\n}\n```\n\n## \n\nchannel ,  ID , Pool \n\n Pool :\n\n```go\nimport (\n    \"fmt\"\n)\n \n type pool chan []byte\n \n func newPool(cap int) pool {\n \treturn make(chan []byte, cap)\n }\n \n func (p pool) get() []byte {\n \tvar bytes []byte\n \tselect {\n \tcase bytes = <-p:\n \t\tfmt.Println(\"\")\n \tdefault:\n \t\tfmt.Println(\", \")\n \t\tbytes = make([]byte, 10)\n \t}\n \treturn bytes\n }\n func (p pool) put(bytes []byte) {\n \tselect {\n \tcase p <- bytes:\n \t\tfmt.Println(\"\")\n \tdefault:\n \t\tfmt.Println(\"\")\n \t}\n }\n```","slug":"go-study-notes-concurrency","published":1,"date":"2020-04-30T10:46:40.119Z","updated":"2020-05-02T00:18:18.325Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihux0006k8u7ctlba8yk","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>(concurrency) (parallesim)</p>\n<ul>\n<li>: , ()/, /, CPU , /</li>\n<li>: , ,  CPU,  CPU </li>\n</ul>\n<p>, . ,, ,  CPU . , , . </p>\n<p>, . .</p>\n<p>Go  <code>goroutine</code> , <code>goroutine</code> , . , . <code>goroutine</code>  2KB,  MB </p>\n<p> Go  <code>goroutine</code> ,  <code>go</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span>  // </span></span><br></pre></td></tr></table></figure>\n\n<p>, <code>go</code> , . , . , , .</p>\n<p> <code>defer</code> , <code>go</code>  <code>goroutine</code> , .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> c <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">counter</span><span class=\"params\">()</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">\tc++</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> c</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ta := <span class=\"number\">100</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"main: %p,%v\\n\"</span>, &amp;a, a)</span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(x, y <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\t\ttime.Sleep(time.Second)                <span class=\"comment\">//  goroutine  mian </span></span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"go: %p,%v,%v\\n\"</span>, &amp;x, x, y) <span class=\"comment\">// </span></span><br><span class=\"line\">\t&#125;(a, counter())</span><br><span class=\"line\"></span><br><span class=\"line\">\ta += <span class=\"number\">100</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"main: %p,%v,%v\\n\"</span>, &amp;a, a, counter())</span><br><span class=\"line\">\ttime.Sleep(time.Second * <span class=\"number\">3</span>) <span class=\"comment\">//  goroutine </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// main: 0xc000062090,100</span></span><br><span class=\"line\"><span class=\"comment\">// main: 0xc000062090,200,2</span></span><br><span class=\"line\"><span class=\"comment\">// go: 0xc00000a038,100,1</span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine  a  main ,  goroutine </span></span><br></pre></td></tr></table></figure>\n\n<p> <code>time.sleep()</code>  <code>goroutine</code> ,  <code>goroutine</code> , <code>main</code>  <code>sleep</code> .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,  <code>channel</code>  <code>main</code> , </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\texit := <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">struct</span>&#123;&#125;) <span class=\"comment\">//  channel</span></span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\ttime.Sleep(time.Second)</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"goroutine done\"</span>)</span><br><span class=\"line\">\t\t<span class=\"built_in\">close</span>(exit) <span class=\"comment\">//  channel, </span></span><br><span class=\"line\">\t&#125;()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"main...\"</span>)</span><br><span class=\"line\">\t&lt;-exit <span class=\"comment\">//  channel , </span></span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"main exit...\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,  <code>sync.WaitGroup</code>. ,  goroutine ,  0 .</p>\n <figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">\t\twg.Add(<span class=\"number\">1</span>) <span class=\"comment\">//  goroutine,  1</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(id <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">defer</span> wg.Done() <span class=\"comment\">//  goroutine ,  1</span></span><br><span class=\"line\">\t\t\ttime.Sleep(time.Second)</span><br><span class=\"line\">\t\t\tfmt.Printf(<span class=\"string\">\"goroutine %v done\\n\"</span>, id)</span><br><span class=\"line\">\t\t&#125;(i)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"main...\"</span>)</span><br><span class=\"line\">\twg.Wait() <span class=\"comment\">// ,  0</span></span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"main exit...\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>WaitGroup.Add</code> ,  goroutine , (Add), (Wait)</p>\n<h1 id=\"channel\"><a href=\"#channel\" class=\"headerlink\" title=\"channel\"></a><code>channel</code></h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>Go  CSP(Communicating Sequential Process) channel, , .</p>\n<blockquote>\n<p>Dont communicate by sharing memory, share memory by communicating. , .</p>\n</blockquote>\n<p> CSP , channel , , . , .</p>\n<p>channel :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> channelName = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> Type, <span class=\"built_in\">cap</span>)  <span class=\"comment\">//  cap  channel,  Type </span></span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>, . channel ,  nil</li>\n<li> cap()  len() .  0, (0)(0).</li>\n<li> goroutine , </li>\n<li> ok-idom  for-range . ok-idom  channel, for-range  channel,  <code>fatal error: all goroutines are asleep - deadlock</code></li>\n<li> channel ,  panic.</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">putNum</span><span class=\"params\">(intChan <span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(intChan)  <span class=\"comment\">//  intChan</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">2</span>; i &lt;= <span class=\"number\">1000</span>; i++ &#123;</span><br><span class=\"line\">\t\tintChan &lt;- i  <span class=\"comment\">//  intChan </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">isPrime</span><span class=\"params\">(value <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> value &lt;= <span class=\"number\">3</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> value &gt;= <span class=\"number\">2</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> value%<span class=\"number\">2</span> == <span class=\"number\">0</span> || value%<span class=\"number\">3</span> == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">5</span>; i*i &lt;= value; i += <span class=\"number\">6</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> value%i == <span class=\"number\">0</span> || value%(i+<span class=\"number\">2</span>) == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getNum</span><span class=\"params\">(intChan <span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, outChan <span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, wg *sync.WaitGroup)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> wg.Done()</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> value := <span class=\"keyword\">range</span> intChan &#123;  <span class=\"comment\">//  for-range  intChan </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> isPrime(value) &#123;</span><br><span class=\"line\">\t\t\toutChan &lt;- value  <span class=\"comment\">//  outChan </span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> inChannel = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> outChannel = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">1000</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">go</span> putNum(inChannel)</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">\t\twg.Add(<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">go</span> getNum(inChannel, outChannel, &amp;wg)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\twg.Wait()</span><br><span class=\"line\">\t<span class=\"built_in\">close</span>(outChannel)</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> x := <span class=\"keyword\">range</span> outChannel &#123;</span><br><span class=\"line\">\t\tfmt.Println(x)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-channel\"><a href=\"#-channel\" class=\"headerlink\" title=\" channel\"></a> channel</h2><p>channel , . ,  channel,  channel </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> send <span class=\"keyword\">chan</span>&lt;- <span class=\"keyword\">int</span> = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> recv &lt;-<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span> = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\"><span class=\"comment\">// &lt;-send // , invalid operation: &lt;-send (recevice from send-only type chan&lt;- int), </span></span><br><span class=\"line\"><span class=\"comment\">// recv &lt;- 1</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"select-\"><a href=\"#select-\" class=\"headerlink\" title=\"select \"></a><code>select</code> </h3><p> channel,  <code>select</code> . </p>\n<p><code>select</code>  <code>switch</code> ,  case , .  case.  case ,  default </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\">\twg.Add(<span class=\"number\">2</span>)</span><br><span class=\"line\">\ta, b := <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>), <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> wg.Done()</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> (</span><br><span class=\"line\">\t\t\t\tname <span class=\"keyword\">string</span></span><br><span class=\"line\">\t\t\t\tx    <span class=\"keyword\">int</span></span><br><span class=\"line\">\t\t\t\tok   <span class=\"keyword\">bool</span></span><br><span class=\"line\">\t\t\t)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> x, ok = &lt;-a:</span><br><span class=\"line\">\t\t\t\tname = <span class=\"string\">\"a\"</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> x, ok = &lt;-b:</span><br><span class=\"line\">\t\t\t\tname = <span class=\"string\">\"b\"</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> !ok &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tfmt.Println(name, x)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;()</span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> wg.Done()</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(a)</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(b)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> a &lt;- i:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> b &lt;- i * <span class=\"number\">10</span>:</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;()</span><br><span class=\"line\">\twg.Wait()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>default  ,  channel .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tdone := <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>)</span><br><span class=\"line\">\tdata := []<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>&#123;<span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">3</span>)&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(done)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> data[<span class=\"built_in\">len</span>(data)<span class=\"number\">-1</span>] &lt;- i:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">default</span>:</span><br><span class=\"line\">\t\t\t\tdata = <span class=\"built_in\">append</span>(data, <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">3</span>))  <span class=\"comment\">// default  channel .</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;()</span><br><span class=\"line\">\t&lt;-done <span class=\"comment\">// ,  goroutine </span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">len</span>(data); i++ &#123;</span><br><span class=\"line\">\t\tc := data[i]</span><br><span class=\"line\">\t\t<span class=\"built_in\">close</span>(c)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> x := <span class=\"keyword\">range</span> c &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(x)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>channel ,  ID , Pool </p>\n<p> Pool :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"keyword\">type</span> pool <span class=\"keyword\">chan</span> []<span class=\"keyword\">byte</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newPool</span><span class=\"params\">(<span class=\"built_in\">cap</span> <span class=\"keyword\">int</span>)</span> <span class=\"title\">pool</span></span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> []<span class=\"keyword\">byte</span>, <span class=\"built_in\">cap</span>)</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p pool)</span> <span class=\"title\">get</span><span class=\"params\">()</span> []<span class=\"title\">byte</span></span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">var</span> bytes []<span class=\"keyword\">byte</span></span><br><span class=\"line\"> \t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">case</span> bytes = &lt;-p:</span><br><span class=\"line\"> \t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\"> \t<span class=\"keyword\">default</span>:</span><br><span class=\"line\"> \t\tfmt.Println(<span class=\"string\">\", \"</span>)</span><br><span class=\"line\"> \t\tbytes = <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\"> \t&#125;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> bytes</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p pool)</span> <span class=\"title\">put</span><span class=\"params\">(bytes []<span class=\"keyword\">byte</span>)</span></span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">case</span> p &lt;- bytes:</span><br><span class=\"line\"> \t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\"> \t<span class=\"keyword\">default</span>:</span><br><span class=\"line\"> \t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\"> \t&#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>(concurrency) (parallesim)</p>\n<ul>\n<li>: , ()/, /, CPU , /</li>\n<li>: , ,  CPU,  CPU </li>\n</ul>\n<p>, . ,, ,  CPU . , , . </p>\n<p>, . .</p>\n<p>Go  <code>goroutine</code> , <code>goroutine</code> , . , . <code>goroutine</code>  2KB,  MB </p>\n<p> Go  <code>goroutine</code> ,  <code>go</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span>  // </span></span><br></pre></td></tr></table></figure>\n\n<p>, <code>go</code> , . , . , , .</p>\n<p> <code>defer</code> , <code>go</code>  <code>goroutine</code> , .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> c <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">counter</span><span class=\"params\">()</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">\tc++</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> c</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ta := <span class=\"number\">100</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"main: %p,%v\\n\"</span>, &amp;a, a)</span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(x, y <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\t\ttime.Sleep(time.Second)                <span class=\"comment\">//  goroutine  mian </span></span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"go: %p,%v,%v\\n\"</span>, &amp;x, x, y) <span class=\"comment\">// </span></span><br><span class=\"line\">\t&#125;(a, counter())</span><br><span class=\"line\"></span><br><span class=\"line\">\ta += <span class=\"number\">100</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"main: %p,%v,%v\\n\"</span>, &amp;a, a, counter())</span><br><span class=\"line\">\ttime.Sleep(time.Second * <span class=\"number\">3</span>) <span class=\"comment\">//  goroutine </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// main: 0xc000062090,100</span></span><br><span class=\"line\"><span class=\"comment\">// main: 0xc000062090,200,2</span></span><br><span class=\"line\"><span class=\"comment\">// go: 0xc00000a038,100,1</span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine  a  main ,  goroutine </span></span><br></pre></td></tr></table></figure>\n\n<p> <code>time.sleep()</code>  <code>goroutine</code> ,  <code>goroutine</code> , <code>main</code>  <code>sleep</code> .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,  <code>channel</code>  <code>main</code> , </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\texit := <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">struct</span>&#123;&#125;) <span class=\"comment\">//  channel</span></span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\ttime.Sleep(time.Second)</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"goroutine done\"</span>)</span><br><span class=\"line\">\t\t<span class=\"built_in\">close</span>(exit) <span class=\"comment\">//  channel, </span></span><br><span class=\"line\">\t&#125;()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"main...\"</span>)</span><br><span class=\"line\">\t&lt;-exit <span class=\"comment\">//  channel , </span></span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"main exit...\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,  <code>sync.WaitGroup</code>. ,  goroutine ,  0 .</p>\n <figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">\t\twg.Add(<span class=\"number\">1</span>) <span class=\"comment\">//  goroutine,  1</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(id <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">defer</span> wg.Done() <span class=\"comment\">//  goroutine ,  1</span></span><br><span class=\"line\">\t\t\ttime.Sleep(time.Second)</span><br><span class=\"line\">\t\t\tfmt.Printf(<span class=\"string\">\"goroutine %v done\\n\"</span>, id)</span><br><span class=\"line\">\t\t&#125;(i)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"main...\"</span>)</span><br><span class=\"line\">\twg.Wait() <span class=\"comment\">// ,  0</span></span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"main exit...\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>WaitGroup.Add</code> ,  goroutine , (Add), (Wait)</p>\n<h1 id=\"channel\"><a href=\"#channel\" class=\"headerlink\" title=\"channel\"></a><code>channel</code></h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>Go  CSP(Communicating Sequential Process) channel, , .</p>\n<blockquote>\n<p>Dont communicate by sharing memory, share memory by communicating. , .</p>\n</blockquote>\n<p> CSP , channel , , . , .</p>\n<p>channel :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> channelName = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> Type, <span class=\"built_in\">cap</span>)  <span class=\"comment\">//  cap  channel,  Type </span></span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>, . channel ,  nil</li>\n<li> cap()  len() .  0, (0)(0).</li>\n<li> goroutine , </li>\n<li> ok-idom  for-range . ok-idom  channel, for-range  channel,  <code>fatal error: all goroutines are asleep - deadlock</code></li>\n<li> channel ,  panic.</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">putNum</span><span class=\"params\">(intChan <span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(intChan)  <span class=\"comment\">//  intChan</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">2</span>; i &lt;= <span class=\"number\">1000</span>; i++ &#123;</span><br><span class=\"line\">\t\tintChan &lt;- i  <span class=\"comment\">//  intChan </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">isPrime</span><span class=\"params\">(value <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> value &lt;= <span class=\"number\">3</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> value &gt;= <span class=\"number\">2</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> value%<span class=\"number\">2</span> == <span class=\"number\">0</span> || value%<span class=\"number\">3</span> == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">5</span>; i*i &lt;= value; i += <span class=\"number\">6</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> value%i == <span class=\"number\">0</span> || value%(i+<span class=\"number\">2</span>) == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getNum</span><span class=\"params\">(intChan <span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, outChan <span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, wg *sync.WaitGroup)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> wg.Done()</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> value := <span class=\"keyword\">range</span> intChan &#123;  <span class=\"comment\">//  for-range  intChan </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> isPrime(value) &#123;</span><br><span class=\"line\">\t\t\toutChan &lt;- value  <span class=\"comment\">//  outChan </span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> inChannel = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> outChannel = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">1000</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">go</span> putNum(inChannel)</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">\t\twg.Add(<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">go</span> getNum(inChannel, outChannel, &amp;wg)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\twg.Wait()</span><br><span class=\"line\">\t<span class=\"built_in\">close</span>(outChannel)</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> x := <span class=\"keyword\">range</span> outChannel &#123;</span><br><span class=\"line\">\t\tfmt.Println(x)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-channel\"><a href=\"#-channel\" class=\"headerlink\" title=\" channel\"></a> channel</h2><p>channel , . ,  channel,  channel </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> send <span class=\"keyword\">chan</span>&lt;- <span class=\"keyword\">int</span> = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> recv &lt;-<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span> = <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\"><span class=\"comment\">// &lt;-send // , invalid operation: &lt;-send (recevice from send-only type chan&lt;- int), </span></span><br><span class=\"line\"><span class=\"comment\">// recv &lt;- 1</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"select-\"><a href=\"#select-\" class=\"headerlink\" title=\"select \"></a><code>select</code> </h3><p> channel,  <code>select</code> . </p>\n<p><code>select</code>  <code>switch</code> ,  case , .  case.  case ,  default </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\">\twg.Add(<span class=\"number\">2</span>)</span><br><span class=\"line\">\ta, b := <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>), <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> wg.Done()</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> (</span><br><span class=\"line\">\t\t\t\tname <span class=\"keyword\">string</span></span><br><span class=\"line\">\t\t\t\tx    <span class=\"keyword\">int</span></span><br><span class=\"line\">\t\t\t\tok   <span class=\"keyword\">bool</span></span><br><span class=\"line\">\t\t\t)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> x, ok = &lt;-a:</span><br><span class=\"line\">\t\t\t\tname = <span class=\"string\">\"a\"</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> x, ok = &lt;-b:</span><br><span class=\"line\">\t\t\t\tname = <span class=\"string\">\"b\"</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> !ok &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tfmt.Println(name, x)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;()</span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> wg.Done()</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(a)</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(b)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> a &lt;- i:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> b &lt;- i * <span class=\"number\">10</span>:</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;()</span><br><span class=\"line\">\twg.Wait()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>default  ,  channel .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tdone := <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>)</span><br><span class=\"line\">\tdata := []<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>&#123;<span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">3</span>)&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(done)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> data[<span class=\"built_in\">len</span>(data)<span class=\"number\">-1</span>] &lt;- i:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">default</span>:</span><br><span class=\"line\">\t\t\t\tdata = <span class=\"built_in\">append</span>(data, <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">3</span>))  <span class=\"comment\">// default  channel .</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;()</span><br><span class=\"line\">\t&lt;-done <span class=\"comment\">// ,  goroutine </span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">len</span>(data); i++ &#123;</span><br><span class=\"line\">\t\tc := data[i]</span><br><span class=\"line\">\t\t<span class=\"built_in\">close</span>(c)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> x := <span class=\"keyword\">range</span> c &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(x)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>channel ,  ID , Pool </p>\n<p> Pool :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"keyword\">type</span> pool <span class=\"keyword\">chan</span> []<span class=\"keyword\">byte</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newPool</span><span class=\"params\">(<span class=\"built_in\">cap</span> <span class=\"keyword\">int</span>)</span> <span class=\"title\">pool</span></span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> []<span class=\"keyword\">byte</span>, <span class=\"built_in\">cap</span>)</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p pool)</span> <span class=\"title\">get</span><span class=\"params\">()</span> []<span class=\"title\">byte</span></span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">var</span> bytes []<span class=\"keyword\">byte</span></span><br><span class=\"line\"> \t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">case</span> bytes = &lt;-p:</span><br><span class=\"line\"> \t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\"> \t<span class=\"keyword\">default</span>:</span><br><span class=\"line\"> \t\tfmt.Println(<span class=\"string\">\", \"</span>)</span><br><span class=\"line\"> \t\tbytes = <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\"> \t&#125;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> bytes</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p pool)</span> <span class=\"title\">put</span><span class=\"params\">(bytes []<span class=\"keyword\">byte</span>)</span></span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">case</span> p &lt;- bytes:</span><br><span class=\"line\"> \t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\"> \t<span class=\"keyword\">default</span>:</span><br><span class=\"line\"> \t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\"> \t&#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>"},{"title":"go ","abbrlink":42823,"description":" Go , ,  Go \"\", Go ,.","_content":"\n## `range` \n\n\n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    arr := []int{0, 1, 2, 3}\n    for i, v := range arr {\n        wg.Add(1)\n        go func() {\n            fmt.Printf(\"(%v,%v)\", i, v)\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n}\n// :\n// (3,3)(3,3)(3,3)(3,3)\n```\n\n `arr`,.\n\n- `for range`  i, v \n- main  goroutine  goroutine , `go run -race main.go`  goroutine \n\n,`range` , goroutine , i,v ,\n\n,.:\n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    arr := []int{0, 1, 2, 3}\n    for i, v := range arr {\n        wg.Add(1)\n        // \n        go func(i, v int) {\n            fmt.Printf(\"(%v,%v)\", i, v)\n            wg.Done()\n        }(i, v)\n    }\n    wg.Wait()\n}\n// :  goroutine ,\n(3,3)(0,0)(1,1)(2,2)\n```\n\n.,, `i,v`  `a,b`(),\n\n## `defer` \n\n:\n\n```go\nimport \"fmt\"\n\nfunc f1() (r int) {\n    defer func() {\n        r++\n    }()\n    return 2\n}\n\nfunc f2() (r int) {\n    t := 5\n    defer func() {\n        t += 5\n    }()\n    return t\n}\n\nfunc f3() (r int) {\n    defer func(r int) {\n        r += 5\n    }(r)\n    return 1\n}\n\nfunc main() {\n    fmt.Printf(\"f1=%v,f2=%v,f3=%v\", f1(), f2(), f3())\n}\n// :\nf1=3,f2=5,f3=1\n```\n\n,\n\n,, `r` ,, `return` .\n\n1.  `f1` , `r`  2. `defer`  `r` .,. `f1`  `r` (). 3\n2.  `f2` , `r`  `t` ( `t`  `r`),  5. `defer`  `t` , `r` . `f2`  5\n3.  `f3` , `r`  1.,  `r`  `defer` (),`defer`  `r` . `f3`  1\n\n, **Go ,,.,**\n\n\n## \n\n## \n\n:\n\n- \n-  make \n- \n\n```go\narr := [5]int{0, 1, 2, 3, 4}\ns1 := arr[:]\ns2 := make([]int, 3, 5)\ns3 := []int{0, 1, 2}\nvar s4 []int  // s4 = nil\n```\n\n```go\n// runtime/slice.go\ntype slice struct {\n    array unsafe.Pointer\n    len   int\n    cap   int\n}\n```\n\n,. `runtime/slice.go`  3 ,,. len  cap ,,\n\n `var s = make([]int, 0)`  `var s []int` ,,,, nil.\n\n### \n\n `append` ,,,\n\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"unsafe\"\n)\n\nfunc main() {\n    arr := [7]int{0, 1, 2, 3, 4, 5, 6}\n    a := arr[:]\n    b := arr[0:4]\n    as := (*reflect.SliceHeader)(unsafe.Pointer(&a))\n    bs := (*reflect.SliceHeader)(unsafe.Pointer(&b))\n\n    fmt.Printf(\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", a, len(a), cap(a), &a, as.Data)\n    fmt.Printf(\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", b, len(b), cap(b), &b, bs.Data)\n\n    b = append(b, 10, 11, 12)\n    fmt.Printf(\"arr=%v,len=%d,cap=%d,pointer=%p\\n\", arr, len(arr), cap(arr))\n    fmt.Printf(\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", a, len(a), cap(a), &a, as.Data)\n    fmt.Printf(\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", b, len(b), cap(b), &b, bs.Data)\n\n    b = append(b, 13, 14)\n    fmt.Printf(\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", a, len(a), cap(a), &a, as.Data)\n    fmt.Printf(\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", b, len(b), cap(b), &b, bs.Data)\n}\n// \n// arr=[0 1 2 3 4 5 6],len=7,cap=7,pointer=0xc00000e280\n// a=[0 1 2 3 4 5 6],len=7,cap=7,pointer=0xc0000044a0, type=824633778816\n// b=[0 1 2 3],len=4,cap=7,pointer=0xc0000044c0, type=824633778816\n// arr=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc00000e280\n// a=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044a0, type=824633778816\n// b=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044c0, type=824633778816\n// arr=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc00000e280\n// a=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044a0, type=824633778816\n// b=[0 1 2 3 10 11 12 13 14],len=9,cap=14,pointer=0xc0000044c0, type=824633786816\n```\n\n:\n\n-  `append`  b , arr . a \n-  `append`  b , `len(b) > cap(b)`,,,\n\n## \n\nGo .\n\n- ,,,\n- (`chan,map,slice`),,\n","source":"_posts/go-study-notes-maybe-trap.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 42823\ndescription: ' Go , ,  Go \"\", Go ,.'\n---\n\n## `range` \n\n\n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    arr := []int{0, 1, 2, 3}\n    for i, v := range arr {\n        wg.Add(1)\n        go func() {\n            fmt.Printf(\"(%v,%v)\", i, v)\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n}\n// :\n// (3,3)(3,3)(3,3)(3,3)\n```\n\n `arr`,.\n\n- `for range`  i, v \n- main  goroutine  goroutine , `go run -race main.go`  goroutine \n\n,`range` , goroutine , i,v ,\n\n,.:\n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    arr := []int{0, 1, 2, 3}\n    for i, v := range arr {\n        wg.Add(1)\n        // \n        go func(i, v int) {\n            fmt.Printf(\"(%v,%v)\", i, v)\n            wg.Done()\n        }(i, v)\n    }\n    wg.Wait()\n}\n// :  goroutine ,\n(3,3)(0,0)(1,1)(2,2)\n```\n\n.,, `i,v`  `a,b`(),\n\n## `defer` \n\n:\n\n```go\nimport \"fmt\"\n\nfunc f1() (r int) {\n    defer func() {\n        r++\n    }()\n    return 2\n}\n\nfunc f2() (r int) {\n    t := 5\n    defer func() {\n        t += 5\n    }()\n    return t\n}\n\nfunc f3() (r int) {\n    defer func(r int) {\n        r += 5\n    }(r)\n    return 1\n}\n\nfunc main() {\n    fmt.Printf(\"f1=%v,f2=%v,f3=%v\", f1(), f2(), f3())\n}\n// :\nf1=3,f2=5,f3=1\n```\n\n,\n\n,, `r` ,, `return` .\n\n1.  `f1` , `r`  2. `defer`  `r` .,. `f1`  `r` (). 3\n2.  `f2` , `r`  `t` ( `t`  `r`),  5. `defer`  `t` , `r` . `f2`  5\n3.  `f3` , `r`  1.,  `r`  `defer` (),`defer`  `r` . `f3`  1\n\n, **Go ,,.,**\n\n\n## \n\n## \n\n:\n\n- \n-  make \n- \n\n```go\narr := [5]int{0, 1, 2, 3, 4}\ns1 := arr[:]\ns2 := make([]int, 3, 5)\ns3 := []int{0, 1, 2}\nvar s4 []int  // s4 = nil\n```\n\n```go\n// runtime/slice.go\ntype slice struct {\n    array unsafe.Pointer\n    len   int\n    cap   int\n}\n```\n\n,. `runtime/slice.go`  3 ,,. len  cap ,,\n\n `var s = make([]int, 0)`  `var s []int` ,,,, nil.\n\n### \n\n `append` ,,,\n\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"unsafe\"\n)\n\nfunc main() {\n    arr := [7]int{0, 1, 2, 3, 4, 5, 6}\n    a := arr[:]\n    b := arr[0:4]\n    as := (*reflect.SliceHeader)(unsafe.Pointer(&a))\n    bs := (*reflect.SliceHeader)(unsafe.Pointer(&b))\n\n    fmt.Printf(\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", a, len(a), cap(a), &a, as.Data)\n    fmt.Printf(\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", b, len(b), cap(b), &b, bs.Data)\n\n    b = append(b, 10, 11, 12)\n    fmt.Printf(\"arr=%v,len=%d,cap=%d,pointer=%p\\n\", arr, len(arr), cap(arr))\n    fmt.Printf(\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", a, len(a), cap(a), &a, as.Data)\n    fmt.Printf(\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", b, len(b), cap(b), &b, bs.Data)\n\n    b = append(b, 13, 14)\n    fmt.Printf(\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", a, len(a), cap(a), &a, as.Data)\n    fmt.Printf(\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\", b, len(b), cap(b), &b, bs.Data)\n}\n// \n// arr=[0 1 2 3 4 5 6],len=7,cap=7,pointer=0xc00000e280\n// a=[0 1 2 3 4 5 6],len=7,cap=7,pointer=0xc0000044a0, type=824633778816\n// b=[0 1 2 3],len=4,cap=7,pointer=0xc0000044c0, type=824633778816\n// arr=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc00000e280\n// a=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044a0, type=824633778816\n// b=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044c0, type=824633778816\n// arr=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc00000e280\n// a=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044a0, type=824633778816\n// b=[0 1 2 3 10 11 12 13 14],len=9,cap=14,pointer=0xc0000044c0, type=824633786816\n```\n\n:\n\n-  `append`  b , arr . a \n-  `append`  b , `len(b) > cap(b)`,,,\n\n## \n\nGo .\n\n- ,,,\n- (`chan,map,slice`),,\n","slug":"go-study-notes-maybe-trap","published":1,"date":"2020-05-17T12:13:06.599Z","updated":"2020-05-17T14:54:06.271Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihuy0007k8u70hph3y0y","content":"<h2 id=\"range-\"><a href=\"#range-\" class=\"headerlink\" title=\"range \"></a><code>range</code> </h2><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\">    arr := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i, v := <span class=\"keyword\">range</span> arr &#123;</span><br><span class=\"line\">        wg.Add(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\"(%v,%v)\"</span>, i, v)</span><br><span class=\"line\">            wg.Done()</span><br><span class=\"line\">        &#125;()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    wg.Wait()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">// (3,3)(3,3)(3,3)(3,3)</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>arr</code>,.</p>\n<ul>\n<li><code>for range</code>  i, v </li>\n<li>main  goroutine  goroutine , <code>go run -race main.go</code>  goroutine </li>\n</ul>\n<p>,<code>range</code> , goroutine , i,v ,</p>\n<p>,.:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\">    arr := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i, v := <span class=\"keyword\">range</span> arr &#123;</span><br><span class=\"line\">        wg.Add(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i, v <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\"(%v,%v)\"</span>, i, v)</span><br><span class=\"line\">            wg.Done()</span><br><span class=\"line\">        &#125;(i, v)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    wg.Wait()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :  goroutine ,</span></span><br><span class=\"line\">(<span class=\"number\">3</span>,<span class=\"number\">3</span>)(<span class=\"number\">0</span>,<span class=\"number\">0</span>)(<span class=\"number\">1</span>,<span class=\"number\">1</span>)(<span class=\"number\">2</span>,<span class=\"number\">2</span>)</span><br></pre></td></tr></table></figure>\n\n<p>.,, <code>i,v</code>  <code>a,b</code>(),</p>\n<h2 id=\"defer-\"><a href=\"#defer-\" class=\"headerlink\" title=\"defer \"></a><code>defer</code> </h2><p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f1</span><span class=\"params\">()</span> <span class=\"params\">(r <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        r++</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">2</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f2</span><span class=\"params\">()</span> <span class=\"params\">(r <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    t := <span class=\"number\">5</span></span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        t += <span class=\"number\">5</span></span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f3</span><span class=\"params\">()</span> <span class=\"params\">(r <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(r <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">        r += <span class=\"number\">5</span></span><br><span class=\"line\">    &#125;(r)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"f1=%v,f2=%v,f3=%v\"</span>, f1(), f2(), f3())</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\">f1=<span class=\"number\">3</span>,f2=<span class=\"number\">5</span>,f3=<span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n<p>,</p>\n<p>,, <code>r</code> ,, <code>return</code> .</p>\n<ol>\n<li> <code>f1</code> , <code>r</code>  2. <code>defer</code>  <code>r</code> .,. <code>f1</code>  <code>r</code> (). 3</li>\n<li> <code>f2</code> , <code>r</code>  <code>t</code> ( <code>t</code>  <code>r</code>),  5. <code>defer</code>  <code>t</code> , <code>r</code> . <code>f2</code>  5</li>\n<li> <code>f3</code> , <code>r</code>  1.,  <code>r</code>  <code>defer</code> (),<code>defer</code>  <code>r</code> . <code>f3</code>  1</li>\n</ol>\n<p>, <strong>Go ,,.,</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<ul>\n<li></li>\n<li> make </li>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arr := [<span class=\"number\">5</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>&#125;</span><br><span class=\"line\">s1 := arr[:]</span><br><span class=\"line\">s2 := <span class=\"built_in\">make</span>([]<span class=\"keyword\">int</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\">s3 := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> s4 []<span class=\"keyword\">int</span>  <span class=\"comment\">// s4 = nil</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// runtime/slice.go</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> slice <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    array unsafe.Pointer</span><br><span class=\"line\">    <span class=\"built_in\">len</span>   <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"built_in\">cap</span>   <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,. <code>runtime/slice.go</code>  3 ,,. len  cap ,,</p>\n<p> <code>var s = make([]int, 0)</code>  <code>var s []int</code> ,,,, nil.</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> <code>append</code> ,,,</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">    <span class=\"string\">\"unsafe\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    arr := [<span class=\"number\">7</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>&#125;</span><br><span class=\"line\">    a := arr[:]</span><br><span class=\"line\">    b := arr[<span class=\"number\">0</span>:<span class=\"number\">4</span>]</span><br><span class=\"line\">    as := (*reflect.SliceHeader)(unsafe.Pointer(&amp;a))</span><br><span class=\"line\">    bs := (*reflect.SliceHeader)(unsafe.Pointer(&amp;b))</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, a, <span class=\"built_in\">len</span>(a), <span class=\"built_in\">cap</span>(a), &amp;a, as.Data)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, b, <span class=\"built_in\">len</span>(b), <span class=\"built_in\">cap</span>(b), &amp;b, bs.Data)</span><br><span class=\"line\"></span><br><span class=\"line\">    b = <span class=\"built_in\">append</span>(b, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"arr=%v,len=%d,cap=%d,pointer=%p\\n\"</span>, arr, <span class=\"built_in\">len</span>(arr), <span class=\"built_in\">cap</span>(arr))</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, a, <span class=\"built_in\">len</span>(a), <span class=\"built_in\">cap</span>(a), &amp;a, as.Data)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, b, <span class=\"built_in\">len</span>(b), <span class=\"built_in\">cap</span>(b), &amp;b, bs.Data)</span><br><span class=\"line\"></span><br><span class=\"line\">    b = <span class=\"built_in\">append</span>(b, <span class=\"number\">13</span>, <span class=\"number\">14</span>)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, a, <span class=\"built_in\">len</span>(a), <span class=\"built_in\">cap</span>(a), &amp;a, as.Data)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, b, <span class=\"built_in\">len</span>(b), <span class=\"built_in\">cap</span>(b), &amp;b, bs.Data)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// arr=[0 1 2 3 4 5 6],len=7,cap=7,pointer=0xc00000e280</span></span><br><span class=\"line\"><span class=\"comment\">// a=[0 1 2 3 4 5 6],len=7,cap=7,pointer=0xc0000044a0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// b=[0 1 2 3],len=4,cap=7,pointer=0xc0000044c0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// arr=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc00000e280</span></span><br><span class=\"line\"><span class=\"comment\">// a=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044a0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// b=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044c0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// arr=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc00000e280</span></span><br><span class=\"line\"><span class=\"comment\">// a=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044a0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// b=[0 1 2 3 10 11 12 13 14],len=9,cap=14,pointer=0xc0000044c0, type=824633786816</span></span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li> <code>append</code>  b , arr . a </li>\n<li> <code>append</code>  b , <code>len(b) &gt; cap(b)</code>,,,</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Go .</p>\n<ul>\n<li>,,,</li>\n<li>(<code>chan,map,slice</code>),,</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"range-\"><a href=\"#range-\" class=\"headerlink\" title=\"range \"></a><code>range</code> </h2><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\">    arr := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i, v := <span class=\"keyword\">range</span> arr &#123;</span><br><span class=\"line\">        wg.Add(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\"(%v,%v)\"</span>, i, v)</span><br><span class=\"line\">            wg.Done()</span><br><span class=\"line\">        &#125;()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    wg.Wait()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">// (3,3)(3,3)(3,3)(3,3)</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>arr</code>,.</p>\n<ul>\n<li><code>for range</code>  i, v </li>\n<li>main  goroutine  goroutine , <code>go run -race main.go</code>  goroutine </li>\n</ul>\n<p>,<code>range</code> , goroutine , i,v ,</p>\n<p>,.:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\">    arr := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i, v := <span class=\"keyword\">range</span> arr &#123;</span><br><span class=\"line\">        wg.Add(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i, v <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\"(%v,%v)\"</span>, i, v)</span><br><span class=\"line\">            wg.Done()</span><br><span class=\"line\">        &#125;(i, v)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    wg.Wait()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :  goroutine ,</span></span><br><span class=\"line\">(<span class=\"number\">3</span>,<span class=\"number\">3</span>)(<span class=\"number\">0</span>,<span class=\"number\">0</span>)(<span class=\"number\">1</span>,<span class=\"number\">1</span>)(<span class=\"number\">2</span>,<span class=\"number\">2</span>)</span><br></pre></td></tr></table></figure>\n\n<p>.,, <code>i,v</code>  <code>a,b</code>(),</p>\n<h2 id=\"defer-\"><a href=\"#defer-\" class=\"headerlink\" title=\"defer \"></a><code>defer</code> </h2><p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f1</span><span class=\"params\">()</span> <span class=\"params\">(r <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        r++</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">2</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f2</span><span class=\"params\">()</span> <span class=\"params\">(r <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    t := <span class=\"number\">5</span></span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        t += <span class=\"number\">5</span></span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f3</span><span class=\"params\">()</span> <span class=\"params\">(r <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(r <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">        r += <span class=\"number\">5</span></span><br><span class=\"line\">    &#125;(r)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"f1=%v,f2=%v,f3=%v\"</span>, f1(), f2(), f3())</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\">f1=<span class=\"number\">3</span>,f2=<span class=\"number\">5</span>,f3=<span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n<p>,</p>\n<p>,, <code>r</code> ,, <code>return</code> .</p>\n<ol>\n<li> <code>f1</code> , <code>r</code>  2. <code>defer</code>  <code>r</code> .,. <code>f1</code>  <code>r</code> (). 3</li>\n<li> <code>f2</code> , <code>r</code>  <code>t</code> ( <code>t</code>  <code>r</code>),  5. <code>defer</code>  <code>t</code> , <code>r</code> . <code>f2</code>  5</li>\n<li> <code>f3</code> , <code>r</code>  1.,  <code>r</code>  <code>defer</code> (),<code>defer</code>  <code>r</code> . <code>f3</code>  1</li>\n</ol>\n<p>, <strong>Go ,,.,</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<ul>\n<li></li>\n<li> make </li>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arr := [<span class=\"number\">5</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>&#125;</span><br><span class=\"line\">s1 := arr[:]</span><br><span class=\"line\">s2 := <span class=\"built_in\">make</span>([]<span class=\"keyword\">int</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\">s3 := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> s4 []<span class=\"keyword\">int</span>  <span class=\"comment\">// s4 = nil</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// runtime/slice.go</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> slice <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    array unsafe.Pointer</span><br><span class=\"line\">    <span class=\"built_in\">len</span>   <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"built_in\">cap</span>   <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,. <code>runtime/slice.go</code>  3 ,,. len  cap ,,</p>\n<p> <code>var s = make([]int, 0)</code>  <code>var s []int</code> ,,,, nil.</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> <code>append</code> ,,,</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">    <span class=\"string\">\"unsafe\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    arr := [<span class=\"number\">7</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>&#125;</span><br><span class=\"line\">    a := arr[:]</span><br><span class=\"line\">    b := arr[<span class=\"number\">0</span>:<span class=\"number\">4</span>]</span><br><span class=\"line\">    as := (*reflect.SliceHeader)(unsafe.Pointer(&amp;a))</span><br><span class=\"line\">    bs := (*reflect.SliceHeader)(unsafe.Pointer(&amp;b))</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, a, <span class=\"built_in\">len</span>(a), <span class=\"built_in\">cap</span>(a), &amp;a, as.Data)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, b, <span class=\"built_in\">len</span>(b), <span class=\"built_in\">cap</span>(b), &amp;b, bs.Data)</span><br><span class=\"line\"></span><br><span class=\"line\">    b = <span class=\"built_in\">append</span>(b, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"arr=%v,len=%d,cap=%d,pointer=%p\\n\"</span>, arr, <span class=\"built_in\">len</span>(arr), <span class=\"built_in\">cap</span>(arr))</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, a, <span class=\"built_in\">len</span>(a), <span class=\"built_in\">cap</span>(a), &amp;a, as.Data)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, b, <span class=\"built_in\">len</span>(b), <span class=\"built_in\">cap</span>(b), &amp;b, bs.Data)</span><br><span class=\"line\"></span><br><span class=\"line\">    b = <span class=\"built_in\">append</span>(b, <span class=\"number\">13</span>, <span class=\"number\">14</span>)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"a=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, a, <span class=\"built_in\">len</span>(a), <span class=\"built_in\">cap</span>(a), &amp;a, as.Data)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"b=%v,len=%d,cap=%d,pointer=%p, type=%d\\n\"</span>, b, <span class=\"built_in\">len</span>(b), <span class=\"built_in\">cap</span>(b), &amp;b, bs.Data)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// arr=[0 1 2 3 4 5 6],len=7,cap=7,pointer=0xc00000e280</span></span><br><span class=\"line\"><span class=\"comment\">// a=[0 1 2 3 4 5 6],len=7,cap=7,pointer=0xc0000044a0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// b=[0 1 2 3],len=4,cap=7,pointer=0xc0000044c0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// arr=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc00000e280</span></span><br><span class=\"line\"><span class=\"comment\">// a=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044a0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// b=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044c0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// arr=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc00000e280</span></span><br><span class=\"line\"><span class=\"comment\">// a=[0 1 2 3 10 11 12],len=7,cap=7,pointer=0xc0000044a0, type=824633778816</span></span><br><span class=\"line\"><span class=\"comment\">// b=[0 1 2 3 10 11 12 13 14],len=9,cap=14,pointer=0xc0000044c0, type=824633786816</span></span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li> <code>append</code>  b , arr . a </li>\n<li> <code>append</code>  b , <code>len(b) &gt; cap(b)</code>,,,</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Go .</p>\n<ul>\n<li>,,,</li>\n<li>(<code>chan,map,slice</code>),,</li>\n</ul>\n"},{"title":"go ","abbrlink":46843,"description":" Go , ,  Go , for , if-else,switch, select  fallthrough,goto,break,continue ","_content":"\n# \n\n, . , \n\n-  `&` .\n-  `*` .\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    x := 100\n    p := &x\n    fmt.Printf(\"p :%T, p :%p\\n\", p, &p) // p  *int ,,\n    fmt.Printf(\"p :%v, x :%p\\n\", p, &x)  //  p  x \n    fmt.Printf(\"x :%v, p :%v\\n\", x, *p) // p  x \n}\n```\n\n,  Go , , :\n\n```go\nfunc main() {\n    type Student struct {\n        Name string\n        age int\n    }\n    stu := Student{\"tom\", 20}\n    p := &stu\n    (*p).Name=\"jack\"  // , , \n    p.Name = \"jack\"   // , Go , /\n}\n```\n\n# `for` \n\n\n```go\nfor i := 0; i < 10; i++ {\n    // do something\n}\n\nfor index, value := range x {\n    // do something\n    // , index  x , value  x \n    //  _ \n}\n```\nGo  `while`, `until` ,  `while true`  `do...until` ,  `for` + `if` . :\n\n```\n// \nfor {\n    // do something\n}\n\n// do...while \nfor {\n    // do something\n    if expression {\n        break\n    }\n}\n```\n\n# `if-else` \n\n`if-else` , \n```go\nif expression {\n    // do something\n} else if {\n    // do something\n} else {\n    // do something\n}\n```\n\n# `switch` \n\n `if-else` , `switch` , \n\n:\n\n-  `switch` \n- `case` \n-   `case`  `default` \n-   `case` \n-   `break` , `case` \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\tswitch x := 5; x {\n    case 0:     //  \"case 0: break;\"\n\tcase 1, 2, 3, 4, 5:\n\t\tfmt.Println(\"\")\n\tcase 6, 7:\n\t\tfmt.Println(\"\")\n\tdefault:\n\t\tfmt.Println(\"\")\n\t}\n}\n```\n\n`switch`  `if` ,  `switch`  `true`,  `case` : \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    x := 20\n\tswitch  {\n\tcase x > 0 && x < 18:\n\t\tfmt.Println(\"\")\n\tcase x >= 18:\n\t\tfmt.Println(\"\")\n\tdefault:\n\t\tfmt.Println(\"\")\n\t}\n}\n```\n\n## `select` \n\n`select`  Go , `switch` .`select`  case. case , default  case \n\n:\n\n```go\nselect {\ncase communicating_1:\n    statements\ncase communicating_2:\n    statements\ndefault: // \n    statements\n}\n```\n\n:\n\n-  case \n-  case , select ,\n-  case , default ,;,\n\n\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    done := make(chan int)\n    data := []chan int{make(chan int, 3)}\n\n    go func() {\n        defer close(done)\n        for i := 0; i < 10; i++ {\n            select {\n            case data[len(data)-1] <- i:\n                fmt.Println(\"case 1 \")\n            case data[len(data)-1] <- i:\n                fmt.Println(\"case 2 \")\n            default:\n                data = append(data, make(chan int, 3))  // default  channel .\n            }\n        }\n    }()\n    <-done // ,  goroutine \n    for i := 0; i < len(data); i++ {\n        c := data[i]\n        close(c)\n        for x := range c {\n            fmt.Println(x)\n        }\n    }\n}\n//  case 1 2 \n```\n\n\n## `fallthrough` \n\n`fallthrough` **** `case` ,  `case` \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\tswitch x := 0; x {\n    case 0:\n        fmt.Println(\"0\")\n        fallthrough\n\tcase 1, 2, 3, 4, 5:\n\t\tfmt.Println(\"\")\n\tcase 6, 7:\n\t\tfmt.Println(\"\")\n\tdefault:\n\t\tfmt.Println(\"\")\n\t}\n}\n// \n// 0\n// \n```\n\n# `goto`, `continue`, `break` \n\n- `goto` , , \n- `continue`  `for` , , .\n- `break`  `switch`, `for`, `select` , \n\n, `continue`  `break` .\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\nouter:\n\tfor x := 0; x < 5; x++ {\n\t\tfor y := 0; y < 10; y++ {\n\t\t\tif y > 2 {\n\t\t\t\tfmt.Println()\n\t\t\t\tcontinue outer\n\t\t\t}\n\t\t\tif x > 2 {\n\t\t\t\tbreak outer\n\t\t\t}\n\t\t\tfmt.Printf(\"%v:%v \", x, y)\n\t\t}\n\t}\n}\n// :\n// 0:0 0:1 0:2 \n// 1:0 1:1 1:2 \n// 2:0 2:1 2:2 \n```","source":"_posts/go-study-notes-expression.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 46843\ndescription: >-\n   Go , ,  Go , for , if-else,switch, select \n  fallthrough,goto,break,continue \n---\n\n# \n\n, . , \n\n-  `&` .\n-  `*` .\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    x := 100\n    p := &x\n    fmt.Printf(\"p :%T, p :%p\\n\", p, &p) // p  *int ,,\n    fmt.Printf(\"p :%v, x :%p\\n\", p, &x)  //  p  x \n    fmt.Printf(\"x :%v, p :%v\\n\", x, *p) // p  x \n}\n```\n\n,  Go , , :\n\n```go\nfunc main() {\n    type Student struct {\n        Name string\n        age int\n    }\n    stu := Student{\"tom\", 20}\n    p := &stu\n    (*p).Name=\"jack\"  // , , \n    p.Name = \"jack\"   // , Go , /\n}\n```\n\n# `for` \n\n\n```go\nfor i := 0; i < 10; i++ {\n    // do something\n}\n\nfor index, value := range x {\n    // do something\n    // , index  x , value  x \n    //  _ \n}\n```\nGo  `while`, `until` ,  `while true`  `do...until` ,  `for` + `if` . :\n\n```\n// \nfor {\n    // do something\n}\n\n// do...while \nfor {\n    // do something\n    if expression {\n        break\n    }\n}\n```\n\n# `if-else` \n\n`if-else` , \n```go\nif expression {\n    // do something\n} else if {\n    // do something\n} else {\n    // do something\n}\n```\n\n# `switch` \n\n `if-else` , `switch` , \n\n:\n\n-  `switch` \n- `case` \n-   `case`  `default` \n-   `case` \n-   `break` , `case` \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\tswitch x := 5; x {\n    case 0:     //  \"case 0: break;\"\n\tcase 1, 2, 3, 4, 5:\n\t\tfmt.Println(\"\")\n\tcase 6, 7:\n\t\tfmt.Println(\"\")\n\tdefault:\n\t\tfmt.Println(\"\")\n\t}\n}\n```\n\n`switch`  `if` ,  `switch`  `true`,  `case` : \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    x := 20\n\tswitch  {\n\tcase x > 0 && x < 18:\n\t\tfmt.Println(\"\")\n\tcase x >= 18:\n\t\tfmt.Println(\"\")\n\tdefault:\n\t\tfmt.Println(\"\")\n\t}\n}\n```\n\n## `select` \n\n`select`  Go , `switch` .`select`  case. case , default  case \n\n:\n\n```go\nselect {\ncase communicating_1:\n    statements\ncase communicating_2:\n    statements\ndefault: // \n    statements\n}\n```\n\n:\n\n-  case \n-  case , select ,\n-  case , default ,;,\n\n\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    done := make(chan int)\n    data := []chan int{make(chan int, 3)}\n\n    go func() {\n        defer close(done)\n        for i := 0; i < 10; i++ {\n            select {\n            case data[len(data)-1] <- i:\n                fmt.Println(\"case 1 \")\n            case data[len(data)-1] <- i:\n                fmt.Println(\"case 2 \")\n            default:\n                data = append(data, make(chan int, 3))  // default  channel .\n            }\n        }\n    }()\n    <-done // ,  goroutine \n    for i := 0; i < len(data); i++ {\n        c := data[i]\n        close(c)\n        for x := range c {\n            fmt.Println(x)\n        }\n    }\n}\n//  case 1 2 \n```\n\n\n## `fallthrough` \n\n`fallthrough` **** `case` ,  `case` \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\tswitch x := 0; x {\n    case 0:\n        fmt.Println(\"0\")\n        fallthrough\n\tcase 1, 2, 3, 4, 5:\n\t\tfmt.Println(\"\")\n\tcase 6, 7:\n\t\tfmt.Println(\"\")\n\tdefault:\n\t\tfmt.Println(\"\")\n\t}\n}\n// \n// 0\n// \n```\n\n# `goto`, `continue`, `break` \n\n- `goto` , , \n- `continue`  `for` , , .\n- `break`  `switch`, `for`, `select` , \n\n, `continue`  `break` .\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\nouter:\n\tfor x := 0; x < 5; x++ {\n\t\tfor y := 0; y < 10; y++ {\n\t\t\tif y > 2 {\n\t\t\t\tfmt.Println()\n\t\t\t\tcontinue outer\n\t\t\t}\n\t\t\tif x > 2 {\n\t\t\t\tbreak outer\n\t\t\t}\n\t\t\tfmt.Printf(\"%v:%v \", x, y)\n\t\t}\n\t}\n}\n// :\n// 0:0 0:1 0:2 \n// 1:0 1:1 1:2 \n// 2:0 2:1 2:2 \n```","slug":"go-study-notes-expression","published":1,"date":"2020-04-30T10:10:58.183Z","updated":"2020-05-04T03:54:28.956Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihuz0008k8u722x23wge","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, . , </p>\n<ul>\n<li> <code>&amp;</code> .</li>\n<li> <code>*</code> .</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    x := <span class=\"number\">100</span></span><br><span class=\"line\">    p := &amp;x</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"p :%T, p :%p\\n\"</span>, p, &amp;p) <span class=\"comment\">// p  *int ,,</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"p :%v, x :%p\\n\"</span>, p, &amp;x)  <span class=\"comment\">//  p  x </span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"x :%v, p :%v\\n\"</span>, x, *p) <span class=\"comment\">// p  x </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,  Go , , :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        Name <span class=\"keyword\">string</span></span><br><span class=\"line\">        age <span class=\"keyword\">int</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    stu := Student&#123;<span class=\"string\">\"tom\"</span>, <span class=\"number\">20</span>&#125;</span><br><span class=\"line\">    p := &amp;stu</span><br><span class=\"line\">    (*p).Name=<span class=\"string\">\"jack\"</span>  <span class=\"comment\">// , , </span></span><br><span class=\"line\">    p.Name = <span class=\"string\">\"jack\"</span>   <span class=\"comment\">// , Go , /</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"for-\"><a href=\"#for-\" class=\"headerlink\" title=\"for \"></a><code>for</code> </h1><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> index, value := <span class=\"keyword\">range</span> x &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">    <span class=\"comment\">// , index  x , value  x </span></span><br><span class=\"line\">    <span class=\"comment\">//  _ </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Go  <code>while</code>, <code>until</code> ,  <code>while true</code>  <code>do...until</code> ,  <code>for</code> + <code>if</code> . :</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"regexp\">//</span> </span><br><span class=\"line\"><span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">    <span class=\"regexp\">//</span> <span class=\"keyword\">do</span> something</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"regexp\">//</span> <span class=\"keyword\">do</span>...<span class=\"keyword\">while</span> </span><br><span class=\"line\"><span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">    <span class=\"regexp\">//</span> <span class=\"keyword\">do</span> something</span><br><span class=\"line\">    <span class=\"keyword\">if</span> expression &#123;</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"if-else-\"><a href=\"#if-else-\" class=\"headerlink\" title=\"if-else \"></a><code>if-else</code> </h1><p><code>if-else</code> , </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> expression &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"switch-\"><a href=\"#switch-\" class=\"headerlink\" title=\"switch \"></a><code>switch</code> </h1><p> <code>if-else</code> , <code>switch</code> , </p>\n<p>:</p>\n<ul>\n<li> <code>switch</code> </li>\n<li><code>case</code> </li>\n<li> <code>case</code>  <code>default</code> </li>\n<li> <code>case</code> </li>\n<li> <code>break</code> , <code>case</code> </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">switch</span> x := <span class=\"number\">5</span>; x &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"number\">0</span>:     <span class=\"comment\">//  \"case 0: break;\"</span></span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">6</span>, <span class=\"number\">7</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">default</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>switch</code>  <code>if</code> ,  <code>switch</code>  <code>true</code>,  <code>case</code> : </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    x := <span class=\"number\">20</span></span><br><span class=\"line\">\t<span class=\"keyword\">switch</span>  &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> x &gt; <span class=\"number\">0</span> &amp;&amp; x &lt; <span class=\"number\">18</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> x &gt;= <span class=\"number\">18</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">default</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"select-\"><a href=\"#select-\" class=\"headerlink\" title=\"select \"></a><code>select</code> </h2><p><code>select</code>  Go , <code>switch</code> .<code>select</code>  case. case , default  case </p>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">case</span> communicating_1:</span><br><span class=\"line\">    statements</span><br><span class=\"line\"><span class=\"keyword\">case</span> communicating_2:</span><br><span class=\"line\">    statements</span><br><span class=\"line\"><span class=\"keyword\">default</span>: <span class=\"comment\">// </span></span><br><span class=\"line\">    statements</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li> case </li>\n<li> case , select ,</li>\n<li> case , default ,;,</li>\n</ul>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    done := <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>)</span><br><span class=\"line\">    data := []<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>&#123;<span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">3</span>)&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(done)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">            <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> data[<span class=\"built_in\">len</span>(data)<span class=\"number\">-1</span>] &lt;- i:</span><br><span class=\"line\">                fmt.Println(<span class=\"string\">\"case 1 \"</span>)</span><br><span class=\"line\">            <span class=\"keyword\">case</span> data[<span class=\"built_in\">len</span>(data)<span class=\"number\">-1</span>] &lt;- i:</span><br><span class=\"line\">                fmt.Println(<span class=\"string\">\"case 2 \"</span>)</span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                data = <span class=\"built_in\">append</span>(data, <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">3</span>))  <span class=\"comment\">// default  channel .</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    &lt;-done <span class=\"comment\">// ,  goroutine </span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">len</span>(data); i++ &#123;</span><br><span class=\"line\">        c := data[i]</span><br><span class=\"line\">        <span class=\"built_in\">close</span>(c)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> x := <span class=\"keyword\">range</span> c &#123;</span><br><span class=\"line\">            fmt.Println(x)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//  case 1 2 </span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"fallthrough-\"><a href=\"#fallthrough-\" class=\"headerlink\" title=\"fallthrough \"></a><code>fallthrough</code> </h2><p><code>fallthrough</code> <strong></strong> <code>case</code> ,  <code>case</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">switch</span> x := <span class=\"number\">0</span>; x &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"number\">0</span>:</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"0\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">fallthrough</span></span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">6</span>, <span class=\"number\">7</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">default</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"goto-continue-break-\"><a href=\"#goto-continue-break-\" class=\"headerlink\" title=\"goto, continue, break \"></a><code>goto</code>, <code>continue</code>, <code>break</code> </h1><ul>\n<li><code>goto</code> , , </li>\n<li><code>continue</code>  <code>for</code> , , .</li>\n<li><code>break</code>  <code>switch</code>, <code>for</code>, <code>select</code> , </li>\n</ul>\n<p>, <code>continue</code>  <code>break</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">outer:</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> x := <span class=\"number\">0</span>; x &lt; <span class=\"number\">5</span>; x++ &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> y := <span class=\"number\">0</span>; y &lt; <span class=\"number\">10</span>; y++ &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> y &gt; <span class=\"number\">2</span> &#123;</span><br><span class=\"line\">\t\t\t\tfmt.Println()</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">continue</span> outer</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> x &gt; <span class=\"number\">2</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span> outer</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tfmt.Printf(<span class=\"string\">\"%v:%v \"</span>, x, y)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">// 0:0 0:1 0:2 </span></span><br><span class=\"line\"><span class=\"comment\">// 1:0 1:1 1:2 </span></span><br><span class=\"line\"><span class=\"comment\">// 2:0 2:1 2:2</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, . , </p>\n<ul>\n<li> <code>&amp;</code> .</li>\n<li> <code>*</code> .</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    x := <span class=\"number\">100</span></span><br><span class=\"line\">    p := &amp;x</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"p :%T, p :%p\\n\"</span>, p, &amp;p) <span class=\"comment\">// p  *int ,,</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"p :%v, x :%p\\n\"</span>, p, &amp;x)  <span class=\"comment\">//  p  x </span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"x :%v, p :%v\\n\"</span>, x, *p) <span class=\"comment\">// p  x </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,  Go , , :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        Name <span class=\"keyword\">string</span></span><br><span class=\"line\">        age <span class=\"keyword\">int</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    stu := Student&#123;<span class=\"string\">\"tom\"</span>, <span class=\"number\">20</span>&#125;</span><br><span class=\"line\">    p := &amp;stu</span><br><span class=\"line\">    (*p).Name=<span class=\"string\">\"jack\"</span>  <span class=\"comment\">// , , </span></span><br><span class=\"line\">    p.Name = <span class=\"string\">\"jack\"</span>   <span class=\"comment\">// , Go , /</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"for-\"><a href=\"#for-\" class=\"headerlink\" title=\"for \"></a><code>for</code> </h1><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> index, value := <span class=\"keyword\">range</span> x &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">    <span class=\"comment\">// , index  x , value  x </span></span><br><span class=\"line\">    <span class=\"comment\">//  _ </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Go  <code>while</code>, <code>until</code> ,  <code>while true</code>  <code>do...until</code> ,  <code>for</code> + <code>if</code> . :</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"regexp\">//</span> </span><br><span class=\"line\"><span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">    <span class=\"regexp\">//</span> <span class=\"keyword\">do</span> something</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"regexp\">//</span> <span class=\"keyword\">do</span>...<span class=\"keyword\">while</span> </span><br><span class=\"line\"><span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">    <span class=\"regexp\">//</span> <span class=\"keyword\">do</span> something</span><br><span class=\"line\">    <span class=\"keyword\">if</span> expression &#123;</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"if-else-\"><a href=\"#if-else-\" class=\"headerlink\" title=\"if-else \"></a><code>if-else</code> </h1><p><code>if-else</code> , </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> expression &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"switch-\"><a href=\"#switch-\" class=\"headerlink\" title=\"switch \"></a><code>switch</code> </h1><p> <code>if-else</code> , <code>switch</code> , </p>\n<p>:</p>\n<ul>\n<li> <code>switch</code> </li>\n<li><code>case</code> </li>\n<li> <code>case</code>  <code>default</code> </li>\n<li> <code>case</code> </li>\n<li> <code>break</code> , <code>case</code> </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">switch</span> x := <span class=\"number\">5</span>; x &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"number\">0</span>:     <span class=\"comment\">//  \"case 0: break;\"</span></span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">6</span>, <span class=\"number\">7</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">default</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>switch</code>  <code>if</code> ,  <code>switch</code>  <code>true</code>,  <code>case</code> : </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    x := <span class=\"number\">20</span></span><br><span class=\"line\">\t<span class=\"keyword\">switch</span>  &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> x &gt; <span class=\"number\">0</span> &amp;&amp; x &lt; <span class=\"number\">18</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> x &gt;= <span class=\"number\">18</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">default</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"select-\"><a href=\"#select-\" class=\"headerlink\" title=\"select \"></a><code>select</code> </h2><p><code>select</code>  Go , <code>switch</code> .<code>select</code>  case. case , default  case </p>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">case</span> communicating_1:</span><br><span class=\"line\">    statements</span><br><span class=\"line\"><span class=\"keyword\">case</span> communicating_2:</span><br><span class=\"line\">    statements</span><br><span class=\"line\"><span class=\"keyword\">default</span>: <span class=\"comment\">// </span></span><br><span class=\"line\">    statements</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li> case </li>\n<li> case , select ,</li>\n<li> case , default ,;,</li>\n</ul>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    done := <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>)</span><br><span class=\"line\">    data := []<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>&#123;<span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">3</span>)&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">defer</span> <span class=\"built_in\">close</span>(done)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++ &#123;</span><br><span class=\"line\">            <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> data[<span class=\"built_in\">len</span>(data)<span class=\"number\">-1</span>] &lt;- i:</span><br><span class=\"line\">                fmt.Println(<span class=\"string\">\"case 1 \"</span>)</span><br><span class=\"line\">            <span class=\"keyword\">case</span> data[<span class=\"built_in\">len</span>(data)<span class=\"number\">-1</span>] &lt;- i:</span><br><span class=\"line\">                fmt.Println(<span class=\"string\">\"case 2 \"</span>)</span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                data = <span class=\"built_in\">append</span>(data, <span class=\"built_in\">make</span>(<span class=\"keyword\">chan</span> <span class=\"keyword\">int</span>, <span class=\"number\">3</span>))  <span class=\"comment\">// default  channel .</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    &lt;-done <span class=\"comment\">// ,  goroutine </span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">len</span>(data); i++ &#123;</span><br><span class=\"line\">        c := data[i]</span><br><span class=\"line\">        <span class=\"built_in\">close</span>(c)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> x := <span class=\"keyword\">range</span> c &#123;</span><br><span class=\"line\">            fmt.Println(x)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//  case 1 2 </span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"fallthrough-\"><a href=\"#fallthrough-\" class=\"headerlink\" title=\"fallthrough \"></a><code>fallthrough</code> </h2><p><code>fallthrough</code> <strong></strong> <code>case</code> ,  <code>case</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">switch</span> x := <span class=\"number\">0</span>; x &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"number\">0</span>:</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"0\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">fallthrough</span></span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">6</span>, <span class=\"number\">7</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">default</span>:</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"goto-continue-break-\"><a href=\"#goto-continue-break-\" class=\"headerlink\" title=\"goto, continue, break \"></a><code>goto</code>, <code>continue</code>, <code>break</code> </h1><ul>\n<li><code>goto</code> , , </li>\n<li><code>continue</code>  <code>for</code> , , .</li>\n<li><code>break</code>  <code>switch</code>, <code>for</code>, <code>select</code> , </li>\n</ul>\n<p>, <code>continue</code>  <code>break</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">outer:</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> x := <span class=\"number\">0</span>; x &lt; <span class=\"number\">5</span>; x++ &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> y := <span class=\"number\">0</span>; y &lt; <span class=\"number\">10</span>; y++ &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> y &gt; <span class=\"number\">2</span> &#123;</span><br><span class=\"line\">\t\t\t\tfmt.Println()</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">continue</span> outer</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> x &gt; <span class=\"number\">2</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span> outer</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tfmt.Printf(<span class=\"string\">\"%v:%v \"</span>, x, y)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">// 0:0 0:1 0:2 </span></span><br><span class=\"line\"><span class=\"comment\">// 1:0 1:1 1:2 </span></span><br><span class=\"line\"><span class=\"comment\">// 2:0 2:1 2:2</span></span><br></pre></td></tr></table></figure>"},{"title":"go  go ","abbrlink":44881,"description":" Go , ,  Go , ","_content":"\n Go ,  go , \n\n go  `go`  Go .\n\n.  `go <command> [arguments]`,  `go help <command>` \n\n go \n\n |  | \n:---: | :--- | :---\nbug | bug/issue  |  Go ,  `github/golang/go`  issues\nbuild |  |\nclean |  | \ndoc |  |\nenv |  Go  |  `GO111MODULE`, `GOARCH`, `GOBIN`, ` GOHOSTARCH`, `GOHOSTOS`, `GOPATH`, `GOPROXY`, `GOROOT`, `GOTOOLDIR`,`GOMOD` \nfix |  API |\nfmt |  go \ngenerate |  Go \nget | \ninstall | \nlist | \nmod | \nrun |  Go \ntest | \ntool |  go \nversion |  Go \nvet |  | , , \n\n.  `go help <topic>` .\n\ntopic | \n:--- | :---\nbuildmode | \nc | Go  C \ncache | \nenvironment | \nfiletype | \ngo.mod | go.mod , , (python  requirements.txt )\ngopath | `GOPATH` \ngopath-get |  go get  GOPATH\ngoproxy |  go module \nimportpath | import \nmodules | , \nmodule-get |  go get \nmodule-auth |  go.sum \nmodule-private | \npackages | \ntestflag | \ntestfunc | \n\n# `go build`\n\n, \n\n```\ngo build [-o output] [-i] [build flags] [packages]\n```\n\n-  `.go` ,  build \n- , build  `_test.go` \n-  main , build ( `go build ed.go rx.go`  `ed`/`ed.exe`, `go build unix/sam`  `sam`/`sam.exe`).  Windows ,  \".exe\"  \n-  main , build , . \n\n | \n:---: | :---\n`-o` | \n`-i` | \n\n `build`, `clean`, `get`, `install`, `list`, `run`, `test` \n\n | \n:---: | :---\n`-a` | \n`-n` | , \n`-p n` | ,  CPU \n`-race` | ,  linux/amd64, freebsd/amd64, darwin/amd64  windows/amd64\n`-msan` | \n`-v` | \n`-work` | , \n`-x` | \n`-asm` | \n`-buildmode mode` | ,  `archive`, `c-archive`, `c-shared`, `default`, `shared`, `exe`, `pie`, `plugin`.  `go help buildmode`\n`-compiler name` |   `runtime.Compiler`(gccgo  gc)\n`-mod mode` | : readonly  vendor\n`-pkgdir dir` | , ,  -pkgdir \n`-tags tag,list` | \n\n# `go clean`\n\n\n\n```\ngo clean [clean flags] [build flags] [packages]\n```\ngo ,  `go clean`  `go build` \n\n | \n:---: | :---\n`-i` | \n`-n` | , \n`-r` | \n`-x` | \n`-cache` |  `go build` \n`-modcache` | , \n\n# `go doc`\n\n\n```\ngo doc [-u] [-c] [package|[package.]symbol[.methodOrField]]\n```\n\n(package, const, func, type, var, method, struct), \n\n | \n:---: | :---\n`-all` | \n`-c` | \n`-cmd` |  command (package main) , , , \n`-src` | \n`-u` | , \n\n# `go env`\n\n Go \n\n```\ngo env [-json] [-u] [-w] [var ...]\n```\n\n, env  shell ( Windows ). , \n\n | \n:---: | :---\n`-json` |  JSON \n`-u <arg> ...` |  `go env -w NAME=VALUE` \n`-w <NAME=VALUE> ...` | ()\n\n# `go fix`\n\n API\n\n```\ngo fix [packages]\n```\n\n# `go fmt`\n\n go ,  `gofmt -l -w`. \n\n```\ngo fmt [-n] [-x] [packages]\n```\n\n | \n:---: | :---\n`-n` | \n`-x` | \n\n# `go get`\n\n```\ngo get [-d] [-f] [-t] [-u] [-v] [-fix] [-insecure] [build flags] [packages]\n```\n\n, \n\n | \n:---: | :---\n`-d` | , \n`-f` |  `-u` ,  `-u` .  fork \n`-fix` | ,  fix \n`-insecure` | . \n`-t` | \n`-u` | . , , \n`-v` | \n\ncheckout , get  `GOPATH/src/<import-path>`.  `GOPATH` , .  `go help gopath`.\n\n checkout , get  Go  brach  tag. , .\n\n go get checkout  git ,  git \n\nget  checkout  vendor \n\n# `go install`\n\n\n\n```\ngo install [-i] [build flags] [packages]\n```\n\n `GOBIN` ,  `$GOPATH/bin`.  `GOPATH`,  `$HOME/go/bin`. `$GOROOT`  `$GOROOT/bin`  `$GOTOOLDIR` ,  `$GOBIN`.\n\n module-aware,  `$GOPATH/pkg/$GOOS_$GOARCH`.  module-aware, , .\n\n | \n:---: | :---\n`-i` | \n\n## `go list`\n\n\n\n```\ngo list [-f format] [-json] [-m] [list flags] [build flags] [packages]\n```\n\n, .  `...` .  `go list net/...`  \"net\" , \n\n | \n:---: | :---\n`-f` | \n`-json` |  json \n`-deps` | , .\n`-export` |  `Export` \n`-find` | , , `Imports`  `Deps` \n`-test` | , \n`-m` |  , \n\n `-f` , , .  `'\\{\\{ .ImportPath }}'`() (), `'\\{\\{ .Name }}'`(). \n\n\n\n```go\ntype Package struct {\n        Dir           string   // \n        ImportPath    string   // , `go list`  \n        ImportComment string   // packageimport\n        Name          string   // \n        Doc           string   // \n        Target        string   // \n        Shlib         string   // -linkshared\n        Goroot        bool     // GOROOT?\n        Standard      bool     // go?\n        Stale         bool     // `go install`?\n        StaleReason   string   // explanation for Stale==true\n        Root          string   // GOROOTGOPATH\n        ConflictDir   string   // $GOPATHshadows dir\n        BinaryOnly    bool     // binary-only package (no longer supported)\n        ForTest       string   // package is only for use in named test\n        Export        string   // file containing export data (when using -export)\n        Module        *Module  // info about package's containing module, if any (can be nil)\n        Match         []string // command-line patterns matching this package\n        DepOnly       bool     // package is only a dependency, not explicitly listed\n\n        // Source files\n        GoFiles         []string // .go source files (excluding CgoFiles, TestGoFiles, XTestGoFiles)\n        CgoFiles        []string // .go source files that import \"C\"\n        CompiledGoFiles []string // .go files presented to compiler (when using -compiled)\n        IgnoredGoFiles  []string // .go source files ignored due to build constraints\n        CFiles          []string // .c source files\n        CXXFiles        []string // .cc, .cxx and .cpp source files\n        MFiles          []string // .m source files\n        HFiles          []string // .h, .hh, .hpp and .hxx source files\n        FFiles          []string // .f, .F, .for and .f90 Fortran source files\n        SFiles          []string // .s source files\n        SwigFiles       []string // .swig files\n        SwigCXXFiles    []string // .swigcxx files\n        SysoFiles       []string // .syso object files to add to archive\n        TestGoFiles     []string // _test.go files in package\n        XTestGoFiles    []string // _test.go files outside package\n\n        // Cgo directives\n        CgoCFLAGS    []string // cgo: flags for C compiler\n        CgoCPPFLAGS  []string // cgo: flags for C preprocessor\n        CgoCXXFLAGS  []string // cgo: flags for C++ compiler\n        CgoFFLAGS    []string // cgo: flags for Fortran compiler\n        CgoLDFLAGS   []string // cgo: flags for linker\n        CgoPkgConfig []string // cgo: pkg-config names\n\n        // Dependency information\n        Imports      []string          // import paths used by this package\n        ImportMap    map[string]string // map from source import to ImportPath (identity entries omitted)\n        Deps         []string          // all (recursively) imported dependencies\n        TestImports  []string          // imports from TestGoFiles\n        XTestImports []string          // imports from XTestGoFiles\n\n        // Error information\n        Incomplete bool            // this package or a dependency has an error\n        Error      *PackageError   // error loading package\n        DepsErrors []*PackageError // errors loading dependencies\n}\n```\n\n:\n\n```go\ntype Module struct {\n    Path      string       // \n    Version   string       // \n    Versions  []string     //  (with -versions)\n    Replace   *Module      // \n    Time      *time.Time   // \n    Update    *Module      //  (with -u)\n    Main      bool         // \n    Indirect  bool         // ?\n    Dir       string       // \n    GoMod     string       // go.mod \n    GoVersion string       //  Go \n    Error     *ModuleError // \n}\n\ntype ModuleError struct {\n\tErr string // \n}\n```\n\n# `go mod`\n\n\n\n```\ngo mod <command> [arguments]\n```\n\n\n\ncommand | \n:---: | :---\ndownload | ( GOPATH/pkg/mod )\nedit |  go.mod\ngraph | \ninit | ,  go.mod\ntidy | ,\nvendor |  vendor \nverify | \nwhy | \n\n## `download`\n\n, ,  `path@version` . , .\n\n```\ngo mod download [-json] [modules]\n```\n\ngo . `go mod download`  go \n\n | \n:---: | :---\n`-json` |  json , .  Go Module \n\n```go\ntype Module struct {\n    Path     string // module path\n    Version  string // module version\n    Error    string // error loading module\n    Info     string // absolute path to cached .info file\n    GoMod    string // absolute path to cached .mod file\n    Zip      string // absolute path to cached .zip file\n    Dir      string // absolute path to cached source root directory\n    Sum      string // checksum for path, version (as in go.sum)\n    GoModSum string // checksum for go.mod (as in go.sum)\n}\n```\n\n## `edit`\n\n go.mod , .  go.mod, .\n\n, edit  go.mod ,\n\n | \n:---: | :---\n`-fmt` |  go.mod , \n`-module` | \n`-require=path@version`/`-droprequire=path` |  `path@version` / path \n`-exclude=path@version`/`-dropexclude=path@version` |  `path@version` / exclude \n`-replace=old[@v]=new[@v]`/`-dropreplace=old[@v]` |  `path@version` \n`-go=version` |  Go \n`-print` |  go.mod,  go.mod\n`-json` |   JSON  go.mod,  go.mod. JSON  Go \n\n```go\ntype Module struct {\n    Path string\n    Version string\n}\n\ntype GoMod struct {\n\tModule  Module\n    Go      string\n    Require []Require\n    Exclude []Module\n    Replace []Replace\n}\n\ntype Require struct {\n    Path string\n    Version string\n    Indirect bool\n}\n\ntype Replace struct {\n    Old Module\n    New Module\n}\n```\n\n## `init`\n\n go.mod ,  `/` . go.mod \n\n```\ngo mod init [module]\n```\n\n### `tidy`\n\n```\ngo mod tidy [-v]\n```\n\n go.mod , , .  go.sum , .\n\n`-v` \n\n## `vendor`\n\n```\ngo mod vendor [-v]\n```\n\n vendor , .  vendored .\n\n`-v`  vendored \n\n# `go run`\n\n Go \n\n```\ngo run [build flags] [-exec xprog] package [arguments...]\n```\n\n,  .go , , .\n\n, `go run` .  `-exec` ,  `go run`  xprog .  `-exec` ,  GOOS  `GOARCH` ,  `go_$GOOS_$GOARCH_exec` \n\n\n# `go test`\n\n, \n\n```\ngo test [build/test flags] [packages] [build/test flags & test binary flags]\n```\n\n`go test`  `*_test.go` . ,. .  `_`  `.` (`_test.go`)\n\n `_test` , . go  testdata , \n\ngo test :\n\n- :  package  go test . , go test , . , . , , (ok  FAIL), \n- :  package  go test . , go test , ,  ok . , .\n\n, go test , . \n\n | \n:---: | :---\n`-args` | (-args ). \n`-c` |  `pkg.test`, (pkg ).  `-o` \n`-exec xprog` |  xprog \n`-i` | , \n`-json` |  JSON \n`-o file` | , ( -c  -i)","source":"_posts/go-study-notes-go-command.md","raw":"---\ntitle: go  go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 44881\ndescription: ' Go , ,  Go , '\n---\n\n Go ,  go , \n\n go  `go`  Go .\n\n.  `go <command> [arguments]`,  `go help <command>` \n\n go \n\n |  | \n:---: | :--- | :---\nbug | bug/issue  |  Go ,  `github/golang/go`  issues\nbuild |  |\nclean |  | \ndoc |  |\nenv |  Go  |  `GO111MODULE`, `GOARCH`, `GOBIN`, ` GOHOSTARCH`, `GOHOSTOS`, `GOPATH`, `GOPROXY`, `GOROOT`, `GOTOOLDIR`,`GOMOD` \nfix |  API |\nfmt |  go \ngenerate |  Go \nget | \ninstall | \nlist | \nmod | \nrun |  Go \ntest | \ntool |  go \nversion |  Go \nvet |  | , , \n\n.  `go help <topic>` .\n\ntopic | \n:--- | :---\nbuildmode | \nc | Go  C \ncache | \nenvironment | \nfiletype | \ngo.mod | go.mod , , (python  requirements.txt )\ngopath | `GOPATH` \ngopath-get |  go get  GOPATH\ngoproxy |  go module \nimportpath | import \nmodules | , \nmodule-get |  go get \nmodule-auth |  go.sum \nmodule-private | \npackages | \ntestflag | \ntestfunc | \n\n# `go build`\n\n, \n\n```\ngo build [-o output] [-i] [build flags] [packages]\n```\n\n-  `.go` ,  build \n- , build  `_test.go` \n-  main , build ( `go build ed.go rx.go`  `ed`/`ed.exe`, `go build unix/sam`  `sam`/`sam.exe`).  Windows ,  \".exe\"  \n-  main , build , . \n\n | \n:---: | :---\n`-o` | \n`-i` | \n\n `build`, `clean`, `get`, `install`, `list`, `run`, `test` \n\n | \n:---: | :---\n`-a` | \n`-n` | , \n`-p n` | ,  CPU \n`-race` | ,  linux/amd64, freebsd/amd64, darwin/amd64  windows/amd64\n`-msan` | \n`-v` | \n`-work` | , \n`-x` | \n`-asm` | \n`-buildmode mode` | ,  `archive`, `c-archive`, `c-shared`, `default`, `shared`, `exe`, `pie`, `plugin`.  `go help buildmode`\n`-compiler name` |   `runtime.Compiler`(gccgo  gc)\n`-mod mode` | : readonly  vendor\n`-pkgdir dir` | , ,  -pkgdir \n`-tags tag,list` | \n\n# `go clean`\n\n\n\n```\ngo clean [clean flags] [build flags] [packages]\n```\ngo ,  `go clean`  `go build` \n\n | \n:---: | :---\n`-i` | \n`-n` | , \n`-r` | \n`-x` | \n`-cache` |  `go build` \n`-modcache` | , \n\n# `go doc`\n\n\n```\ngo doc [-u] [-c] [package|[package.]symbol[.methodOrField]]\n```\n\n(package, const, func, type, var, method, struct), \n\n | \n:---: | :---\n`-all` | \n`-c` | \n`-cmd` |  command (package main) , , , \n`-src` | \n`-u` | , \n\n# `go env`\n\n Go \n\n```\ngo env [-json] [-u] [-w] [var ...]\n```\n\n, env  shell ( Windows ). , \n\n | \n:---: | :---\n`-json` |  JSON \n`-u <arg> ...` |  `go env -w NAME=VALUE` \n`-w <NAME=VALUE> ...` | ()\n\n# `go fix`\n\n API\n\n```\ngo fix [packages]\n```\n\n# `go fmt`\n\n go ,  `gofmt -l -w`. \n\n```\ngo fmt [-n] [-x] [packages]\n```\n\n | \n:---: | :---\n`-n` | \n`-x` | \n\n# `go get`\n\n```\ngo get [-d] [-f] [-t] [-u] [-v] [-fix] [-insecure] [build flags] [packages]\n```\n\n, \n\n | \n:---: | :---\n`-d` | , \n`-f` |  `-u` ,  `-u` .  fork \n`-fix` | ,  fix \n`-insecure` | . \n`-t` | \n`-u` | . , , \n`-v` | \n\ncheckout , get  `GOPATH/src/<import-path>`.  `GOPATH` , .  `go help gopath`.\n\n checkout , get  Go  brach  tag. , .\n\n go get checkout  git ,  git \n\nget  checkout  vendor \n\n# `go install`\n\n\n\n```\ngo install [-i] [build flags] [packages]\n```\n\n `GOBIN` ,  `$GOPATH/bin`.  `GOPATH`,  `$HOME/go/bin`. `$GOROOT`  `$GOROOT/bin`  `$GOTOOLDIR` ,  `$GOBIN`.\n\n module-aware,  `$GOPATH/pkg/$GOOS_$GOARCH`.  module-aware, , .\n\n | \n:---: | :---\n`-i` | \n\n## `go list`\n\n\n\n```\ngo list [-f format] [-json] [-m] [list flags] [build flags] [packages]\n```\n\n, .  `...` .  `go list net/...`  \"net\" , \n\n | \n:---: | :---\n`-f` | \n`-json` |  json \n`-deps` | , .\n`-export` |  `Export` \n`-find` | , , `Imports`  `Deps` \n`-test` | , \n`-m` |  , \n\n `-f` , , .  `'\\{\\{ .ImportPath }}'`() (), `'\\{\\{ .Name }}'`(). \n\n\n\n```go\ntype Package struct {\n        Dir           string   // \n        ImportPath    string   // , `go list`  \n        ImportComment string   // packageimport\n        Name          string   // \n        Doc           string   // \n        Target        string   // \n        Shlib         string   // -linkshared\n        Goroot        bool     // GOROOT?\n        Standard      bool     // go?\n        Stale         bool     // `go install`?\n        StaleReason   string   // explanation for Stale==true\n        Root          string   // GOROOTGOPATH\n        ConflictDir   string   // $GOPATHshadows dir\n        BinaryOnly    bool     // binary-only package (no longer supported)\n        ForTest       string   // package is only for use in named test\n        Export        string   // file containing export data (when using -export)\n        Module        *Module  // info about package's containing module, if any (can be nil)\n        Match         []string // command-line patterns matching this package\n        DepOnly       bool     // package is only a dependency, not explicitly listed\n\n        // Source files\n        GoFiles         []string // .go source files (excluding CgoFiles, TestGoFiles, XTestGoFiles)\n        CgoFiles        []string // .go source files that import \"C\"\n        CompiledGoFiles []string // .go files presented to compiler (when using -compiled)\n        IgnoredGoFiles  []string // .go source files ignored due to build constraints\n        CFiles          []string // .c source files\n        CXXFiles        []string // .cc, .cxx and .cpp source files\n        MFiles          []string // .m source files\n        HFiles          []string // .h, .hh, .hpp and .hxx source files\n        FFiles          []string // .f, .F, .for and .f90 Fortran source files\n        SFiles          []string // .s source files\n        SwigFiles       []string // .swig files\n        SwigCXXFiles    []string // .swigcxx files\n        SysoFiles       []string // .syso object files to add to archive\n        TestGoFiles     []string // _test.go files in package\n        XTestGoFiles    []string // _test.go files outside package\n\n        // Cgo directives\n        CgoCFLAGS    []string // cgo: flags for C compiler\n        CgoCPPFLAGS  []string // cgo: flags for C preprocessor\n        CgoCXXFLAGS  []string // cgo: flags for C++ compiler\n        CgoFFLAGS    []string // cgo: flags for Fortran compiler\n        CgoLDFLAGS   []string // cgo: flags for linker\n        CgoPkgConfig []string // cgo: pkg-config names\n\n        // Dependency information\n        Imports      []string          // import paths used by this package\n        ImportMap    map[string]string // map from source import to ImportPath (identity entries omitted)\n        Deps         []string          // all (recursively) imported dependencies\n        TestImports  []string          // imports from TestGoFiles\n        XTestImports []string          // imports from XTestGoFiles\n\n        // Error information\n        Incomplete bool            // this package or a dependency has an error\n        Error      *PackageError   // error loading package\n        DepsErrors []*PackageError // errors loading dependencies\n}\n```\n\n:\n\n```go\ntype Module struct {\n    Path      string       // \n    Version   string       // \n    Versions  []string     //  (with -versions)\n    Replace   *Module      // \n    Time      *time.Time   // \n    Update    *Module      //  (with -u)\n    Main      bool         // \n    Indirect  bool         // ?\n    Dir       string       // \n    GoMod     string       // go.mod \n    GoVersion string       //  Go \n    Error     *ModuleError // \n}\n\ntype ModuleError struct {\n\tErr string // \n}\n```\n\n# `go mod`\n\n\n\n```\ngo mod <command> [arguments]\n```\n\n\n\ncommand | \n:---: | :---\ndownload | ( GOPATH/pkg/mod )\nedit |  go.mod\ngraph | \ninit | ,  go.mod\ntidy | ,\nvendor |  vendor \nverify | \nwhy | \n\n## `download`\n\n, ,  `path@version` . , .\n\n```\ngo mod download [-json] [modules]\n```\n\ngo . `go mod download`  go \n\n | \n:---: | :---\n`-json` |  json , .  Go Module \n\n```go\ntype Module struct {\n    Path     string // module path\n    Version  string // module version\n    Error    string // error loading module\n    Info     string // absolute path to cached .info file\n    GoMod    string // absolute path to cached .mod file\n    Zip      string // absolute path to cached .zip file\n    Dir      string // absolute path to cached source root directory\n    Sum      string // checksum for path, version (as in go.sum)\n    GoModSum string // checksum for go.mod (as in go.sum)\n}\n```\n\n## `edit`\n\n go.mod , .  go.mod, .\n\n, edit  go.mod ,\n\n | \n:---: | :---\n`-fmt` |  go.mod , \n`-module` | \n`-require=path@version`/`-droprequire=path` |  `path@version` / path \n`-exclude=path@version`/`-dropexclude=path@version` |  `path@version` / exclude \n`-replace=old[@v]=new[@v]`/`-dropreplace=old[@v]` |  `path@version` \n`-go=version` |  Go \n`-print` |  go.mod,  go.mod\n`-json` |   JSON  go.mod,  go.mod. JSON  Go \n\n```go\ntype Module struct {\n    Path string\n    Version string\n}\n\ntype GoMod struct {\n\tModule  Module\n    Go      string\n    Require []Require\n    Exclude []Module\n    Replace []Replace\n}\n\ntype Require struct {\n    Path string\n    Version string\n    Indirect bool\n}\n\ntype Replace struct {\n    Old Module\n    New Module\n}\n```\n\n## `init`\n\n go.mod ,  `/` . go.mod \n\n```\ngo mod init [module]\n```\n\n### `tidy`\n\n```\ngo mod tidy [-v]\n```\n\n go.mod , , .  go.sum , .\n\n`-v` \n\n## `vendor`\n\n```\ngo mod vendor [-v]\n```\n\n vendor , .  vendored .\n\n`-v`  vendored \n\n# `go run`\n\n Go \n\n```\ngo run [build flags] [-exec xprog] package [arguments...]\n```\n\n,  .go , , .\n\n, `go run` .  `-exec` ,  `go run`  xprog .  `-exec` ,  GOOS  `GOARCH` ,  `go_$GOOS_$GOARCH_exec` \n\n\n# `go test`\n\n, \n\n```\ngo test [build/test flags] [packages] [build/test flags & test binary flags]\n```\n\n`go test`  `*_test.go` . ,. .  `_`  `.` (`_test.go`)\n\n `_test` , . go  testdata , \n\ngo test :\n\n- :  package  go test . , go test , . , . , , (ok  FAIL), \n- :  package  go test . , go test , ,  ok . , .\n\n, go test , . \n\n | \n:---: | :---\n`-args` | (-args ). \n`-c` |  `pkg.test`, (pkg ).  `-o` \n`-exec xprog` |  xprog \n`-i` | , \n`-json` |  JSON \n`-o file` | , ( -c  -i)","slug":"go-study-notes-go-command","published":1,"date":"2020-04-30T10:51:30.474Z","updated":"2020-05-02T00:15:51.313Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihv2000bk8u76o5mgp80","content":"<p> Go ,  go , </p>\n<p> go  <code>go</code>  Go .</p>\n<p>.  <code>go &lt;command&gt; [arguments]</code>,  <code>go help &lt;command&gt;</code> </p>\n<p> go </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">bug</td>\n<td align=\"left\">bug/issue </td>\n<td align=\"left\"> Go ,  <code>github/golang/go</code>  issues</td>\n</tr>\n<tr>\n<td align=\"center\">build</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">clean</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">doc</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">env</td>\n<td align=\"left\"> Go </td>\n<td align=\"left\"> <code>GO111MODULE</code>, <code>GOARCH</code>, <code>GOBIN</code>, <code>GOHOSTARCH</code>, <code>GOHOSTOS</code>, <code>GOPATH</code>, <code>GOPROXY</code>, <code>GOROOT</code>, <code>GOTOOLDIR</code>,<code>GOMOD</code> </td>\n</tr>\n<tr>\n<td align=\"center\">fix</td>\n<td align=\"left\"> API</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">fmt</td>\n<td align=\"left\"> go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">generate</td>\n<td align=\"left\"> Go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">get</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">install</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">list</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">mod</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">run</td>\n<td align=\"left\"> Go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">test</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">tool</td>\n<td align=\"left\"> go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">version</td>\n<td align=\"left\"> Go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">vet</td>\n<td align=\"left\"></td>\n<td align=\"left\">, , </td>\n</tr>\n</tbody></table>\n<p>.  <code>go help &lt;topic&gt;</code> .</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">topic</th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">buildmode</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">c</td>\n<td align=\"left\">Go  C </td>\n</tr>\n<tr>\n<td align=\"left\">cache</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">environment</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">filetype</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">go.mod</td>\n<td align=\"left\">go.mod , , (python  requirements.txt )</td>\n</tr>\n<tr>\n<td align=\"left\">gopath</td>\n<td align=\"left\"><code>GOPATH</code> </td>\n</tr>\n<tr>\n<td align=\"left\">gopath-get</td>\n<td align=\"left\"> go get  GOPATH</td>\n</tr>\n<tr>\n<td align=\"left\">goproxy</td>\n<td align=\"left\"> go module </td>\n</tr>\n<tr>\n<td align=\"left\">importpath</td>\n<td align=\"left\">import </td>\n</tr>\n<tr>\n<td align=\"left\">modules</td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"left\">module-get</td>\n<td align=\"left\">go get </td>\n</tr>\n<tr>\n<td align=\"left\">module-auth</td>\n<td align=\"left\"> go.sum </td>\n</tr>\n<tr>\n<td align=\"left\">module-private</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">packages</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">testflag</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">testfunc</td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h1 id=\"go-build\"><a href=\"#go-build\" class=\"headerlink\" title=\"go build\"></a><code>go build</code></h1><p>, </p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">build</span> <span class=\"selector-attr\">[-o output]</span> <span class=\"selector-attr\">[-i]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> <code>.go</code> ,  build </li>\n<li>, build  <code>_test.go</code> </li>\n<li> main , build ( <code>go build ed.go rx.go</code>  <code>ed</code>/<code>ed.exe</code>, <code>go build unix/sam</code>  <code>sam</code>/<code>sam.exe</code>).  Windows ,  .exe  </li>\n<li> main , build , . </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-o</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-i</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<p> <code>build</code>, <code>clean</code>, <code>get</code>, <code>install</code>, <code>list</code>, <code>run</code>, <code>test</code> </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-a</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-n</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-p n</code></td>\n<td align=\"left\">,  CPU </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-race</code></td>\n<td align=\"left\">,  linux/amd64, freebsd/amd64, darwin/amd64  windows/amd64</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-msan</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-v</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-work</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-x</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-asm</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-buildmode mode</code></td>\n<td align=\"left\">,  <code>archive</code>, <code>c-archive</code>, <code>c-shared</code>, <code>default</code>, <code>shared</code>, <code>exe</code>, <code>pie</code>, <code>plugin</code>.  <code>go help buildmode</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-compiler name</code></td>\n<td align=\"left\">  <code>runtime.Compiler</code>(gccgo  gc)</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-mod mode</code></td>\n<td align=\"left\">: readonly  vendor</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-pkgdir dir</code></td>\n<td align=\"left\">, ,  -pkgdir </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-tags tag,list</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h1 id=\"go-clean\"><a href=\"#go-clean\" class=\"headerlink\" title=\"go clean\"></a><code>go clean</code></h1><p></p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">clean</span> <span class=\"selector-attr\">[clean flags]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n<p>go ,  <code>go clean</code>  <code>go build</code> </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-i</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-n</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-r</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-x</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-cache</code></td>\n<td align=\"left\"> <code>go build</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-modcache</code></td>\n<td align=\"left\">, </td>\n</tr>\n</tbody></table>\n<h1 id=\"go-doc\"><a href=\"#go-doc\" class=\"headerlink\" title=\"go doc\"></a><code>go doc</code></h1><p></p>\n<figure class=\"highlight inform7\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go doc <span class=\"comment\">[-u]</span> <span class=\"comment\">[-c]</span> <span class=\"comment\">[package|<span class=\"comment\">[package.]</span>symbol<span class=\"comment\">[.methodOrField]</span>]</span></span><br></pre></td></tr></table></figure>\n\n<p>(package, const, func, type, var, method, struct), </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-all</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-c</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-cmd</code></td>\n<td align=\"left\"> command (package main) , , , </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-src</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-u</code></td>\n<td align=\"left\">, </td>\n</tr>\n</tbody></table>\n<h1 id=\"go-env\"><a href=\"#go-env\" class=\"headerlink\" title=\"go env\"></a><code>go env</code></h1><p> Go </p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">env</span> <span class=\"selector-attr\">[-json]</span> <span class=\"selector-attr\">[-u]</span> <span class=\"selector-attr\">[-w]</span> <span class=\"selector-attr\">[var ...]</span></span><br></pre></td></tr></table></figure>\n\n<p>, env  shell ( Windows ). , </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> JSON </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-u &lt;arg&gt; ...</code></td>\n<td align=\"left\"> <code>go env -w NAME=VALUE</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-w &lt;NAME=VALUE&gt; ...</code></td>\n<td align=\"left\">()</td>\n</tr>\n</tbody></table>\n<h1 id=\"go-fix\"><a href=\"#go-fix\" class=\"headerlink\" title=\"go fix\"></a><code>go fix</code></h1><p> API</p>\n<figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">fix</span> [packages]</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"go-fmt\"><a href=\"#go-fmt\" class=\"headerlink\" title=\"go fmt\"></a><code>go fmt</code></h1><p> go ,  <code>gofmt -l -w</code>. </p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">fmt</span> <span class=\"selector-attr\">[-n]</span> <span class=\"selector-attr\">[-x]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-n</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-x</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h1 id=\"go-get\"><a href=\"#go-get\" class=\"headerlink\" title=\"go get\"></a><code>go get</code></h1><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">get</span> <span class=\"selector-attr\">[-d]</span> <span class=\"selector-attr\">[-f]</span> <span class=\"selector-attr\">[-t]</span> <span class=\"selector-attr\">[-u]</span> <span class=\"selector-attr\">[-v]</span> <span class=\"selector-attr\">[-fix]</span> <span class=\"selector-attr\">[-insecure]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<p>, </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-d</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-f</code></td>\n<td align=\"left\"> <code>-u</code> ,  <code>-u</code> .  fork </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-fix</code></td>\n<td align=\"left\">,  fix </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-insecure</code></td>\n<td align=\"left\">. </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-t</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-u</code></td>\n<td align=\"left\">. , , </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-v</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<p>checkout , get  <code>GOPATH/src/&lt;import-path&gt;</code>.  <code>GOPATH</code> , .  <code>go help gopath</code>.</p>\n<p> checkout , get  Go  brach  tag. , .</p>\n<p> go get checkout  git ,  git </p>\n<p>get  checkout  vendor </p>\n<h1 id=\"go-install\"><a href=\"#go-install\" class=\"headerlink\" title=\"go install\"></a><code>go install</code></h1><p></p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">install</span> <span class=\"selector-attr\">[-i]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>GOBIN</code> ,  <code>$GOPATH/bin</code>.  <code>GOPATH</code>,  <code>$HOME/go/bin</code>. <code>$GOROOT</code>  <code>$GOROOT/bin</code>  <code>$GOTOOLDIR</code> ,  <code>$GOBIN</code>.</p>\n<p> module-aware,  <code>$GOPATH/pkg/$GOOS_$GOARCH</code>.  module-aware, , .</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-i</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h2 id=\"go-list\"><a href=\"#go-list\" class=\"headerlink\" title=\"go list\"></a><code>go list</code></h2><p></p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">list</span> <span class=\"selector-attr\">[-f format]</span> <span class=\"selector-attr\">[-json]</span> <span class=\"selector-attr\">[-m]</span> <span class=\"selector-attr\">[list flags]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<p>, .  <code>...</code> .  <code>go list net/...</code>  net , </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-f</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> json </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-deps</code></td>\n<td align=\"left\">, .</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-export</code></td>\n<td align=\"left\"> <code>Export</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-find</code></td>\n<td align=\"left\">, , <code>Imports</code>  <code>Deps</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-test</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-m</code></td>\n<td align=\"left\"> , </td>\n</tr>\n</tbody></table>\n<p> <code>-f</code> , , .  <code>&#39;\\{\\{ .ImportPath }}&#39;</code>() (), <code>&#39;\\{\\{ .Name }}&#39;</code>(). </p>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Package <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        Dir           <span class=\"keyword\">string</span>   <span class=\"comment\">// </span></span><br><span class=\"line\">        ImportPath    <span class=\"keyword\">string</span>   <span class=\"comment\">// , `go list`  </span></span><br><span class=\"line\">        ImportComment <span class=\"keyword\">string</span>   <span class=\"comment\">// packageimport</span></span><br><span class=\"line\">        Name          <span class=\"keyword\">string</span>   <span class=\"comment\">// </span></span><br><span class=\"line\">        Doc           <span class=\"keyword\">string</span>   <span class=\"comment\">// </span></span><br><span class=\"line\">        Target        <span class=\"keyword\">string</span>   <span class=\"comment\">// </span></span><br><span class=\"line\">        Shlib         <span class=\"keyword\">string</span>   <span class=\"comment\">// -linkshared</span></span><br><span class=\"line\">        Goroot        <span class=\"keyword\">bool</span>     <span class=\"comment\">// GOROOT?</span></span><br><span class=\"line\">        Standard      <span class=\"keyword\">bool</span>     <span class=\"comment\">// go?</span></span><br><span class=\"line\">        Stale         <span class=\"keyword\">bool</span>     <span class=\"comment\">// `go install`?</span></span><br><span class=\"line\">        StaleReason   <span class=\"keyword\">string</span>   <span class=\"comment\">// explanation for Stale==true</span></span><br><span class=\"line\">        Root          <span class=\"keyword\">string</span>   <span class=\"comment\">// GOROOTGOPATH</span></span><br><span class=\"line\">        ConflictDir   <span class=\"keyword\">string</span>   <span class=\"comment\">// $GOPATHshadows dir</span></span><br><span class=\"line\">        BinaryOnly    <span class=\"keyword\">bool</span>     <span class=\"comment\">// binary-only package (no longer supported)</span></span><br><span class=\"line\">        ForTest       <span class=\"keyword\">string</span>   <span class=\"comment\">// package is only for use in named test</span></span><br><span class=\"line\">        Export        <span class=\"keyword\">string</span>   <span class=\"comment\">// file containing export data (when using -export)</span></span><br><span class=\"line\">        Module        *Module  <span class=\"comment\">// info about package's containing module, if any (can be nil)</span></span><br><span class=\"line\">        Match         []<span class=\"keyword\">string</span> <span class=\"comment\">// command-line patterns matching this package</span></span><br><span class=\"line\">        DepOnly       <span class=\"keyword\">bool</span>     <span class=\"comment\">// package is only a dependency, not explicitly listed</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Source files</span></span><br><span class=\"line\">        GoFiles         []<span class=\"keyword\">string</span> <span class=\"comment\">// .go source files (excluding CgoFiles, TestGoFiles, XTestGoFiles)</span></span><br><span class=\"line\">        CgoFiles        []<span class=\"keyword\">string</span> <span class=\"comment\">// .go source files that import \"C\"</span></span><br><span class=\"line\">        CompiledGoFiles []<span class=\"keyword\">string</span> <span class=\"comment\">// .go files presented to compiler (when using -compiled)</span></span><br><span class=\"line\">        IgnoredGoFiles  []<span class=\"keyword\">string</span> <span class=\"comment\">// .go source files ignored due to build constraints</span></span><br><span class=\"line\">        CFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .c source files</span></span><br><span class=\"line\">        CXXFiles        []<span class=\"keyword\">string</span> <span class=\"comment\">// .cc, .cxx and .cpp source files</span></span><br><span class=\"line\">        MFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .m source files</span></span><br><span class=\"line\">        HFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .h, .hh, .hpp and .hxx source files</span></span><br><span class=\"line\">        FFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .f, .F, .for and .f90 Fortran source files</span></span><br><span class=\"line\">        SFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .s source files</span></span><br><span class=\"line\">        SwigFiles       []<span class=\"keyword\">string</span> <span class=\"comment\">// .swig files</span></span><br><span class=\"line\">        SwigCXXFiles    []<span class=\"keyword\">string</span> <span class=\"comment\">// .swigcxx files</span></span><br><span class=\"line\">        SysoFiles       []<span class=\"keyword\">string</span> <span class=\"comment\">// .syso object files to add to archive</span></span><br><span class=\"line\">        TestGoFiles     []<span class=\"keyword\">string</span> <span class=\"comment\">// _test.go files in package</span></span><br><span class=\"line\">        XTestGoFiles    []<span class=\"keyword\">string</span> <span class=\"comment\">// _test.go files outside package</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Cgo directives</span></span><br><span class=\"line\">        CgoCFLAGS    []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for C compiler</span></span><br><span class=\"line\">        CgoCPPFLAGS  []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for C preprocessor</span></span><br><span class=\"line\">        CgoCXXFLAGS  []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for C++ compiler</span></span><br><span class=\"line\">        CgoFFLAGS    []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for Fortran compiler</span></span><br><span class=\"line\">        CgoLDFLAGS   []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for linker</span></span><br><span class=\"line\">        CgoPkgConfig []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: pkg-config names</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Dependency information</span></span><br><span class=\"line\">        Imports      []<span class=\"keyword\">string</span>          <span class=\"comment\">// import paths used by this package</span></span><br><span class=\"line\">        ImportMap    <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"comment\">// map from source import to ImportPath (identity entries omitted)</span></span><br><span class=\"line\">        Deps         []<span class=\"keyword\">string</span>          <span class=\"comment\">// all (recursively) imported dependencies</span></span><br><span class=\"line\">        TestImports  []<span class=\"keyword\">string</span>          <span class=\"comment\">// imports from TestGoFiles</span></span><br><span class=\"line\">        XTestImports []<span class=\"keyword\">string</span>          <span class=\"comment\">// imports from XTestGoFiles</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Error information</span></span><br><span class=\"line\">        Incomplete <span class=\"keyword\">bool</span>            <span class=\"comment\">// this package or a dependency has an error</span></span><br><span class=\"line\">        Error      *PackageError   <span class=\"comment\">// error loading package</span></span><br><span class=\"line\">        DepsErrors []*PackageError <span class=\"comment\">// errors loading dependencies</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Module <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Path      <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    Version   <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    Versions  []<span class=\"keyword\">string</span>     <span class=\"comment\">//  (with -versions)</span></span><br><span class=\"line\">    Replace   *Module      <span class=\"comment\">// </span></span><br><span class=\"line\">    Time      *time.Time   <span class=\"comment\">// </span></span><br><span class=\"line\">    Update    *Module      <span class=\"comment\">//  (with -u)</span></span><br><span class=\"line\">    Main      <span class=\"keyword\">bool</span>         <span class=\"comment\">// </span></span><br><span class=\"line\">    Indirect  <span class=\"keyword\">bool</span>         <span class=\"comment\">// ?</span></span><br><span class=\"line\">    Dir       <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    GoMod     <span class=\"keyword\">string</span>       <span class=\"comment\">// go.mod </span></span><br><span class=\"line\">    GoVersion <span class=\"keyword\">string</span>       <span class=\"comment\">//  Go </span></span><br><span class=\"line\">    Error     *ModuleError <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ModuleError <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tErr <span class=\"keyword\">string</span> <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"go-mod\"><a href=\"#go-mod\" class=\"headerlink\" title=\"go mod\"></a><code>go mod</code></h1><p></p>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go <span class=\"keyword\">mod</span> &lt;<span class=\"keyword\">command</span>&gt; [<span class=\"title\">arguments</span>]</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">command</th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">download</td>\n<td align=\"left\">( GOPATH/pkg/mod )</td>\n</tr>\n<tr>\n<td align=\"center\">edit</td>\n<td align=\"left\"> go.mod</td>\n</tr>\n<tr>\n<td align=\"center\">graph</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">init</td>\n<td align=\"left\">,  go.mod</td>\n</tr>\n<tr>\n<td align=\"center\">tidy</td>\n<td align=\"left\">,</td>\n</tr>\n<tr>\n<td align=\"center\">vendor</td>\n<td align=\"left\"> vendor </td>\n</tr>\n<tr>\n<td align=\"center\">verify</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">why</td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h2 id=\"download\"><a href=\"#download\" class=\"headerlink\" title=\"download\"></a><code>download</code></h2><p>, ,  <code>path@version</code> . , .</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">mod</span> <span class=\"selector-tag\">download</span> <span class=\"selector-attr\">[-json]</span> <span class=\"selector-attr\">[modules]</span></span><br></pre></td></tr></table></figure>\n\n<p>go . <code>go mod download</code>  go </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> json , .  Go Module </td>\n</tr>\n</tbody></table>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Module <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Path     <span class=\"keyword\">string</span> <span class=\"comment\">// module path</span></span><br><span class=\"line\">    Version  <span class=\"keyword\">string</span> <span class=\"comment\">// module version</span></span><br><span class=\"line\">    Error    <span class=\"keyword\">string</span> <span class=\"comment\">// error loading module</span></span><br><span class=\"line\">    Info     <span class=\"keyword\">string</span> <span class=\"comment\">// absolute path to cached .info file</span></span><br><span class=\"line\">    GoMod    <span class=\"keyword\">string</span> <span class=\"comment\">// absolute path to cached .mod file</span></span><br><span class=\"line\">    Zip      <span class=\"keyword\">string</span> <span class=\"comment\">// absolute path to cached .zip file</span></span><br><span class=\"line\">    Dir      <span class=\"keyword\">string</span> <span class=\"comment\">// absolute path to cached source root directory</span></span><br><span class=\"line\">    Sum      <span class=\"keyword\">string</span> <span class=\"comment\">// checksum for path, version (as in go.sum)</span></span><br><span class=\"line\">    GoModSum <span class=\"keyword\">string</span> <span class=\"comment\">// checksum for go.mod (as in go.sum)</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"edit\"><a href=\"#edit\" class=\"headerlink\" title=\"edit\"></a><code>edit</code></h2><p> go.mod , .  go.mod, .</p>\n<p>, edit  go.mod ,</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-fmt</code></td>\n<td align=\"left\"> go.mod , </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-module</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-require=path@version</code>/<code>-droprequire=path</code></td>\n<td align=\"left\"> <code>path@version</code> / path </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-exclude=path@version</code>/<code>-dropexclude=path@version</code></td>\n<td align=\"left\"> <code>path@version</code> / exclude </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-replace=old[@v]=new[@v]</code>/<code>-dropreplace=old[@v]</code></td>\n<td align=\"left\"> <code>path@version</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-go=version</code></td>\n<td align=\"left\"> Go </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-print</code></td>\n<td align=\"left\"> go.mod,  go.mod</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> JSON  go.mod,  go.mod. JSON  Go </td>\n</tr>\n</tbody></table>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Module <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Path <span class=\"keyword\">string</span></span><br><span class=\"line\">    Version <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> GoMod <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tModule  Module</span><br><span class=\"line\">    Go      <span class=\"keyword\">string</span></span><br><span class=\"line\">    Require []Require</span><br><span class=\"line\">    Exclude []Module</span><br><span class=\"line\">    Replace []Replace</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Require <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Path <span class=\"keyword\">string</span></span><br><span class=\"line\">    Version <span class=\"keyword\">string</span></span><br><span class=\"line\">    Indirect <span class=\"keyword\">bool</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Replace <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Old Module</span><br><span class=\"line\">    New Module</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"init\"><a href=\"#init\" class=\"headerlink\" title=\"init\"></a><code>init</code></h2><p> go.mod ,  <code>/</code> . go.mod </p>\n<figure class=\"highlight crystal\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go mod init [<span class=\"class\"><span class=\"keyword\">module</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"tidy\"><a href=\"#tidy\" class=\"headerlink\" title=\"tidy\"></a><code>tidy</code></h3><figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">mod</span> tidy [-v]</span><br></pre></td></tr></table></figure>\n\n<p> go.mod , , .  go.sum , .</p>\n<p><code>-v</code> </p>\n<h2 id=\"vendor\"><a href=\"#vendor\" class=\"headerlink\" title=\"vendor\"></a><code>vendor</code></h2><figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">mod</span> vendor [-v]</span><br></pre></td></tr></table></figure>\n\n<p> vendor , .  vendored .</p>\n<p><code>-v</code>  vendored </p>\n<h1 id=\"go-run\"><a href=\"#go-run\" class=\"headerlink\" title=\"go run\"></a><code>go run</code></h1><p> Go </p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">run</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[-exec xprog]</span> <span class=\"selector-tag\">package</span> <span class=\"selector-attr\">[arguments...]</span></span><br></pre></td></tr></table></figure>\n\n<p>,  .go , , .</p>\n<p>, <code>go run</code> .  <code>-exec</code> ,  <code>go run</code>  xprog .  <code>-exec</code> ,  GOOS  <code>GOARCH</code> ,  <code>go_$GOOS_$GOARCH_exec</code> </p>\n<h1 id=\"go-test\"><a href=\"#go-test\" class=\"headerlink\" title=\"go test\"></a><code>go test</code></h1><p>, </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go <span class=\"built_in\">test</span> [build/<span class=\"built_in\">test</span> flags] [packages] [build/<span class=\"built_in\">test</span> flags &amp; <span class=\"built_in\">test</span> binary flags]</span><br></pre></td></tr></table></figure>\n\n<p><code>go test</code>  <code>*_test.go</code> . ,. .  <code>_</code>  <code>.</code> (<code>_test.go</code>)</p>\n<p> <code>_test</code> , . go  testdata , </p>\n<p>go test :</p>\n<ul>\n<li>:  package  go test . , go test , . , . , , (ok  FAIL), </li>\n<li>:  package  go test . , go test , ,  ok . , .</li>\n</ul>\n<p>, go test , . </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-args</code></td>\n<td align=\"left\">(-args ). </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-c</code></td>\n<td align=\"left\"> <code>pkg.test</code>, (pkg ).  <code>-o</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-exec xprog</code></td>\n<td align=\"left\"> xprog </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-i</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> JSON </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-o file</code></td>\n<td align=\"left\">, ( -c  -i)</td>\n</tr>\n</tbody></table>\n","site":{"data":{}},"excerpt":"","more":"<p> Go ,  go , </p>\n<p> go  <code>go</code>  Go .</p>\n<p>.  <code>go &lt;command&gt; [arguments]</code>,  <code>go help &lt;command&gt;</code> </p>\n<p> go </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">bug</td>\n<td align=\"left\">bug/issue </td>\n<td align=\"left\"> Go ,  <code>github/golang/go</code>  issues</td>\n</tr>\n<tr>\n<td align=\"center\">build</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">clean</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">doc</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">env</td>\n<td align=\"left\"> Go </td>\n<td align=\"left\"> <code>GO111MODULE</code>, <code>GOARCH</code>, <code>GOBIN</code>, <code>GOHOSTARCH</code>, <code>GOHOSTOS</code>, <code>GOPATH</code>, <code>GOPROXY</code>, <code>GOROOT</code>, <code>GOTOOLDIR</code>,<code>GOMOD</code> </td>\n</tr>\n<tr>\n<td align=\"center\">fix</td>\n<td align=\"left\"> API</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">fmt</td>\n<td align=\"left\"> go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">generate</td>\n<td align=\"left\"> Go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">get</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">install</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">list</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">mod</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">run</td>\n<td align=\"left\"> Go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">test</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">tool</td>\n<td align=\"left\"> go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">version</td>\n<td align=\"left\"> Go </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">vet</td>\n<td align=\"left\"></td>\n<td align=\"left\">, , </td>\n</tr>\n</tbody></table>\n<p>.  <code>go help &lt;topic&gt;</code> .</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">topic</th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">buildmode</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">c</td>\n<td align=\"left\">Go  C </td>\n</tr>\n<tr>\n<td align=\"left\">cache</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">environment</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">filetype</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">go.mod</td>\n<td align=\"left\">go.mod , , (python  requirements.txt )</td>\n</tr>\n<tr>\n<td align=\"left\">gopath</td>\n<td align=\"left\"><code>GOPATH</code> </td>\n</tr>\n<tr>\n<td align=\"left\">gopath-get</td>\n<td align=\"left\"> go get  GOPATH</td>\n</tr>\n<tr>\n<td align=\"left\">goproxy</td>\n<td align=\"left\"> go module </td>\n</tr>\n<tr>\n<td align=\"left\">importpath</td>\n<td align=\"left\">import </td>\n</tr>\n<tr>\n<td align=\"left\">modules</td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"left\">module-get</td>\n<td align=\"left\">go get </td>\n</tr>\n<tr>\n<td align=\"left\">module-auth</td>\n<td align=\"left\"> go.sum </td>\n</tr>\n<tr>\n<td align=\"left\">module-private</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">packages</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">testflag</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">testfunc</td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h1 id=\"go-build\"><a href=\"#go-build\" class=\"headerlink\" title=\"go build\"></a><code>go build</code></h1><p>, </p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">build</span> <span class=\"selector-attr\">[-o output]</span> <span class=\"selector-attr\">[-i]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> <code>.go</code> ,  build </li>\n<li>, build  <code>_test.go</code> </li>\n<li> main , build ( <code>go build ed.go rx.go</code>  <code>ed</code>/<code>ed.exe</code>, <code>go build unix/sam</code>  <code>sam</code>/<code>sam.exe</code>).  Windows ,  .exe  </li>\n<li> main , build , . </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-o</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-i</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<p> <code>build</code>, <code>clean</code>, <code>get</code>, <code>install</code>, <code>list</code>, <code>run</code>, <code>test</code> </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-a</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-n</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-p n</code></td>\n<td align=\"left\">,  CPU </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-race</code></td>\n<td align=\"left\">,  linux/amd64, freebsd/amd64, darwin/amd64  windows/amd64</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-msan</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-v</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-work</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-x</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-asm</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-buildmode mode</code></td>\n<td align=\"left\">,  <code>archive</code>, <code>c-archive</code>, <code>c-shared</code>, <code>default</code>, <code>shared</code>, <code>exe</code>, <code>pie</code>, <code>plugin</code>.  <code>go help buildmode</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-compiler name</code></td>\n<td align=\"left\">  <code>runtime.Compiler</code>(gccgo  gc)</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-mod mode</code></td>\n<td align=\"left\">: readonly  vendor</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-pkgdir dir</code></td>\n<td align=\"left\">, ,  -pkgdir </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-tags tag,list</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h1 id=\"go-clean\"><a href=\"#go-clean\" class=\"headerlink\" title=\"go clean\"></a><code>go clean</code></h1><p></p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">clean</span> <span class=\"selector-attr\">[clean flags]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n<p>go ,  <code>go clean</code>  <code>go build</code> </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-i</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-n</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-r</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-x</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-cache</code></td>\n<td align=\"left\"> <code>go build</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-modcache</code></td>\n<td align=\"left\">, </td>\n</tr>\n</tbody></table>\n<h1 id=\"go-doc\"><a href=\"#go-doc\" class=\"headerlink\" title=\"go doc\"></a><code>go doc</code></h1><p></p>\n<figure class=\"highlight inform7\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go doc <span class=\"comment\">[-u]</span> <span class=\"comment\">[-c]</span> <span class=\"comment\">[package|<span class=\"comment\">[package.]</span>symbol<span class=\"comment\">[.methodOrField]</span>]</span></span><br></pre></td></tr></table></figure>\n\n<p>(package, const, func, type, var, method, struct), </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-all</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-c</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-cmd</code></td>\n<td align=\"left\"> command (package main) , , , </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-src</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-u</code></td>\n<td align=\"left\">, </td>\n</tr>\n</tbody></table>\n<h1 id=\"go-env\"><a href=\"#go-env\" class=\"headerlink\" title=\"go env\"></a><code>go env</code></h1><p> Go </p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">env</span> <span class=\"selector-attr\">[-json]</span> <span class=\"selector-attr\">[-u]</span> <span class=\"selector-attr\">[-w]</span> <span class=\"selector-attr\">[var ...]</span></span><br></pre></td></tr></table></figure>\n\n<p>, env  shell ( Windows ). , </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> JSON </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-u &lt;arg&gt; ...</code></td>\n<td align=\"left\"> <code>go env -w NAME=VALUE</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-w &lt;NAME=VALUE&gt; ...</code></td>\n<td align=\"left\">()</td>\n</tr>\n</tbody></table>\n<h1 id=\"go-fix\"><a href=\"#go-fix\" class=\"headerlink\" title=\"go fix\"></a><code>go fix</code></h1><p> API</p>\n<figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">fix</span> [packages]</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"go-fmt\"><a href=\"#go-fmt\" class=\"headerlink\" title=\"go fmt\"></a><code>go fmt</code></h1><p> go ,  <code>gofmt -l -w</code>. </p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">fmt</span> <span class=\"selector-attr\">[-n]</span> <span class=\"selector-attr\">[-x]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-n</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-x</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h1 id=\"go-get\"><a href=\"#go-get\" class=\"headerlink\" title=\"go get\"></a><code>go get</code></h1><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">get</span> <span class=\"selector-attr\">[-d]</span> <span class=\"selector-attr\">[-f]</span> <span class=\"selector-attr\">[-t]</span> <span class=\"selector-attr\">[-u]</span> <span class=\"selector-attr\">[-v]</span> <span class=\"selector-attr\">[-fix]</span> <span class=\"selector-attr\">[-insecure]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<p>, </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-d</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-f</code></td>\n<td align=\"left\"> <code>-u</code> ,  <code>-u</code> .  fork </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-fix</code></td>\n<td align=\"left\">,  fix </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-insecure</code></td>\n<td align=\"left\">. </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-t</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-u</code></td>\n<td align=\"left\">. , , </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-v</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<p>checkout , get  <code>GOPATH/src/&lt;import-path&gt;</code>.  <code>GOPATH</code> , .  <code>go help gopath</code>.</p>\n<p> checkout , get  Go  brach  tag. , .</p>\n<p> go get checkout  git ,  git </p>\n<p>get  checkout  vendor </p>\n<h1 id=\"go-install\"><a href=\"#go-install\" class=\"headerlink\" title=\"go install\"></a><code>go install</code></h1><p></p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">install</span> <span class=\"selector-attr\">[-i]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>GOBIN</code> ,  <code>$GOPATH/bin</code>.  <code>GOPATH</code>,  <code>$HOME/go/bin</code>. <code>$GOROOT</code>  <code>$GOROOT/bin</code>  <code>$GOTOOLDIR</code> ,  <code>$GOBIN</code>.</p>\n<p> module-aware,  <code>$GOPATH/pkg/$GOOS_$GOARCH</code>.  module-aware, , .</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-i</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h2 id=\"go-list\"><a href=\"#go-list\" class=\"headerlink\" title=\"go list\"></a><code>go list</code></h2><p></p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">list</span> <span class=\"selector-attr\">[-f format]</span> <span class=\"selector-attr\">[-json]</span> <span class=\"selector-attr\">[-m]</span> <span class=\"selector-attr\">[list flags]</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[packages]</span></span><br></pre></td></tr></table></figure>\n\n<p>, .  <code>...</code> .  <code>go list net/...</code>  net , </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-f</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> json </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-deps</code></td>\n<td align=\"left\">, .</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-export</code></td>\n<td align=\"left\"> <code>Export</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-find</code></td>\n<td align=\"left\">, , <code>Imports</code>  <code>Deps</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-test</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-m</code></td>\n<td align=\"left\"> , </td>\n</tr>\n</tbody></table>\n<p> <code>-f</code> , , .  <code>&#39;\\{\\{ .ImportPath }}&#39;</code>() (), <code>&#39;\\{\\{ .Name }}&#39;</code>(). </p>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Package <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        Dir           <span class=\"keyword\">string</span>   <span class=\"comment\">// </span></span><br><span class=\"line\">        ImportPath    <span class=\"keyword\">string</span>   <span class=\"comment\">// , `go list`  </span></span><br><span class=\"line\">        ImportComment <span class=\"keyword\">string</span>   <span class=\"comment\">// packageimport</span></span><br><span class=\"line\">        Name          <span class=\"keyword\">string</span>   <span class=\"comment\">// </span></span><br><span class=\"line\">        Doc           <span class=\"keyword\">string</span>   <span class=\"comment\">// </span></span><br><span class=\"line\">        Target        <span class=\"keyword\">string</span>   <span class=\"comment\">// </span></span><br><span class=\"line\">        Shlib         <span class=\"keyword\">string</span>   <span class=\"comment\">// -linkshared</span></span><br><span class=\"line\">        Goroot        <span class=\"keyword\">bool</span>     <span class=\"comment\">// GOROOT?</span></span><br><span class=\"line\">        Standard      <span class=\"keyword\">bool</span>     <span class=\"comment\">// go?</span></span><br><span class=\"line\">        Stale         <span class=\"keyword\">bool</span>     <span class=\"comment\">// `go install`?</span></span><br><span class=\"line\">        StaleReason   <span class=\"keyword\">string</span>   <span class=\"comment\">// explanation for Stale==true</span></span><br><span class=\"line\">        Root          <span class=\"keyword\">string</span>   <span class=\"comment\">// GOROOTGOPATH</span></span><br><span class=\"line\">        ConflictDir   <span class=\"keyword\">string</span>   <span class=\"comment\">// $GOPATHshadows dir</span></span><br><span class=\"line\">        BinaryOnly    <span class=\"keyword\">bool</span>     <span class=\"comment\">// binary-only package (no longer supported)</span></span><br><span class=\"line\">        ForTest       <span class=\"keyword\">string</span>   <span class=\"comment\">// package is only for use in named test</span></span><br><span class=\"line\">        Export        <span class=\"keyword\">string</span>   <span class=\"comment\">// file containing export data (when using -export)</span></span><br><span class=\"line\">        Module        *Module  <span class=\"comment\">// info about package's containing module, if any (can be nil)</span></span><br><span class=\"line\">        Match         []<span class=\"keyword\">string</span> <span class=\"comment\">// command-line patterns matching this package</span></span><br><span class=\"line\">        DepOnly       <span class=\"keyword\">bool</span>     <span class=\"comment\">// package is only a dependency, not explicitly listed</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Source files</span></span><br><span class=\"line\">        GoFiles         []<span class=\"keyword\">string</span> <span class=\"comment\">// .go source files (excluding CgoFiles, TestGoFiles, XTestGoFiles)</span></span><br><span class=\"line\">        CgoFiles        []<span class=\"keyword\">string</span> <span class=\"comment\">// .go source files that import \"C\"</span></span><br><span class=\"line\">        CompiledGoFiles []<span class=\"keyword\">string</span> <span class=\"comment\">// .go files presented to compiler (when using -compiled)</span></span><br><span class=\"line\">        IgnoredGoFiles  []<span class=\"keyword\">string</span> <span class=\"comment\">// .go source files ignored due to build constraints</span></span><br><span class=\"line\">        CFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .c source files</span></span><br><span class=\"line\">        CXXFiles        []<span class=\"keyword\">string</span> <span class=\"comment\">// .cc, .cxx and .cpp source files</span></span><br><span class=\"line\">        MFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .m source files</span></span><br><span class=\"line\">        HFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .h, .hh, .hpp and .hxx source files</span></span><br><span class=\"line\">        FFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .f, .F, .for and .f90 Fortran source files</span></span><br><span class=\"line\">        SFiles          []<span class=\"keyword\">string</span> <span class=\"comment\">// .s source files</span></span><br><span class=\"line\">        SwigFiles       []<span class=\"keyword\">string</span> <span class=\"comment\">// .swig files</span></span><br><span class=\"line\">        SwigCXXFiles    []<span class=\"keyword\">string</span> <span class=\"comment\">// .swigcxx files</span></span><br><span class=\"line\">        SysoFiles       []<span class=\"keyword\">string</span> <span class=\"comment\">// .syso object files to add to archive</span></span><br><span class=\"line\">        TestGoFiles     []<span class=\"keyword\">string</span> <span class=\"comment\">// _test.go files in package</span></span><br><span class=\"line\">        XTestGoFiles    []<span class=\"keyword\">string</span> <span class=\"comment\">// _test.go files outside package</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Cgo directives</span></span><br><span class=\"line\">        CgoCFLAGS    []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for C compiler</span></span><br><span class=\"line\">        CgoCPPFLAGS  []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for C preprocessor</span></span><br><span class=\"line\">        CgoCXXFLAGS  []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for C++ compiler</span></span><br><span class=\"line\">        CgoFFLAGS    []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for Fortran compiler</span></span><br><span class=\"line\">        CgoLDFLAGS   []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: flags for linker</span></span><br><span class=\"line\">        CgoPkgConfig []<span class=\"keyword\">string</span> <span class=\"comment\">// cgo: pkg-config names</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Dependency information</span></span><br><span class=\"line\">        Imports      []<span class=\"keyword\">string</span>          <span class=\"comment\">// import paths used by this package</span></span><br><span class=\"line\">        ImportMap    <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"comment\">// map from source import to ImportPath (identity entries omitted)</span></span><br><span class=\"line\">        Deps         []<span class=\"keyword\">string</span>          <span class=\"comment\">// all (recursively) imported dependencies</span></span><br><span class=\"line\">        TestImports  []<span class=\"keyword\">string</span>          <span class=\"comment\">// imports from TestGoFiles</span></span><br><span class=\"line\">        XTestImports []<span class=\"keyword\">string</span>          <span class=\"comment\">// imports from XTestGoFiles</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Error information</span></span><br><span class=\"line\">        Incomplete <span class=\"keyword\">bool</span>            <span class=\"comment\">// this package or a dependency has an error</span></span><br><span class=\"line\">        Error      *PackageError   <span class=\"comment\">// error loading package</span></span><br><span class=\"line\">        DepsErrors []*PackageError <span class=\"comment\">// errors loading dependencies</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Module <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Path      <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    Version   <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    Versions  []<span class=\"keyword\">string</span>     <span class=\"comment\">//  (with -versions)</span></span><br><span class=\"line\">    Replace   *Module      <span class=\"comment\">// </span></span><br><span class=\"line\">    Time      *time.Time   <span class=\"comment\">// </span></span><br><span class=\"line\">    Update    *Module      <span class=\"comment\">//  (with -u)</span></span><br><span class=\"line\">    Main      <span class=\"keyword\">bool</span>         <span class=\"comment\">// </span></span><br><span class=\"line\">    Indirect  <span class=\"keyword\">bool</span>         <span class=\"comment\">// ?</span></span><br><span class=\"line\">    Dir       <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    GoMod     <span class=\"keyword\">string</span>       <span class=\"comment\">// go.mod </span></span><br><span class=\"line\">    GoVersion <span class=\"keyword\">string</span>       <span class=\"comment\">//  Go </span></span><br><span class=\"line\">    Error     *ModuleError <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ModuleError <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tErr <span class=\"keyword\">string</span> <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"go-mod\"><a href=\"#go-mod\" class=\"headerlink\" title=\"go mod\"></a><code>go mod</code></h1><p></p>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go <span class=\"keyword\">mod</span> &lt;<span class=\"keyword\">command</span>&gt; [<span class=\"title\">arguments</span>]</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">command</th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">download</td>\n<td align=\"left\">( GOPATH/pkg/mod )</td>\n</tr>\n<tr>\n<td align=\"center\">edit</td>\n<td align=\"left\"> go.mod</td>\n</tr>\n<tr>\n<td align=\"center\">graph</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">init</td>\n<td align=\"left\">,  go.mod</td>\n</tr>\n<tr>\n<td align=\"center\">tidy</td>\n<td align=\"left\">,</td>\n</tr>\n<tr>\n<td align=\"center\">vendor</td>\n<td align=\"left\"> vendor </td>\n</tr>\n<tr>\n<td align=\"center\">verify</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\">why</td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h2 id=\"download\"><a href=\"#download\" class=\"headerlink\" title=\"download\"></a><code>download</code></h2><p>, ,  <code>path@version</code> . , .</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">mod</span> <span class=\"selector-tag\">download</span> <span class=\"selector-attr\">[-json]</span> <span class=\"selector-attr\">[modules]</span></span><br></pre></td></tr></table></figure>\n\n<p>go . <code>go mod download</code>  go </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> json , .  Go Module </td>\n</tr>\n</tbody></table>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Module <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Path     <span class=\"keyword\">string</span> <span class=\"comment\">// module path</span></span><br><span class=\"line\">    Version  <span class=\"keyword\">string</span> <span class=\"comment\">// module version</span></span><br><span class=\"line\">    Error    <span class=\"keyword\">string</span> <span class=\"comment\">// error loading module</span></span><br><span class=\"line\">    Info     <span class=\"keyword\">string</span> <span class=\"comment\">// absolute path to cached .info file</span></span><br><span class=\"line\">    GoMod    <span class=\"keyword\">string</span> <span class=\"comment\">// absolute path to cached .mod file</span></span><br><span class=\"line\">    Zip      <span class=\"keyword\">string</span> <span class=\"comment\">// absolute path to cached .zip file</span></span><br><span class=\"line\">    Dir      <span class=\"keyword\">string</span> <span class=\"comment\">// absolute path to cached source root directory</span></span><br><span class=\"line\">    Sum      <span class=\"keyword\">string</span> <span class=\"comment\">// checksum for path, version (as in go.sum)</span></span><br><span class=\"line\">    GoModSum <span class=\"keyword\">string</span> <span class=\"comment\">// checksum for go.mod (as in go.sum)</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"edit\"><a href=\"#edit\" class=\"headerlink\" title=\"edit\"></a><code>edit</code></h2><p> go.mod , .  go.mod, .</p>\n<p>, edit  go.mod ,</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-fmt</code></td>\n<td align=\"left\"> go.mod , </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-module</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>-require=path@version</code>/<code>-droprequire=path</code></td>\n<td align=\"left\"> <code>path@version</code> / path </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-exclude=path@version</code>/<code>-dropexclude=path@version</code></td>\n<td align=\"left\"> <code>path@version</code> / exclude </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-replace=old[@v]=new[@v]</code>/<code>-dropreplace=old[@v]</code></td>\n<td align=\"left\"> <code>path@version</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-go=version</code></td>\n<td align=\"left\"> Go </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-print</code></td>\n<td align=\"left\"> go.mod,  go.mod</td>\n</tr>\n<tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> JSON  go.mod,  go.mod. JSON  Go </td>\n</tr>\n</tbody></table>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Module <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Path <span class=\"keyword\">string</span></span><br><span class=\"line\">    Version <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> GoMod <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tModule  Module</span><br><span class=\"line\">    Go      <span class=\"keyword\">string</span></span><br><span class=\"line\">    Require []Require</span><br><span class=\"line\">    Exclude []Module</span><br><span class=\"line\">    Replace []Replace</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Require <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Path <span class=\"keyword\">string</span></span><br><span class=\"line\">    Version <span class=\"keyword\">string</span></span><br><span class=\"line\">    Indirect <span class=\"keyword\">bool</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Replace <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Old Module</span><br><span class=\"line\">    New Module</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"init\"><a href=\"#init\" class=\"headerlink\" title=\"init\"></a><code>init</code></h2><p> go.mod ,  <code>/</code> . go.mod </p>\n<figure class=\"highlight crystal\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go mod init [<span class=\"class\"><span class=\"keyword\">module</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"tidy\"><a href=\"#tidy\" class=\"headerlink\" title=\"tidy\"></a><code>tidy</code></h3><figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">mod</span> tidy [-v]</span><br></pre></td></tr></table></figure>\n\n<p> go.mod , , .  go.sum , .</p>\n<p><code>-v</code> </p>\n<h2 id=\"vendor\"><a href=\"#vendor\" class=\"headerlink\" title=\"vendor\"></a><code>vendor</code></h2><figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">mod</span> vendor [-v]</span><br></pre></td></tr></table></figure>\n\n<p> vendor , .  vendored .</p>\n<p><code>-v</code>  vendored </p>\n<h1 id=\"go-run\"><a href=\"#go-run\" class=\"headerlink\" title=\"go run\"></a><code>go run</code></h1><p> Go </p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">go</span> <span class=\"selector-tag\">run</span> <span class=\"selector-attr\">[build flags]</span> <span class=\"selector-attr\">[-exec xprog]</span> <span class=\"selector-tag\">package</span> <span class=\"selector-attr\">[arguments...]</span></span><br></pre></td></tr></table></figure>\n\n<p>,  .go , , .</p>\n<p>, <code>go run</code> .  <code>-exec</code> ,  <code>go run</code>  xprog .  <code>-exec</code> ,  GOOS  <code>GOARCH</code> ,  <code>go_$GOOS_$GOARCH_exec</code> </p>\n<h1 id=\"go-test\"><a href=\"#go-test\" class=\"headerlink\" title=\"go test\"></a><code>go test</code></h1><p>, </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go <span class=\"built_in\">test</span> [build/<span class=\"built_in\">test</span> flags] [packages] [build/<span class=\"built_in\">test</span> flags &amp; <span class=\"built_in\">test</span> binary flags]</span><br></pre></td></tr></table></figure>\n\n<p><code>go test</code>  <code>*_test.go</code> . ,. .  <code>_</code>  <code>.</code> (<code>_test.go</code>)</p>\n<p> <code>_test</code> , . go  testdata , </p>\n<p>go test :</p>\n<ul>\n<li>:  package  go test . , go test , . , . , , (ok  FAIL), </li>\n<li>:  package  go test . , go test , ,  ok . , .</li>\n</ul>\n<p>, go test , . </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>-args</code></td>\n<td align=\"left\">(-args ). </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-c</code></td>\n<td align=\"left\"> <code>pkg.test</code>, (pkg ).  <code>-o</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-exec xprog</code></td>\n<td align=\"left\"> xprog </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-i</code></td>\n<td align=\"left\">, </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-json</code></td>\n<td align=\"left\"> JSON </td>\n</tr>\n<tr>\n<td align=\"center\"><code>-o file</code></td>\n<td align=\"left\">, ( -c  -i)</td>\n</tr>\n</tbody></table>\n"},{"title":"go ","abbrlink":47797,"description":" Go , ,  Go , , , .  defer .","_content":"\n\n# \n\n `func` . Go :\n\n- \n- \n- \n- \n- \n- \n- \n- \n\n,:\n\n```go\nfunc () () {\n    // expression\n    return\n}\n// \n// `args... argsType` , , \nfunc FuncName(arg argType, args ...argsType) {  \n    // expression\n}\n// \n// returnName ,  `,` \nfunc FuncName() (returnName returnType) { \n    // expression\n}\n// \n// , , \na := func (arg argType) (returnName returnType) {  \n    // expression\n}\n\n// \nFuncName(args)\na(args)\n```\n\n# \n\n, \n\n> , .\n\n,,,., . \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc Change(x int) {\n    x = 100\n    fmt.Println(x)\n}\nfunc ChangePtr(x *int) {\n    *x = 200\n    fmt.Println(*x)\n}\nfunc main() {\n    x := 10\n    fmt.Println(x)  // 10\n    Change(x)       // 100\n    fmt.Println(x)  // 10\n    x = 10\n    fmt.Println(x)  // 10\n    ChangePtr(&x)   // 200\n    fmt.Println(x)  // 200\n}\n```\n\n## \n\n,,\n\n```go\n// `args... argsType` , , \nfunc FuncName(arg argType, args ...argsType) {  \n    // expression\n}\n```\n\n,.,. , .  `copy()` .\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test(a ...int){\n    for i, _ := range a {\n        a[i] += 100\n    }\n}\nfunc main() {\n    arr := [3]int{10, 20, 30}\n    s := arr[:]\n    scopy := make([]int, len(s))\n    copy(scopy, s)  //  s  scopy\n    test(s...)\n    fmt.Println(arr)\n    fmt.Println(s)\n}\n```\n\n# \n\n- ,  `return` \n- Go \n- , , ,  `a`  `a := xxx` \n- , , \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test() (a int) {\n    fmt.Println(a) //  0\n    a := 10        // ,No new variables on left side of :=,  a ,  = \n\treturn\n}\n```\n\n# \n\n, . , , \n\n- \n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    // \n    func (s string){\n        fmt.Println(s)\n    }(\"hello world\")\n    \n    // \n    add := func (x, y int) int {\n        return x + y\n    }\n    fmt.Println(add(1, 2))\n}\n```\n\n- \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test(f func()) {\n    f()\n}\nfunc main() {\n    test(func (){\n        fmt.Println(\"hello world\")\n    })\n}\n```\n\n- \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test() func(int, int) int {\n    return func(x, y int) int {\n        return x + y\n    }\n}\nfunc main() {\n    add := test()\n    fmt.Println(add(1, 2))\n}\n```\n\n## \n\n- \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test(x int) func(){\n    return func(){\n        fmt.Println(x)\n    }\n}\nfunc main(){\n    f := test(123)\n    f()  //  123\n}\n```\n\n, `test`  `x`.  `main` ,  `x` , .\n\n, ,  \"\"\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test() []func() {\n\tvar s []func()\n\tfor i := 0; i < 2; i++ {\n\t\ts = append(s, func() {\n\t\t\tfmt.Println(&i, i)\n\t\t})\n\t}\n\treturn s\n}\n\nfunc main() {\n\tfor _, f := range test() {\n\t\tf()\n\t}\n}\n// :\n// 0xc000062090 2\n// 0xc000062090 2\n```\n\n, for  i, . , .  main ,  i , 2.\n\n, \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test() []func() {\n\tvar s []func()\n\tfor i := 0; i < 2; i++ {\n        x := i // x \n\t\ts = append(s, func() {\n\t\t\tfmt.Println(&x, x)\n\t\t})\n\t}\n\treturn s\n}\n```\n\n# `defer` \n\n- `defer` , , , .  `defer` \"\"(FILO). \n- `defer` , .  `defer` . \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\tx, y := 1, 2\n\tdefer func(a, b int) {\n\t\tfmt.Println(\" defer  a b  \", a, b)  // \n\t\tfmt.Println(\" defer  x y \", x, y)\n    }(x, y)\n\tx += 100\n\ty += 100\n\tfmt.Println(\" x y \", x, y)\n}\n// :\n//  x y  101 102\n//  defer  a b   1 2\n//  defer  x y  101 102\n```\n\n## \n\n`defer` . .\n\n for  `defer` \n\n```go\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\tfor i := 0; i < 100; i++ {\n\t\tpath := fmt.Sprintf(\"log/%d.txt\", i)\n\t\tfile, err := os.Open(path)\n\t\tif err != nil {\n\t\t\tfmt.Println(err)\n\t\t}\n        //  main ,\n\t\tdefer file.Close()\n        // do something...\n\t}\n}\n```\n\n `defer` ,. , , `defer` , \n\n```go\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\tdo := func(n int){\n\t\tpath := fmt.Sprintf(\"log/%d.txt\", n)\n\t\tfile, err := os.Open(path)\n\t\tif err != nil {\n\t\t\tfmt.Println(err)\n\t\t}\n        // \n\t\tdefer file.Close()\n        // do something...\n\t}\n\n    for i := 0; i < 100; i++ {\n        do()\n    }\n}\n```\n\n# \n\n## `error`\n\n `error`\n\n `error` , . , \n\n```go\n// Go  error \ntype error interface {\n\tError() string\n}\n\n//  Error\ntype DivError struct {\n\ts string\n}\n\nfunc (divError *DivError) Error() string {\n\treturn divError.s\n}\n```\n\n `error` ,  `error` \n\n```go\nerr := errors.New(\"some description for error\")\n```\n\n## `panic()`, `revover()` \n\n- `panic()`  `interface` , ,  `panice` \n- `revover()`  `interface` ,  `panic()` . ****\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc catch() {\n\trecover()\n\tfmt.Println(\"\")\n}\n\nfunc main() {\n\tdefer catch()                // \n\tdefer fmt.Println(recover()) // \n\tdefer recover()              // \n\tpanic(\"error\")\n}\n```","source":"_posts/go-study-notes-func.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 47797\ndescription: >-\n   Go , ,  Go , , ,\n  .  defer .\n---\n\n\n# \n\n `func` . Go :\n\n- \n- \n- \n- \n- \n- \n- \n- \n\n,:\n\n```go\nfunc () () {\n    // expression\n    return\n}\n// \n// `args... argsType` , , \nfunc FuncName(arg argType, args ...argsType) {  \n    // expression\n}\n// \n// returnName ,  `,` \nfunc FuncName() (returnName returnType) { \n    // expression\n}\n// \n// , , \na := func (arg argType) (returnName returnType) {  \n    // expression\n}\n\n// \nFuncName(args)\na(args)\n```\n\n# \n\n, \n\n> , .\n\n,,,., . \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc Change(x int) {\n    x = 100\n    fmt.Println(x)\n}\nfunc ChangePtr(x *int) {\n    *x = 200\n    fmt.Println(*x)\n}\nfunc main() {\n    x := 10\n    fmt.Println(x)  // 10\n    Change(x)       // 100\n    fmt.Println(x)  // 10\n    x = 10\n    fmt.Println(x)  // 10\n    ChangePtr(&x)   // 200\n    fmt.Println(x)  // 200\n}\n```\n\n## \n\n,,\n\n```go\n// `args... argsType` , , \nfunc FuncName(arg argType, args ...argsType) {  \n    // expression\n}\n```\n\n,.,. , .  `copy()` .\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test(a ...int){\n    for i, _ := range a {\n        a[i] += 100\n    }\n}\nfunc main() {\n    arr := [3]int{10, 20, 30}\n    s := arr[:]\n    scopy := make([]int, len(s))\n    copy(scopy, s)  //  s  scopy\n    test(s...)\n    fmt.Println(arr)\n    fmt.Println(s)\n}\n```\n\n# \n\n- ,  `return` \n- Go \n- , , ,  `a`  `a := xxx` \n- , , \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test() (a int) {\n    fmt.Println(a) //  0\n    a := 10        // ,No new variables on left side of :=,  a ,  = \n\treturn\n}\n```\n\n# \n\n, . , , \n\n- \n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    // \n    func (s string){\n        fmt.Println(s)\n    }(\"hello world\")\n    \n    // \n    add := func (x, y int) int {\n        return x + y\n    }\n    fmt.Println(add(1, 2))\n}\n```\n\n- \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test(f func()) {\n    f()\n}\nfunc main() {\n    test(func (){\n        fmt.Println(\"hello world\")\n    })\n}\n```\n\n- \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test() func(int, int) int {\n    return func(x, y int) int {\n        return x + y\n    }\n}\nfunc main() {\n    add := test()\n    fmt.Println(add(1, 2))\n}\n```\n\n## \n\n- \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test(x int) func(){\n    return func(){\n        fmt.Println(x)\n    }\n}\nfunc main(){\n    f := test(123)\n    f()  //  123\n}\n```\n\n, `test`  `x`.  `main` ,  `x` , .\n\n, ,  \"\"\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test() []func() {\n\tvar s []func()\n\tfor i := 0; i < 2; i++ {\n\t\ts = append(s, func() {\n\t\t\tfmt.Println(&i, i)\n\t\t})\n\t}\n\treturn s\n}\n\nfunc main() {\n\tfor _, f := range test() {\n\t\tf()\n\t}\n}\n// :\n// 0xc000062090 2\n// 0xc000062090 2\n```\n\n, for  i, . , .  main ,  i , 2.\n\n, \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc test() []func() {\n\tvar s []func()\n\tfor i := 0; i < 2; i++ {\n        x := i // x \n\t\ts = append(s, func() {\n\t\t\tfmt.Println(&x, x)\n\t\t})\n\t}\n\treturn s\n}\n```\n\n# `defer` \n\n- `defer` , , , .  `defer` \"\"(FILO). \n- `defer` , .  `defer` . \n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\tx, y := 1, 2\n\tdefer func(a, b int) {\n\t\tfmt.Println(\" defer  a b  \", a, b)  // \n\t\tfmt.Println(\" defer  x y \", x, y)\n    }(x, y)\n\tx += 100\n\ty += 100\n\tfmt.Println(\" x y \", x, y)\n}\n// :\n//  x y  101 102\n//  defer  a b   1 2\n//  defer  x y  101 102\n```\n\n## \n\n`defer` . .\n\n for  `defer` \n\n```go\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\tfor i := 0; i < 100; i++ {\n\t\tpath := fmt.Sprintf(\"log/%d.txt\", i)\n\t\tfile, err := os.Open(path)\n\t\tif err != nil {\n\t\t\tfmt.Println(err)\n\t\t}\n        //  main ,\n\t\tdefer file.Close()\n        // do something...\n\t}\n}\n```\n\n `defer` ,. , , `defer` , \n\n```go\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\tdo := func(n int){\n\t\tpath := fmt.Sprintf(\"log/%d.txt\", n)\n\t\tfile, err := os.Open(path)\n\t\tif err != nil {\n\t\t\tfmt.Println(err)\n\t\t}\n        // \n\t\tdefer file.Close()\n        // do something...\n\t}\n\n    for i := 0; i < 100; i++ {\n        do()\n    }\n}\n```\n\n# \n\n## `error`\n\n `error`\n\n `error` , . , \n\n```go\n// Go  error \ntype error interface {\n\tError() string\n}\n\n//  Error\ntype DivError struct {\n\ts string\n}\n\nfunc (divError *DivError) Error() string {\n\treturn divError.s\n}\n```\n\n `error` ,  `error` \n\n```go\nerr := errors.New(\"some description for error\")\n```\n\n## `panic()`, `revover()` \n\n- `panic()`  `interface` , ,  `panice` \n- `revover()`  `interface` ,  `panic()` . ****\n\n```go\nimport (\n    \"fmt\"\n)\n\nfunc catch() {\n\trecover()\n\tfmt.Println(\"\")\n}\n\nfunc main() {\n\tdefer catch()                // \n\tdefer fmt.Println(recover()) // \n\tdefer recover()              // \n\tpanic(\"error\")\n}\n```","slug":"go-study-notes-func","published":1,"date":"2020-04-30T10:34:29.589Z","updated":"2020-05-02T00:15:46.905Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihv3000ck8u7e1qadem6","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>func</code> . Go :</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>,:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">()</span> <span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// `args... argsType` , , </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FuncName</span><span class=\"params\">(arg argType, args ...argsType)</span></span> &#123;  </span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// returnName ,  `,` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FuncName</span><span class=\"params\">()</span> <span class=\"params\">(returnName returnType)</span></span> &#123; </span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// , , </span></span><br><span class=\"line\">a := <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(arg argType)</span> <span class=\"params\">(returnName returnType)</span></span> &#123;  </span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FuncName(args)</span><br><span class=\"line\">a(args)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, </p>\n<blockquote>\n<p>, .</p>\n</blockquote>\n<p>,,,., . </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Change</span><span class=\"params\">(x <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    x = <span class=\"number\">100</span></span><br><span class=\"line\">    fmt.Println(x)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ChangePtr</span><span class=\"params\">(x *<span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    *x = <span class=\"number\">200</span></span><br><span class=\"line\">    fmt.Println(*x)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    x := <span class=\"number\">10</span></span><br><span class=\"line\">    fmt.Println(x)  <span class=\"comment\">// 10</span></span><br><span class=\"line\">    Change(x)       <span class=\"comment\">// 100</span></span><br><span class=\"line\">    fmt.Println(x)  <span class=\"comment\">// 10</span></span><br><span class=\"line\">    x = <span class=\"number\">10</span></span><br><span class=\"line\">    fmt.Println(x)  <span class=\"comment\">// 10</span></span><br><span class=\"line\">    ChangePtr(&amp;x)   <span class=\"comment\">// 200</span></span><br><span class=\"line\">    fmt.Println(x)  <span class=\"comment\">// 200</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,,</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// `args... argsType` , , </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FuncName</span><span class=\"params\">(arg argType, args ...argsType)</span></span> &#123;  </span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,.,. , .  <code>copy()</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">(a ...<span class=\"keyword\">int</span>)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i, _ := <span class=\"keyword\">range</span> a &#123;</span><br><span class=\"line\">        a[i] += <span class=\"number\">100</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    arr := [<span class=\"number\">3</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">10</span>, <span class=\"number\">20</span>, <span class=\"number\">30</span>&#125;</span><br><span class=\"line\">    s := arr[:]</span><br><span class=\"line\">    scopy := <span class=\"built_in\">make</span>([]<span class=\"keyword\">int</span>, <span class=\"built_in\">len</span>(s))</span><br><span class=\"line\">    <span class=\"built_in\">copy</span>(scopy, s)  <span class=\"comment\">//  s  scopy</span></span><br><span class=\"line\">    test(s...)</span><br><span class=\"line\">    fmt.Println(arr)</span><br><span class=\"line\">    fmt.Println(s)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>,  <code>return</code> </li>\n<li>Go </li>\n<li>, , ,  <code>a</code>  <code>a := xxx</code> </li>\n<li>, , </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">()</span> <span class=\"params\">(a <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    fmt.Println(a) <span class=\"comment\">//  0</span></span><br><span class=\"line\">    a := <span class=\"number\">10</span>        <span class=\"comment\">// ,No new variables on left side of :=,  a ,  = </span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, . , , </p>\n<ul>\n<li><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s <span class=\"keyword\">string</span>)</span></span>&#123;</span><br><span class=\"line\">        fmt.Println(s)</span><br><span class=\"line\">    &#125;(<span class=\"string\">\"hello world\"</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    add := <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(x, y <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x + y</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Println(add(<span class=\"number\">1</span>, <span class=\"number\">2</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">(f <span class=\"keyword\">func</span>()</span>)</span> &#123;</span><br><span class=\"line\">    f()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    test(<span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"hello world\"</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">()</span> <span class=\"title\">func</span><span class=\"params\">(<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(x, y <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x + y</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    add := test()</span><br><span class=\"line\">    fmt.Println(add(<span class=\"number\">1</span>, <span class=\"number\">2</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">(x <span class=\"keyword\">int</span>)</span> <span class=\"title\">func</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        fmt.Println(x)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    f := test(<span class=\"number\">123</span>)</span><br><span class=\"line\">    f()  <span class=\"comment\">//  123</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, <code>test</code>  <code>x</code>.  <code>main</code> ,  <code>x</code> , .</p>\n<p>, ,  </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">()</span> []<span class=\"title\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> s []<span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">2</span>; i++ &#123;</span><br><span class=\"line\">\t\ts = <span class=\"built_in\">append</span>(s, <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(&amp;i, i)</span><br><span class=\"line\">\t\t&#125;)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> s</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, f := <span class=\"keyword\">range</span> test() &#123;</span><br><span class=\"line\">\t\tf()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc000062090 2</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc000062090 2</span></span><br></pre></td></tr></table></figure>\n\n<p>, for  i, . , .  main ,  i , 2.</p>\n<p>, </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">()</span> []<span class=\"title\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> s []<span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">2</span>; i++ &#123;</span><br><span class=\"line\">        x := i <span class=\"comment\">// x </span></span><br><span class=\"line\">\t\ts = <span class=\"built_in\">append</span>(s, <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(&amp;x, x)</span><br><span class=\"line\">\t\t&#125;)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> s</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"defer-\"><a href=\"#defer-\" class=\"headerlink\" title=\"defer \"></a><code>defer</code> </h1><ul>\n<li><code>defer</code> , , , .  <code>defer</code> (FILO). </li>\n<li><code>defer</code> , .  <code>defer</code> . </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tx, y := <span class=\"number\">1</span>, <span class=\"number\">2</span></span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(a, b <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\" defer  a b  \"</span>, a, b)  <span class=\"comment\">// </span></span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\" defer  x y \"</span>, x, y)</span><br><span class=\"line\">    &#125;(x, y)</span><br><span class=\"line\">\tx += <span class=\"number\">100</span></span><br><span class=\"line\">\ty += <span class=\"number\">100</span></span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\" x y \"</span>, x, y)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">//  x y  101 102</span></span><br><span class=\"line\"><span class=\"comment\">//  defer  a b   1 2</span></span><br><span class=\"line\"><span class=\"comment\">//  defer  x y  101 102</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>defer</code> . .</p>\n<p> for  <code>defer</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">100</span>; i++ &#123;</span><br><span class=\"line\">\t\tpath := fmt.Sprintf(<span class=\"string\">\"log/%d.txt\"</span>, i)</span><br><span class=\"line\">\t\tfile, err := os.Open(path)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(err)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">        <span class=\"comment\">//  main ,</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> file.Close()</span><br><span class=\"line\">        <span class=\"comment\">// do something...</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>defer</code> ,. , , <code>defer</code> , </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tdo := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span></span>&#123;</span><br><span class=\"line\">\t\tpath := fmt.Sprintf(<span class=\"string\">\"log/%d.txt\"</span>, n)</span><br><span class=\"line\">\t\tfile, err := os.Open(path)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(err)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> file.Close()</span><br><span class=\"line\">        <span class=\"comment\">// do something...</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">100</span>; i++ &#123;</span><br><span class=\"line\">        do()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"error\"><a href=\"#error\" class=\"headerlink\" title=\"error\"></a><code>error</code></h2><p> <code>error</code></p>\n<p> <code>error</code> , . , </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Go  error </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> error <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">\tError() <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Error</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> DivError <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\ts <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(divError *DivError)</span> <span class=\"title\">Error</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> divError.s</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>error</code> ,  <code>error</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">err := errors.New(<span class=\"string\">\"some description for error\"</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"panic-revover-\"><a href=\"#panic-revover-\" class=\"headerlink\" title=\"panic(), revover() \"></a><code>panic()</code>, <code>revover()</code> </h2><ul>\n<li><code>panic()</code>  <code>interface</code> , ,  <code>panice</code> </li>\n<li><code>revover()</code>  <code>interface</code> ,  <code>panic()</code> . <strong></strong></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">catch</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">recover</span>()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> catch()                <span class=\"comment\">// </span></span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> fmt.Println(<span class=\"built_in\">recover</span>()) <span class=\"comment\">// </span></span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> <span class=\"built_in\">recover</span>()              <span class=\"comment\">// </span></span><br><span class=\"line\">\t<span class=\"built_in\">panic</span>(<span class=\"string\">\"error\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>func</code> . Go :</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>,:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">()</span> <span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// `args... argsType` , , </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FuncName</span><span class=\"params\">(arg argType, args ...argsType)</span></span> &#123;  </span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// returnName ,  `,` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FuncName</span><span class=\"params\">()</span> <span class=\"params\">(returnName returnType)</span></span> &#123; </span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// , , </span></span><br><span class=\"line\">a := <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(arg argType)</span> <span class=\"params\">(returnName returnType)</span></span> &#123;  </span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FuncName(args)</span><br><span class=\"line\">a(args)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, </p>\n<blockquote>\n<p>, .</p>\n</blockquote>\n<p>,,,., . </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Change</span><span class=\"params\">(x <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    x = <span class=\"number\">100</span></span><br><span class=\"line\">    fmt.Println(x)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ChangePtr</span><span class=\"params\">(x *<span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    *x = <span class=\"number\">200</span></span><br><span class=\"line\">    fmt.Println(*x)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    x := <span class=\"number\">10</span></span><br><span class=\"line\">    fmt.Println(x)  <span class=\"comment\">// 10</span></span><br><span class=\"line\">    Change(x)       <span class=\"comment\">// 100</span></span><br><span class=\"line\">    fmt.Println(x)  <span class=\"comment\">// 10</span></span><br><span class=\"line\">    x = <span class=\"number\">10</span></span><br><span class=\"line\">    fmt.Println(x)  <span class=\"comment\">// 10</span></span><br><span class=\"line\">    ChangePtr(&amp;x)   <span class=\"comment\">// 200</span></span><br><span class=\"line\">    fmt.Println(x)  <span class=\"comment\">// 200</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,,</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// `args... argsType` , , </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FuncName</span><span class=\"params\">(arg argType, args ...argsType)</span></span> &#123;  </span><br><span class=\"line\">    <span class=\"comment\">// expression</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,.,. , .  <code>copy()</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">(a ...<span class=\"keyword\">int</span>)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i, _ := <span class=\"keyword\">range</span> a &#123;</span><br><span class=\"line\">        a[i] += <span class=\"number\">100</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    arr := [<span class=\"number\">3</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">10</span>, <span class=\"number\">20</span>, <span class=\"number\">30</span>&#125;</span><br><span class=\"line\">    s := arr[:]</span><br><span class=\"line\">    scopy := <span class=\"built_in\">make</span>([]<span class=\"keyword\">int</span>, <span class=\"built_in\">len</span>(s))</span><br><span class=\"line\">    <span class=\"built_in\">copy</span>(scopy, s)  <span class=\"comment\">//  s  scopy</span></span><br><span class=\"line\">    test(s...)</span><br><span class=\"line\">    fmt.Println(arr)</span><br><span class=\"line\">    fmt.Println(s)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>,  <code>return</code> </li>\n<li>Go </li>\n<li>, , ,  <code>a</code>  <code>a := xxx</code> </li>\n<li>, , </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">()</span> <span class=\"params\">(a <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    fmt.Println(a) <span class=\"comment\">//  0</span></span><br><span class=\"line\">    a := <span class=\"number\">10</span>        <span class=\"comment\">// ,No new variables on left side of :=,  a ,  = </span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, . , , </p>\n<ul>\n<li><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s <span class=\"keyword\">string</span>)</span></span>&#123;</span><br><span class=\"line\">        fmt.Println(s)</span><br><span class=\"line\">    &#125;(<span class=\"string\">\"hello world\"</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    add := <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(x, y <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x + y</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Println(add(<span class=\"number\">1</span>, <span class=\"number\">2</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">(f <span class=\"keyword\">func</span>()</span>)</span> &#123;</span><br><span class=\"line\">    f()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    test(<span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"hello world\"</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">()</span> <span class=\"title\">func</span><span class=\"params\">(<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(x, y <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x + y</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    add := test()</span><br><span class=\"line\">    fmt.Println(add(<span class=\"number\">1</span>, <span class=\"number\">2</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">(x <span class=\"keyword\">int</span>)</span> <span class=\"title\">func</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        fmt.Println(x)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    f := test(<span class=\"number\">123</span>)</span><br><span class=\"line\">    f()  <span class=\"comment\">//  123</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, <code>test</code>  <code>x</code>.  <code>main</code> ,  <code>x</code> , .</p>\n<p>, ,  </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">()</span> []<span class=\"title\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> s []<span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">2</span>; i++ &#123;</span><br><span class=\"line\">\t\ts = <span class=\"built_in\">append</span>(s, <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(&amp;i, i)</span><br><span class=\"line\">\t\t&#125;)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> s</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, f := <span class=\"keyword\">range</span> test() &#123;</span><br><span class=\"line\">\t\tf()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc000062090 2</span></span><br><span class=\"line\"><span class=\"comment\">// 0xc000062090 2</span></span><br></pre></td></tr></table></figure>\n\n<p>, for  i, . , .  main ,  i , 2.</p>\n<p>, </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">test</span><span class=\"params\">()</span> []<span class=\"title\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> s []<span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">2</span>; i++ &#123;</span><br><span class=\"line\">        x := i <span class=\"comment\">// x </span></span><br><span class=\"line\">\t\ts = <span class=\"built_in\">append</span>(s, <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(&amp;x, x)</span><br><span class=\"line\">\t\t&#125;)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> s</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"defer-\"><a href=\"#defer-\" class=\"headerlink\" title=\"defer \"></a><code>defer</code> </h1><ul>\n<li><code>defer</code> , , , .  <code>defer</code> (FILO). </li>\n<li><code>defer</code> , .  <code>defer</code> . </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tx, y := <span class=\"number\">1</span>, <span class=\"number\">2</span></span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(a, b <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\" defer  a b  \"</span>, a, b)  <span class=\"comment\">// </span></span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\" defer  x y \"</span>, x, y)</span><br><span class=\"line\">    &#125;(x, y)</span><br><span class=\"line\">\tx += <span class=\"number\">100</span></span><br><span class=\"line\">\ty += <span class=\"number\">100</span></span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\" x y \"</span>, x, y)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// :</span></span><br><span class=\"line\"><span class=\"comment\">//  x y  101 102</span></span><br><span class=\"line\"><span class=\"comment\">//  defer  a b   1 2</span></span><br><span class=\"line\"><span class=\"comment\">//  defer  x y  101 102</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>defer</code> . .</p>\n<p> for  <code>defer</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">100</span>; i++ &#123;</span><br><span class=\"line\">\t\tpath := fmt.Sprintf(<span class=\"string\">\"log/%d.txt\"</span>, i)</span><br><span class=\"line\">\t\tfile, err := os.Open(path)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(err)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">        <span class=\"comment\">//  main ,</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> file.Close()</span><br><span class=\"line\">        <span class=\"comment\">// do something...</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>defer</code> ,. , , <code>defer</code> , </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tdo := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span></span>&#123;</span><br><span class=\"line\">\t\tpath := fmt.Sprintf(<span class=\"string\">\"log/%d.txt\"</span>, n)</span><br><span class=\"line\">\t\tfile, err := os.Open(path)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(err)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> file.Close()</span><br><span class=\"line\">        <span class=\"comment\">// do something...</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">100</span>; i++ &#123;</span><br><span class=\"line\">        do()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"error\"><a href=\"#error\" class=\"headerlink\" title=\"error\"></a><code>error</code></h2><p> <code>error</code></p>\n<p> <code>error</code> , . , </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Go  error </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> error <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">\tError() <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Error</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> DivError <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\ts <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(divError *DivError)</span> <span class=\"title\">Error</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> divError.s</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>error</code> ,  <code>error</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">err := errors.New(<span class=\"string\">\"some description for error\"</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"panic-revover-\"><a href=\"#panic-revover-\" class=\"headerlink\" title=\"panic(), revover() \"></a><code>panic()</code>, <code>revover()</code> </h2><ul>\n<li><code>panic()</code>  <code>interface</code> , ,  <code>panice</code> </li>\n<li><code>revover()</code>  <code>interface</code> ,  <code>panic()</code> . <strong></strong></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">catch</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">recover</span>()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> catch()                <span class=\"comment\">// </span></span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> fmt.Println(<span class=\"built_in\">recover</span>()) <span class=\"comment\">// </span></span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> <span class=\"built_in\">recover</span>()              <span class=\"comment\">// </span></span><br><span class=\"line\">\t<span class=\"built_in\">panic</span>(<span class=\"string\">\"error\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go ","abbrlink":403,"description":" Go , ,  Go ","_content":"\n# \n\n. , . :\n\n```go\ntype structName struct{\n    fieldName fieldType\n    // ...\n}\n\nfunc (receiver structName) MethodName() (){\n    // func expression\n}\n```\n\n:\n\n- ,\n- , , receiver , \n- ,  receiver \n- , \n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\ntype N int\ntype S struct{\n    N\n}\n\nfunc (n N) value() {\n\tn++\n\tfmt.Printf(\"%p, %v\\n\", &n, n)\n}\nfunc (n *N) pointer() {\n\t(*n)++\n\tfmt.Printf(\"%p, %v\\n\", n, *n)\n}\n\nfunc main() {\n\tvar n N = 20\n\tn.value()                     // 0xc00000a0d0, 21\n\tfmt.Printf(\"%p, %v\\n\", &n, n) // 0xc00000a0b8 ,20\n\tn.pointer()                   // 0xc00000a0b8,21\n\tfmt.Printf(\"%p, %v\\n\", &n, n) // 0xc00000a0b8, 21\n    \n\ts := S{23000}\n\ts.value()                     // 0xc00000a120, 23001\n\tfmt.Printf(\"%p, %v\\n\", &s, s) // 0xc00000a118, {23000}\n\ts.pointer()                   // 0xc00000a118, 23001\n\tfmt.Printf(\"%p, %v\\n\", &s, s) // 0xc00000a118, {23001}\n}\n```\n\n>  \"\", \"\" \"\", Go ,  \"\" . , , , . , .\n\n## \n\n, , , ,  expression  value .\n\n## \n\n method expression , receiver , . ,  T  *T.\n\n```go\nimport (\n    \"fmt\"\n)\n\ntype N int\n\nfunc (n N) test() {\n    fmt.Printf(\"test.n: %p, %v\\n\", &n, n)\n}\n\nfunc main() {\n    var n N = 25\n    fmt.Printf(\"main.n: %p, %v\\n\", &n, n)\n    f1 := N.test        //  N.test(n)\n    f1(n)\n    f2 := (*N).test     //  (*N).test(&n)\n    f2(&n)\n}\n// \n// main.n: 0xc00000a0b8, 25\n// test.n: 0xc00000a0f0, 25\n// test.n: 0xc00000a100, 25\n```\n## \n\n-  method value, .  method value , **** receiver , . ,  receiver \n-  receiver , . , \n\n```go\nimport (\n    \"fmt\"\n)\n\ntype N int\n\nfunc (n N) value() {\n\tfmt.Printf(\"test.n: %p, %v\\n\", &n, n)\n}\nfunc (n *n) pointer(){\n    fmt.Printf(\"test.n: %p, %v\\n\", &n, n)\n}\n\nfunc main() {\n\tvar n N = 100\n\tp := &n\n\tn++  // 101\n\tf1 := n.value       //  n ,,  test \n    f3 := n.pointer     //  n  &n\n\tn++  // 102\n\tf2 := p.value       //  p , ,  test \n    f4 := m.pointer     //  n  &n\n\tn++  // 103\n\tfmt.Printf(\"main.n: %p, %v\\n\", &n, n)\n\tf1()\n    f3()    //  *n = 103\n\tf2()\n    f4()    //  *n = 103\n}\n// \n// main.n: 0xc00000a0b8, 103\n// test.n: 0xc00000a100, 101\n// test.n: 0xc00000a0b8, 103\n// test.n: 0xc00000a118, 102\n// test.n: 0xc00000a0b8, 103\n```","source":"_posts/go-study-notes-method.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 403\ndescription: ' Go , ,  Go '\n---\n\n# \n\n. , . :\n\n```go\ntype structName struct{\n    fieldName fieldType\n    // ...\n}\n\nfunc (receiver structName) MethodName() (){\n    // func expression\n}\n```\n\n:\n\n- ,\n- , , receiver , \n- ,  receiver \n- , \n\n:\n\n```go\nimport (\n    \"fmt\"\n)\n\ntype N int\ntype S struct{\n    N\n}\n\nfunc (n N) value() {\n\tn++\n\tfmt.Printf(\"%p, %v\\n\", &n, n)\n}\nfunc (n *N) pointer() {\n\t(*n)++\n\tfmt.Printf(\"%p, %v\\n\", n, *n)\n}\n\nfunc main() {\n\tvar n N = 20\n\tn.value()                     // 0xc00000a0d0, 21\n\tfmt.Printf(\"%p, %v\\n\", &n, n) // 0xc00000a0b8 ,20\n\tn.pointer()                   // 0xc00000a0b8,21\n\tfmt.Printf(\"%p, %v\\n\", &n, n) // 0xc00000a0b8, 21\n    \n\ts := S{23000}\n\ts.value()                     // 0xc00000a120, 23001\n\tfmt.Printf(\"%p, %v\\n\", &s, s) // 0xc00000a118, {23000}\n\ts.pointer()                   // 0xc00000a118, 23001\n\tfmt.Printf(\"%p, %v\\n\", &s, s) // 0xc00000a118, {23001}\n}\n```\n\n>  \"\", \"\" \"\", Go ,  \"\" . , , , . , .\n\n## \n\n, , , ,  expression  value .\n\n## \n\n method expression , receiver , . ,  T  *T.\n\n```go\nimport (\n    \"fmt\"\n)\n\ntype N int\n\nfunc (n N) test() {\n    fmt.Printf(\"test.n: %p, %v\\n\", &n, n)\n}\n\nfunc main() {\n    var n N = 25\n    fmt.Printf(\"main.n: %p, %v\\n\", &n, n)\n    f1 := N.test        //  N.test(n)\n    f1(n)\n    f2 := (*N).test     //  (*N).test(&n)\n    f2(&n)\n}\n// \n// main.n: 0xc00000a0b8, 25\n// test.n: 0xc00000a0f0, 25\n// test.n: 0xc00000a100, 25\n```\n## \n\n-  method value, .  method value , **** receiver , . ,  receiver \n-  receiver , . , \n\n```go\nimport (\n    \"fmt\"\n)\n\ntype N int\n\nfunc (n N) value() {\n\tfmt.Printf(\"test.n: %p, %v\\n\", &n, n)\n}\nfunc (n *n) pointer(){\n    fmt.Printf(\"test.n: %p, %v\\n\", &n, n)\n}\n\nfunc main() {\n\tvar n N = 100\n\tp := &n\n\tn++  // 101\n\tf1 := n.value       //  n ,,  test \n    f3 := n.pointer     //  n  &n\n\tn++  // 102\n\tf2 := p.value       //  p , ,  test \n    f4 := m.pointer     //  n  &n\n\tn++  // 103\n\tfmt.Printf(\"main.n: %p, %v\\n\", &n, n)\n\tf1()\n    f3()    //  *n = 103\n\tf2()\n    f4()    //  *n = 103\n}\n// \n// main.n: 0xc00000a0b8, 103\n// test.n: 0xc00000a100, 101\n// test.n: 0xc00000a0b8, 103\n// test.n: 0xc00000a118, 102\n// test.n: 0xc00000a0b8, 103\n```","slug":"go-study-notes-method","published":1,"date":"2020-04-30T10:43:18.486Z","updated":"2020-05-02T00:15:58.944Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihv5000hk8u72jpcgkdc","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>. , . :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> structName <span class=\"keyword\">struct</span>&#123;</span><br><span class=\"line\">    fieldName fieldType</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(receiver structName)</span> <span class=\"title\">MethodName</span><span class=\"params\">()</span> <span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// func expression</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>,</li>\n<li>, , receiver , </li>\n<li>,  receiver </li>\n<li>, </li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> N <span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> S <span class=\"keyword\">struct</span>&#123;</span><br><span class=\"line\">    N</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n N)</span> <span class=\"title\">value</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tn++</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n *N)</span> <span class=\"title\">pointer</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t(*n)++</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, n, *n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> n N = <span class=\"number\">20</span></span><br><span class=\"line\">\tn.value()                     <span class=\"comment\">// 0xc00000a0d0, 21</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;n, n) <span class=\"comment\">// 0xc00000a0b8 ,20</span></span><br><span class=\"line\">\tn.pointer()                   <span class=\"comment\">// 0xc00000a0b8,21</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;n, n) <span class=\"comment\">// 0xc00000a0b8, 21</span></span><br><span class=\"line\">    </span><br><span class=\"line\">\ts := S&#123;<span class=\"number\">23000</span>&#125;</span><br><span class=\"line\">\ts.value()                     <span class=\"comment\">// 0xc00000a120, 23001</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;s, s) <span class=\"comment\">// 0xc00000a118, &#123;23000&#125;</span></span><br><span class=\"line\">\ts.pointer()                   <span class=\"comment\">// 0xc00000a118, 23001</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;s, s) <span class=\"comment\">// 0xc00000a118, &#123;23001&#125;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p> ,  , Go ,   . , , , . , .</p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>, , , ,  expression  value .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> method expression , receiver , . ,  T  *T.</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> N <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n N)</span> <span class=\"title\">test</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"test.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> n N = <span class=\"number\">25</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"main.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">    f1 := N.test        <span class=\"comment\">//  N.test(n)</span></span><br><span class=\"line\">    f1(n)</span><br><span class=\"line\">    f2 := (*N).test     <span class=\"comment\">//  (*N).test(&amp;n)</span></span><br><span class=\"line\">    f2(&amp;n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// main.n: 0xc00000a0b8, 25</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a0f0, 25</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a100, 25</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li> method value, .  method value , <strong></strong> receiver , . ,  receiver </li>\n<li> receiver , . , </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> N <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n N)</span> <span class=\"title\">value</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"test.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n *n)</span> <span class=\"title\">pointer</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"test.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> n N = <span class=\"number\">100</span></span><br><span class=\"line\">\tp := &amp;n</span><br><span class=\"line\">\tn++  <span class=\"comment\">// 101</span></span><br><span class=\"line\">\tf1 := n.value       <span class=\"comment\">//  n ,,  test </span></span><br><span class=\"line\">    f3 := n.pointer     <span class=\"comment\">//  n  &amp;n</span></span><br><span class=\"line\">\tn++  <span class=\"comment\">// 102</span></span><br><span class=\"line\">\tf2 := p.value       <span class=\"comment\">//  p , ,  test </span></span><br><span class=\"line\">    f4 := m.pointer     <span class=\"comment\">//  n  &amp;n</span></span><br><span class=\"line\">\tn++  <span class=\"comment\">// 103</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"main.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">\tf1()</span><br><span class=\"line\">    f3()    <span class=\"comment\">//  *n = 103</span></span><br><span class=\"line\">\tf2()</span><br><span class=\"line\">    f4()    <span class=\"comment\">//  *n = 103</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// main.n: 0xc00000a0b8, 103</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a100, 101</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a0b8, 103</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a118, 102</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a0b8, 103</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>. , . :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> structName <span class=\"keyword\">struct</span>&#123;</span><br><span class=\"line\">    fieldName fieldType</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(receiver structName)</span> <span class=\"title\">MethodName</span><span class=\"params\">()</span> <span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// func expression</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<ul>\n<li>,</li>\n<li>, , receiver , </li>\n<li>,  receiver </li>\n<li>, </li>\n</ul>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> N <span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> S <span class=\"keyword\">struct</span>&#123;</span><br><span class=\"line\">    N</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n N)</span> <span class=\"title\">value</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tn++</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n *N)</span> <span class=\"title\">pointer</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t(*n)++</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, n, *n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> n N = <span class=\"number\">20</span></span><br><span class=\"line\">\tn.value()                     <span class=\"comment\">// 0xc00000a0d0, 21</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;n, n) <span class=\"comment\">// 0xc00000a0b8 ,20</span></span><br><span class=\"line\">\tn.pointer()                   <span class=\"comment\">// 0xc00000a0b8,21</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;n, n) <span class=\"comment\">// 0xc00000a0b8, 21</span></span><br><span class=\"line\">    </span><br><span class=\"line\">\ts := S&#123;<span class=\"number\">23000</span>&#125;</span><br><span class=\"line\">\ts.value()                     <span class=\"comment\">// 0xc00000a120, 23001</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;s, s) <span class=\"comment\">// 0xc00000a118, &#123;23000&#125;</span></span><br><span class=\"line\">\ts.pointer()                   <span class=\"comment\">// 0xc00000a118, 23001</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%p, %v\\n\"</span>, &amp;s, s) <span class=\"comment\">// 0xc00000a118, &#123;23001&#125;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p> ,  , Go ,   . , , , . , .</p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>, , , ,  expression  value .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> method expression , receiver , . ,  T  *T.</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> N <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n N)</span> <span class=\"title\">test</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"test.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> n N = <span class=\"number\">25</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"main.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">    f1 := N.test        <span class=\"comment\">//  N.test(n)</span></span><br><span class=\"line\">    f1(n)</span><br><span class=\"line\">    f2 := (*N).test     <span class=\"comment\">//  (*N).test(&amp;n)</span></span><br><span class=\"line\">    f2(&amp;n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// main.n: 0xc00000a0b8, 25</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a0f0, 25</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a100, 25</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li> method value, .  method value , <strong></strong> receiver , . ,  receiver </li>\n<li> receiver , . , </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> N <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n N)</span> <span class=\"title\">value</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"test.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n *n)</span> <span class=\"title\">pointer</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"test.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> n N = <span class=\"number\">100</span></span><br><span class=\"line\">\tp := &amp;n</span><br><span class=\"line\">\tn++  <span class=\"comment\">// 101</span></span><br><span class=\"line\">\tf1 := n.value       <span class=\"comment\">//  n ,,  test </span></span><br><span class=\"line\">    f3 := n.pointer     <span class=\"comment\">//  n  &amp;n</span></span><br><span class=\"line\">\tn++  <span class=\"comment\">// 102</span></span><br><span class=\"line\">\tf2 := p.value       <span class=\"comment\">//  p , ,  test </span></span><br><span class=\"line\">    f4 := m.pointer     <span class=\"comment\">//  n  &amp;n</span></span><br><span class=\"line\">\tn++  <span class=\"comment\">// 103</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"main.n: %p, %v\\n\"</span>, &amp;n, n)</span><br><span class=\"line\">\tf1()</span><br><span class=\"line\">    f3()    <span class=\"comment\">//  *n = 103</span></span><br><span class=\"line\">\tf2()</span><br><span class=\"line\">    f4()    <span class=\"comment\">//  *n = 103</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// main.n: 0xc00000a0b8, 103</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a100, 101</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a0b8, 103</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a118, 102</span></span><br><span class=\"line\"><span class=\"comment\">// test.n: 0xc00000a0b8, 103</span></span><br></pre></td></tr></table></figure>"},{"title":"go ","abbrlink":34261,"description":" Go , ,  Go ","_content":"\n# \n\n, :\n\n```go\ntype interfaceName interface {\n    // () ()\n}\n```\n- , (`interface{}`). , \n- \n- , , \n- , , .\n- . , , \n-  `var i1 = interface{}` ,  `nil`\n- , , ; , , \n\n# /\n\n, . :\n\n```go\nType, ok := x.(Type)    // \nType, ok := x.(interfaceName)  // \n```\n\n:\n```go\nimport (\n    \"fmt\"\n)\n\ntype N int\ntype interfaceName interface {\n\ttest() int\n}\n\nfunc (n N) test() int {\n\treturn 0\n}\n\nfunc main() {\n\tvar n N = 100\n\tvar x interface{} = n\n    //  `switch`  `x.(type)`  x \n    switch x.(type) {\n    case nil:\n    \tfmt.Println(\"nil\")\n    case int, string, N:\n    \tfmt.Println(x)\n    case func(int) string:\n    \tfmt.Println(\"func\")\n    default:\n    \tfmt.Println(\"unknown\")\n    }\n    //  x  N \n\tif n, ok := x.(N); ok {\n\t\tfmt.Printf(\"%T, %v\\n\", n)\n\t}\n    //  n  interfaceName \n\tif n, ok := x.(interfaceName); ok {\n\t\tfmt.Printf(\"%T, %v\\n\", n, n)\n\t}\n    \n}\n```","source":"_posts/go-study-notes-interface.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 34261\ndescription: ' Go , ,  Go '\n---\n\n# \n\n, :\n\n```go\ntype interfaceName interface {\n    // () ()\n}\n```\n- , (`interface{}`). , \n- \n- , , \n- , , .\n- . , , \n-  `var i1 = interface{}` ,  `nil`\n- , , ; , , \n\n# /\n\n, . :\n\n```go\nType, ok := x.(Type)    // \nType, ok := x.(interfaceName)  // \n```\n\n:\n```go\nimport (\n    \"fmt\"\n)\n\ntype N int\ntype interfaceName interface {\n\ttest() int\n}\n\nfunc (n N) test() int {\n\treturn 0\n}\n\nfunc main() {\n\tvar n N = 100\n\tvar x interface{} = n\n    //  `switch`  `x.(type)`  x \n    switch x.(type) {\n    case nil:\n    \tfmt.Println(\"nil\")\n    case int, string, N:\n    \tfmt.Println(x)\n    case func(int) string:\n    \tfmt.Println(\"func\")\n    default:\n    \tfmt.Println(\"unknown\")\n    }\n    //  x  N \n\tif n, ok := x.(N); ok {\n\t\tfmt.Printf(\"%T, %v\\n\", n)\n\t}\n    //  n  interfaceName \n\tif n, ok := x.(interfaceName); ok {\n\t\tfmt.Printf(\"%T, %v\\n\", n, n)\n\t}\n    \n}\n```","slug":"go-study-notes-interface","published":1,"date":"2020-04-30T10:44:18.180Z","updated":"2020-05-02T00:15:54.769Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihv6000kk8u703ga1bn6","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> interfaceName <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// () ()</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>, (<code>interface{}</code>). , </li>\n<li></li>\n<li>, , </li>\n<li>, , .</li>\n<li>. , , </li>\n<li> <code>var i1 = interface{}</code> ,  <code>nil</code></li>\n<li>, , ; , , </li>\n</ul>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"/\"></a>/</h1><p>, . :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Type, ok := x.(Type)    <span class=\"comment\">// </span></span><br><span class=\"line\">Type, ok := x.(interfaceName)  <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> N <span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> interfaceName <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">\ttest() <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n N)</span> <span class=\"title\">test</span><span class=\"params\">()</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> n N = <span class=\"number\">100</span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> x <span class=\"keyword\">interface</span>&#123;&#125; = n</span><br><span class=\"line\">    <span class=\"comment\">//  `switch`  `x.(type)`  x </span></span><br><span class=\"line\">    <span class=\"keyword\">switch</span> x.(<span class=\"keyword\">type</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"literal\">nil</span>:</span><br><span class=\"line\">    \tfmt.Println(<span class=\"string\">\"nil\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"keyword\">int</span>, <span class=\"keyword\">string</span>, N:</span><br><span class=\"line\">    \tfmt.Println(x)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(<span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span>:</span></span><br><span class=\"line\">    \tfmt.Println(<span class=\"string\">\"func\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">default</span>:</span><br><span class=\"line\">    \tfmt.Println(<span class=\"string\">\"unknown\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  x  N </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> n, ok := x.(N); ok &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%T, %v\\n\"</span>, n)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"comment\">//  n  interfaceName </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> n, ok := x.(interfaceName); ok &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%T, %v\\n\"</span>, n, n)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> interfaceName <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// () ()</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>, (<code>interface{}</code>). , </li>\n<li></li>\n<li>, , </li>\n<li>, , .</li>\n<li>. , , </li>\n<li> <code>var i1 = interface{}</code> ,  <code>nil</code></li>\n<li>, , ; , , </li>\n</ul>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"/\"></a>/</h1><p>, . :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Type, ok := x.(Type)    <span class=\"comment\">// </span></span><br><span class=\"line\">Type, ok := x.(interfaceName)  <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> N <span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> interfaceName <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">\ttest() <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n N)</span> <span class=\"title\">test</span><span class=\"params\">()</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> n N = <span class=\"number\">100</span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> x <span class=\"keyword\">interface</span>&#123;&#125; = n</span><br><span class=\"line\">    <span class=\"comment\">//  `switch`  `x.(type)`  x </span></span><br><span class=\"line\">    <span class=\"keyword\">switch</span> x.(<span class=\"keyword\">type</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"literal\">nil</span>:</span><br><span class=\"line\">    \tfmt.Println(<span class=\"string\">\"nil\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"keyword\">int</span>, <span class=\"keyword\">string</span>, N:</span><br><span class=\"line\">    \tfmt.Println(x)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(<span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span>:</span></span><br><span class=\"line\">    \tfmt.Println(<span class=\"string\">\"func\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">default</span>:</span><br><span class=\"line\">    \tfmt.Println(<span class=\"string\">\"unknown\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  x  N </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> n, ok := x.(N); ok &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%T, %v\\n\"</span>, n)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"comment\">//  n  interfaceName </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> n, ok := x.(interfaceName); ok &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%T, %v\\n\"</span>, n, n)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go  bufio ","abbrlink":54358,"description":" Go bufio .bufio  IO, IO  IO ","_content":"\n`bufio`  IO.  `io.Reader()`  `io.Writer()`  `Reader`  `Writer`, IO  IO . `import \"bufio\"`\n\n# \n\n```go\n// Reader  `io.Reader` \ntype Reader struct {\n    // \n}\n\n// Writer  `io.Writer` .\n//  Writer ,, `Flush()`` \n// , `Flush()`  `io.Writer`\ntype Writer struct {\n    // \n}\n\ntype ReadWriter struct {\n    *Reader\n    *Writer\n}\n\n// Scanner ,.\n//  `Scan()`  'token'(), token .token  `SplitFunc` .,.\n// ,,unicode, word.\n// \n//  token , reader , `bufio.Reader`\ntype Scanner struct {\n    // \n}\n\n//  Scanner \n// ,(token)\ntype SplitFunc func(data []byte, atEOF bool) (advance int, token []byte, err error)  \n```\n\n# \n\n```go\nconst (\n    //  token, token ,\n    MaxScanTokenSize = 64 * 1024\n)\n```\n\n# \n\n## `bufio` \n\n```go\n//  `Reader` \nfunc NewReader(rd io.Reader) *Reader\n//  `Reader` , 4096, 16\nfunc NewReaderSize(rd io.Reader, size int) *Reader\n//  `Writer` \nfunc NewWriter(w io.Writer) *Writer\n//  `Writer` \nfunc NewWriterSize(w io.Writer, size int) *Writer\n//  Reader,Writer  ReadWriter  \nfunc NewReadWriter(r *Reader, w *Writer) *ReadWriter\n\n\n//  `scanner.Split()` , Scanner \n\n//  token\nfunc ScanBytes(data []byte, atEOF bool) (advance int, token []byte, err error)\n//  runes  token\nfunc ScanRunes(data []byte, atEOF bool) (advance int, token []byte, err error)\n//  token,\nfunc ScanWords(data []byte, atEOF bool) (advance int, token []byte, err error)\n//  token, '\\n'\nfunc ScanLines(data []byte, atEOF bool) (advance int, token []byte, err error)\n```\n\n## `Reader` \n\n```go\n// ,, b  r \nfunc (b *Reader) Reset(r io.Reader)\n// \nfunc (b *Reader) Buffered() int\n//  n .\nfunc (b *Reader) Peek(n int) ([]byte, error)\n//  p. p .,n  0  err  io.EOF\nfunc (b *Reader) Read(p []byte) (n int, err error)\n// \nfunc (b *Reader) ReadByte() (c byte, err error)\n\n// , byte (),\n// ,, isPrefix  true.,,isPrefix  false\n//  `ReadBytes('\\n')`  `ReadString('\\n')` \nfunc (b *Reader) ReadLine() (line []byte, isPrefix bool, err error)\n//  delim .\nfunc (b *Reader) ReadBytes(delim byte) (line []byte, err error)\n//  delim .. ReadBytes \nfunc (b *Reader) ReadString(delim byte) (line string, err error)\n//  w\nfunc (b *Reader) WriteTo(w io.Writer) (n int64, err error)  \n```\n\n## `Writer` \n\n```go\nfunc (b *Writer) Reset(w io.Writer)  // ,, b  w \nfunc (b *Writer) Buffered() int  // \nfunc (b *Writer) Write(p []byte) (nn int, err error)  //  p .. nn < len(p),err \nfunc (b *Writer) WriteString(s string) (int, error)  //  s .. nn < len(p),err \nfunc (b *Writer) WriteByte(c byte) error  //  c ,\nfunc (b *Writer) Flush() error  // .\nfunc (b *Writer) ReadFrom(r io.Reader) (n int64, err error)  //  `io.ReaderFrom` . r \n```\n\n## `Scanner` \n\n```go\n//  Scanner . `Scan()` \nfunc (s *Scanner) Split(split SplitFunc)\n//  token. Scanner  token\nfunc (s *Scanner) Scan() bool\n//  `Scan()`  token\nfunc (s *Scanner) Bytes() []byte\n//  `Scan()`  token\nfunc (s *Scanner) Text() string\n//  Scanner \nfunc (s *Scanner) Err() error\n```\n\n# \n\n `filename` :\n```\nhello\nthe second line: nice to meet you\nthe third line: see you next time\n```\n\n## `bufio` \n\n```go\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\n// `bufio.Writer.WriteString()` \nfunc WriterExample(bw *bufio.Writer) {\n    defer bw.Flush() // \n    bw.WriteString(\"this new add line\\n\")\n}\n\n// `bufio.Reader.ReadLine()` \nfunc ReadLineExample(br *bufio.Reader) {\n    for {\n        line, isPrefix, err := br.ReadLine()\n        if err == io.EOF {\n            break\n        }\n        if isPrefix {\n            fmt.Printf(\",: %v\", string(line))\n        } else {\n            fmt.Printf(\",: %v\", string(line))\n        }\n        fmt.Println() // ,\n    }\n}\n\n// `bufio.Reader.ReadString()` \nfunc ReadStringExample(br *bufio.Reader) {\n    for {\n        line, err := br.ReadString('\\n') //  ReadString \n        if err == io.EOF {\n            fmt.Print(line) // ,err  io.EOF,\n            break\n        }\n        fmt.Print(line)\n    }\n}\n\n\nfunc main() {\n    file, err := os.OpenFile(\"filename\", os.O_RDWR|os.O_CREATE|os.O_APPEND, 0)\n    if err != nil {\n        fmt.Println(\"err\", err)\n        return\n    }\n    defer file.Close()\n\n    br := bufio.NewReaderSize(reader, 16) // ,\n    ReadLineExample(br)\n    file.Seek(0, 0)  // \n    fmt.Println(\"------\")\n    ReadStringExample(br)\n    file.Seek(0, 0)\n    bw := bufio.NewWriter(file)\n    WriterExample(bw)\n}\n\n// : \n// ,: hello\n// ,: the second line:\n// ,:  nice to meet yo\n// ,: u\n// ,: the third line: \n// ,: see you next tim\n// ,: e\n// ------\n// hello\n// the second line: nice to meet you\n// the third line: see you next time\n```\n:\n- `ReadLine()` ,\n-  \"this new add line\\n\" \n\n## `bufio.Scanner` \n\n- \n```go\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n    const input = \"Now is the winter of our discontent,\\nMade glorious summer by this sun of York.\\n\"\n    scanner := bufio.NewScanner(strings.NewReader(input))\n    scanner.Split(bufio.ScanWords) //  scanner \n    // \n    count := 0\n    for scanner.Scan() {\n        count++\n    }\n    if err := scanner.Err(); err != nil {\n        fmt.Fprintln(os.Stderr, \"reading input:\", err)\n    }\n    fmt.Printf(\"%d\\n\", count)\n}\n```\n\n- \n\n\n\n```go\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    const input = \"1234 5678 5681 1234567890123456\"\n    scanner := bufio.NewScanner(strings.NewReader(input))\n    // \n    split := func(data []byte, atEOF bool) (advance int, token []byte, err error) {\n        advance, token, err = bufio.ScanWords(data, atEOF)  //  token\n        if err == nil && token != nil {\n            _, err = strconv.ParseInt(string(token), 10, 32)  // \n        }\n        return\n    }\n    //  split\n    scanner.Split(split)\n    // ,\n    for scanner.Scan() {\n        fmt.Printf(\"%s\\n\", scanner.Text())\n    }\n    if err := scanner.Err(); err != nil {\n        fmt.Printf(\"Invalid input: %s\", err)\n    }\n}\n```","source":"_posts/go-study-notes-package-bufio.md","raw":"---\ntitle: go  bufio \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 54358\ndescription: ' Go bufio .bufio  IO, IO  IO '\n---\n\n`bufio`  IO.  `io.Reader()`  `io.Writer()`  `Reader`  `Writer`, IO  IO . `import \"bufio\"`\n\n# \n\n```go\n// Reader  `io.Reader` \ntype Reader struct {\n    // \n}\n\n// Writer  `io.Writer` .\n//  Writer ,, `Flush()`` \n// , `Flush()`  `io.Writer`\ntype Writer struct {\n    // \n}\n\ntype ReadWriter struct {\n    *Reader\n    *Writer\n}\n\n// Scanner ,.\n//  `Scan()`  'token'(), token .token  `SplitFunc` .,.\n// ,,unicode, word.\n// \n//  token , reader , `bufio.Reader`\ntype Scanner struct {\n    // \n}\n\n//  Scanner \n// ,(token)\ntype SplitFunc func(data []byte, atEOF bool) (advance int, token []byte, err error)  \n```\n\n# \n\n```go\nconst (\n    //  token, token ,\n    MaxScanTokenSize = 64 * 1024\n)\n```\n\n# \n\n## `bufio` \n\n```go\n//  `Reader` \nfunc NewReader(rd io.Reader) *Reader\n//  `Reader` , 4096, 16\nfunc NewReaderSize(rd io.Reader, size int) *Reader\n//  `Writer` \nfunc NewWriter(w io.Writer) *Writer\n//  `Writer` \nfunc NewWriterSize(w io.Writer, size int) *Writer\n//  Reader,Writer  ReadWriter  \nfunc NewReadWriter(r *Reader, w *Writer) *ReadWriter\n\n\n//  `scanner.Split()` , Scanner \n\n//  token\nfunc ScanBytes(data []byte, atEOF bool) (advance int, token []byte, err error)\n//  runes  token\nfunc ScanRunes(data []byte, atEOF bool) (advance int, token []byte, err error)\n//  token,\nfunc ScanWords(data []byte, atEOF bool) (advance int, token []byte, err error)\n//  token, '\\n'\nfunc ScanLines(data []byte, atEOF bool) (advance int, token []byte, err error)\n```\n\n## `Reader` \n\n```go\n// ,, b  r \nfunc (b *Reader) Reset(r io.Reader)\n// \nfunc (b *Reader) Buffered() int\n//  n .\nfunc (b *Reader) Peek(n int) ([]byte, error)\n//  p. p .,n  0  err  io.EOF\nfunc (b *Reader) Read(p []byte) (n int, err error)\n// \nfunc (b *Reader) ReadByte() (c byte, err error)\n\n// , byte (),\n// ,, isPrefix  true.,,isPrefix  false\n//  `ReadBytes('\\n')`  `ReadString('\\n')` \nfunc (b *Reader) ReadLine() (line []byte, isPrefix bool, err error)\n//  delim .\nfunc (b *Reader) ReadBytes(delim byte) (line []byte, err error)\n//  delim .. ReadBytes \nfunc (b *Reader) ReadString(delim byte) (line string, err error)\n//  w\nfunc (b *Reader) WriteTo(w io.Writer) (n int64, err error)  \n```\n\n## `Writer` \n\n```go\nfunc (b *Writer) Reset(w io.Writer)  // ,, b  w \nfunc (b *Writer) Buffered() int  // \nfunc (b *Writer) Write(p []byte) (nn int, err error)  //  p .. nn < len(p),err \nfunc (b *Writer) WriteString(s string) (int, error)  //  s .. nn < len(p),err \nfunc (b *Writer) WriteByte(c byte) error  //  c ,\nfunc (b *Writer) Flush() error  // .\nfunc (b *Writer) ReadFrom(r io.Reader) (n int64, err error)  //  `io.ReaderFrom` . r \n```\n\n## `Scanner` \n\n```go\n//  Scanner . `Scan()` \nfunc (s *Scanner) Split(split SplitFunc)\n//  token. Scanner  token\nfunc (s *Scanner) Scan() bool\n//  `Scan()`  token\nfunc (s *Scanner) Bytes() []byte\n//  `Scan()`  token\nfunc (s *Scanner) Text() string\n//  Scanner \nfunc (s *Scanner) Err() error\n```\n\n# \n\n `filename` :\n```\nhello\nthe second line: nice to meet you\nthe third line: see you next time\n```\n\n## `bufio` \n\n```go\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\n// `bufio.Writer.WriteString()` \nfunc WriterExample(bw *bufio.Writer) {\n    defer bw.Flush() // \n    bw.WriteString(\"this new add line\\n\")\n}\n\n// `bufio.Reader.ReadLine()` \nfunc ReadLineExample(br *bufio.Reader) {\n    for {\n        line, isPrefix, err := br.ReadLine()\n        if err == io.EOF {\n            break\n        }\n        if isPrefix {\n            fmt.Printf(\",: %v\", string(line))\n        } else {\n            fmt.Printf(\",: %v\", string(line))\n        }\n        fmt.Println() // ,\n    }\n}\n\n// `bufio.Reader.ReadString()` \nfunc ReadStringExample(br *bufio.Reader) {\n    for {\n        line, err := br.ReadString('\\n') //  ReadString \n        if err == io.EOF {\n            fmt.Print(line) // ,err  io.EOF,\n            break\n        }\n        fmt.Print(line)\n    }\n}\n\n\nfunc main() {\n    file, err := os.OpenFile(\"filename\", os.O_RDWR|os.O_CREATE|os.O_APPEND, 0)\n    if err != nil {\n        fmt.Println(\"err\", err)\n        return\n    }\n    defer file.Close()\n\n    br := bufio.NewReaderSize(reader, 16) // ,\n    ReadLineExample(br)\n    file.Seek(0, 0)  // \n    fmt.Println(\"------\")\n    ReadStringExample(br)\n    file.Seek(0, 0)\n    bw := bufio.NewWriter(file)\n    WriterExample(bw)\n}\n\n// : \n// ,: hello\n// ,: the second line:\n// ,:  nice to meet yo\n// ,: u\n// ,: the third line: \n// ,: see you next tim\n// ,: e\n// ------\n// hello\n// the second line: nice to meet you\n// the third line: see you next time\n```\n:\n- `ReadLine()` ,\n-  \"this new add line\\n\" \n\n## `bufio.Scanner` \n\n- \n```go\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n    const input = \"Now is the winter of our discontent,\\nMade glorious summer by this sun of York.\\n\"\n    scanner := bufio.NewScanner(strings.NewReader(input))\n    scanner.Split(bufio.ScanWords) //  scanner \n    // \n    count := 0\n    for scanner.Scan() {\n        count++\n    }\n    if err := scanner.Err(); err != nil {\n        fmt.Fprintln(os.Stderr, \"reading input:\", err)\n    }\n    fmt.Printf(\"%d\\n\", count)\n}\n```\n\n- \n\n\n\n```go\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    const input = \"1234 5678 5681 1234567890123456\"\n    scanner := bufio.NewScanner(strings.NewReader(input))\n    // \n    split := func(data []byte, atEOF bool) (advance int, token []byte, err error) {\n        advance, token, err = bufio.ScanWords(data, atEOF)  //  token\n        if err == nil && token != nil {\n            _, err = strconv.ParseInt(string(token), 10, 32)  // \n        }\n        return\n    }\n    //  split\n    scanner.Split(split)\n    // ,\n    for scanner.Scan() {\n        fmt.Printf(\"%s\\n\", scanner.Text())\n    }\n    if err := scanner.Err(); err != nil {\n        fmt.Printf(\"Invalid input: %s\", err)\n    }\n}\n```","slug":"go-study-notes-package-bufio","published":1,"date":"2020-05-02T09:10:07.050Z","updated":"2020-05-05T13:42:35.179Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihv8000ok8u715dl9fsl","content":"<p><code>bufio</code>  IO.  <code>io.Reader()</code>  <code>io.Writer()</code>  <code>Reader</code>  <code>Writer</code>, IO  IO . <code>import &quot;bufio&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Reader  `io.Reader` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Reader <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Writer  `io.Writer` .</span></span><br><span class=\"line\"><span class=\"comment\">//  Writer ,, `Flush()`` </span></span><br><span class=\"line\"><span class=\"comment\">// , `Flush()`  `io.Writer`</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Writer <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ReadWriter <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    *Reader</span><br><span class=\"line\">    *Writer</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Scanner ,.</span></span><br><span class=\"line\"><span class=\"comment\">//  `Scan()`  'token'(), token .token  `SplitFunc` .,.</span></span><br><span class=\"line\"><span class=\"comment\">// ,,unicode, word.</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">//  token , reader , `bufio.Reader`</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Scanner <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Scanner </span></span><br><span class=\"line\"><span class=\"comment\">// ,(token)</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> SplitFunc <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    <span class=\"comment\">//  token, token ,</span></span><br><span class=\"line\">    MaxScanTokenSize = <span class=\"number\">64</span> * <span class=\"number\">1024</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"bufio-\"><a href=\"#bufio-\" class=\"headerlink\" title=\"bufio \"></a><code>bufio</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `Reader` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReader</span><span class=\"params\">(rd io.Reader)</span> *<span class=\"title\">Reader</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Reader` , 4096, 16</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReaderSize</span><span class=\"params\">(rd io.Reader, size <span class=\"keyword\">int</span>)</span> *<span class=\"title\">Reader</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Writer` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewWriter</span><span class=\"params\">(w io.Writer)</span> *<span class=\"title\">Writer</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Writer` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewWriterSize</span><span class=\"params\">(w io.Writer, size <span class=\"keyword\">int</span>)</span> *<span class=\"title\">Writer</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Reader,Writer  ReadWriter  </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReadWriter</span><span class=\"params\">(r *Reader, w *Writer)</span> *<span class=\"title\">ReadWriter</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  `scanner.Split()` , Scanner </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ScanBytes</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  runes  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ScanRunes</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  token,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ScanWords</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  token, '\\n'</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ScanLines</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Reader-\"><a href=\"#Reader-\" class=\"headerlink\" title=\"Reader \"></a><code>Reader</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,, b  r </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">Reset</span><span class=\"params\">(r io.Reader)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">Buffered</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  n .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">Peek</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  p. p .,n  0  err  io.EOF</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">Read</span><span class=\"params\">(p []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">ReadByte</span><span class=\"params\">()</span> <span class=\"params\">(c <span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// , byte (),</span></span><br><span class=\"line\"><span class=\"comment\">// ,, isPrefix  true.,,isPrefix  false</span></span><br><span class=\"line\"><span class=\"comment\">//  `ReadBytes('\\n')`  `ReadString('\\n')` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">ReadLine</span><span class=\"params\">()</span> <span class=\"params\">(line []<span class=\"keyword\">byte</span>, isPrefix <span class=\"keyword\">bool</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  delim .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">ReadBytes</span><span class=\"params\">(delim <span class=\"keyword\">byte</span>)</span> <span class=\"params\">(line []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  delim .. ReadBytes </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">ReadString</span><span class=\"params\">(delim <span class=\"keyword\">byte</span>)</span> <span class=\"params\">(line <span class=\"keyword\">string</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  w</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">WriteTo</span><span class=\"params\">(w io.Writer)</span> <span class=\"params\">(n <span class=\"keyword\">int64</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Writer-\"><a href=\"#Writer-\" class=\"headerlink\" title=\"Writer \"></a><code>Writer</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">Reset</span><span class=\"params\">(w io.Writer)</span>  // ,, <span class=\"title\">b</span>  <span class=\"title\">w</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">Buffered</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">Write</span><span class=\"params\">(p []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(nn <span class=\"keyword\">int</span>, err error)</span>  //  <span class=\"title\">p</span> .. <span class=\"title\">nn</span> &lt; <span class=\"title\">len</span><span class=\"params\">(p)</span>,<span class=\"title\">err</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">WriteString</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(<span class=\"keyword\">int</span>, error)</span>  //  <span class=\"title\">s</span> .. <span class=\"title\">nn</span> &lt; <span class=\"title\">len</span><span class=\"params\">(p)</span>,<span class=\"title\">err</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">WriteByte</span><span class=\"params\">(c <span class=\"keyword\">byte</span>)</span> <span class=\"title\">error</span>  //  <span class=\"title\">c</span> ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">Flush</span><span class=\"params\">()</span> <span class=\"title\">error</span>  // .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">ReadFrom</span><span class=\"params\">(r io.Reader)</span> <span class=\"params\">(n <span class=\"keyword\">int64</span>, err error)</span>  //  `<span class=\"title\">io</span>.<span class=\"title\">ReaderFrom</span>` . <span class=\"title\">r</span> </span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Scanner-\"><a href=\"#Scanner-\" class=\"headerlink\" title=\"Scanner \"></a><code>Scanner</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Scanner . `Scan()` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Split</span><span class=\"params\">(split SplitFunc)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  token. Scanner  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Scan</span><span class=\"params\">()</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Scan()`  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Bytes</span><span class=\"params\">()</span> []<span class=\"title\">byte</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Scan()`  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Text</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Scanner </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Err</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>filename</code> :</p>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hello</span><br><span class=\"line\"><span class=\"keyword\">the</span> <span class=\"keyword\">second</span> <span class=\"built_in\">line</span>: nice <span class=\"built_in\">to</span> meet you</span><br><span class=\"line\"><span class=\"keyword\">the</span> <span class=\"keyword\">third</span> <span class=\"built_in\">line</span>: see you next <span class=\"built_in\">time</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"bufio-\"><a href=\"#bufio-\" class=\"headerlink\" title=\"bufio \"></a><code>bufio</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bufio\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// `bufio.Writer.WriteString()` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WriterExample</span><span class=\"params\">(bw *bufio.Writer)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> bw.Flush() <span class=\"comment\">// </span></span><br><span class=\"line\">    bw.WriteString(<span class=\"string\">\"this new add line\\n\"</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// `bufio.Reader.ReadLine()` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadLineExample</span><span class=\"params\">(br *bufio.Reader)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        line, isPrefix, err := br.ReadLine()</span><br><span class=\"line\">        <span class=\"keyword\">if</span> err == io.EOF &#123;</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> isPrefix &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\",: %v\"</span>, <span class=\"keyword\">string</span>(line))</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\",: %v\"</span>, <span class=\"keyword\">string</span>(line))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Println() <span class=\"comment\">// ,</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// `bufio.Reader.ReadString()` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadStringExample</span><span class=\"params\">(br *bufio.Reader)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        line, err := br.ReadString(<span class=\"string\">'\\n'</span>) <span class=\"comment\">//  ReadString </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> err == io.EOF &#123;</span><br><span class=\"line\">            fmt.Print(line) <span class=\"comment\">// ,err  io.EOF,</span></span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Print(line)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    file, err := os.OpenFile(<span class=\"string\">\"filename\"</span>, os.O_RDWR|os.O_CREATE|os.O_APPEND, <span class=\"number\">0</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"err\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> file.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">    br := bufio.NewReaderSize(reader, <span class=\"number\">16</span>) <span class=\"comment\">// ,</span></span><br><span class=\"line\">    ReadLineExample(br)</span><br><span class=\"line\">    file.Seek(<span class=\"number\">0</span>, <span class=\"number\">0</span>)  <span class=\"comment\">// </span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"------\"</span>)</span><br><span class=\"line\">    ReadStringExample(br)</span><br><span class=\"line\">    file.Seek(<span class=\"number\">0</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">    bw := bufio.NewWriter(file)</span><br><span class=\"line\">    WriterExample(bw)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// : </span></span><br><span class=\"line\"><span class=\"comment\">// ,: hello</span></span><br><span class=\"line\"><span class=\"comment\">// ,: the second line:</span></span><br><span class=\"line\"><span class=\"comment\">// ,:  nice to meet yo</span></span><br><span class=\"line\"><span class=\"comment\">// ,: u</span></span><br><span class=\"line\"><span class=\"comment\">// ,: the third line: </span></span><br><span class=\"line\"><span class=\"comment\">// ,: see you next tim</span></span><br><span class=\"line\"><span class=\"comment\">// ,: e</span></span><br><span class=\"line\"><span class=\"comment\">// ------</span></span><br><span class=\"line\"><span class=\"comment\">// hello</span></span><br><span class=\"line\"><span class=\"comment\">// the second line: nice to meet you</span></span><br><span class=\"line\"><span class=\"comment\">// the third line: see you next time</span></span><br></pre></td></tr></table></figure>\n<p>:</p>\n<ul>\n<li><code>ReadLine()</code> ,</li>\n<li> this new add line\\n </li>\n</ul>\n<h2 id=\"bufio-Scanner-\"><a href=\"#bufio-Scanner-\" class=\"headerlink\" title=\"bufio.Scanner \"></a><code>bufio.Scanner</code> </h2><ul>\n<li><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bufio\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strings\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> input = <span class=\"string\">\"Now is the winter of our discontent,\\nMade glorious summer by this sun of York.\\n\"</span></span><br><span class=\"line\">    scanner := bufio.NewScanner(strings.NewReader(input))</span><br><span class=\"line\">    scanner.Split(bufio.ScanWords) <span class=\"comment\">//  scanner </span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    count := <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> scanner.Scan() &#123;</span><br><span class=\"line\">        count++</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err := scanner.Err(); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintln(os.Stderr, <span class=\"string\">\"reading input:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%d\\n\"</span>, count)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bufio\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strconv\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strings\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> input = <span class=\"string\">\"1234 5678 5681 1234567890123456\"</span></span><br><span class=\"line\">    scanner := bufio.NewScanner(strings.NewReader(input))</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    split := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span> &#123;</span><br><span class=\"line\">        advance, token, err = bufio.ScanWords(data, atEOF)  <span class=\"comment\">//  token</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> err == <span class=\"literal\">nil</span> &amp;&amp; token != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            _, err = strconv.ParseInt(<span class=\"keyword\">string</span>(token), <span class=\"number\">10</span>, <span class=\"number\">32</span>)  <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  split</span></span><br><span class=\"line\">    scanner.Split(split)</span><br><span class=\"line\">    <span class=\"comment\">// ,</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> scanner.Scan() &#123;</span><br><span class=\"line\">        fmt.Printf(<span class=\"string\">\"%s\\n\"</span>, scanner.Text())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err := scanner.Err(); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Printf(<span class=\"string\">\"Invalid input: %s\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>bufio</code>  IO.  <code>io.Reader()</code>  <code>io.Writer()</code>  <code>Reader</code>  <code>Writer</code>, IO  IO . <code>import &quot;bufio&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Reader  `io.Reader` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Reader <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Writer  `io.Writer` .</span></span><br><span class=\"line\"><span class=\"comment\">//  Writer ,, `Flush()`` </span></span><br><span class=\"line\"><span class=\"comment\">// , `Flush()`  `io.Writer`</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Writer <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ReadWriter <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    *Reader</span><br><span class=\"line\">    *Writer</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Scanner ,.</span></span><br><span class=\"line\"><span class=\"comment\">//  `Scan()`  'token'(), token .token  `SplitFunc` .,.</span></span><br><span class=\"line\"><span class=\"comment\">// ,,unicode, word.</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">//  token , reader , `bufio.Reader`</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Scanner <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Scanner </span></span><br><span class=\"line\"><span class=\"comment\">// ,(token)</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> SplitFunc <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    <span class=\"comment\">//  token, token ,</span></span><br><span class=\"line\">    MaxScanTokenSize = <span class=\"number\">64</span> * <span class=\"number\">1024</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"bufio-\"><a href=\"#bufio-\" class=\"headerlink\" title=\"bufio \"></a><code>bufio</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `Reader` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReader</span><span class=\"params\">(rd io.Reader)</span> *<span class=\"title\">Reader</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Reader` , 4096, 16</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReaderSize</span><span class=\"params\">(rd io.Reader, size <span class=\"keyword\">int</span>)</span> *<span class=\"title\">Reader</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Writer` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewWriter</span><span class=\"params\">(w io.Writer)</span> *<span class=\"title\">Writer</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Writer` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewWriterSize</span><span class=\"params\">(w io.Writer, size <span class=\"keyword\">int</span>)</span> *<span class=\"title\">Writer</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Reader,Writer  ReadWriter  </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReadWriter</span><span class=\"params\">(r *Reader, w *Writer)</span> *<span class=\"title\">ReadWriter</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  `scanner.Split()` , Scanner </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ScanBytes</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  runes  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ScanRunes</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  token,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ScanWords</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  token, '\\n'</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ScanLines</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Reader-\"><a href=\"#Reader-\" class=\"headerlink\" title=\"Reader \"></a><code>Reader</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,, b  r </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">Reset</span><span class=\"params\">(r io.Reader)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">Buffered</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  n .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">Peek</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  p. p .,n  0  err  io.EOF</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">Read</span><span class=\"params\">(p []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">ReadByte</span><span class=\"params\">()</span> <span class=\"params\">(c <span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// , byte (),</span></span><br><span class=\"line\"><span class=\"comment\">// ,, isPrefix  true.,,isPrefix  false</span></span><br><span class=\"line\"><span class=\"comment\">//  `ReadBytes('\\n')`  `ReadString('\\n')` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">ReadLine</span><span class=\"params\">()</span> <span class=\"params\">(line []<span class=\"keyword\">byte</span>, isPrefix <span class=\"keyword\">bool</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  delim .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">ReadBytes</span><span class=\"params\">(delim <span class=\"keyword\">byte</span>)</span> <span class=\"params\">(line []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  delim .. ReadBytes </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">ReadString</span><span class=\"params\">(delim <span class=\"keyword\">byte</span>)</span> <span class=\"params\">(line <span class=\"keyword\">string</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  w</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Reader)</span> <span class=\"title\">WriteTo</span><span class=\"params\">(w io.Writer)</span> <span class=\"params\">(n <span class=\"keyword\">int64</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Writer-\"><a href=\"#Writer-\" class=\"headerlink\" title=\"Writer \"></a><code>Writer</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">Reset</span><span class=\"params\">(w io.Writer)</span>  // ,, <span class=\"title\">b</span>  <span class=\"title\">w</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">Buffered</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">Write</span><span class=\"params\">(p []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(nn <span class=\"keyword\">int</span>, err error)</span>  //  <span class=\"title\">p</span> .. <span class=\"title\">nn</span> &lt; <span class=\"title\">len</span><span class=\"params\">(p)</span>,<span class=\"title\">err</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">WriteString</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(<span class=\"keyword\">int</span>, error)</span>  //  <span class=\"title\">s</span> .. <span class=\"title\">nn</span> &lt; <span class=\"title\">len</span><span class=\"params\">(p)</span>,<span class=\"title\">err</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">WriteByte</span><span class=\"params\">(c <span class=\"keyword\">byte</span>)</span> <span class=\"title\">error</span>  //  <span class=\"title\">c</span> ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">Flush</span><span class=\"params\">()</span> <span class=\"title\">error</span>  // .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(b *Writer)</span> <span class=\"title\">ReadFrom</span><span class=\"params\">(r io.Reader)</span> <span class=\"params\">(n <span class=\"keyword\">int64</span>, err error)</span>  //  `<span class=\"title\">io</span>.<span class=\"title\">ReaderFrom</span>` . <span class=\"title\">r</span> </span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Scanner-\"><a href=\"#Scanner-\" class=\"headerlink\" title=\"Scanner \"></a><code>Scanner</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Scanner . `Scan()` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Split</span><span class=\"params\">(split SplitFunc)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  token. Scanner  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Scan</span><span class=\"params\">()</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Scan()`  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Bytes</span><span class=\"params\">()</span> []<span class=\"title\">byte</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Scan()`  token</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Text</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Scanner </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Scanner)</span> <span class=\"title\">Err</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>filename</code> :</p>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hello</span><br><span class=\"line\"><span class=\"keyword\">the</span> <span class=\"keyword\">second</span> <span class=\"built_in\">line</span>: nice <span class=\"built_in\">to</span> meet you</span><br><span class=\"line\"><span class=\"keyword\">the</span> <span class=\"keyword\">third</span> <span class=\"built_in\">line</span>: see you next <span class=\"built_in\">time</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"bufio-\"><a href=\"#bufio-\" class=\"headerlink\" title=\"bufio \"></a><code>bufio</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bufio\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// `bufio.Writer.WriteString()` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WriterExample</span><span class=\"params\">(bw *bufio.Writer)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> bw.Flush() <span class=\"comment\">// </span></span><br><span class=\"line\">    bw.WriteString(<span class=\"string\">\"this new add line\\n\"</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// `bufio.Reader.ReadLine()` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadLineExample</span><span class=\"params\">(br *bufio.Reader)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        line, isPrefix, err := br.ReadLine()</span><br><span class=\"line\">        <span class=\"keyword\">if</span> err == io.EOF &#123;</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> isPrefix &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\",: %v\"</span>, <span class=\"keyword\">string</span>(line))</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\",: %v\"</span>, <span class=\"keyword\">string</span>(line))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Println() <span class=\"comment\">// ,</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// `bufio.Reader.ReadString()` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadStringExample</span><span class=\"params\">(br *bufio.Reader)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        line, err := br.ReadString(<span class=\"string\">'\\n'</span>) <span class=\"comment\">//  ReadString </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> err == io.EOF &#123;</span><br><span class=\"line\">            fmt.Print(line) <span class=\"comment\">// ,err  io.EOF,</span></span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Print(line)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    file, err := os.OpenFile(<span class=\"string\">\"filename\"</span>, os.O_RDWR|os.O_CREATE|os.O_APPEND, <span class=\"number\">0</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"err\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> file.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">    br := bufio.NewReaderSize(reader, <span class=\"number\">16</span>) <span class=\"comment\">// ,</span></span><br><span class=\"line\">    ReadLineExample(br)</span><br><span class=\"line\">    file.Seek(<span class=\"number\">0</span>, <span class=\"number\">0</span>)  <span class=\"comment\">// </span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"------\"</span>)</span><br><span class=\"line\">    ReadStringExample(br)</span><br><span class=\"line\">    file.Seek(<span class=\"number\">0</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">    bw := bufio.NewWriter(file)</span><br><span class=\"line\">    WriterExample(bw)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// : </span></span><br><span class=\"line\"><span class=\"comment\">// ,: hello</span></span><br><span class=\"line\"><span class=\"comment\">// ,: the second line:</span></span><br><span class=\"line\"><span class=\"comment\">// ,:  nice to meet yo</span></span><br><span class=\"line\"><span class=\"comment\">// ,: u</span></span><br><span class=\"line\"><span class=\"comment\">// ,: the third line: </span></span><br><span class=\"line\"><span class=\"comment\">// ,: see you next tim</span></span><br><span class=\"line\"><span class=\"comment\">// ,: e</span></span><br><span class=\"line\"><span class=\"comment\">// ------</span></span><br><span class=\"line\"><span class=\"comment\">// hello</span></span><br><span class=\"line\"><span class=\"comment\">// the second line: nice to meet you</span></span><br><span class=\"line\"><span class=\"comment\">// the third line: see you next time</span></span><br></pre></td></tr></table></figure>\n<p>:</p>\n<ul>\n<li><code>ReadLine()</code> ,</li>\n<li> this new add line\\n </li>\n</ul>\n<h2 id=\"bufio-Scanner-\"><a href=\"#bufio-Scanner-\" class=\"headerlink\" title=\"bufio.Scanner \"></a><code>bufio.Scanner</code> </h2><ul>\n<li><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bufio\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strings\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> input = <span class=\"string\">\"Now is the winter of our discontent,\\nMade glorious summer by this sun of York.\\n\"</span></span><br><span class=\"line\">    scanner := bufio.NewScanner(strings.NewReader(input))</span><br><span class=\"line\">    scanner.Split(bufio.ScanWords) <span class=\"comment\">//  scanner </span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    count := <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> scanner.Scan() &#123;</span><br><span class=\"line\">        count++</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err := scanner.Err(); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintln(os.Stderr, <span class=\"string\">\"reading input:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%d\\n\"</span>, count)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bufio\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strconv\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strings\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> input = <span class=\"string\">\"1234 5678 5681 1234567890123456\"</span></span><br><span class=\"line\">    scanner := bufio.NewScanner(strings.NewReader(input))</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    split := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, atEOF <span class=\"keyword\">bool</span>)</span> <span class=\"params\">(advance <span class=\"keyword\">int</span>, token []<span class=\"keyword\">byte</span>, err error)</span></span> &#123;</span><br><span class=\"line\">        advance, token, err = bufio.ScanWords(data, atEOF)  <span class=\"comment\">//  token</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> err == <span class=\"literal\">nil</span> &amp;&amp; token != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            _, err = strconv.ParseInt(<span class=\"keyword\">string</span>(token), <span class=\"number\">10</span>, <span class=\"number\">32</span>)  <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  split</span></span><br><span class=\"line\">    scanner.Split(split)</span><br><span class=\"line\">    <span class=\"comment\">// ,</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> scanner.Scan() &#123;</span><br><span class=\"line\">        fmt.Printf(<span class=\"string\">\"%s\\n\"</span>, scanner.Text())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err := scanner.Err(); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Printf(<span class=\"string\">\"Invalid input: %s\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go  context ","abbrlink":2915,"description":" Go context .context  Context , API ,.","_content":"\ncontext  Context , API ,. `import context`\n\n `Context` ,. `Context`, `WithCancel`, `WithDeadline`,`WithTimeout`  `WithValue` .,\n\n>  Go http  Server , goroutine . goroutine , RPC . goroutine ,, token,., goroutine , goroutine \n\n`WithCancel`,`WithDeadline`  `WithTimeout`  Context(parent) `Context`(child) `CancelFunc`. `CancelFunc` , parent  child ,.\n\n# \n\n Contexts ,:\n\n- ,. Context , `ctx`:\n```go\nfunc DoSomething(ctx context.Context, arg Arg) error {\n    // ... use ctx ...\n}\n```\n- , nil ., `context.TODO`\n-  API ,\n-  goroutine . goroutine \n\n\n# \n\n```go\n// ,. goroutine  CancelFunc,,\ntype CancelFunc func()\n\n// \ntype Context interface {\n    // ., ok  false\n    Deadline() (deadline time.Time, ok bool)\n    // \n    Done() <-chan struct{}\n    //  Done() , nil. nil ,\n    Err() error\n    //  key . nil\n    Value(key interface{}) interface{}\n}\n```\n\n# \n\n```go\n//  Done  parent .\n//  cancel  parent  Done , Done \nfunc WithCancel(parent Context) (ctx Context, cancel CancelFunc) \n\n//  parent \n//  parent  d, parent.\n// , cancel  parent  Done , Done \nfunc WithDeadline(parent Context, d time.Time) (Context, CancelFunc)  \n\n//  WithDeadline(parent, time.Now().Add(timeout)), parent \nfunc WithTimeout(parent Context, timeout time.Duration) (Context, CancelFunc)\n\n//  Context ,.,,\nfunc Background() Context  \n\n//  Context ,, `context.TODO`\nfunc func TODO() Context  \n\n//  parent , key=val \nfunc WithValue(parent Context, key, val interface{}) Context  \n```\n\n","source":"_posts/go-study-notes-package-context.md","raw":"---\ntitle: go  context \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 2915\ndescription: >-\n   Go context .context  Context , API\n  ,.\n---\n\ncontext  Context , API ,. `import context`\n\n `Context` ,. `Context`, `WithCancel`, `WithDeadline`,`WithTimeout`  `WithValue` .,\n\n>  Go http  Server , goroutine . goroutine , RPC . goroutine ,, token,., goroutine , goroutine \n\n`WithCancel`,`WithDeadline`  `WithTimeout`  Context(parent) `Context`(child) `CancelFunc`. `CancelFunc` , parent  child ,.\n\n# \n\n Contexts ,:\n\n- ,. Context , `ctx`:\n```go\nfunc DoSomething(ctx context.Context, arg Arg) error {\n    // ... use ctx ...\n}\n```\n- , nil ., `context.TODO`\n-  API ,\n-  goroutine . goroutine \n\n\n# \n\n```go\n// ,. goroutine  CancelFunc,,\ntype CancelFunc func()\n\n// \ntype Context interface {\n    // ., ok  false\n    Deadline() (deadline time.Time, ok bool)\n    // \n    Done() <-chan struct{}\n    //  Done() , nil. nil ,\n    Err() error\n    //  key . nil\n    Value(key interface{}) interface{}\n}\n```\n\n# \n\n```go\n//  Done  parent .\n//  cancel  parent  Done , Done \nfunc WithCancel(parent Context) (ctx Context, cancel CancelFunc) \n\n//  parent \n//  parent  d, parent.\n// , cancel  parent  Done , Done \nfunc WithDeadline(parent Context, d time.Time) (Context, CancelFunc)  \n\n//  WithDeadline(parent, time.Now().Add(timeout)), parent \nfunc WithTimeout(parent Context, timeout time.Duration) (Context, CancelFunc)\n\n//  Context ,.,,\nfunc Background() Context  \n\n//  Context ,, `context.TODO`\nfunc func TODO() Context  \n\n//  parent , key=val \nfunc WithValue(parent Context, key, val interface{}) Context  \n```\n\n","slug":"go-study-notes-package-context","published":1,"date":"2020-05-04T12:26:13.391Z","updated":"2020-05-05T09:21:23.525Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvc000rk8u70i0b1s06","content":"<p>context  Context , API ,. <code>import context</code></p>\n<p> <code>Context</code> ,. <code>Context</code>, <code>WithCancel</code>, <code>WithDeadline</code>,<code>WithTimeout</code>  <code>WithValue</code> .,</p>\n<blockquote>\n<p> Go http  Server , goroutine . goroutine , RPC . goroutine ,, token,., goroutine , goroutine </p>\n</blockquote>\n<p><code>WithCancel</code>,<code>WithDeadline</code>  <code>WithTimeout</code>  Context(parent) <code>Context</code>(child) <code>CancelFunc</code>. <code>CancelFunc</code> , parent  child ,.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Contexts ,:</p>\n<ul>\n<li>,. Context , <code>ctx</code>:<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DoSomething</span><span class=\"params\">(ctx context.Context, arg Arg)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ... use ctx ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>, nil ., <code>context.TODO</code></li>\n<li> API ,</li>\n<li> goroutine . goroutine </li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,. goroutine  CancelFunc,,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> CancelFunc <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Context <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ., ok  false</span></span><br><span class=\"line\">    Deadline() (deadline time.Time, ok <span class=\"keyword\">bool</span>)</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Done() &lt;-<span class=\"keyword\">chan</span> <span class=\"keyword\">struct</span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">//  Done() , nil. nil ,</span></span><br><span class=\"line\">    Err() error</span><br><span class=\"line\">    <span class=\"comment\">//  key . nil</span></span><br><span class=\"line\">    Value(key <span class=\"keyword\">interface</span>&#123;&#125;) <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Done  parent .</span></span><br><span class=\"line\"><span class=\"comment\">//  cancel  parent  Done , Done </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WithCancel</span><span class=\"params\">(parent Context)</span> <span class=\"params\">(ctx Context, cancel CancelFunc)</span></span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  parent </span></span><br><span class=\"line\"><span class=\"comment\">//  parent  d, parent.</span></span><br><span class=\"line\"><span class=\"comment\">// , cancel  parent  Done , Done </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WithDeadline</span><span class=\"params\">(parent Context, d time.Time)</span> <span class=\"params\">(Context, CancelFunc)</span></span>  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  WithDeadline(parent, time.Now().Add(timeout)), parent </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WithTimeout</span><span class=\"params\">(parent Context, timeout time.Duration)</span> <span class=\"params\">(Context, CancelFunc)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Context ,.,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Background</span><span class=\"params\">()</span> <span class=\"title\">Context</span></span>  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Context ,, `context.TODO`</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">func</span> <span class=\"title\">TODO</span><span class=\"params\">()</span> <span class=\"title\">Context</span></span>  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  parent , key=val </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WithValue</span><span class=\"params\">(parent Context, key, val <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">Context</span></span></span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<p>context  Context , API ,. <code>import context</code></p>\n<p> <code>Context</code> ,. <code>Context</code>, <code>WithCancel</code>, <code>WithDeadline</code>,<code>WithTimeout</code>  <code>WithValue</code> .,</p>\n<blockquote>\n<p> Go http  Server , goroutine . goroutine , RPC . goroutine ,, token,., goroutine , goroutine </p>\n</blockquote>\n<p><code>WithCancel</code>,<code>WithDeadline</code>  <code>WithTimeout</code>  Context(parent) <code>Context</code>(child) <code>CancelFunc</code>. <code>CancelFunc</code> , parent  child ,.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Contexts ,:</p>\n<ul>\n<li>,. Context , <code>ctx</code>:<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DoSomething</span><span class=\"params\">(ctx context.Context, arg Arg)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ... use ctx ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>, nil ., <code>context.TODO</code></li>\n<li> API ,</li>\n<li> goroutine . goroutine </li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,. goroutine  CancelFunc,,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> CancelFunc <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Context <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ., ok  false</span></span><br><span class=\"line\">    Deadline() (deadline time.Time, ok <span class=\"keyword\">bool</span>)</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Done() &lt;-<span class=\"keyword\">chan</span> <span class=\"keyword\">struct</span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">//  Done() , nil. nil ,</span></span><br><span class=\"line\">    Err() error</span><br><span class=\"line\">    <span class=\"comment\">//  key . nil</span></span><br><span class=\"line\">    Value(key <span class=\"keyword\">interface</span>&#123;&#125;) <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Done  parent .</span></span><br><span class=\"line\"><span class=\"comment\">//  cancel  parent  Done , Done </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WithCancel</span><span class=\"params\">(parent Context)</span> <span class=\"params\">(ctx Context, cancel CancelFunc)</span></span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  parent </span></span><br><span class=\"line\"><span class=\"comment\">//  parent  d, parent.</span></span><br><span class=\"line\"><span class=\"comment\">// , cancel  parent  Done , Done </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WithDeadline</span><span class=\"params\">(parent Context, d time.Time)</span> <span class=\"params\">(Context, CancelFunc)</span></span>  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  WithDeadline(parent, time.Now().Add(timeout)), parent </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WithTimeout</span><span class=\"params\">(parent Context, timeout time.Duration)</span> <span class=\"params\">(Context, CancelFunc)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Context ,.,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Background</span><span class=\"params\">()</span> <span class=\"title\">Context</span></span>  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Context ,, `context.TODO`</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">func</span> <span class=\"title\">TODO</span><span class=\"params\">()</span> <span class=\"title\">Context</span></span>  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  parent , key=val </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WithValue</span><span class=\"params\">(parent Context, key, val <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">Context</span></span></span><br></pre></td></tr></table></figure>\n\n"},{"title":"go  encoding ","abbrlink":10194,"description":" Go encoding .encoding ,.","_content":"\n`encoding` ,,:\n\n- `encoding/bash64` bas64 .\n- `encoding/json`  json .\n- `encoding/pem`  PEM , TLS \n- `encoding/xml`  xml \n\n# `encoding/base64` \n\n## \n\n```go\nconst encodeStd = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\nconst encodeURL = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\"\nconst (\n    StdPadding rune = '=' // \n    NoPadding  rune = -1  // \n)\n// \nvar RawStdEncoding = StdEncoding.WithPadding(NoPadding)\n//  URL , URL \nvar RawURLEncoding = URLEncoding.WithPadding(NoPadding)\n// \nvar StdEncoding = NewEncoding(encodeStd)\n//  URL , URL \nvar URLEncoding = NewEncoding(encodeURL)\n```\n\n## \n\n- \n\n```go\n//  Encoding , WithPadding \nfunc NewEncoding(encoder string) *Encoding\n```\n\n- `Encoding` \n\n```go\n//  src , DecodedLen(len(src))  dst\nfunc (enc *Encoding) Decode(dst, src []byte) (n int, err error)\n//  s ,\nfunc (enc *Encoding) DecodeString(s string) ([]byte, error)\n//  src , DecodedLen(len(src))  dst\nfunc (enc *Encoding) Encode(dst, src []byte)\n//  src ,\nfunc (enc *Encoding) EncodeToString(src []byte) string\n// \nfunc (enc Encoding) WithPadding(padding rune) *Encoding\n```\n\n## \n\n```go\nimport (\n\t\"encoding/base64\"\n\t\"fmt\"\n)\n\nfunc main() {\n\tdataForEncoding := []byte(\"string for encoding\")\n\tstrAfterEncode := base64.StdEncoding.EncodeToString(dataForEncoding)\n    fmt.Println(strAfterEncode)\n    \n    strForDecode := \"c29tZSBkYXRhIHdpdGggACBhbmQg77u/\"\n\tdataAfterDecode, err := base64.StdEncoding.DecodeString(strForDecode)\n\tif err != nil {\n\t\tfmt.Println(\"error:\", err)\n\t\treturn\n\t}\n\tfmt.Printf(\"%q\\n\", dataAfterDecode)\n}\n```\n\n# `encoding/json` \n\n`encoding/json`  json . JSON .\n\n```go\n//  JSON \nfunc Marshal(v interface{}) ([]byte, error)\n//  JSON , JSON  prefix , indent ,\nfunc MarshalIndent(v interface{}, prefix, indent string) ([]byte, error)\n//  JSON \nfunc Unmarshal(data []byte, v interface{}) error\n```\n\n, `json: \"jsonField\"` , `jsonField` .:\n\n```go\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"os\"\n)\n\ntype ColorGroup struct {\n\tID     int      `json:\"id\"`\n\tName   string   `json:\"name\"`\n\tColors []string `json:\"colors\"`\n}\n\nfunc main() {\n\tgroup := ColorGroup{\n\t\tID:     1,\n\t\tName:   \"Reds\",\n\t\tColors: []string{\"Crimson\", \"Red\", \"Ruby\", \"Maroon\"},\n\t}\n\tb, err := json.MarshalIndent(group, \"\", \"  \")\n\tif err != nil {\n\t\tfmt.Println(\"error:\", err)\n\t}\n\tos.Stdout.Write(b)\n\tfmt.Println()\n\n\tcolor := []byte(`{\"id\":2,\"name\":\"Greens\",\"colors\":[\"Crimson\",\"Green\"]}`)\n\tvar colorGroup ColorGroup\n\terr = json.Unmarshal(color, &colorGroup)\n\tfmt.Println(colorGroup)\n}\n```\n\n# `encoding/pem` \n\n`pem`  PEM , TLS \n\n```go\n//  PEM ,\n/*\n-----BEGIN Type-----\nHeaders\nbase64-encoded Bytes\n-----END Type-----\n*/\ntype Block struct {\n    Type    string            // The type, taken from the preamble (i.e. \"RSA PRIVATE KEY\").\n    Headers map[string]string // Optional headers.\n    Bytes   []byte            // The decoded bytes of the contents. Typically a DER encoded ASN.1 structure.\n}\n```\n\n```go\n//  b PEM  out\nfunc Encode(out io.Writer, b *Block) error\n//  PEM , Block , TLS \nfunc Decode(data []byte) (p *Block, rest []byte)\n```\n\n\n# `encoding/xml` \n\n `encoding/json` ,`encoding/xml`  xml . xml .\n\n```go\n//  xml \nfunc Marshal(v interface{}) ([]byte, error)\n//  xml , xml  prefix , indent ,\nfunc MarshalIndent(v interface{}, prefix, indent string) ([]byte, error)\n//  xml \nfunc Unmarshal(data []byte, v interface{}) error\n```\n\n, `xml: \"xmlField\"` , `xmlField` .:\n\n```go\nimport (\n\t\"encoding/xml\"\n\t\"fmt\"\n\t\"os\"\n)\n\ntype Address struct {\n\tCity, State string\n}\ntype Person struct {\n\tXMLName   xml.Name `xml:\"person\"`\n\tId        int      `xml:\"id,attr\"`\n\tFirstName string   `xml:\"name>first\"`\n\tLastName  string   `xml:\"name>last\"`\n\tAge       int      `xml:\"age\"`\n\tHeight    float32  `xml:\"height,omitempty\"`\n\tMarried   bool\n\tAddress\n\tComment string `xml:\",comment\"`\n}\n\nfunc main() {\n\tperson := &Person{Id: 13, FirstName: \"John\", LastName: \"Doe\", Age: 42}\n\tperson.Comment = \" Need more details. \"\n\tperson.Address = Address{\"Hanga Roa\", \"Easter Island\"}\n\n\toutput, err := xml.MarshalIndent(person, \"\", \"  \")\n\tif err != nil {\n\t\tfmt.Printf(\"error: %v\\n\", err)\n\t}\n\tos.Stdout.Write(output)\n}\n```\n\n","source":"_posts/go-study-notes-package-encoding.md","raw":"---\ntitle: go  encoding \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 10194\ndescription: ' Go encoding .encoding ,.'\n---\n\n`encoding` ,,:\n\n- `encoding/bash64` bas64 .\n- `encoding/json`  json .\n- `encoding/pem`  PEM , TLS \n- `encoding/xml`  xml \n\n# `encoding/base64` \n\n## \n\n```go\nconst encodeStd = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\nconst encodeURL = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\"\nconst (\n    StdPadding rune = '=' // \n    NoPadding  rune = -1  // \n)\n// \nvar RawStdEncoding = StdEncoding.WithPadding(NoPadding)\n//  URL , URL \nvar RawURLEncoding = URLEncoding.WithPadding(NoPadding)\n// \nvar StdEncoding = NewEncoding(encodeStd)\n//  URL , URL \nvar URLEncoding = NewEncoding(encodeURL)\n```\n\n## \n\n- \n\n```go\n//  Encoding , WithPadding \nfunc NewEncoding(encoder string) *Encoding\n```\n\n- `Encoding` \n\n```go\n//  src , DecodedLen(len(src))  dst\nfunc (enc *Encoding) Decode(dst, src []byte) (n int, err error)\n//  s ,\nfunc (enc *Encoding) DecodeString(s string) ([]byte, error)\n//  src , DecodedLen(len(src))  dst\nfunc (enc *Encoding) Encode(dst, src []byte)\n//  src ,\nfunc (enc *Encoding) EncodeToString(src []byte) string\n// \nfunc (enc Encoding) WithPadding(padding rune) *Encoding\n```\n\n## \n\n```go\nimport (\n\t\"encoding/base64\"\n\t\"fmt\"\n)\n\nfunc main() {\n\tdataForEncoding := []byte(\"string for encoding\")\n\tstrAfterEncode := base64.StdEncoding.EncodeToString(dataForEncoding)\n    fmt.Println(strAfterEncode)\n    \n    strForDecode := \"c29tZSBkYXRhIHdpdGggACBhbmQg77u/\"\n\tdataAfterDecode, err := base64.StdEncoding.DecodeString(strForDecode)\n\tif err != nil {\n\t\tfmt.Println(\"error:\", err)\n\t\treturn\n\t}\n\tfmt.Printf(\"%q\\n\", dataAfterDecode)\n}\n```\n\n# `encoding/json` \n\n`encoding/json`  json . JSON .\n\n```go\n//  JSON \nfunc Marshal(v interface{}) ([]byte, error)\n//  JSON , JSON  prefix , indent ,\nfunc MarshalIndent(v interface{}, prefix, indent string) ([]byte, error)\n//  JSON \nfunc Unmarshal(data []byte, v interface{}) error\n```\n\n, `json: \"jsonField\"` , `jsonField` .:\n\n```go\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"os\"\n)\n\ntype ColorGroup struct {\n\tID     int      `json:\"id\"`\n\tName   string   `json:\"name\"`\n\tColors []string `json:\"colors\"`\n}\n\nfunc main() {\n\tgroup := ColorGroup{\n\t\tID:     1,\n\t\tName:   \"Reds\",\n\t\tColors: []string{\"Crimson\", \"Red\", \"Ruby\", \"Maroon\"},\n\t}\n\tb, err := json.MarshalIndent(group, \"\", \"  \")\n\tif err != nil {\n\t\tfmt.Println(\"error:\", err)\n\t}\n\tos.Stdout.Write(b)\n\tfmt.Println()\n\n\tcolor := []byte(`{\"id\":2,\"name\":\"Greens\",\"colors\":[\"Crimson\",\"Green\"]}`)\n\tvar colorGroup ColorGroup\n\terr = json.Unmarshal(color, &colorGroup)\n\tfmt.Println(colorGroup)\n}\n```\n\n# `encoding/pem` \n\n`pem`  PEM , TLS \n\n```go\n//  PEM ,\n/*\n-----BEGIN Type-----\nHeaders\nbase64-encoded Bytes\n-----END Type-----\n*/\ntype Block struct {\n    Type    string            // The type, taken from the preamble (i.e. \"RSA PRIVATE KEY\").\n    Headers map[string]string // Optional headers.\n    Bytes   []byte            // The decoded bytes of the contents. Typically a DER encoded ASN.1 structure.\n}\n```\n\n```go\n//  b PEM  out\nfunc Encode(out io.Writer, b *Block) error\n//  PEM , Block , TLS \nfunc Decode(data []byte) (p *Block, rest []byte)\n```\n\n\n# `encoding/xml` \n\n `encoding/json` ,`encoding/xml`  xml . xml .\n\n```go\n//  xml \nfunc Marshal(v interface{}) ([]byte, error)\n//  xml , xml  prefix , indent ,\nfunc MarshalIndent(v interface{}, prefix, indent string) ([]byte, error)\n//  xml \nfunc Unmarshal(data []byte, v interface{}) error\n```\n\n, `xml: \"xmlField\"` , `xmlField` .:\n\n```go\nimport (\n\t\"encoding/xml\"\n\t\"fmt\"\n\t\"os\"\n)\n\ntype Address struct {\n\tCity, State string\n}\ntype Person struct {\n\tXMLName   xml.Name `xml:\"person\"`\n\tId        int      `xml:\"id,attr\"`\n\tFirstName string   `xml:\"name>first\"`\n\tLastName  string   `xml:\"name>last\"`\n\tAge       int      `xml:\"age\"`\n\tHeight    float32  `xml:\"height,omitempty\"`\n\tMarried   bool\n\tAddress\n\tComment string `xml:\",comment\"`\n}\n\nfunc main() {\n\tperson := &Person{Id: 13, FirstName: \"John\", LastName: \"Doe\", Age: 42}\n\tperson.Comment = \" Need more details. \"\n\tperson.Address = Address{\"Hanga Roa\", \"Easter Island\"}\n\n\toutput, err := xml.MarshalIndent(person, \"\", \"  \")\n\tif err != nil {\n\t\tfmt.Printf(\"error: %v\\n\", err)\n\t}\n\tos.Stdout.Write(output)\n}\n```\n\n","slug":"go-study-notes-package-encoding","published":1,"date":"2020-05-15T13:48:12.353Z","updated":"2020-05-22T13:29:06.149Z","_id":"ckab8ihvd000vk8u76tvmhrl9","comments":1,"layout":"post","photos":[],"link":"","content":"<p><code>encoding</code> ,,:</p>\n<ul>\n<li><code>encoding/bash64</code> bas64 .</li>\n<li><code>encoding/json</code>  json .</li>\n<li><code>encoding/pem</code>  PEM , TLS </li>\n<li><code>encoding/xml</code>  xml </li>\n</ul>\n<h1 id=\"encoding-base64-\"><a href=\"#encoding-base64-\" class=\"headerlink\" title=\"encoding/base64 \"></a><code>encoding/base64</code> </h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> encodeStd = <span class=\"string\">\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> encodeURL = <span class=\"string\">\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\"</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    StdPadding <span class=\"keyword\">rune</span> = <span class=\"string\">'='</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    NoPadding  <span class=\"keyword\">rune</span> = <span class=\"number\">-1</span>  <span class=\"comment\">// </span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> RawStdEncoding = StdEncoding.WithPadding(NoPadding)</span><br><span class=\"line\"><span class=\"comment\">//  URL , URL </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> RawURLEncoding = URLEncoding.WithPadding(NoPadding)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> StdEncoding = NewEncoding(encodeStd)</span><br><span class=\"line\"><span class=\"comment\">//  URL , URL </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> URLEncoding = NewEncoding(encodeURL)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Encoding , WithPadding </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewEncoding</span><span class=\"params\">(encoder <span class=\"keyword\">string</span>)</span> *<span class=\"title\">Encoding</span></span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>Encoding</code> </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  src , DecodedLen(len(src))  dst</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc *Encoding)</span> <span class=\"title\">Decode</span><span class=\"params\">(dst, src []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc *Encoding)</span> <span class=\"title\">DecodeString</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  src , DecodedLen(len(src))  dst</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc *Encoding)</span> <span class=\"title\">Encode</span><span class=\"params\">(dst, src []<span class=\"keyword\">byte</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  src ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc *Encoding)</span> <span class=\"title\">EncodeToString</span><span class=\"params\">(src []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc Encoding)</span> <span class=\"title\">WithPadding</span><span class=\"params\">(padding <span class=\"keyword\">rune</span>)</span> *<span class=\"title\">Encoding</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"encoding/base64\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tdataForEncoding := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"string for encoding\"</span>)</span><br><span class=\"line\">\tstrAfterEncode := base64.StdEncoding.EncodeToString(dataForEncoding)</span><br><span class=\"line\">    fmt.Println(strAfterEncode)</span><br><span class=\"line\">    </span><br><span class=\"line\">    strForDecode := <span class=\"string\">\"c29tZSBkYXRhIHdpdGggACBhbmQg77u/\"</span></span><br><span class=\"line\">\tdataAfterDecode, err := base64.StdEncoding.DecodeString(strForDecode)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%q\\n\"</span>, dataAfterDecode)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"encoding-json-\"><a href=\"#encoding-json-\" class=\"headerlink\" title=\"encoding/json \"></a><code>encoding/json</code> </h1><p><code>encoding/json</code>  json . JSON .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  JSON </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Marshal</span><span class=\"params\">(v <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  JSON , JSON  prefix , indent ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">MarshalIndent</span><span class=\"params\">(v <span class=\"keyword\">interface</span>&#123;&#125;, prefix, indent <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  JSON </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Unmarshal</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, v <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<p>, <code>json: &quot;jsonField&quot;</code> , <code>jsonField</code> .:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ColorGroup <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tID     <span class=\"keyword\">int</span>      <span class=\"string\">`json:\"id\"`</span></span><br><span class=\"line\">\tName   <span class=\"keyword\">string</span>   <span class=\"string\">`json:\"name\"`</span></span><br><span class=\"line\">\tColors []<span class=\"keyword\">string</span> <span class=\"string\">`json:\"colors\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tgroup := ColorGroup&#123;</span><br><span class=\"line\">\t\tID:     <span class=\"number\">1</span>,</span><br><span class=\"line\">\t\tName:   <span class=\"string\">\"Reds\"</span>,</span><br><span class=\"line\">\t\tColors: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"Crimson\"</span>, <span class=\"string\">\"Red\"</span>, <span class=\"string\">\"Ruby\"</span>, <span class=\"string\">\"Maroon\"</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tb, err := json.MarshalIndent(group, <span class=\"string\">\"\"</span>, <span class=\"string\">\"  \"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tos.Stdout.Write(b)</span><br><span class=\"line\">\tfmt.Println()</span><br><span class=\"line\"></span><br><span class=\"line\">\tcolor := []<span class=\"keyword\">byte</span>(<span class=\"string\">`&#123;\"id\":2,\"name\":\"Greens\",\"colors\":[\"Crimson\",\"Green\"]&#125;`</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> colorGroup ColorGroup</span><br><span class=\"line\">\terr = json.Unmarshal(color, &amp;colorGroup)</span><br><span class=\"line\">\tfmt.Println(colorGroup)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"encoding-pem-\"><a href=\"#encoding-pem-\" class=\"headerlink\" title=\"encoding/pem \"></a><code>encoding/pem</code> </h1><p><code>pem</code>  PEM , TLS </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  PEM ,</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">-----BEGIN Type-----</span></span><br><span class=\"line\"><span class=\"comment\">Headers</span></span><br><span class=\"line\"><span class=\"comment\">base64-encoded Bytes</span></span><br><span class=\"line\"><span class=\"comment\">-----END Type-----</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Block <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Type    <span class=\"keyword\">string</span>            <span class=\"comment\">// The type, taken from the preamble (i.e. \"RSA PRIVATE KEY\").</span></span><br><span class=\"line\">    Headers <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"comment\">// Optional headers.</span></span><br><span class=\"line\">    Bytes   []<span class=\"keyword\">byte</span>            <span class=\"comment\">// The decoded bytes of the contents. Typically a DER encoded ASN.1 structure.</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  b PEM  out</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Encode</span><span class=\"params\">(out io.Writer, b *Block)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  PEM , Block , TLS </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Decode</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(p *Block, rest []<span class=\"keyword\">byte</span>)</span></span></span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"encoding-xml-\"><a href=\"#encoding-xml-\" class=\"headerlink\" title=\"encoding/xml \"></a><code>encoding/xml</code> </h1><p> <code>encoding/json</code> ,<code>encoding/xml</code>  xml . xml .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  xml </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Marshal</span><span class=\"params\">(v <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  xml , xml  prefix , indent ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">MarshalIndent</span><span class=\"params\">(v <span class=\"keyword\">interface</span>&#123;&#125;, prefix, indent <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  xml </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Unmarshal</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, v <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<p>, <code>xml: &quot;xmlField&quot;</code> , <code>xmlField</code> .:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"encoding/xml\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Address <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tCity, State <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> Person <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tXMLName   xml.Name <span class=\"string\">`xml:\"person\"`</span></span><br><span class=\"line\">\tId        <span class=\"keyword\">int</span>      <span class=\"string\">`xml:\"id,attr\"`</span></span><br><span class=\"line\">\tFirstName <span class=\"keyword\">string</span>   <span class=\"string\">`xml:\"name&gt;first\"`</span></span><br><span class=\"line\">\tLastName  <span class=\"keyword\">string</span>   <span class=\"string\">`xml:\"name&gt;last\"`</span></span><br><span class=\"line\">\tAge       <span class=\"keyword\">int</span>      <span class=\"string\">`xml:\"age\"`</span></span><br><span class=\"line\">\tHeight    <span class=\"keyword\">float32</span>  <span class=\"string\">`xml:\"height,omitempty\"`</span></span><br><span class=\"line\">\tMarried   <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tAddress</span><br><span class=\"line\">\tComment <span class=\"keyword\">string</span> <span class=\"string\">`xml:\",comment\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tperson := &amp;Person&#123;Id: <span class=\"number\">13</span>, FirstName: <span class=\"string\">\"John\"</span>, LastName: <span class=\"string\">\"Doe\"</span>, Age: <span class=\"number\">42</span>&#125;</span><br><span class=\"line\">\tperson.Comment = <span class=\"string\">\" Need more details. \"</span></span><br><span class=\"line\">\tperson.Address = Address&#123;<span class=\"string\">\"Hanga Roa\"</span>, <span class=\"string\">\"Easter Island\"</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\toutput, err := xml.MarshalIndent(person, <span class=\"string\">\"\"</span>, <span class=\"string\">\"  \"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"error: %v\\n\"</span>, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tos.Stdout.Write(output)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<p><code>encoding</code> ,,:</p>\n<ul>\n<li><code>encoding/bash64</code> bas64 .</li>\n<li><code>encoding/json</code>  json .</li>\n<li><code>encoding/pem</code>  PEM , TLS </li>\n<li><code>encoding/xml</code>  xml </li>\n</ul>\n<h1 id=\"encoding-base64-\"><a href=\"#encoding-base64-\" class=\"headerlink\" title=\"encoding/base64 \"></a><code>encoding/base64</code> </h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> encodeStd = <span class=\"string\">\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> encodeURL = <span class=\"string\">\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\"</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    StdPadding <span class=\"keyword\">rune</span> = <span class=\"string\">'='</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    NoPadding  <span class=\"keyword\">rune</span> = <span class=\"number\">-1</span>  <span class=\"comment\">// </span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> RawStdEncoding = StdEncoding.WithPadding(NoPadding)</span><br><span class=\"line\"><span class=\"comment\">//  URL , URL </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> RawURLEncoding = URLEncoding.WithPadding(NoPadding)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> StdEncoding = NewEncoding(encodeStd)</span><br><span class=\"line\"><span class=\"comment\">//  URL , URL </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> URLEncoding = NewEncoding(encodeURL)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Encoding , WithPadding </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewEncoding</span><span class=\"params\">(encoder <span class=\"keyword\">string</span>)</span> *<span class=\"title\">Encoding</span></span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>Encoding</code> </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  src , DecodedLen(len(src))  dst</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc *Encoding)</span> <span class=\"title\">Decode</span><span class=\"params\">(dst, src []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc *Encoding)</span> <span class=\"title\">DecodeString</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  src , DecodedLen(len(src))  dst</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc *Encoding)</span> <span class=\"title\">Encode</span><span class=\"params\">(dst, src []<span class=\"keyword\">byte</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  src ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc *Encoding)</span> <span class=\"title\">EncodeToString</span><span class=\"params\">(src []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(enc Encoding)</span> <span class=\"title\">WithPadding</span><span class=\"params\">(padding <span class=\"keyword\">rune</span>)</span> *<span class=\"title\">Encoding</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"encoding/base64\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tdataForEncoding := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"string for encoding\"</span>)</span><br><span class=\"line\">\tstrAfterEncode := base64.StdEncoding.EncodeToString(dataForEncoding)</span><br><span class=\"line\">    fmt.Println(strAfterEncode)</span><br><span class=\"line\">    </span><br><span class=\"line\">    strForDecode := <span class=\"string\">\"c29tZSBkYXRhIHdpdGggACBhbmQg77u/\"</span></span><br><span class=\"line\">\tdataAfterDecode, err := base64.StdEncoding.DecodeString(strForDecode)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"%q\\n\"</span>, dataAfterDecode)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"encoding-json-\"><a href=\"#encoding-json-\" class=\"headerlink\" title=\"encoding/json \"></a><code>encoding/json</code> </h1><p><code>encoding/json</code>  json . JSON .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  JSON </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Marshal</span><span class=\"params\">(v <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  JSON , JSON  prefix , indent ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">MarshalIndent</span><span class=\"params\">(v <span class=\"keyword\">interface</span>&#123;&#125;, prefix, indent <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  JSON </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Unmarshal</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, v <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<p>, <code>json: &quot;jsonField&quot;</code> , <code>jsonField</code> .:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ColorGroup <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tID     <span class=\"keyword\">int</span>      <span class=\"string\">`json:\"id\"`</span></span><br><span class=\"line\">\tName   <span class=\"keyword\">string</span>   <span class=\"string\">`json:\"name\"`</span></span><br><span class=\"line\">\tColors []<span class=\"keyword\">string</span> <span class=\"string\">`json:\"colors\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tgroup := ColorGroup&#123;</span><br><span class=\"line\">\t\tID:     <span class=\"number\">1</span>,</span><br><span class=\"line\">\t\tName:   <span class=\"string\">\"Reds\"</span>,</span><br><span class=\"line\">\t\tColors: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"Crimson\"</span>, <span class=\"string\">\"Red\"</span>, <span class=\"string\">\"Ruby\"</span>, <span class=\"string\">\"Maroon\"</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tb, err := json.MarshalIndent(group, <span class=\"string\">\"\"</span>, <span class=\"string\">\"  \"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tos.Stdout.Write(b)</span><br><span class=\"line\">\tfmt.Println()</span><br><span class=\"line\"></span><br><span class=\"line\">\tcolor := []<span class=\"keyword\">byte</span>(<span class=\"string\">`&#123;\"id\":2,\"name\":\"Greens\",\"colors\":[\"Crimson\",\"Green\"]&#125;`</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> colorGroup ColorGroup</span><br><span class=\"line\">\terr = json.Unmarshal(color, &amp;colorGroup)</span><br><span class=\"line\">\tfmt.Println(colorGroup)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"encoding-pem-\"><a href=\"#encoding-pem-\" class=\"headerlink\" title=\"encoding/pem \"></a><code>encoding/pem</code> </h1><p><code>pem</code>  PEM , TLS </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  PEM ,</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">-----BEGIN Type-----</span></span><br><span class=\"line\"><span class=\"comment\">Headers</span></span><br><span class=\"line\"><span class=\"comment\">base64-encoded Bytes</span></span><br><span class=\"line\"><span class=\"comment\">-----END Type-----</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Block <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Type    <span class=\"keyword\">string</span>            <span class=\"comment\">// The type, taken from the preamble (i.e. \"RSA PRIVATE KEY\").</span></span><br><span class=\"line\">    Headers <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"comment\">// Optional headers.</span></span><br><span class=\"line\">    Bytes   []<span class=\"keyword\">byte</span>            <span class=\"comment\">// The decoded bytes of the contents. Typically a DER encoded ASN.1 structure.</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  b PEM  out</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Encode</span><span class=\"params\">(out io.Writer, b *Block)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  PEM , Block , TLS </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Decode</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(p *Block, rest []<span class=\"keyword\">byte</span>)</span></span></span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"encoding-xml-\"><a href=\"#encoding-xml-\" class=\"headerlink\" title=\"encoding/xml \"></a><code>encoding/xml</code> </h1><p> <code>encoding/json</code> ,<code>encoding/xml</code>  xml . xml .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  xml </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Marshal</span><span class=\"params\">(v <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  xml , xml  prefix , indent ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">MarshalIndent</span><span class=\"params\">(v <span class=\"keyword\">interface</span>&#123;&#125;, prefix, indent <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  xml </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Unmarshal</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>, v <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<p>, <code>xml: &quot;xmlField&quot;</code> , <code>xmlField</code> .:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"encoding/xml\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Address <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tCity, State <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> Person <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tXMLName   xml.Name <span class=\"string\">`xml:\"person\"`</span></span><br><span class=\"line\">\tId        <span class=\"keyword\">int</span>      <span class=\"string\">`xml:\"id,attr\"`</span></span><br><span class=\"line\">\tFirstName <span class=\"keyword\">string</span>   <span class=\"string\">`xml:\"name&gt;first\"`</span></span><br><span class=\"line\">\tLastName  <span class=\"keyword\">string</span>   <span class=\"string\">`xml:\"name&gt;last\"`</span></span><br><span class=\"line\">\tAge       <span class=\"keyword\">int</span>      <span class=\"string\">`xml:\"age\"`</span></span><br><span class=\"line\">\tHeight    <span class=\"keyword\">float32</span>  <span class=\"string\">`xml:\"height,omitempty\"`</span></span><br><span class=\"line\">\tMarried   <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tAddress</span><br><span class=\"line\">\tComment <span class=\"keyword\">string</span> <span class=\"string\">`xml:\",comment\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tperson := &amp;Person&#123;Id: <span class=\"number\">13</span>, FirstName: <span class=\"string\">\"John\"</span>, LastName: <span class=\"string\">\"Doe\"</span>, Age: <span class=\"number\">42</span>&#125;</span><br><span class=\"line\">\tperson.Comment = <span class=\"string\">\" Need more details. \"</span></span><br><span class=\"line\">\tperson.Address = Address&#123;<span class=\"string\">\"Hanga Roa\"</span>, <span class=\"string\">\"Easter Island\"</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\toutput, err := xml.MarshalIndent(person, <span class=\"string\">\"\"</span>, <span class=\"string\">\"  \"</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"error: %v\\n\"</span>, err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tos.Stdout.Write(output)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"go  crypto ","abbrlink":16535,"description":" Go crypto .crypto .","_content":"\n# `crypto `\n\ncrypto ,. `import \"crypto\"`.\n\n.\n\n- : , AES,DES()\n- : , RSA\n- : ,,,,, MD5,SHA1,HMAC \n\n## \n\n\n\n```go\n// Decrypter ,. RSA \ntype Decrypter interface {\n    // \n    Public() PublicKey\n    //  msg.opts .\n    Decrypt(rand io.Reader, msg []byte, opts DecrypterOpts) (plaintext []byte, err error)\n}\n\ntype DecrypterOpts interface{}\n\n// Hash \ntype Hash uint\n\n// \ntype PrivateKey interface{}\n\n// \ntype PublicKey interface{}\n\n// Signer ,.\ntype Signer interface {\n    // \n    Public() PublicKey\n\n    //  digest \n    Sign(rand io.Reader, digest []byte, opts SignerOpts) (signature []byte, err error)\n}\n\n//  Signer \ntype SignerOpts interface {\n    //  `Signer.Sign` ,\n    HashFunc() Hash\n}\n```\n\n## \n\n```go\nconst (\n    MD4         Hash = 1 + iota // import golang.org/x/crypto/md4\n    MD5                         // import crypto/md5\n    SHA1                        // import crypto/sha1\n    SHA224                      // import crypto/sha256\n    SHA256                      // import crypto/sha256\n    SHA384                      // import crypto/sha512\n    SHA512                      // import crypto/sha512\n    MD5SHA1                     // no implementation; MD5+SHA1 used for TLS RSA\n    RIPEMD160                   // import golang.org/x/crypto/ripemd160\n    SHA3_224                    // import golang.org/x/crypto/sha3\n    SHA3_256                    // import golang.org/x/crypto/sha3\n    SHA3_384                    // import golang.org/x/crypto/sha3\n    SHA3_512                    // import golang.org/x/crypto/sha3\n    SHA512_224                  // import crypto/sha512\n    SHA512_256                  // import crypto/sha512\n    BLAKE2s_256                 // import golang.org/x/crypto/blake2s\n    BLAKE2b_256                 // import golang.org/x/crypto/blake2b\n    BLAKE2b_384                 // import golang.org/x/crypto/blake2b\n    BLAKE2b_512                 // import golang.org/x/crypto/blake2b\n)\n```\n\n## \n\n,\n\n | \n:--- | :---\naes |  AES\ncipher | (CBC,ECB ),\ndes | (DES)(TDEA)\ndsa |  FIPS 186-3 \necdsa |  FIPS 186-3 \ned25519 |  ED25519\nelliptic | \nhmac |  Keyed-Hash \nmd5 |  RFC 1321  MD5 \nrand | \nrc4 |  RC4 \nrsa |  PKCS#1  RSA \nsha1 |  RFC 3174  SHA-1 \nsha256 |  FIPS 180-4  SHA224  SHA256 \nsha512 |  FIPS 180-4  SHA-384, SHA-512, SHA-512/224  SHA-512/256 \ntls |  RFC 5246  TLS 1.2  RFC 8446  TLS 1.3\nx509 |  X.509 \nx509/pkix | X.509,CRL  OCSP  ASN.1 \n\n# `crypto/aes`\n\naes  AES . `import \"crypto/aes\"`\n\n## \n\n```go\n// AES .\nconst BlockSize = 16\n```\n\n## \n\n```go\n//  `cipher.Block`\n//  key  AES , 16,24  32  AES-128, AES-192  AES-256 \nfunc NewCipher(key []byte) (cipher.Block, error)\n```\n\n# `crypto/cipher`\n\ncipher (CBC,ECB ),. `import \"crypto/cipher\"`\n\n## \n\n```go\n// AEAD ,\ntype AEAD interface {\n    //  Seal  Open \n    NonceSize() int\n    // \n    Overhead() int\n\n    // ,\n    // ,nonce  NonceSize() \n    // ,nonce\n    Seal(dst, nonce, plaintext, additionalData []byte) []byte\n\n    // ,\n    // ,nonce  NonceSize() \n    // ,nonce\n    Open(dst, nonce, ciphertext, additionalData []byte) ([]byte, error)\n}\n\n// ..\ntype Block interface {\n    // \n    BlockSize() int\n    //  src  dst. dst  src \n    Encrypt(dst, src []byte)\n    //  src  dst. dst  src \n    Decrypt(dst, src []byte)\n}\n\n// \ntype BlockMode interface {\n    // \n    BlockSize() int\n    // . src ,dst  src \n    CryptBlocks(dst, src []byte)\n}\n\n// \ntype Stream interface {\n    //  XOR.dst  src \n    XORKeyStream(dst, src []byte)\n}\n\ntype StreamReader struct {\n    S Stream\n    R io.Reader\n}\ntype StreamWriter struct {\n    S   Stream\n    W   io.Writer\n    Err error // unused\n}\n```\n\n## \n\n### `cipher` \n\n```go\n// GCM(12) 128  AEAD \nfunc NewGCM(cipher Block) (AEAD, error)\n// GCM(12) 128  AEAD \nfunc NewGCMWithNonceSize(cipher Block, size int) (AEAD, error)\n\n// (CBC)\n// iv  iv \nfunc NewCBCDecrypter(b Block, iv []byte) BlockMode\n// (CBC)\n// iv  iv \nfunc NewCBCEncrypter(b Block, iv []byte) BlockMode\n\n// (CFB)\n// iv  iv \nfunc NewCFBDecrypter(block Block, iv []byte) Stream\n// (CFB) Stream\n// iv  iv \nfunc NewCFBEncrypter(block Block, iv []byte) Stream\n\n// / Stream\n// iv  iv \nfunc NewCTR(block Block, iv []byte) Stream\n\n// (OFB) Stream\n// iv  b \nfunc NewOFB(b Block, iv []byte) Stream\n```\n\n## \n\n### AES GCM \n```go\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"crypto/rand\"\n    \"encoding/base64\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc AESGCMEncrypt(plaintextStr string, keyStr string) (string, string) {\n    // \n    plaintext := []byte(plaintextStr)\n    key := []byte(keyStr)\n\n    // \n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(fmt.Sprintf(\"key  16/24/32: %s\", err.Error()))\n    }\n\n    //  GCM  AEAD\n    aesgcm, err := cipher.NewGCM(block)\n    if err != nil {\n        panic(err.Error())\n    }\n    // ,.\n    nonce := make([]byte, aesgcm.NonceSize())\n    if _, err := io.ReadFull(rand.Reader, nonce); err != nil {\n        panic(err.Error())\n    }\n    // \n    ciphertext := aesgcm.Seal(nil, nonce, plaintext, nil)\n    //  base64 \n    fmt.Println(ciphertext, nonce, key)\n    return base64.RawURLEncoding.EncodeToString(ciphertext), base64.RawURLEncoding.EncodeToString(nonce)\n}\n\nfunc AESGCMDecrypt(ciphertextStr string, keyStr string, nonceStr string) string {\n    // ,\n    ciphertext, _ := base64.RawURLEncoding.DecodeString(ciphertextStr)\n    nonce, _ := base64.RawURLEncoding.DecodeString(nonceStr)\n    key := []byte(keyStr)\n\n    // \n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err.Error())\n    }\n    //  GCM  AEAD\n    aesgcm, err := cipher.NewGCM(block)\n    if err != nil {\n        panic(err.Error())\n    }\n    // \n    plaintext, err := aesgcm.Open(nil, nonce, ciphertext, nil)\n    if err != nil {\n        panic(err.Error())\n    }\n    return string(plaintext)\n}\n\nfunc main() {\n    plaintext := \"hello world\"\n    key := \"123456781234567812345678\" // 16,24,32 \n    fmt.Println(\"\", plaintext)\n    ciphertext, nonce := AESGCMEncrypt(plaintext, key)\n    fmt.Println(\": \", ciphertext, nonce)\n    fmt.Println(\": \", AESGCMDecrypt(ciphertext, key, nonce))\n}\n```\n\n### AES CBC \n\n```go\nimport (\n    \"bytes\"\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc AESCBCEncrypt(plaintextStr string, keyStr string) string {\n    // \n    plaintext := []byte(plaintextStr)\n    key := []byte(keyStr)\n\n    // \n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(fmt.Sprintf(\"key  16/24/32: %s\", err.Error()))\n    }\n    // \n    blockSize := block.BlockSize()\n    // \n    plaintext = PKCS7Padding(plaintext, blockSize)\n    // \n    blockMode := cipher.NewCBCEncrypter(block, key[:blockSize])\n    // \n    ciphertext := make([]byte, len(plaintext))\n    // \n    blockMode.CryptBlocks(ciphertext, plaintext)\n    // RawURLEncoding, StdEncoding,url\n    return base64.RawURLEncoding.EncodeToString(ciphertext)\n\n}\n\nfunc AESCBCDecrypt(ciphertextStr string, key string) string {\n    // RawURLEncoding, StdEncoding url\n    ciphertext, _ := base64.RawURLEncoding.DecodeString(ciphertextStr)\n    k := []byte(key)\n\n    // \n    block, err := aes.NewCipher(k)\n    if err != nil {\n        panic(fmt.Sprintf(\"key  16/24/32: %s\", err.Error()))\n    }\n    // \n    blockSize := block.BlockSize()\n    // \n    blockMode := cipher.NewCBCDecrypter(block, k[:blockSize])\n    // \n    plaintext := make([]byte, len(ciphertext))\n    // \n    blockMode.CryptBlocks(plaintext, ciphertext)\n    // \n    plaintext = PKCS7UnPadding(plaintext)\n    return string(plaintext)\n}\n\n//\nfunc PKCS7Padding(plaintext []byte, blocksize int) []byte {\n    padding := blocksize - len(plaintext)%blocksize\n    padtext := bytes.Repeat([]byte{byte(padding)}, padding)\n    return append(plaintext, padtext...)\n}\n\n//\nfunc PKCS7UnPadding(plaintext []byte) []byte {\n    length := len(plaintext)\n    unpadding := int(plaintext[length-1])\n    return plaintext[:(length - unpadding)]\n}\n\nfunc main() {\n    plaintext := \"hello world\"\n    key := \"123456781234567812345678\" // 16,24,32 \n    fmt.Println(\": \", plaintext)\n    ciphertext := AESCBCEncrypt(plaintext, key)\n    fmt.Println(\": \", ciphertext)\n    plaintext2 := AESCBCDecrypt(ciphertext, key)\n    fmt.Println(\": \", plaintext2)\n}\n```\nCFB  CBC , `blockMode` \n\n# `crypto/md5`\n\nmd5  RFC 1321  MD5 . `import \"crypto/md5\"`. `sha1`,`sha256`,`sha512`  `md5` ,\n\n## \n```go\n// MD5,\nconst BlockSize = 64\n// MD5 \nconst Size = 16\n```\n## \n\n```go\n//  `hash.Hash`, MD5.\nfunc New() hash.Hash\n//  data  MD5 \nfunc Sum(data []byte) [Size]byte\n```\n\n## \n\n### \n\n```go\nimport (\n    \"crypto/md5\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc main() {\n    //  `hash.Hash`\n    h := md5.New()\n    // \n    io.WriteString(h, \"The fog is getting thicker!\")\n    io.WriteString(h, \"And Leon's getting laaarger!\")\n    fmt.Printf(\"%x\", h.Sum(nil)) // h.Sum() \n\n    //  md5.Sum(data []byte) \n    data := []byte(\"These pretzels are making me thirsty.\")\n    fmt.Printf(\"%x\", md5.Sum(data))\n}\n```\n\n### \n\n```go\nimport (\n    \"crypto/md5\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    f, err := os.Open(\"file.txt\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer f.Close()\n\n    h := md5.New()\n    // , h \n    if _, err := io.Copy(h, f); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%x\", h.Sum(nil))\n}\n\n```\n\n# `crypto/rand`\n\nrand . `var Reader io.Reader` \n\n## \n\n```go\n// \nvar Reader io.Reader\n```\n\n## \n\n```go\n//  [0,max) \nfunc Int(rand io.Reader, max *big.Int) (n *big.Int, err error)\n//  b. io.ReadFull(Reader, b),.\n//  n=len(b), err=nil\nfunc Read(b []byte) (n int, err error)\n```\n\n## \n\n```go\n// , `io.ReadFull`  rand.Reader  nonce \nnonce := make([]byte, 12)\nif _, err := io.ReadFull(rand.Reader, nonce); err != nil {\n        panic(err.Error())\n}\n```\n\n# `crypto/rsa`\n\nrsa  RSA ,,,.\n\nRSA ,. RSA .\n\n## \n\n```go\nconst (\n    // PSSSaltLengthAuto  RSA-PSS ,\n    PSSSaltLengthAuto = 0\n    // PSSSaltLengthEqualsHash \n    PSSSaltLengthEqualsHash = -1\n)\n```\n\n## \n\n```go\n// RSA , `rsa.GenerateKey` \ntype PrivateKey struct {\n    PublicKey            // \n    D         *big.Int   // private exponent\n    Primes    []*big.Int // prime factors of N, has >= 2 elements.\n    // Precomputed contains precomputed values that speed up private operations, if available.\n    Precomputed PrecomputedValues\n}\n\n// RSA ,\ntype PublicKey struct {\n    N *big.Int // modulus\n    E int      // public exponent\n}\n\n//  `crypto.Decrypter`  OAEP \ntype OAEPOptions struct {\n    // .\n    Hash crypto.Hash\n    // , Label\n    Label []byte\n}\n\n//  `crypto.Decrypter` PKCS#1 v1.5  PKCS1v15 \ntype PKCS1v15DecryptOptions struct {\n    // . ,,\n    SessionKeyLen int\n}\n\n//  RSA-PSS \ntype PSSOptions struct {\n    //  PSS ,, PSSSaltLength \n    SaltLength int\n\n    //  SignPSS  hash \n    //  crypto.Signer \n    Hash crypto.Hash\n}\n```\n\n## \n\n### `rsa` \n\n```go\n//  random  bits  RSA \nfunc GenerateKey(random io.Reader, bits int) (*PrivateKey, error)\n//  RSA-OAEP  msg \nfunc EncryptOAEP(hash hash.Hash, random io.Reader, pub *PublicKey, msg []byte, label []byte) ([]byte, error)\n//  RSA-OAEP  ciphertext \nfunc DecryptOAEP(hash hash.Hash, random io.Reader, priv *PrivateKey, ciphertext []byte, label []byte) ([]byte, error)\n\n//  RSA  PKCS#1 v1.5  msg \nfunc EncryptPKCS1v15(rand io.Reader, pub *PublicKey, msg []byte) ([]byte, error)\nfunc DecryptPKCS1v15(rand io.Reader, priv *PrivateKey, ciphertext []byte) ([]byte, error)\n\n//  RSA PKCS1 v1.5  RSASSA-PKCS1-V1_5-SIGN  hashed \n// hashed  hash  msg \nfunc SignPKCS1v15(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []byte) ([]byte, error)\nfunc VerifyPKCS1v15(pub *PublicKey, hash crypto.Hash, hashed []byte, sig []byte) error\n//  RSASSA-PSS [1] hashed \n// hashed  hash  msg .optsnil,\nfunc SignPSS(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []byte, opts *PSSOptions) ([]byte, error)\n```\n\n### `PrivateKey` \n\n`PrivateKey`  `crypto.Decrypter`  `crypto.Signer` .\n\n```go\n//  priv  ciphertext ,\n//  opts  *PKCS1v15DecryptOptions, PKCS#1 v1.5 . *OAEPOptions  OAEP \nfunc (priv *PrivateKey) Decrypt(rand io.Reader, ciphertext []byte, opts crypto.DecrypterOpts) (plaintext []byte, err error)\n// ,\nfunc (priv *PrivateKey) Precompute()\n// \nfunc (priv *PrivateKey) Public() crypto.PublicKey\n// , rand \n//  opts  *PSSOptions  PSS, PKCS#1 v1.5 \nfunc (priv *PrivateKey) Sign(rand io.Reader, digest []byte, opts crypto.SignerOpts) ([]byte, error)\n// .\nfunc (priv *PrivateKey) Validate() error\n```\n\n## \n\n### \n\n```go\nimport (\n    \"crypto/rand\"\n    \"crypto/rsa\"\n    \"crypto/sha256\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    privateKey, err := rsa.GenerateKey(rand.Reader, 2048)\n    if err != nil {\n        fmt.Println(err)\n    }\n    msg := []byte(\"send reinforcements, we're going to advance\")\n    label := []byte(\"orders\")\n    rng := rand.Reader\n    // \n    ciphertext, err := rsa.EncryptOAEP(sha256.New(), rng, &privateKey.PublicKey, msg, label)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error from encryption: %s\\n\", err)\n        return\n    }\n    fmt.Printf(\"Ciphertext: %x\\n\", ciphertext)\n    // \n    plaintext, err := rsa.DecryptOAEP(sha256.New(), rng, privateKey, ciphertext, label)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error from deecryption: %s\\n\", err)\n        return\n    }\n    fmt.Printf(\"Plaintext: %s\\n\", string(plaintext))\n}\n```\n\n### \n\n```go\nimport (\n    \"crypto\"\n    \"crypto/rand\"\n    \"crypto/rsa\"\n    \"crypto/sha256\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    privateKey, err := rsa.GenerateKey(rand.Reader, 2048)\n    if err != nil {\n        fmt.Println(err)\n    }\n    message := []byte(\"message to be signed\")\n    hashed := sha256.Sum256(message)  //  sha256 \n    //  rsa \n    signature, err := rsa.SignPKCS1v15(rand.Reader, privateKey, crypto.SHA256, hashed[:])\n    //  rsa PSS \n    // signature, err := rsa.SignPSS(rand.Reader, privateKey, crypto.SHA256, hashed[:], nil)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error from signing: %s\\n\", err)\n        return\n    }\n    fmt.Printf(\"Signature: %x\\n\", signature)\n    //  rsa \n    err = rsa.VerifyPKCS1v15(&privateKey.PublicKey, crypto.SHA256, hashed[:], signature)\n    //  rsa PSS \n    // err = rsa.VerifyPSS(&privateKey.PublicKey, crypto.SHA256, hashed[:], signature, nil)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error from verification: %s\\n\", err)\n        return\n    }\n    fmt.Println(\"\")\n}\n```","source":"_posts/go-study-notes-package-crypto.md","raw":"---\ntitle: go  crypto \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 16535\ndescription:  Go crypto .crypto .\n---\n\n# `crypto `\n\ncrypto ,. `import \"crypto\"`.\n\n.\n\n- : , AES,DES()\n- : , RSA\n- : ,,,,, MD5,SHA1,HMAC \n\n## \n\n\n\n```go\n// Decrypter ,. RSA \ntype Decrypter interface {\n    // \n    Public() PublicKey\n    //  msg.opts .\n    Decrypt(rand io.Reader, msg []byte, opts DecrypterOpts) (plaintext []byte, err error)\n}\n\ntype DecrypterOpts interface{}\n\n// Hash \ntype Hash uint\n\n// \ntype PrivateKey interface{}\n\n// \ntype PublicKey interface{}\n\n// Signer ,.\ntype Signer interface {\n    // \n    Public() PublicKey\n\n    //  digest \n    Sign(rand io.Reader, digest []byte, opts SignerOpts) (signature []byte, err error)\n}\n\n//  Signer \ntype SignerOpts interface {\n    //  `Signer.Sign` ,\n    HashFunc() Hash\n}\n```\n\n## \n\n```go\nconst (\n    MD4         Hash = 1 + iota // import golang.org/x/crypto/md4\n    MD5                         // import crypto/md5\n    SHA1                        // import crypto/sha1\n    SHA224                      // import crypto/sha256\n    SHA256                      // import crypto/sha256\n    SHA384                      // import crypto/sha512\n    SHA512                      // import crypto/sha512\n    MD5SHA1                     // no implementation; MD5+SHA1 used for TLS RSA\n    RIPEMD160                   // import golang.org/x/crypto/ripemd160\n    SHA3_224                    // import golang.org/x/crypto/sha3\n    SHA3_256                    // import golang.org/x/crypto/sha3\n    SHA3_384                    // import golang.org/x/crypto/sha3\n    SHA3_512                    // import golang.org/x/crypto/sha3\n    SHA512_224                  // import crypto/sha512\n    SHA512_256                  // import crypto/sha512\n    BLAKE2s_256                 // import golang.org/x/crypto/blake2s\n    BLAKE2b_256                 // import golang.org/x/crypto/blake2b\n    BLAKE2b_384                 // import golang.org/x/crypto/blake2b\n    BLAKE2b_512                 // import golang.org/x/crypto/blake2b\n)\n```\n\n## \n\n,\n\n | \n:--- | :---\naes |  AES\ncipher | (CBC,ECB ),\ndes | (DES)(TDEA)\ndsa |  FIPS 186-3 \necdsa |  FIPS 186-3 \ned25519 |  ED25519\nelliptic | \nhmac |  Keyed-Hash \nmd5 |  RFC 1321  MD5 \nrand | \nrc4 |  RC4 \nrsa |  PKCS#1  RSA \nsha1 |  RFC 3174  SHA-1 \nsha256 |  FIPS 180-4  SHA224  SHA256 \nsha512 |  FIPS 180-4  SHA-384, SHA-512, SHA-512/224  SHA-512/256 \ntls |  RFC 5246  TLS 1.2  RFC 8446  TLS 1.3\nx509 |  X.509 \nx509/pkix | X.509,CRL  OCSP  ASN.1 \n\n# `crypto/aes`\n\naes  AES . `import \"crypto/aes\"`\n\n## \n\n```go\n// AES .\nconst BlockSize = 16\n```\n\n## \n\n```go\n//  `cipher.Block`\n//  key  AES , 16,24  32  AES-128, AES-192  AES-256 \nfunc NewCipher(key []byte) (cipher.Block, error)\n```\n\n# `crypto/cipher`\n\ncipher (CBC,ECB ),. `import \"crypto/cipher\"`\n\n## \n\n```go\n// AEAD ,\ntype AEAD interface {\n    //  Seal  Open \n    NonceSize() int\n    // \n    Overhead() int\n\n    // ,\n    // ,nonce  NonceSize() \n    // ,nonce\n    Seal(dst, nonce, plaintext, additionalData []byte) []byte\n\n    // ,\n    // ,nonce  NonceSize() \n    // ,nonce\n    Open(dst, nonce, ciphertext, additionalData []byte) ([]byte, error)\n}\n\n// ..\ntype Block interface {\n    // \n    BlockSize() int\n    //  src  dst. dst  src \n    Encrypt(dst, src []byte)\n    //  src  dst. dst  src \n    Decrypt(dst, src []byte)\n}\n\n// \ntype BlockMode interface {\n    // \n    BlockSize() int\n    // . src ,dst  src \n    CryptBlocks(dst, src []byte)\n}\n\n// \ntype Stream interface {\n    //  XOR.dst  src \n    XORKeyStream(dst, src []byte)\n}\n\ntype StreamReader struct {\n    S Stream\n    R io.Reader\n}\ntype StreamWriter struct {\n    S   Stream\n    W   io.Writer\n    Err error // unused\n}\n```\n\n## \n\n### `cipher` \n\n```go\n// GCM(12) 128  AEAD \nfunc NewGCM(cipher Block) (AEAD, error)\n// GCM(12) 128  AEAD \nfunc NewGCMWithNonceSize(cipher Block, size int) (AEAD, error)\n\n// (CBC)\n// iv  iv \nfunc NewCBCDecrypter(b Block, iv []byte) BlockMode\n// (CBC)\n// iv  iv \nfunc NewCBCEncrypter(b Block, iv []byte) BlockMode\n\n// (CFB)\n// iv  iv \nfunc NewCFBDecrypter(block Block, iv []byte) Stream\n// (CFB) Stream\n// iv  iv \nfunc NewCFBEncrypter(block Block, iv []byte) Stream\n\n// / Stream\n// iv  iv \nfunc NewCTR(block Block, iv []byte) Stream\n\n// (OFB) Stream\n// iv  b \nfunc NewOFB(b Block, iv []byte) Stream\n```\n\n## \n\n### AES GCM \n```go\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"crypto/rand\"\n    \"encoding/base64\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc AESGCMEncrypt(plaintextStr string, keyStr string) (string, string) {\n    // \n    plaintext := []byte(plaintextStr)\n    key := []byte(keyStr)\n\n    // \n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(fmt.Sprintf(\"key  16/24/32: %s\", err.Error()))\n    }\n\n    //  GCM  AEAD\n    aesgcm, err := cipher.NewGCM(block)\n    if err != nil {\n        panic(err.Error())\n    }\n    // ,.\n    nonce := make([]byte, aesgcm.NonceSize())\n    if _, err := io.ReadFull(rand.Reader, nonce); err != nil {\n        panic(err.Error())\n    }\n    // \n    ciphertext := aesgcm.Seal(nil, nonce, plaintext, nil)\n    //  base64 \n    fmt.Println(ciphertext, nonce, key)\n    return base64.RawURLEncoding.EncodeToString(ciphertext), base64.RawURLEncoding.EncodeToString(nonce)\n}\n\nfunc AESGCMDecrypt(ciphertextStr string, keyStr string, nonceStr string) string {\n    // ,\n    ciphertext, _ := base64.RawURLEncoding.DecodeString(ciphertextStr)\n    nonce, _ := base64.RawURLEncoding.DecodeString(nonceStr)\n    key := []byte(keyStr)\n\n    // \n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err.Error())\n    }\n    //  GCM  AEAD\n    aesgcm, err := cipher.NewGCM(block)\n    if err != nil {\n        panic(err.Error())\n    }\n    // \n    plaintext, err := aesgcm.Open(nil, nonce, ciphertext, nil)\n    if err != nil {\n        panic(err.Error())\n    }\n    return string(plaintext)\n}\n\nfunc main() {\n    plaintext := \"hello world\"\n    key := \"123456781234567812345678\" // 16,24,32 \n    fmt.Println(\"\", plaintext)\n    ciphertext, nonce := AESGCMEncrypt(plaintext, key)\n    fmt.Println(\": \", ciphertext, nonce)\n    fmt.Println(\": \", AESGCMDecrypt(ciphertext, key, nonce))\n}\n```\n\n### AES CBC \n\n```go\nimport (\n    \"bytes\"\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc AESCBCEncrypt(plaintextStr string, keyStr string) string {\n    // \n    plaintext := []byte(plaintextStr)\n    key := []byte(keyStr)\n\n    // \n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(fmt.Sprintf(\"key  16/24/32: %s\", err.Error()))\n    }\n    // \n    blockSize := block.BlockSize()\n    // \n    plaintext = PKCS7Padding(plaintext, blockSize)\n    // \n    blockMode := cipher.NewCBCEncrypter(block, key[:blockSize])\n    // \n    ciphertext := make([]byte, len(plaintext))\n    // \n    blockMode.CryptBlocks(ciphertext, plaintext)\n    // RawURLEncoding, StdEncoding,url\n    return base64.RawURLEncoding.EncodeToString(ciphertext)\n\n}\n\nfunc AESCBCDecrypt(ciphertextStr string, key string) string {\n    // RawURLEncoding, StdEncoding url\n    ciphertext, _ := base64.RawURLEncoding.DecodeString(ciphertextStr)\n    k := []byte(key)\n\n    // \n    block, err := aes.NewCipher(k)\n    if err != nil {\n        panic(fmt.Sprintf(\"key  16/24/32: %s\", err.Error()))\n    }\n    // \n    blockSize := block.BlockSize()\n    // \n    blockMode := cipher.NewCBCDecrypter(block, k[:blockSize])\n    // \n    plaintext := make([]byte, len(ciphertext))\n    // \n    blockMode.CryptBlocks(plaintext, ciphertext)\n    // \n    plaintext = PKCS7UnPadding(plaintext)\n    return string(plaintext)\n}\n\n//\nfunc PKCS7Padding(plaintext []byte, blocksize int) []byte {\n    padding := blocksize - len(plaintext)%blocksize\n    padtext := bytes.Repeat([]byte{byte(padding)}, padding)\n    return append(plaintext, padtext...)\n}\n\n//\nfunc PKCS7UnPadding(plaintext []byte) []byte {\n    length := len(plaintext)\n    unpadding := int(plaintext[length-1])\n    return plaintext[:(length - unpadding)]\n}\n\nfunc main() {\n    plaintext := \"hello world\"\n    key := \"123456781234567812345678\" // 16,24,32 \n    fmt.Println(\": \", plaintext)\n    ciphertext := AESCBCEncrypt(plaintext, key)\n    fmt.Println(\": \", ciphertext)\n    plaintext2 := AESCBCDecrypt(ciphertext, key)\n    fmt.Println(\": \", plaintext2)\n}\n```\nCFB  CBC , `blockMode` \n\n# `crypto/md5`\n\nmd5  RFC 1321  MD5 . `import \"crypto/md5\"`. `sha1`,`sha256`,`sha512`  `md5` ,\n\n## \n```go\n// MD5,\nconst BlockSize = 64\n// MD5 \nconst Size = 16\n```\n## \n\n```go\n//  `hash.Hash`, MD5.\nfunc New() hash.Hash\n//  data  MD5 \nfunc Sum(data []byte) [Size]byte\n```\n\n## \n\n### \n\n```go\nimport (\n    \"crypto/md5\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc main() {\n    //  `hash.Hash`\n    h := md5.New()\n    // \n    io.WriteString(h, \"The fog is getting thicker!\")\n    io.WriteString(h, \"And Leon's getting laaarger!\")\n    fmt.Printf(\"%x\", h.Sum(nil)) // h.Sum() \n\n    //  md5.Sum(data []byte) \n    data := []byte(\"These pretzels are making me thirsty.\")\n    fmt.Printf(\"%x\", md5.Sum(data))\n}\n```\n\n### \n\n```go\nimport (\n    \"crypto/md5\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    f, err := os.Open(\"file.txt\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer f.Close()\n\n    h := md5.New()\n    // , h \n    if _, err := io.Copy(h, f); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%x\", h.Sum(nil))\n}\n\n```\n\n# `crypto/rand`\n\nrand . `var Reader io.Reader` \n\n## \n\n```go\n// \nvar Reader io.Reader\n```\n\n## \n\n```go\n//  [0,max) \nfunc Int(rand io.Reader, max *big.Int) (n *big.Int, err error)\n//  b. io.ReadFull(Reader, b),.\n//  n=len(b), err=nil\nfunc Read(b []byte) (n int, err error)\n```\n\n## \n\n```go\n// , `io.ReadFull`  rand.Reader  nonce \nnonce := make([]byte, 12)\nif _, err := io.ReadFull(rand.Reader, nonce); err != nil {\n        panic(err.Error())\n}\n```\n\n# `crypto/rsa`\n\nrsa  RSA ,,,.\n\nRSA ,. RSA .\n\n## \n\n```go\nconst (\n    // PSSSaltLengthAuto  RSA-PSS ,\n    PSSSaltLengthAuto = 0\n    // PSSSaltLengthEqualsHash \n    PSSSaltLengthEqualsHash = -1\n)\n```\n\n## \n\n```go\n// RSA , `rsa.GenerateKey` \ntype PrivateKey struct {\n    PublicKey            // \n    D         *big.Int   // private exponent\n    Primes    []*big.Int // prime factors of N, has >= 2 elements.\n    // Precomputed contains precomputed values that speed up private operations, if available.\n    Precomputed PrecomputedValues\n}\n\n// RSA ,\ntype PublicKey struct {\n    N *big.Int // modulus\n    E int      // public exponent\n}\n\n//  `crypto.Decrypter`  OAEP \ntype OAEPOptions struct {\n    // .\n    Hash crypto.Hash\n    // , Label\n    Label []byte\n}\n\n//  `crypto.Decrypter` PKCS#1 v1.5  PKCS1v15 \ntype PKCS1v15DecryptOptions struct {\n    // . ,,\n    SessionKeyLen int\n}\n\n//  RSA-PSS \ntype PSSOptions struct {\n    //  PSS ,, PSSSaltLength \n    SaltLength int\n\n    //  SignPSS  hash \n    //  crypto.Signer \n    Hash crypto.Hash\n}\n```\n\n## \n\n### `rsa` \n\n```go\n//  random  bits  RSA \nfunc GenerateKey(random io.Reader, bits int) (*PrivateKey, error)\n//  RSA-OAEP  msg \nfunc EncryptOAEP(hash hash.Hash, random io.Reader, pub *PublicKey, msg []byte, label []byte) ([]byte, error)\n//  RSA-OAEP  ciphertext \nfunc DecryptOAEP(hash hash.Hash, random io.Reader, priv *PrivateKey, ciphertext []byte, label []byte) ([]byte, error)\n\n//  RSA  PKCS#1 v1.5  msg \nfunc EncryptPKCS1v15(rand io.Reader, pub *PublicKey, msg []byte) ([]byte, error)\nfunc DecryptPKCS1v15(rand io.Reader, priv *PrivateKey, ciphertext []byte) ([]byte, error)\n\n//  RSA PKCS1 v1.5  RSASSA-PKCS1-V1_5-SIGN  hashed \n// hashed  hash  msg \nfunc SignPKCS1v15(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []byte) ([]byte, error)\nfunc VerifyPKCS1v15(pub *PublicKey, hash crypto.Hash, hashed []byte, sig []byte) error\n//  RSASSA-PSS [1] hashed \n// hashed  hash  msg .optsnil,\nfunc SignPSS(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []byte, opts *PSSOptions) ([]byte, error)\n```\n\n### `PrivateKey` \n\n`PrivateKey`  `crypto.Decrypter`  `crypto.Signer` .\n\n```go\n//  priv  ciphertext ,\n//  opts  *PKCS1v15DecryptOptions, PKCS#1 v1.5 . *OAEPOptions  OAEP \nfunc (priv *PrivateKey) Decrypt(rand io.Reader, ciphertext []byte, opts crypto.DecrypterOpts) (plaintext []byte, err error)\n// ,\nfunc (priv *PrivateKey) Precompute()\n// \nfunc (priv *PrivateKey) Public() crypto.PublicKey\n// , rand \n//  opts  *PSSOptions  PSS, PKCS#1 v1.5 \nfunc (priv *PrivateKey) Sign(rand io.Reader, digest []byte, opts crypto.SignerOpts) ([]byte, error)\n// .\nfunc (priv *PrivateKey) Validate() error\n```\n\n## \n\n### \n\n```go\nimport (\n    \"crypto/rand\"\n    \"crypto/rsa\"\n    \"crypto/sha256\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    privateKey, err := rsa.GenerateKey(rand.Reader, 2048)\n    if err != nil {\n        fmt.Println(err)\n    }\n    msg := []byte(\"send reinforcements, we're going to advance\")\n    label := []byte(\"orders\")\n    rng := rand.Reader\n    // \n    ciphertext, err := rsa.EncryptOAEP(sha256.New(), rng, &privateKey.PublicKey, msg, label)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error from encryption: %s\\n\", err)\n        return\n    }\n    fmt.Printf(\"Ciphertext: %x\\n\", ciphertext)\n    // \n    plaintext, err := rsa.DecryptOAEP(sha256.New(), rng, privateKey, ciphertext, label)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error from deecryption: %s\\n\", err)\n        return\n    }\n    fmt.Printf(\"Plaintext: %s\\n\", string(plaintext))\n}\n```\n\n### \n\n```go\nimport (\n    \"crypto\"\n    \"crypto/rand\"\n    \"crypto/rsa\"\n    \"crypto/sha256\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    privateKey, err := rsa.GenerateKey(rand.Reader, 2048)\n    if err != nil {\n        fmt.Println(err)\n    }\n    message := []byte(\"message to be signed\")\n    hashed := sha256.Sum256(message)  //  sha256 \n    //  rsa \n    signature, err := rsa.SignPKCS1v15(rand.Reader, privateKey, crypto.SHA256, hashed[:])\n    //  rsa PSS \n    // signature, err := rsa.SignPSS(rand.Reader, privateKey, crypto.SHA256, hashed[:], nil)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error from signing: %s\\n\", err)\n        return\n    }\n    fmt.Printf(\"Signature: %x\\n\", signature)\n    //  rsa \n    err = rsa.VerifyPKCS1v15(&privateKey.PublicKey, crypto.SHA256, hashed[:], signature)\n    //  rsa PSS \n    // err = rsa.VerifyPSS(&privateKey.PublicKey, crypto.SHA256, hashed[:], signature, nil)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error from verification: %s\\n\", err)\n        return\n    }\n    fmt.Println(\"\")\n}\n```","slug":"go-study-notes-package-crypto","published":1,"date":"2020-05-05T00:09:06.629Z","updated":"2020-05-05T09:45:42.435Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihve000yk8u71qgmhaht","content":"<h1 id=\"crypto-\"><a href=\"#crypto-\" class=\"headerlink\" title=\"crypto \"></a><code>crypto </code></h1><p>crypto ,. <code>import &quot;crypto&quot;</code>.</p>\n<p>.</p>\n<ul>\n<li>: , AES,DES()</li>\n<li>: , RSA</li>\n<li>: ,,,,, MD5,SHA1,HMAC </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Decrypter ,. RSA </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Decrypter <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Public() PublicKey</span><br><span class=\"line\">    <span class=\"comment\">//  msg.opts .</span></span><br><span class=\"line\">    Decrypt(rand io.Reader, msg []<span class=\"keyword\">byte</span>, opts DecrypterOpts) (plaintext []<span class=\"keyword\">byte</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> DecrypterOpts <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Hash </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Hash <span class=\"keyword\">uint</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PrivateKey <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PublicKey <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Signer ,.</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Signer <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Public() PublicKey</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  digest </span></span><br><span class=\"line\">    Sign(rand io.Reader, digest []<span class=\"keyword\">byte</span>, opts SignerOpts) (signature []<span class=\"keyword\">byte</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Signer </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> SignerOpts <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  `Signer.Sign` ,</span></span><br><span class=\"line\">    HashFunc() Hash</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    MD4         Hash = <span class=\"number\">1</span> + <span class=\"literal\">iota</span> <span class=\"comment\">// import golang.org/x/crypto/md4</span></span><br><span class=\"line\">    MD5                         <span class=\"comment\">// import crypto/md5</span></span><br><span class=\"line\">    SHA1                        <span class=\"comment\">// import crypto/sha1</span></span><br><span class=\"line\">    SHA224                      <span class=\"comment\">// import crypto/sha256</span></span><br><span class=\"line\">    SHA256                      <span class=\"comment\">// import crypto/sha256</span></span><br><span class=\"line\">    SHA384                      <span class=\"comment\">// import crypto/sha512</span></span><br><span class=\"line\">    SHA512                      <span class=\"comment\">// import crypto/sha512</span></span><br><span class=\"line\">    MD5SHA1                     <span class=\"comment\">// no implementation; MD5+SHA1 used for TLS RSA</span></span><br><span class=\"line\">    RIPEMD160                   <span class=\"comment\">// import golang.org/x/crypto/ripemd160</span></span><br><span class=\"line\">    SHA3_224                    <span class=\"comment\">// import golang.org/x/crypto/sha3</span></span><br><span class=\"line\">    SHA3_256                    <span class=\"comment\">// import golang.org/x/crypto/sha3</span></span><br><span class=\"line\">    SHA3_384                    <span class=\"comment\">// import golang.org/x/crypto/sha3</span></span><br><span class=\"line\">    SHA3_512                    <span class=\"comment\">// import golang.org/x/crypto/sha3</span></span><br><span class=\"line\">    SHA512_224                  <span class=\"comment\">// import crypto/sha512</span></span><br><span class=\"line\">    SHA512_256                  <span class=\"comment\">// import crypto/sha512</span></span><br><span class=\"line\">    BLAKE2s_256                 <span class=\"comment\">// import golang.org/x/crypto/blake2s</span></span><br><span class=\"line\">    BLAKE2b_256                 <span class=\"comment\">// import golang.org/x/crypto/blake2b</span></span><br><span class=\"line\">    BLAKE2b_384                 <span class=\"comment\">// import golang.org/x/crypto/blake2b</span></span><br><span class=\"line\">    BLAKE2b_512                 <span class=\"comment\">// import golang.org/x/crypto/blake2b</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">aes</td>\n<td align=\"left\"> AES</td>\n</tr>\n<tr>\n<td align=\"left\">cipher</td>\n<td align=\"left\">(CBC,ECB ),</td>\n</tr>\n<tr>\n<td align=\"left\">des</td>\n<td align=\"left\">(DES)(TDEA)</td>\n</tr>\n<tr>\n<td align=\"left\">dsa</td>\n<td align=\"left\"> FIPS 186-3 </td>\n</tr>\n<tr>\n<td align=\"left\">ecdsa</td>\n<td align=\"left\"> FIPS 186-3 </td>\n</tr>\n<tr>\n<td align=\"left\">ed25519</td>\n<td align=\"left\"> ED25519</td>\n</tr>\n<tr>\n<td align=\"left\">elliptic</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">hmac</td>\n<td align=\"left\"> Keyed-Hash </td>\n</tr>\n<tr>\n<td align=\"left\">md5</td>\n<td align=\"left\"> RFC 1321  MD5 </td>\n</tr>\n<tr>\n<td align=\"left\">rand</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">rc4</td>\n<td align=\"left\"> RC4 </td>\n</tr>\n<tr>\n<td align=\"left\">rsa</td>\n<td align=\"left\"> PKCS#1  RSA </td>\n</tr>\n<tr>\n<td align=\"left\">sha1</td>\n<td align=\"left\"> RFC 3174  SHA-1 </td>\n</tr>\n<tr>\n<td align=\"left\">sha256</td>\n<td align=\"left\"> FIPS 180-4  SHA224  SHA256 </td>\n</tr>\n<tr>\n<td align=\"left\">sha512</td>\n<td align=\"left\"> FIPS 180-4  SHA-384, SHA-512, SHA-512/224  SHA-512/256 </td>\n</tr>\n<tr>\n<td align=\"left\">tls</td>\n<td align=\"left\"> RFC 5246  TLS 1.2  RFC 8446  TLS 1.3</td>\n</tr>\n<tr>\n<td align=\"left\">x509</td>\n<td align=\"left\"> X.509 </td>\n</tr>\n<tr>\n<td align=\"left\">x509/pkix</td>\n<td align=\"left\">X.509,CRL  OCSP  ASN.1 </td>\n</tr>\n</tbody></table>\n<h1 id=\"crypto-aes\"><a href=\"#crypto-aes\" class=\"headerlink\" title=\"crypto/aes\"></a><code>crypto/aes</code></h1><p>aes  AES . <code>import &quot;crypto/aes&quot;</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// AES .</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BlockSize = <span class=\"number\">16</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `cipher.Block`</span></span><br><span class=\"line\"><span class=\"comment\">//  key  AES , 16,24  32  AES-128, AES-192  AES-256 </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCipher</span><span class=\"params\">(key []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(cipher.Block, error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"crypto-cipher\"><a href=\"#crypto-cipher\" class=\"headerlink\" title=\"crypto/cipher\"></a><code>crypto/cipher</code></h1><p>cipher (CBC,ECB ),. <code>import &quot;crypto/cipher&quot;</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// AEAD ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> AEAD <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  Seal  Open </span></span><br><span class=\"line\">    NonceSize() <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Overhead() <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ,</span></span><br><span class=\"line\">    <span class=\"comment\">// ,nonce  NonceSize() </span></span><br><span class=\"line\">    <span class=\"comment\">// ,nonce</span></span><br><span class=\"line\">    Seal(dst, nonce, plaintext, additionalData []<span class=\"keyword\">byte</span>) []<span class=\"keyword\">byte</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ,</span></span><br><span class=\"line\">    <span class=\"comment\">// ,nonce  NonceSize() </span></span><br><span class=\"line\">    <span class=\"comment\">// ,nonce</span></span><br><span class=\"line\">    Open(dst, nonce, ciphertext, additionalData []<span class=\"keyword\">byte</span>) ([]<span class=\"keyword\">byte</span>, error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ..</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Block <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    BlockSize() <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"comment\">//  src  dst. dst  src </span></span><br><span class=\"line\">    Encrypt(dst, src []<span class=\"keyword\">byte</span>)</span><br><span class=\"line\">    <span class=\"comment\">//  src  dst. dst  src </span></span><br><span class=\"line\">    Decrypt(dst, src []<span class=\"keyword\">byte</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> BlockMode <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    BlockSize() <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"comment\">// . src ,dst  src </span></span><br><span class=\"line\">    CryptBlocks(dst, src []<span class=\"keyword\">byte</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Stream <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  XOR.dst  src </span></span><br><span class=\"line\">    XORKeyStream(dst, src []<span class=\"keyword\">byte</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> StreamReader <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    S Stream</span><br><span class=\"line\">    R io.Reader</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> StreamWriter <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    S   Stream</span><br><span class=\"line\">    W   io.Writer</span><br><span class=\"line\">    Err error <span class=\"comment\">// unused</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"cipher-\"><a href=\"#cipher-\" class=\"headerlink\" title=\"cipher \"></a><code>cipher</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// GCM(12) 128  AEAD </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewGCM</span><span class=\"params\">(cipher Block)</span> <span class=\"params\">(AEAD, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// GCM(12) 128  AEAD </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewGCMWithNonceSize</span><span class=\"params\">(cipher Block, size <span class=\"keyword\">int</span>)</span> <span class=\"params\">(AEAD, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// (CBC)</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCBCDecrypter</span><span class=\"params\">(b Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">BlockMode</span></span></span><br><span class=\"line\"><span class=\"comment\">// (CBC)</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCBCEncrypter</span><span class=\"params\">(b Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">BlockMode</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// (CFB)</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCFBDecrypter</span><span class=\"params\">(block Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">Stream</span></span></span><br><span class=\"line\"><span class=\"comment\">// (CFB) Stream</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCFBEncrypter</span><span class=\"params\">(block Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">Stream</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// / Stream</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCTR</span><span class=\"params\">(block Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">Stream</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// (OFB) Stream</span></span><br><span class=\"line\"><span class=\"comment\">// iv  b </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewOFB</span><span class=\"params\">(b Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">Stream</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"AES-GCM-\"><a href=\"#AES-GCM-\" class=\"headerlink\" title=\"AES GCM \"></a>AES GCM </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/aes\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/cipher\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"encoding/base64\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AESGCMEncrypt</span><span class=\"params\">(plaintextStr <span class=\"keyword\">string</span>, keyStr <span class=\"keyword\">string</span>)</span> <span class=\"params\">(<span class=\"keyword\">string</span>, <span class=\"keyword\">string</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext := []<span class=\"keyword\">byte</span>(plaintextStr)</span><br><span class=\"line\">    key := []<span class=\"keyword\">byte</span>(keyStr)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    block, err := aes.NewCipher(key)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(fmt.Sprintf(<span class=\"string\">\"key  16/24/32: %s\"</span>, err.Error()))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  GCM  AEAD</span></span><br><span class=\"line\">    aesgcm, err := cipher.NewGCM(block)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ,.</span></span><br><span class=\"line\">    nonce := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, aesgcm.NonceSize())</span><br><span class=\"line\">    <span class=\"keyword\">if</span> _, err := io.ReadFull(rand.Reader, nonce); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ciphertext := aesgcm.Seal(<span class=\"literal\">nil</span>, nonce, plaintext, <span class=\"literal\">nil</span>)</span><br><span class=\"line\">    <span class=\"comment\">//  base64 </span></span><br><span class=\"line\">    fmt.Println(ciphertext, nonce, key)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> base64.RawURLEncoding.EncodeToString(ciphertext), base64.RawURLEncoding.EncodeToString(nonce)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AESGCMDecrypt</span><span class=\"params\">(ciphertextStr <span class=\"keyword\">string</span>, keyStr <span class=\"keyword\">string</span>, nonceStr <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ,</span></span><br><span class=\"line\">    ciphertext, _ := base64.RawURLEncoding.DecodeString(ciphertextStr)</span><br><span class=\"line\">    nonce, _ := base64.RawURLEncoding.DecodeString(nonceStr)</span><br><span class=\"line\">    key := []<span class=\"keyword\">byte</span>(keyStr)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    block, err := aes.NewCipher(key)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  GCM  AEAD</span></span><br><span class=\"line\">    aesgcm, err := cipher.NewGCM(block)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext, err := aesgcm.Open(<span class=\"literal\">nil</span>, nonce, ciphertext, <span class=\"literal\">nil</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">string</span>(plaintext)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    plaintext := <span class=\"string\">\"hello world\"</span></span><br><span class=\"line\">    key := <span class=\"string\">\"123456781234567812345678\"</span> <span class=\"comment\">// 16,24,32 </span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"\"</span>, plaintext)</span><br><span class=\"line\">    ciphertext, nonce := AESGCMEncrypt(plaintext, key)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, ciphertext, nonce)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, AESGCMDecrypt(ciphertext, key, nonce))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"AES-CBC-\"><a href=\"#AES-CBC-\" class=\"headerlink\" title=\"AES CBC \"></a>AES CBC </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bytes\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/aes\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/cipher\"</span></span><br><span class=\"line\">    <span class=\"string\">\"encoding/base64\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AESCBCEncrypt</span><span class=\"params\">(plaintextStr <span class=\"keyword\">string</span>, keyStr <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext := []<span class=\"keyword\">byte</span>(plaintextStr)</span><br><span class=\"line\">    key := []<span class=\"keyword\">byte</span>(keyStr)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    block, err := aes.NewCipher(key)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(fmt.Sprintf(<span class=\"string\">\"key  16/24/32: %s\"</span>, err.Error()))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockSize := block.BlockSize()</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext = PKCS7Padding(plaintext, blockSize)</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockMode := cipher.NewCBCEncrypter(block, key[:blockSize])</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ciphertext := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"built_in\">len</span>(plaintext))</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockMode.CryptBlocks(ciphertext, plaintext)</span><br><span class=\"line\">    <span class=\"comment\">// RawURLEncoding, StdEncoding,url</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> base64.RawURLEncoding.EncodeToString(ciphertext)</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AESCBCDecrypt</span><span class=\"params\">(ciphertextStr <span class=\"keyword\">string</span>, key <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// RawURLEncoding, StdEncoding url</span></span><br><span class=\"line\">    ciphertext, _ := base64.RawURLEncoding.DecodeString(ciphertextStr)</span><br><span class=\"line\">    k := []<span class=\"keyword\">byte</span>(key)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    block, err := aes.NewCipher(k)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(fmt.Sprintf(<span class=\"string\">\"key  16/24/32: %s\"</span>, err.Error()))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockSize := block.BlockSize()</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockMode := cipher.NewCBCDecrypter(block, k[:blockSize])</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"built_in\">len</span>(ciphertext))</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockMode.CryptBlocks(plaintext, ciphertext)</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext = PKCS7UnPadding(plaintext)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">string</span>(plaintext)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">PKCS7Padding</span><span class=\"params\">(plaintext []<span class=\"keyword\">byte</span>, blocksize <span class=\"keyword\">int</span>)</span> []<span class=\"title\">byte</span></span> &#123;</span><br><span class=\"line\">    padding := blocksize - <span class=\"built_in\">len</span>(plaintext)%blocksize</span><br><span class=\"line\">    padtext := bytes.Repeat([]<span class=\"keyword\">byte</span>&#123;<span class=\"keyword\">byte</span>(padding)&#125;, padding)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">append</span>(plaintext, padtext...)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">PKCS7UnPadding</span><span class=\"params\">(plaintext []<span class=\"keyword\">byte</span>)</span> []<span class=\"title\">byte</span></span> &#123;</span><br><span class=\"line\">    length := <span class=\"built_in\">len</span>(plaintext)</span><br><span class=\"line\">    unpadding := <span class=\"keyword\">int</span>(plaintext[length<span class=\"number\">-1</span>])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> plaintext[:(length - unpadding)]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    plaintext := <span class=\"string\">\"hello world\"</span></span><br><span class=\"line\">    key := <span class=\"string\">\"123456781234567812345678\"</span> <span class=\"comment\">// 16,24,32 </span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, plaintext)</span><br><span class=\"line\">    ciphertext := AESCBCEncrypt(plaintext, key)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, ciphertext)</span><br><span class=\"line\">    plaintext2 := AESCBCDecrypt(ciphertext, key)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, plaintext2)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>CFB  CBC , <code>blockMode</code> </p>\n<h1 id=\"crypto-md5\"><a href=\"#crypto-md5\" class=\"headerlink\" title=\"crypto/md5\"></a><code>crypto/md5</code></h1><p>md5  RFC 1321  MD5 . <code>import &quot;crypto/md5&quot;</code>. <code>sha1</code>,<code>sha256</code>,<code>sha512</code>  <code>md5</code> ,</p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// MD5,</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BlockSize = <span class=\"number\">64</span></span><br><span class=\"line\"><span class=\"comment\">// MD5 </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> Size = <span class=\"number\">16</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `hash.Hash`, MD5.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">New</span><span class=\"params\">()</span> <span class=\"title\">hash</span>.<span class=\"title\">Hash</span></span></span><br><span class=\"line\"><span class=\"comment\">//  data  MD5 </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sum</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>)</span> [<span class=\"title\">Size</span>]<span class=\"title\">byte</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/md5\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  `hash.Hash`</span></span><br><span class=\"line\">    h := md5.New()</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    io.WriteString(h, <span class=\"string\">\"The fog is getting thicker!\"</span>)</span><br><span class=\"line\">    io.WriteString(h, <span class=\"string\">\"And Leon's getting laaarger!\"</span>)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%x\"</span>, h.Sum(<span class=\"literal\">nil</span>)) <span class=\"comment\">// h.Sum() </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  md5.Sum(data []byte) </span></span><br><span class=\"line\">    data := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"These pretzels are making me thirsty.\"</span>)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%x\"</span>, md5.Sum(data))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/md5\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    f, err := os.Open(<span class=\"string\">\"file.txt\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Fatal(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> f.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">    h := md5.New()</span><br><span class=\"line\">    <span class=\"comment\">// , h </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> _, err := io.Copy(h, f); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Fatal(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%x\"</span>, h.Sum(<span class=\"literal\">nil</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"crypto-rand\"><a href=\"#crypto-rand\" class=\"headerlink\" title=\"crypto/rand\"></a><code>crypto/rand</code></h1><p>rand . <code>var Reader io.Reader</code> </p>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Reader io.Reader</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  [0,max) </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Int</span><span class=\"params\">(rand io.Reader, max *big.Int)</span> <span class=\"params\">(n *big.Int, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  b. io.ReadFull(Reader, b),.</span></span><br><span class=\"line\"><span class=\"comment\">//  n=len(b), err=nil</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Read</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , `io.ReadFull`  rand.Reader  nonce </span></span><br><span class=\"line\">nonce := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">12</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> _, err := io.ReadFull(rand.Reader, nonce); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"crypto-rsa\"><a href=\"#crypto-rsa\" class=\"headerlink\" title=\"crypto/rsa\"></a><code>crypto/rsa</code></h1><p>rsa  RSA ,,,.</p>\n<p>RSA ,. RSA .</p>\n<h2 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    <span class=\"comment\">// PSSSaltLengthAuto  RSA-PSS ,</span></span><br><span class=\"line\">    PSSSaltLengthAuto = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"comment\">// PSSSaltLengthEqualsHash </span></span><br><span class=\"line\">    PSSSaltLengthEqualsHash = <span class=\"number\">-1</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// RSA , `rsa.GenerateKey` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PrivateKey <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    PublicKey            <span class=\"comment\">// </span></span><br><span class=\"line\">    D         *big.Int   <span class=\"comment\">// private exponent</span></span><br><span class=\"line\">    Primes    []*big.Int <span class=\"comment\">// prime factors of N, has &gt;= 2 elements.</span></span><br><span class=\"line\">    <span class=\"comment\">// Precomputed contains precomputed values that speed up private operations, if available.</span></span><br><span class=\"line\">    Precomputed PrecomputedValues</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// RSA ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PublicKey <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    N *big.Int <span class=\"comment\">// modulus</span></span><br><span class=\"line\">    E <span class=\"keyword\">int</span>      <span class=\"comment\">// public exponent</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  `crypto.Decrypter`  OAEP </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> OAEPOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// .</span></span><br><span class=\"line\">    Hash crypto.Hash</span><br><span class=\"line\">    <span class=\"comment\">// , Label</span></span><br><span class=\"line\">    Label []<span class=\"keyword\">byte</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  `crypto.Decrypter` PKCS#1 v1.5  PKCS1v15 </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PKCS1v15DecryptOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// . ,,</span></span><br><span class=\"line\">    SessionKeyLen <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  RSA-PSS </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PSSOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  PSS ,, PSSSaltLength </span></span><br><span class=\"line\">    SaltLength <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  SignPSS  hash </span></span><br><span class=\"line\">    <span class=\"comment\">//  crypto.Signer </span></span><br><span class=\"line\">    Hash crypto.Hash</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"rsa-\"><a href=\"#rsa-\" class=\"headerlink\" title=\"rsa \"></a><code>rsa</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  random  bits  RSA </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GenerateKey</span><span class=\"params\">(random io.Reader, bits <span class=\"keyword\">int</span>)</span> <span class=\"params\">(*PrivateKey, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  RSA-OAEP  msg </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">EncryptOAEP</span><span class=\"params\">(hash hash.Hash, random io.Reader, pub *PublicKey, msg []<span class=\"keyword\">byte</span>, label []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  RSA-OAEP  ciphertext </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DecryptOAEP</span><span class=\"params\">(hash hash.Hash, random io.Reader, priv *PrivateKey, ciphertext []<span class=\"keyword\">byte</span>, label []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  RSA  PKCS#1 v1.5  msg </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">EncryptPKCS1v15</span><span class=\"params\">(rand io.Reader, pub *PublicKey, msg []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DecryptPKCS1v15</span><span class=\"params\">(rand io.Reader, priv *PrivateKey, ciphertext []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  RSA PKCS1 v1.5  RSASSA-PKCS1-V1_5-SIGN  hashed </span></span><br><span class=\"line\"><span class=\"comment\">// hashed  hash  msg </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SignPKCS1v15</span><span class=\"params\">(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">VerifyPKCS1v15</span><span class=\"params\">(pub *PublicKey, hash crypto.Hash, hashed []<span class=\"keyword\">byte</span>, sig []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  RSASSA-PSS [1] hashed </span></span><br><span class=\"line\"><span class=\"comment\">// hashed  hash  msg .optsnil,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SignPSS</span><span class=\"params\">(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []<span class=\"keyword\">byte</span>, opts *PSSOptions)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"PrivateKey-\"><a href=\"#PrivateKey-\" class=\"headerlink\" title=\"PrivateKey \"></a><code>PrivateKey</code> </h3><p><code>PrivateKey</code>  <code>crypto.Decrypter</code>  <code>crypto.Signer</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  priv  ciphertext ,</span></span><br><span class=\"line\"><span class=\"comment\">//  opts  *PKCS1v15DecryptOptions, PKCS#1 v1.5 . *OAEPOptions  OAEP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Decrypt</span><span class=\"params\">(rand io.Reader, ciphertext []<span class=\"keyword\">byte</span>, opts crypto.DecrypterOpts)</span> <span class=\"params\">(plaintext []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Precompute</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Public</span><span class=\"params\">()</span> <span class=\"title\">crypto</span>.<span class=\"title\">PublicKey</span></span></span><br><span class=\"line\"><span class=\"comment\">// , rand </span></span><br><span class=\"line\"><span class=\"comment\">//  opts  *PSSOptions  PSS, PKCS#1 v1.5 </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Sign</span><span class=\"params\">(rand io.Reader, digest []<span class=\"keyword\">byte</span>, opts crypto.SignerOpts)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Validate</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rsa\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/sha256\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    privateKey, err := rsa.GenerateKey(rand.Reader, <span class=\"number\">2048</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    msg := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"send reinforcements, we're going to advance\"</span>)</span><br><span class=\"line\">    label := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"orders\"</span>)</span><br><span class=\"line\">    rng := rand.Reader</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ciphertext, err := rsa.EncryptOAEP(sha256.New(), rng, &amp;privateKey.PublicKey, msg, label)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintf(os.Stderr, <span class=\"string\">\"Error from encryption: %s\\n\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"Ciphertext: %x\\n\"</span>, ciphertext)</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext, err := rsa.DecryptOAEP(sha256.New(), rng, privateKey, ciphertext, label)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintf(os.Stderr, <span class=\"string\">\"Error from deecryption: %s\\n\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"Plaintext: %s\\n\"</span>, <span class=\"keyword\">string</span>(plaintext))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rsa\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/sha256\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    privateKey, err := rsa.GenerateKey(rand.Reader, <span class=\"number\">2048</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    message := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"message to be signed\"</span>)</span><br><span class=\"line\">    hashed := sha256.Sum256(message)  <span class=\"comment\">//  sha256 </span></span><br><span class=\"line\">    <span class=\"comment\">//  rsa </span></span><br><span class=\"line\">    signature, err := rsa.SignPKCS1v15(rand.Reader, privateKey, crypto.SHA256, hashed[:])</span><br><span class=\"line\">    <span class=\"comment\">//  rsa PSS </span></span><br><span class=\"line\">    <span class=\"comment\">// signature, err := rsa.SignPSS(rand.Reader, privateKey, crypto.SHA256, hashed[:], nil)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintf(os.Stderr, <span class=\"string\">\"Error from signing: %s\\n\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"Signature: %x\\n\"</span>, signature)</span><br><span class=\"line\">    <span class=\"comment\">//  rsa </span></span><br><span class=\"line\">    err = rsa.VerifyPKCS1v15(&amp;privateKey.PublicKey, crypto.SHA256, hashed[:], signature)</span><br><span class=\"line\">    <span class=\"comment\">//  rsa PSS </span></span><br><span class=\"line\">    <span class=\"comment\">// err = rsa.VerifyPSS(&amp;privateKey.PublicKey, crypto.SHA256, hashed[:], signature, nil)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintf(os.Stderr, <span class=\"string\">\"Error from verification: %s\\n\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"crypto-\"><a href=\"#crypto-\" class=\"headerlink\" title=\"crypto \"></a><code>crypto </code></h1><p>crypto ,. <code>import &quot;crypto&quot;</code>.</p>\n<p>.</p>\n<ul>\n<li>: , AES,DES()</li>\n<li>: , RSA</li>\n<li>: ,,,,, MD5,SHA1,HMAC </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Decrypter ,. RSA </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Decrypter <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Public() PublicKey</span><br><span class=\"line\">    <span class=\"comment\">//  msg.opts .</span></span><br><span class=\"line\">    Decrypt(rand io.Reader, msg []<span class=\"keyword\">byte</span>, opts DecrypterOpts) (plaintext []<span class=\"keyword\">byte</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> DecrypterOpts <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Hash </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Hash <span class=\"keyword\">uint</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PrivateKey <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PublicKey <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Signer ,.</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Signer <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Public() PublicKey</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  digest </span></span><br><span class=\"line\">    Sign(rand io.Reader, digest []<span class=\"keyword\">byte</span>, opts SignerOpts) (signature []<span class=\"keyword\">byte</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Signer </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> SignerOpts <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  `Signer.Sign` ,</span></span><br><span class=\"line\">    HashFunc() Hash</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    MD4         Hash = <span class=\"number\">1</span> + <span class=\"literal\">iota</span> <span class=\"comment\">// import golang.org/x/crypto/md4</span></span><br><span class=\"line\">    MD5                         <span class=\"comment\">// import crypto/md5</span></span><br><span class=\"line\">    SHA1                        <span class=\"comment\">// import crypto/sha1</span></span><br><span class=\"line\">    SHA224                      <span class=\"comment\">// import crypto/sha256</span></span><br><span class=\"line\">    SHA256                      <span class=\"comment\">// import crypto/sha256</span></span><br><span class=\"line\">    SHA384                      <span class=\"comment\">// import crypto/sha512</span></span><br><span class=\"line\">    SHA512                      <span class=\"comment\">// import crypto/sha512</span></span><br><span class=\"line\">    MD5SHA1                     <span class=\"comment\">// no implementation; MD5+SHA1 used for TLS RSA</span></span><br><span class=\"line\">    RIPEMD160                   <span class=\"comment\">// import golang.org/x/crypto/ripemd160</span></span><br><span class=\"line\">    SHA3_224                    <span class=\"comment\">// import golang.org/x/crypto/sha3</span></span><br><span class=\"line\">    SHA3_256                    <span class=\"comment\">// import golang.org/x/crypto/sha3</span></span><br><span class=\"line\">    SHA3_384                    <span class=\"comment\">// import golang.org/x/crypto/sha3</span></span><br><span class=\"line\">    SHA3_512                    <span class=\"comment\">// import golang.org/x/crypto/sha3</span></span><br><span class=\"line\">    SHA512_224                  <span class=\"comment\">// import crypto/sha512</span></span><br><span class=\"line\">    SHA512_256                  <span class=\"comment\">// import crypto/sha512</span></span><br><span class=\"line\">    BLAKE2s_256                 <span class=\"comment\">// import golang.org/x/crypto/blake2s</span></span><br><span class=\"line\">    BLAKE2b_256                 <span class=\"comment\">// import golang.org/x/crypto/blake2b</span></span><br><span class=\"line\">    BLAKE2b_384                 <span class=\"comment\">// import golang.org/x/crypto/blake2b</span></span><br><span class=\"line\">    BLAKE2b_512                 <span class=\"comment\">// import golang.org/x/crypto/blake2b</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">aes</td>\n<td align=\"left\"> AES</td>\n</tr>\n<tr>\n<td align=\"left\">cipher</td>\n<td align=\"left\">(CBC,ECB ),</td>\n</tr>\n<tr>\n<td align=\"left\">des</td>\n<td align=\"left\">(DES)(TDEA)</td>\n</tr>\n<tr>\n<td align=\"left\">dsa</td>\n<td align=\"left\"> FIPS 186-3 </td>\n</tr>\n<tr>\n<td align=\"left\">ecdsa</td>\n<td align=\"left\"> FIPS 186-3 </td>\n</tr>\n<tr>\n<td align=\"left\">ed25519</td>\n<td align=\"left\"> ED25519</td>\n</tr>\n<tr>\n<td align=\"left\">elliptic</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">hmac</td>\n<td align=\"left\"> Keyed-Hash </td>\n</tr>\n<tr>\n<td align=\"left\">md5</td>\n<td align=\"left\"> RFC 1321  MD5 </td>\n</tr>\n<tr>\n<td align=\"left\">rand</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">rc4</td>\n<td align=\"left\"> RC4 </td>\n</tr>\n<tr>\n<td align=\"left\">rsa</td>\n<td align=\"left\"> PKCS#1  RSA </td>\n</tr>\n<tr>\n<td align=\"left\">sha1</td>\n<td align=\"left\"> RFC 3174  SHA-1 </td>\n</tr>\n<tr>\n<td align=\"left\">sha256</td>\n<td align=\"left\"> FIPS 180-4  SHA224  SHA256 </td>\n</tr>\n<tr>\n<td align=\"left\">sha512</td>\n<td align=\"left\"> FIPS 180-4  SHA-384, SHA-512, SHA-512/224  SHA-512/256 </td>\n</tr>\n<tr>\n<td align=\"left\">tls</td>\n<td align=\"left\"> RFC 5246  TLS 1.2  RFC 8446  TLS 1.3</td>\n</tr>\n<tr>\n<td align=\"left\">x509</td>\n<td align=\"left\"> X.509 </td>\n</tr>\n<tr>\n<td align=\"left\">x509/pkix</td>\n<td align=\"left\">X.509,CRL  OCSP  ASN.1 </td>\n</tr>\n</tbody></table>\n<h1 id=\"crypto-aes\"><a href=\"#crypto-aes\" class=\"headerlink\" title=\"crypto/aes\"></a><code>crypto/aes</code></h1><p>aes  AES . <code>import &quot;crypto/aes&quot;</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// AES .</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BlockSize = <span class=\"number\">16</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `cipher.Block`</span></span><br><span class=\"line\"><span class=\"comment\">//  key  AES , 16,24  32  AES-128, AES-192  AES-256 </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCipher</span><span class=\"params\">(key []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(cipher.Block, error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"crypto-cipher\"><a href=\"#crypto-cipher\" class=\"headerlink\" title=\"crypto/cipher\"></a><code>crypto/cipher</code></h1><p>cipher (CBC,ECB ),. <code>import &quot;crypto/cipher&quot;</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// AEAD ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> AEAD <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  Seal  Open </span></span><br><span class=\"line\">    NonceSize() <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Overhead() <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ,</span></span><br><span class=\"line\">    <span class=\"comment\">// ,nonce  NonceSize() </span></span><br><span class=\"line\">    <span class=\"comment\">// ,nonce</span></span><br><span class=\"line\">    Seal(dst, nonce, plaintext, additionalData []<span class=\"keyword\">byte</span>) []<span class=\"keyword\">byte</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ,</span></span><br><span class=\"line\">    <span class=\"comment\">// ,nonce  NonceSize() </span></span><br><span class=\"line\">    <span class=\"comment\">// ,nonce</span></span><br><span class=\"line\">    Open(dst, nonce, ciphertext, additionalData []<span class=\"keyword\">byte</span>) ([]<span class=\"keyword\">byte</span>, error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ..</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Block <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    BlockSize() <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"comment\">//  src  dst. dst  src </span></span><br><span class=\"line\">    Encrypt(dst, src []<span class=\"keyword\">byte</span>)</span><br><span class=\"line\">    <span class=\"comment\">//  src  dst. dst  src </span></span><br><span class=\"line\">    Decrypt(dst, src []<span class=\"keyword\">byte</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> BlockMode <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    BlockSize() <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"comment\">// . src ,dst  src </span></span><br><span class=\"line\">    CryptBlocks(dst, src []<span class=\"keyword\">byte</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Stream <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  XOR.dst  src </span></span><br><span class=\"line\">    XORKeyStream(dst, src []<span class=\"keyword\">byte</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> StreamReader <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    S Stream</span><br><span class=\"line\">    R io.Reader</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> StreamWriter <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    S   Stream</span><br><span class=\"line\">    W   io.Writer</span><br><span class=\"line\">    Err error <span class=\"comment\">// unused</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"cipher-\"><a href=\"#cipher-\" class=\"headerlink\" title=\"cipher \"></a><code>cipher</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// GCM(12) 128  AEAD </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewGCM</span><span class=\"params\">(cipher Block)</span> <span class=\"params\">(AEAD, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// GCM(12) 128  AEAD </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewGCMWithNonceSize</span><span class=\"params\">(cipher Block, size <span class=\"keyword\">int</span>)</span> <span class=\"params\">(AEAD, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// (CBC)</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCBCDecrypter</span><span class=\"params\">(b Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">BlockMode</span></span></span><br><span class=\"line\"><span class=\"comment\">// (CBC)</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCBCEncrypter</span><span class=\"params\">(b Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">BlockMode</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// (CFB)</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCFBDecrypter</span><span class=\"params\">(block Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">Stream</span></span></span><br><span class=\"line\"><span class=\"comment\">// (CFB) Stream</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCFBEncrypter</span><span class=\"params\">(block Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">Stream</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// / Stream</span></span><br><span class=\"line\"><span class=\"comment\">// iv  iv </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCTR</span><span class=\"params\">(block Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">Stream</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// (OFB) Stream</span></span><br><span class=\"line\"><span class=\"comment\">// iv  b </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewOFB</span><span class=\"params\">(b Block, iv []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">Stream</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"AES-GCM-\"><a href=\"#AES-GCM-\" class=\"headerlink\" title=\"AES GCM \"></a>AES GCM </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/aes\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/cipher\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"encoding/base64\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AESGCMEncrypt</span><span class=\"params\">(plaintextStr <span class=\"keyword\">string</span>, keyStr <span class=\"keyword\">string</span>)</span> <span class=\"params\">(<span class=\"keyword\">string</span>, <span class=\"keyword\">string</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext := []<span class=\"keyword\">byte</span>(plaintextStr)</span><br><span class=\"line\">    key := []<span class=\"keyword\">byte</span>(keyStr)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    block, err := aes.NewCipher(key)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(fmt.Sprintf(<span class=\"string\">\"key  16/24/32: %s\"</span>, err.Error()))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  GCM  AEAD</span></span><br><span class=\"line\">    aesgcm, err := cipher.NewGCM(block)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ,.</span></span><br><span class=\"line\">    nonce := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, aesgcm.NonceSize())</span><br><span class=\"line\">    <span class=\"keyword\">if</span> _, err := io.ReadFull(rand.Reader, nonce); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ciphertext := aesgcm.Seal(<span class=\"literal\">nil</span>, nonce, plaintext, <span class=\"literal\">nil</span>)</span><br><span class=\"line\">    <span class=\"comment\">//  base64 </span></span><br><span class=\"line\">    fmt.Println(ciphertext, nonce, key)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> base64.RawURLEncoding.EncodeToString(ciphertext), base64.RawURLEncoding.EncodeToString(nonce)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AESGCMDecrypt</span><span class=\"params\">(ciphertextStr <span class=\"keyword\">string</span>, keyStr <span class=\"keyword\">string</span>, nonceStr <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ,</span></span><br><span class=\"line\">    ciphertext, _ := base64.RawURLEncoding.DecodeString(ciphertextStr)</span><br><span class=\"line\">    nonce, _ := base64.RawURLEncoding.DecodeString(nonceStr)</span><br><span class=\"line\">    key := []<span class=\"keyword\">byte</span>(keyStr)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    block, err := aes.NewCipher(key)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  GCM  AEAD</span></span><br><span class=\"line\">    aesgcm, err := cipher.NewGCM(block)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext, err := aesgcm.Open(<span class=\"literal\">nil</span>, nonce, ciphertext, <span class=\"literal\">nil</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">string</span>(plaintext)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    plaintext := <span class=\"string\">\"hello world\"</span></span><br><span class=\"line\">    key := <span class=\"string\">\"123456781234567812345678\"</span> <span class=\"comment\">// 16,24,32 </span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"\"</span>, plaintext)</span><br><span class=\"line\">    ciphertext, nonce := AESGCMEncrypt(plaintext, key)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, ciphertext, nonce)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, AESGCMDecrypt(ciphertext, key, nonce))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"AES-CBC-\"><a href=\"#AES-CBC-\" class=\"headerlink\" title=\"AES CBC \"></a>AES CBC </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bytes\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/aes\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/cipher\"</span></span><br><span class=\"line\">    <span class=\"string\">\"encoding/base64\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AESCBCEncrypt</span><span class=\"params\">(plaintextStr <span class=\"keyword\">string</span>, keyStr <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext := []<span class=\"keyword\">byte</span>(plaintextStr)</span><br><span class=\"line\">    key := []<span class=\"keyword\">byte</span>(keyStr)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    block, err := aes.NewCipher(key)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(fmt.Sprintf(<span class=\"string\">\"key  16/24/32: %s\"</span>, err.Error()))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockSize := block.BlockSize()</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext = PKCS7Padding(plaintext, blockSize)</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockMode := cipher.NewCBCEncrypter(block, key[:blockSize])</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ciphertext := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"built_in\">len</span>(plaintext))</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockMode.CryptBlocks(ciphertext, plaintext)</span><br><span class=\"line\">    <span class=\"comment\">// RawURLEncoding, StdEncoding,url</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> base64.RawURLEncoding.EncodeToString(ciphertext)</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AESCBCDecrypt</span><span class=\"params\">(ciphertextStr <span class=\"keyword\">string</span>, key <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// RawURLEncoding, StdEncoding url</span></span><br><span class=\"line\">    ciphertext, _ := base64.RawURLEncoding.DecodeString(ciphertextStr)</span><br><span class=\"line\">    k := []<span class=\"keyword\">byte</span>(key)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    block, err := aes.NewCipher(k)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(fmt.Sprintf(<span class=\"string\">\"key  16/24/32: %s\"</span>, err.Error()))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockSize := block.BlockSize()</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockMode := cipher.NewCBCDecrypter(block, k[:blockSize])</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"built_in\">len</span>(ciphertext))</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    blockMode.CryptBlocks(plaintext, ciphertext)</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext = PKCS7UnPadding(plaintext)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">string</span>(plaintext)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">PKCS7Padding</span><span class=\"params\">(plaintext []<span class=\"keyword\">byte</span>, blocksize <span class=\"keyword\">int</span>)</span> []<span class=\"title\">byte</span></span> &#123;</span><br><span class=\"line\">    padding := blocksize - <span class=\"built_in\">len</span>(plaintext)%blocksize</span><br><span class=\"line\">    padtext := bytes.Repeat([]<span class=\"keyword\">byte</span>&#123;<span class=\"keyword\">byte</span>(padding)&#125;, padding)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">append</span>(plaintext, padtext...)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">PKCS7UnPadding</span><span class=\"params\">(plaintext []<span class=\"keyword\">byte</span>)</span> []<span class=\"title\">byte</span></span> &#123;</span><br><span class=\"line\">    length := <span class=\"built_in\">len</span>(plaintext)</span><br><span class=\"line\">    unpadding := <span class=\"keyword\">int</span>(plaintext[length<span class=\"number\">-1</span>])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> plaintext[:(length - unpadding)]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    plaintext := <span class=\"string\">\"hello world\"</span></span><br><span class=\"line\">    key := <span class=\"string\">\"123456781234567812345678\"</span> <span class=\"comment\">// 16,24,32 </span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, plaintext)</span><br><span class=\"line\">    ciphertext := AESCBCEncrypt(plaintext, key)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, ciphertext)</span><br><span class=\"line\">    plaintext2 := AESCBCDecrypt(ciphertext, key)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\": \"</span>, plaintext2)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>CFB  CBC , <code>blockMode</code> </p>\n<h1 id=\"crypto-md5\"><a href=\"#crypto-md5\" class=\"headerlink\" title=\"crypto/md5\"></a><code>crypto/md5</code></h1><p>md5  RFC 1321  MD5 . <code>import &quot;crypto/md5&quot;</code>. <code>sha1</code>,<code>sha256</code>,<code>sha512</code>  <code>md5</code> ,</p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// MD5,</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BlockSize = <span class=\"number\">64</span></span><br><span class=\"line\"><span class=\"comment\">// MD5 </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> Size = <span class=\"number\">16</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `hash.Hash`, MD5.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">New</span><span class=\"params\">()</span> <span class=\"title\">hash</span>.<span class=\"title\">Hash</span></span></span><br><span class=\"line\"><span class=\"comment\">//  data  MD5 </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sum</span><span class=\"params\">(data []<span class=\"keyword\">byte</span>)</span> [<span class=\"title\">Size</span>]<span class=\"title\">byte</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/md5\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  `hash.Hash`</span></span><br><span class=\"line\">    h := md5.New()</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    io.WriteString(h, <span class=\"string\">\"The fog is getting thicker!\"</span>)</span><br><span class=\"line\">    io.WriteString(h, <span class=\"string\">\"And Leon's getting laaarger!\"</span>)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%x\"</span>, h.Sum(<span class=\"literal\">nil</span>)) <span class=\"comment\">// h.Sum() </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  md5.Sum(data []byte) </span></span><br><span class=\"line\">    data := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"These pretzels are making me thirsty.\"</span>)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%x\"</span>, md5.Sum(data))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/md5\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    f, err := os.Open(<span class=\"string\">\"file.txt\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Fatal(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> f.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">    h := md5.New()</span><br><span class=\"line\">    <span class=\"comment\">// , h </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> _, err := io.Copy(h, f); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Fatal(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%x\"</span>, h.Sum(<span class=\"literal\">nil</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"crypto-rand\"><a href=\"#crypto-rand\" class=\"headerlink\" title=\"crypto/rand\"></a><code>crypto/rand</code></h1><p>rand . <code>var Reader io.Reader</code> </p>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Reader io.Reader</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  [0,max) </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Int</span><span class=\"params\">(rand io.Reader, max *big.Int)</span> <span class=\"params\">(n *big.Int, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  b. io.ReadFull(Reader, b),.</span></span><br><span class=\"line\"><span class=\"comment\">//  n=len(b), err=nil</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Read</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , `io.ReadFull`  rand.Reader  nonce </span></span><br><span class=\"line\">nonce := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">12</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> _, err := io.ReadFull(rand.Reader, nonce); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err.Error())</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"crypto-rsa\"><a href=\"#crypto-rsa\" class=\"headerlink\" title=\"crypto/rsa\"></a><code>crypto/rsa</code></h1><p>rsa  RSA ,,,.</p>\n<p>RSA ,. RSA .</p>\n<h2 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    <span class=\"comment\">// PSSSaltLengthAuto  RSA-PSS ,</span></span><br><span class=\"line\">    PSSSaltLengthAuto = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"comment\">// PSSSaltLengthEqualsHash </span></span><br><span class=\"line\">    PSSSaltLengthEqualsHash = <span class=\"number\">-1</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// RSA , `rsa.GenerateKey` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PrivateKey <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    PublicKey            <span class=\"comment\">// </span></span><br><span class=\"line\">    D         *big.Int   <span class=\"comment\">// private exponent</span></span><br><span class=\"line\">    Primes    []*big.Int <span class=\"comment\">// prime factors of N, has &gt;= 2 elements.</span></span><br><span class=\"line\">    <span class=\"comment\">// Precomputed contains precomputed values that speed up private operations, if available.</span></span><br><span class=\"line\">    Precomputed PrecomputedValues</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// RSA ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PublicKey <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    N *big.Int <span class=\"comment\">// modulus</span></span><br><span class=\"line\">    E <span class=\"keyword\">int</span>      <span class=\"comment\">// public exponent</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  `crypto.Decrypter`  OAEP </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> OAEPOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// .</span></span><br><span class=\"line\">    Hash crypto.Hash</span><br><span class=\"line\">    <span class=\"comment\">// , Label</span></span><br><span class=\"line\">    Label []<span class=\"keyword\">byte</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  `crypto.Decrypter` PKCS#1 v1.5  PKCS1v15 </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PKCS1v15DecryptOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// . ,,</span></span><br><span class=\"line\">    SessionKeyLen <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  RSA-PSS </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PSSOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  PSS ,, PSSSaltLength </span></span><br><span class=\"line\">    SaltLength <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  SignPSS  hash </span></span><br><span class=\"line\">    <span class=\"comment\">//  crypto.Signer </span></span><br><span class=\"line\">    Hash crypto.Hash</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"rsa-\"><a href=\"#rsa-\" class=\"headerlink\" title=\"rsa \"></a><code>rsa</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  random  bits  RSA </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GenerateKey</span><span class=\"params\">(random io.Reader, bits <span class=\"keyword\">int</span>)</span> <span class=\"params\">(*PrivateKey, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  RSA-OAEP  msg </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">EncryptOAEP</span><span class=\"params\">(hash hash.Hash, random io.Reader, pub *PublicKey, msg []<span class=\"keyword\">byte</span>, label []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  RSA-OAEP  ciphertext </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DecryptOAEP</span><span class=\"params\">(hash hash.Hash, random io.Reader, priv *PrivateKey, ciphertext []<span class=\"keyword\">byte</span>, label []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  RSA  PKCS#1 v1.5  msg </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">EncryptPKCS1v15</span><span class=\"params\">(rand io.Reader, pub *PublicKey, msg []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DecryptPKCS1v15</span><span class=\"params\">(rand io.Reader, priv *PrivateKey, ciphertext []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  RSA PKCS1 v1.5  RSASSA-PKCS1-V1_5-SIGN  hashed </span></span><br><span class=\"line\"><span class=\"comment\">// hashed  hash  msg </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SignPKCS1v15</span><span class=\"params\">(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">VerifyPKCS1v15</span><span class=\"params\">(pub *PublicKey, hash crypto.Hash, hashed []<span class=\"keyword\">byte</span>, sig []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  RSASSA-PSS [1] hashed </span></span><br><span class=\"line\"><span class=\"comment\">// hashed  hash  msg .optsnil,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SignPSS</span><span class=\"params\">(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []<span class=\"keyword\">byte</span>, opts *PSSOptions)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"PrivateKey-\"><a href=\"#PrivateKey-\" class=\"headerlink\" title=\"PrivateKey \"></a><code>PrivateKey</code> </h3><p><code>PrivateKey</code>  <code>crypto.Decrypter</code>  <code>crypto.Signer</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  priv  ciphertext ,</span></span><br><span class=\"line\"><span class=\"comment\">//  opts  *PKCS1v15DecryptOptions, PKCS#1 v1.5 . *OAEPOptions  OAEP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Decrypt</span><span class=\"params\">(rand io.Reader, ciphertext []<span class=\"keyword\">byte</span>, opts crypto.DecrypterOpts)</span> <span class=\"params\">(plaintext []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Precompute</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Public</span><span class=\"params\">()</span> <span class=\"title\">crypto</span>.<span class=\"title\">PublicKey</span></span></span><br><span class=\"line\"><span class=\"comment\">// , rand </span></span><br><span class=\"line\"><span class=\"comment\">//  opts  *PSSOptions  PSS, PKCS#1 v1.5 </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Sign</span><span class=\"params\">(rand io.Reader, digest []<span class=\"keyword\">byte</span>, opts crypto.SignerOpts)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(priv *PrivateKey)</span> <span class=\"title\">Validate</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rsa\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/sha256\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    privateKey, err := rsa.GenerateKey(rand.Reader, <span class=\"number\">2048</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    msg := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"send reinforcements, we're going to advance\"</span>)</span><br><span class=\"line\">    label := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"orders\"</span>)</span><br><span class=\"line\">    rng := rand.Reader</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ciphertext, err := rsa.EncryptOAEP(sha256.New(), rng, &amp;privateKey.PublicKey, msg, label)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintf(os.Stderr, <span class=\"string\">\"Error from encryption: %s\\n\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"Ciphertext: %x\\n\"</span>, ciphertext)</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    plaintext, err := rsa.DecryptOAEP(sha256.New(), rng, privateKey, ciphertext, label)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintf(os.Stderr, <span class=\"string\">\"Error from deecryption: %s\\n\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"Plaintext: %s\\n\"</span>, <span class=\"keyword\">string</span>(plaintext))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rsa\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/sha256\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    privateKey, err := rsa.GenerateKey(rand.Reader, <span class=\"number\">2048</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    message := []<span class=\"keyword\">byte</span>(<span class=\"string\">\"message to be signed\"</span>)</span><br><span class=\"line\">    hashed := sha256.Sum256(message)  <span class=\"comment\">//  sha256 </span></span><br><span class=\"line\">    <span class=\"comment\">//  rsa </span></span><br><span class=\"line\">    signature, err := rsa.SignPKCS1v15(rand.Reader, privateKey, crypto.SHA256, hashed[:])</span><br><span class=\"line\">    <span class=\"comment\">//  rsa PSS </span></span><br><span class=\"line\">    <span class=\"comment\">// signature, err := rsa.SignPSS(rand.Reader, privateKey, crypto.SHA256, hashed[:], nil)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintf(os.Stderr, <span class=\"string\">\"Error from signing: %s\\n\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"Signature: %x\\n\"</span>, signature)</span><br><span class=\"line\">    <span class=\"comment\">//  rsa </span></span><br><span class=\"line\">    err = rsa.VerifyPKCS1v15(&amp;privateKey.PublicKey, crypto.SHA256, hashed[:], signature)</span><br><span class=\"line\">    <span class=\"comment\">//  rsa PSS </span></span><br><span class=\"line\">    <span class=\"comment\">// err = rsa.VerifyPSS(&amp;privateKey.PublicKey, crypto.SHA256, hashed[:], signature, nil)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Fprintf(os.Stderr, <span class=\"string\">\"Error from verification: %s\\n\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go  fmt ","abbrlink":28915,"description":" Go fmt .fmt  I/O.","_content":"\nfmt  I/O.:\n\n```go\ntype User struct {\n\tName string\n}\nuser := User{Name: \"name\"}\n```\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%v |  | `Printf(\"%v\", user)` | {name}\n%+v | , | `Printf(\"%+v\", user)` | {Name:name}\n%#v | Go  | `Printf(\"%#v\", user)` | main.User{Name:\"name\"}\n%T | Go  | `Printf(\"%T\", user)` | main.User\n%% |  | `Printf(\"%%\")` | %\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%t | true  false | `Printf(\"%t\", true)` | true\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%b | ( 0 , 01) | `Printf(\"%b\", 8)` | 1000\n%d |  ( 0 ,0-9) | `Printf(\"%b\", 8)` | 8\n%o | ( 0 , 0-7) | `Printf(\"%o\", 32)` | 40\n%x | ( 0x ) | `Printf(\"%x\", 223)` | df\n%X | ( 0X ) | `Printf(\"%X\", 223)` | DF\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%e | , | `Printf(\"%.2e\", 1024.5)` | 1.02e+03\n%E | , | `Printf(\"%.2E\", 1024.5)` | 1.02E+03\n%f | , | `Printf(\"%.2f\", 22.2335)` | 2.23\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%s |  | `Printf(\"%s,%s\", \"str\", []byte(\"str\")` | str,str\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%p | , | Printf(\"%p\", []byte(\"string\")) | 0xc0000160b0\n\n```go\n// , w\nfunc Fprint(w io.Writer, a ...interface{}) (n int, err error)\nfunc Fprintf(w io.Writer, format string, a ...interface{}) (n int, err error)\nfunc Fprintln(w io.Writer, a ...interface{}) (n int, err error)\n\n//  r ,,\nfunc Fscan(r io.Reader, a ...interface{}) (n int, err error)\nfunc Fscanf(r io.Reader, format string, a ...interface{}) (n int, err error)\nfunc Fscanln(r io.Reader, a ...interface{}) (n int, err error)\n\n// \nfunc Print(a ...interface{}) (n int, err error)\nfunc Printf(format string, a ...interface{}) (n int, err error)\nfunc Println(a ...interface{}) (n int, err error)\n\n// \nfunc Scan(a ...interface{}) (n int, err error)\nfunc Scanf(format string, a ...interface{}) (n int, err error)\nfunc Scanln(a ...interface{}) (n int, err error)\nfunc Sprint(a ...interface{}) string\n\n//  format ,\nfunc Sprintf(format string, a ...interface{}) string\nfunc Sprintln(a ...interface{}) string\n\n//  str ,,\nfunc Sscan(str string, a ...interface{}) (n int, err error)\nfunc Sscanf(str string, format string, a ...interface{}) (n int, err error)\nfunc Sscanln(str string, a ...interface{}) (n int, err error)\n```\n","source":"_posts/go-study-notes-package-fmt.md","raw":"---\ntitle: go  fmt \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 28915\ndescription:  Go fmt .fmt  I/O.\n---\n\nfmt  I/O.:\n\n```go\ntype User struct {\n\tName string\n}\nuser := User{Name: \"name\"}\n```\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%v |  | `Printf(\"%v\", user)` | {name}\n%+v | , | `Printf(\"%+v\", user)` | {Name:name}\n%#v | Go  | `Printf(\"%#v\", user)` | main.User{Name:\"name\"}\n%T | Go  | `Printf(\"%T\", user)` | main.User\n%% |  | `Printf(\"%%\")` | %\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%t | true  false | `Printf(\"%t\", true)` | true\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%b | ( 0 , 01) | `Printf(\"%b\", 8)` | 1000\n%d |  ( 0 ,0-9) | `Printf(\"%b\", 8)` | 8\n%o | ( 0 , 0-7) | `Printf(\"%o\", 32)` | 40\n%x | ( 0x ) | `Printf(\"%x\", 223)` | df\n%X | ( 0X ) | `Printf(\"%X\", 223)` | DF\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%e | , | `Printf(\"%.2e\", 1024.5)` | 1.02e+03\n%E | , | `Printf(\"%.2E\", 1024.5)` | 1.02E+03\n%f | , | `Printf(\"%.2f\", 22.2335)` | 2.23\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%s |  | `Printf(\"%s,%s\", \"str\", []byte(\"str\")` | str,str\n\n- \n\n |  |  | \n:---: | :---: | :---: | :---:\n%p | , | Printf(\"%p\", []byte(\"string\")) | 0xc0000160b0\n\n```go\n// , w\nfunc Fprint(w io.Writer, a ...interface{}) (n int, err error)\nfunc Fprintf(w io.Writer, format string, a ...interface{}) (n int, err error)\nfunc Fprintln(w io.Writer, a ...interface{}) (n int, err error)\n\n//  r ,,\nfunc Fscan(r io.Reader, a ...interface{}) (n int, err error)\nfunc Fscanf(r io.Reader, format string, a ...interface{}) (n int, err error)\nfunc Fscanln(r io.Reader, a ...interface{}) (n int, err error)\n\n// \nfunc Print(a ...interface{}) (n int, err error)\nfunc Printf(format string, a ...interface{}) (n int, err error)\nfunc Println(a ...interface{}) (n int, err error)\n\n// \nfunc Scan(a ...interface{}) (n int, err error)\nfunc Scanf(format string, a ...interface{}) (n int, err error)\nfunc Scanln(a ...interface{}) (n int, err error)\nfunc Sprint(a ...interface{}) string\n\n//  format ,\nfunc Sprintf(format string, a ...interface{}) string\nfunc Sprintln(a ...interface{}) string\n\n//  str ,,\nfunc Sscan(str string, a ...interface{}) (n int, err error)\nfunc Sscanf(str string, format string, a ...interface{}) (n int, err error)\nfunc Sscanln(str string, a ...interface{}) (n int, err error)\n```\n","slug":"go-study-notes-package-fmt","published":1,"date":"2020-05-16T00:03:57.830Z","updated":"2020-05-17T03:56:59.114Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvf0012k8u766c63pn3","content":"<p>fmt  I/O.:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">user := User&#123;Name: <span class=\"string\">\"name\"</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%v</td>\n<td align=\"center\"></td>\n<td align=\"center\"><code>Printf(&quot;%v&quot;, user)</code></td>\n<td align=\"center\">{name}</td>\n</tr>\n<tr>\n<td align=\"center\">%+v</td>\n<td align=\"center\">,</td>\n<td align=\"center\"><code>Printf(&quot;%+v&quot;, user)</code></td>\n<td align=\"center\">{Name:name}</td>\n</tr>\n<tr>\n<td align=\"center\">%#v</td>\n<td align=\"center\">Go </td>\n<td align=\"center\"><code>Printf(&quot;%#v&quot;, user)</code></td>\n<td align=\"center\">main.User{Name:name}</td>\n</tr>\n<tr>\n<td align=\"center\">%T</td>\n<td align=\"center\">Go </td>\n<td align=\"center\"><code>Printf(&quot;%T&quot;, user)</code></td>\n<td align=\"center\">main.User</td>\n</tr>\n<tr>\n<td align=\"center\">%%</td>\n<td align=\"center\"></td>\n<td align=\"center\"><code>Printf(&quot;%%&quot;)</code></td>\n<td align=\"center\">%</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%t</td>\n<td align=\"center\">true  false</td>\n<td align=\"center\"><code>Printf(&quot;%t&quot;, true)</code></td>\n<td align=\"center\">true</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%b</td>\n<td align=\"center\">( 0 , 01)</td>\n<td align=\"center\"><code>Printf(&quot;%b&quot;, 8)</code></td>\n<td align=\"center\">1000</td>\n</tr>\n<tr>\n<td align=\"center\">%d</td>\n<td align=\"center\">( 0 ,0-9)</td>\n<td align=\"center\"><code>Printf(&quot;%b&quot;, 8)</code></td>\n<td align=\"center\">8</td>\n</tr>\n<tr>\n<td align=\"center\">%o</td>\n<td align=\"center\">( 0 , 0-7)</td>\n<td align=\"center\"><code>Printf(&quot;%o&quot;, 32)</code></td>\n<td align=\"center\">40</td>\n</tr>\n<tr>\n<td align=\"center\">%x</td>\n<td align=\"center\">( 0x )</td>\n<td align=\"center\"><code>Printf(&quot;%x&quot;, 223)</code></td>\n<td align=\"center\">df</td>\n</tr>\n<tr>\n<td align=\"center\">%X</td>\n<td align=\"center\">( 0X )</td>\n<td align=\"center\"><code>Printf(&quot;%X&quot;, 223)</code></td>\n<td align=\"center\">DF</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%e</td>\n<td align=\"center\">,</td>\n<td align=\"center\"><code>Printf(&quot;%.2e&quot;, 1024.5)</code></td>\n<td align=\"center\">1.02e+03</td>\n</tr>\n<tr>\n<td align=\"center\">%E</td>\n<td align=\"center\">,</td>\n<td align=\"center\"><code>Printf(&quot;%.2E&quot;, 1024.5)</code></td>\n<td align=\"center\">1.02E+03</td>\n</tr>\n<tr>\n<td align=\"center\">%f</td>\n<td align=\"center\">,</td>\n<td align=\"center\"><code>Printf(&quot;%.2f&quot;, 22.2335)</code></td>\n<td align=\"center\">2.23</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%s</td>\n<td align=\"center\"></td>\n<td align=\"center\"><code>Printf(&quot;%s,%s&quot;, &quot;str&quot;, []byte(&quot;str&quot;)</code></td>\n<td align=\"center\">str,str</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%p</td>\n<td align=\"center\">,</td>\n<td align=\"center\">Printf(%p, []byte(string))</td>\n<td align=\"center\">0xc0000160b0</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , w</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fprint</span><span class=\"params\">(w io.Writer, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fprintf</span><span class=\"params\">(w io.Writer, format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fprintln</span><span class=\"params\">(w io.Writer, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  r ,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fscan</span><span class=\"params\">(r io.Reader, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fscanf</span><span class=\"params\">(r io.Reader, format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fscanln</span><span class=\"params\">(r io.Reader, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Print</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Printf</span><span class=\"params\">(format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Println</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Scan</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Scanf</span><span class=\"params\">(format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Scanln</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sprint</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  format ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sprintf</span><span class=\"params\">(format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sprintln</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  str ,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sscan</span><span class=\"params\">(str <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sscanf</span><span class=\"params\">(str <span class=\"keyword\">string</span>, format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sscanln</span><span class=\"params\">(str <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>fmt  I/O.:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">user := User&#123;Name: <span class=\"string\">\"name\"</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%v</td>\n<td align=\"center\"></td>\n<td align=\"center\"><code>Printf(&quot;%v&quot;, user)</code></td>\n<td align=\"center\">{name}</td>\n</tr>\n<tr>\n<td align=\"center\">%+v</td>\n<td align=\"center\">,</td>\n<td align=\"center\"><code>Printf(&quot;%+v&quot;, user)</code></td>\n<td align=\"center\">{Name:name}</td>\n</tr>\n<tr>\n<td align=\"center\">%#v</td>\n<td align=\"center\">Go </td>\n<td align=\"center\"><code>Printf(&quot;%#v&quot;, user)</code></td>\n<td align=\"center\">main.User{Name:name}</td>\n</tr>\n<tr>\n<td align=\"center\">%T</td>\n<td align=\"center\">Go </td>\n<td align=\"center\"><code>Printf(&quot;%T&quot;, user)</code></td>\n<td align=\"center\">main.User</td>\n</tr>\n<tr>\n<td align=\"center\">%%</td>\n<td align=\"center\"></td>\n<td align=\"center\"><code>Printf(&quot;%%&quot;)</code></td>\n<td align=\"center\">%</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%t</td>\n<td align=\"center\">true  false</td>\n<td align=\"center\"><code>Printf(&quot;%t&quot;, true)</code></td>\n<td align=\"center\">true</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%b</td>\n<td align=\"center\">( 0 , 01)</td>\n<td align=\"center\"><code>Printf(&quot;%b&quot;, 8)</code></td>\n<td align=\"center\">1000</td>\n</tr>\n<tr>\n<td align=\"center\">%d</td>\n<td align=\"center\">( 0 ,0-9)</td>\n<td align=\"center\"><code>Printf(&quot;%b&quot;, 8)</code></td>\n<td align=\"center\">8</td>\n</tr>\n<tr>\n<td align=\"center\">%o</td>\n<td align=\"center\">( 0 , 0-7)</td>\n<td align=\"center\"><code>Printf(&quot;%o&quot;, 32)</code></td>\n<td align=\"center\">40</td>\n</tr>\n<tr>\n<td align=\"center\">%x</td>\n<td align=\"center\">( 0x )</td>\n<td align=\"center\"><code>Printf(&quot;%x&quot;, 223)</code></td>\n<td align=\"center\">df</td>\n</tr>\n<tr>\n<td align=\"center\">%X</td>\n<td align=\"center\">( 0X )</td>\n<td align=\"center\"><code>Printf(&quot;%X&quot;, 223)</code></td>\n<td align=\"center\">DF</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%e</td>\n<td align=\"center\">,</td>\n<td align=\"center\"><code>Printf(&quot;%.2e&quot;, 1024.5)</code></td>\n<td align=\"center\">1.02e+03</td>\n</tr>\n<tr>\n<td align=\"center\">%E</td>\n<td align=\"center\">,</td>\n<td align=\"center\"><code>Printf(&quot;%.2E&quot;, 1024.5)</code></td>\n<td align=\"center\">1.02E+03</td>\n</tr>\n<tr>\n<td align=\"center\">%f</td>\n<td align=\"center\">,</td>\n<td align=\"center\"><code>Printf(&quot;%.2f&quot;, 22.2335)</code></td>\n<td align=\"center\">2.23</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%s</td>\n<td align=\"center\"></td>\n<td align=\"center\"><code>Printf(&quot;%s,%s&quot;, &quot;str&quot;, []byte(&quot;str&quot;)</code></td>\n<td align=\"center\">str,str</td>\n</tr>\n</tbody></table>\n<ul>\n<li></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%p</td>\n<td align=\"center\">,</td>\n<td align=\"center\">Printf(%p, []byte(string))</td>\n<td align=\"center\">0xc0000160b0</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , w</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fprint</span><span class=\"params\">(w io.Writer, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fprintf</span><span class=\"params\">(w io.Writer, format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fprintln</span><span class=\"params\">(w io.Writer, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  r ,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fscan</span><span class=\"params\">(r io.Reader, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fscanf</span><span class=\"params\">(r io.Reader, format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Fscanln</span><span class=\"params\">(r io.Reader, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Print</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Printf</span><span class=\"params\">(format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Println</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Scan</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Scanf</span><span class=\"params\">(format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Scanln</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sprint</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  format ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sprintf</span><span class=\"params\">(format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sprintln</span><span class=\"params\">(a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  str ,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sscan</span><span class=\"params\">(str <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sscanf</span><span class=\"params\">(str <span class=\"keyword\">string</span>, format <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sscanln</span><span class=\"params\">(str <span class=\"keyword\">string</span>, a ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n"},{"title":"go  io ","abbrlink":6060,"description":" Go io .io  IO ,.","_content":"\n`io`  IO . ( os ),.\n\n# \n\n```go\n// \ntype Reader interface {\n     //  len(p)  p.(0<=n<=len(p).,  0 io.EOF \n    Read(p []byte) (n int, err error)\n}\n\ntype ReaderAt interface {\n    //  off  len(p)  p.(0<=n<=len(p)\n    ReadAt(p []byte, off int64) (n int, err error)\n}\n\ntype ReaderFrom interface {\n    //  r (EOF).  n (EOF)\n    ReadFrom(r Reader) (n int64, err error)\n}\n\ntype ByteReader interface {\n    // \n    ReadByte() (c byte, err error)\n}\n\n// \ntype Writer interface {\n    //  p  len(p) .(0<=n<=len(p).\n    Write(p []byte) (n int, err error)\n}\n\ntype WriterAt interface {\n    //  off , p  len(p) .(0<=n<=len(p).\n    WriteAt(p []byte, off int64) (n int, err error)\n}\n\ntype WriterTo interface {\n    //  w . n \n    WriteTo(w Writer) (n int64, err error)\n}\n\ntype StringWriter interface {\n    //  s ,(0<=n<=len(s)\n    WriteString(s string) (n int, err error)\n}\n\n// \ntype ReadWriter interface {\n    Reader\n    Writer\n}\n\n//\ntype Closer interface {\n    // \n    Close() error\n}\n\n// \ntype Seeker interface {\n    // ,whence ,offset .\n    // whence  `io.SeekStart`(0,),`io.SeekCurrent`(1,),`io.SeekEnd`(2,).\n    Seek(offset int64, whence int) (int64, error)\n}\n```\n\n# \n\n```go\nconst (\n    SeekStart   = 0 // \n    SeekCurrent = 1 // \n    SeekEnd     = 2 // \n)\n\n// ,Read  EOF.\nvar EOF = errors.New(\"EOF\")  \n```\n\n# \n\n# `io` \n\n```go\n//  src  dst.\n//  `CopyBuffer(dst, src, nil)`, , 32 * 1024\nfunc Copy(dst Writer, src Reader) (written int64, err error)\n//  src  n  dst, EOF.\nfunc CopyN(dst Writer, src Reader, n int64) (written int64, err error)\n//  src  dst.. buf \nfunc CopyBuffer(dst Writer, src Reader, buf []byte) (written int64, err error)\n//  r  min  buf .\nfunc ReadAtLeast(r Reader, buf []byte, min int) (n int, err error)\n//  r  len(buf)  buf .\n// ,ReadAtLeast(r, buf, len(buf)). n<len(buf), io.EOF \nfunc ReadFull(r Reader, buf []byte) (n int, err error)\n//   s  w .\n//   w  StringWriter , `w.WriteString()` . https://github.com/golang/go/blob/master/src/io/io.go#L293\nfunc WriteString(w Writer, s string) (n int, err error) \n```\n\n# \n\n\n\n```go\nimport (\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\nfunc copyFileExample(src, dest string) (err error) {\n    srcFile, err := os.Open(src)\n    defer srcFile.Close()\n    destFile, err := os.OpenFile(dest, os.O_CREATE|os.O_RDWR|os.O_SYNC, 0)\n    defer destFile.Close()\n    _, err = io.Copy(destFile, srcFile)\n    return\n}\n\nfunc main() {\n    err := copyFileExample(\"src\", \"dest\")\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n```","source":"_posts/go-study-notes-package-io.md","raw":"---\ntitle: go  io \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 6060\ndescription: ' Go io .io  IO ,.'\n---\n\n`io`  IO . ( os ),.\n\n# \n\n```go\n// \ntype Reader interface {\n     //  len(p)  p.(0<=n<=len(p).,  0 io.EOF \n    Read(p []byte) (n int, err error)\n}\n\ntype ReaderAt interface {\n    //  off  len(p)  p.(0<=n<=len(p)\n    ReadAt(p []byte, off int64) (n int, err error)\n}\n\ntype ReaderFrom interface {\n    //  r (EOF).  n (EOF)\n    ReadFrom(r Reader) (n int64, err error)\n}\n\ntype ByteReader interface {\n    // \n    ReadByte() (c byte, err error)\n}\n\n// \ntype Writer interface {\n    //  p  len(p) .(0<=n<=len(p).\n    Write(p []byte) (n int, err error)\n}\n\ntype WriterAt interface {\n    //  off , p  len(p) .(0<=n<=len(p).\n    WriteAt(p []byte, off int64) (n int, err error)\n}\n\ntype WriterTo interface {\n    //  w . n \n    WriteTo(w Writer) (n int64, err error)\n}\n\ntype StringWriter interface {\n    //  s ,(0<=n<=len(s)\n    WriteString(s string) (n int, err error)\n}\n\n// \ntype ReadWriter interface {\n    Reader\n    Writer\n}\n\n//\ntype Closer interface {\n    // \n    Close() error\n}\n\n// \ntype Seeker interface {\n    // ,whence ,offset .\n    // whence  `io.SeekStart`(0,),`io.SeekCurrent`(1,),`io.SeekEnd`(2,).\n    Seek(offset int64, whence int) (int64, error)\n}\n```\n\n# \n\n```go\nconst (\n    SeekStart   = 0 // \n    SeekCurrent = 1 // \n    SeekEnd     = 2 // \n)\n\n// ,Read  EOF.\nvar EOF = errors.New(\"EOF\")  \n```\n\n# \n\n# `io` \n\n```go\n//  src  dst.\n//  `CopyBuffer(dst, src, nil)`, , 32 * 1024\nfunc Copy(dst Writer, src Reader) (written int64, err error)\n//  src  n  dst, EOF.\nfunc CopyN(dst Writer, src Reader, n int64) (written int64, err error)\n//  src  dst.. buf \nfunc CopyBuffer(dst Writer, src Reader, buf []byte) (written int64, err error)\n//  r  min  buf .\nfunc ReadAtLeast(r Reader, buf []byte, min int) (n int, err error)\n//  r  len(buf)  buf .\n// ,ReadAtLeast(r, buf, len(buf)). n<len(buf), io.EOF \nfunc ReadFull(r Reader, buf []byte) (n int, err error)\n//   s  w .\n//   w  StringWriter , `w.WriteString()` . https://github.com/golang/go/blob/master/src/io/io.go#L293\nfunc WriteString(w Writer, s string) (n int, err error) \n```\n\n# \n\n\n\n```go\nimport (\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\nfunc copyFileExample(src, dest string) (err error) {\n    srcFile, err := os.Open(src)\n    defer srcFile.Close()\n    destFile, err := os.OpenFile(dest, os.O_CREATE|os.O_RDWR|os.O_SYNC, 0)\n    defer destFile.Close()\n    _, err = io.Copy(destFile, srcFile)\n    return\n}\n\nfunc main() {\n    err := copyFileExample(\"src\", \"dest\")\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n```","slug":"go-study-notes-package-io","published":1,"date":"2020-05-02T07:56:31.997Z","updated":"2020-05-05T07:25:01.768Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvg0015k8u70qbb74x3","content":"<p><code>io</code>  IO . ( os ),.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Reader <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">     <span class=\"comment\">//  len(p)  p.(0&lt;=n&lt;=len(p).,  0 io.EOF </span></span><br><span class=\"line\">    Read(p []<span class=\"keyword\">byte</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ReaderAt <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  off  len(p)  p.(0&lt;=n&lt;=len(p)</span></span><br><span class=\"line\">    ReadAt(p []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ReaderFrom <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  r (EOF).  n (EOF)</span></span><br><span class=\"line\">    ReadFrom(r Reader) (n <span class=\"keyword\">int64</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByteReader <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ReadByte() (c <span class=\"keyword\">byte</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Writer <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  p  len(p) .(0&lt;=n&lt;=len(p).</span></span><br><span class=\"line\">    Write(p []<span class=\"keyword\">byte</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> WriterAt <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  off , p  len(p) .(0&lt;=n&lt;=len(p).</span></span><br><span class=\"line\">    WriteAt(p []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> WriterTo <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  w . n </span></span><br><span class=\"line\">    WriteTo(w Writer) (n <span class=\"keyword\">int64</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> StringWriter <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  s ,(0&lt;=n&lt;=len(s)</span></span><br><span class=\"line\">    WriteString(s <span class=\"keyword\">string</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ReadWriter <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Reader</span><br><span class=\"line\">    Writer</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Closer <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Close() error</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Seeker <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ,whence ,offset .</span></span><br><span class=\"line\">    <span class=\"comment\">// whence  `io.SeekStart`(0,),`io.SeekCurrent`(1,),`io.SeekEnd`(2,).</span></span><br><span class=\"line\">    Seek(offset <span class=\"keyword\">int64</span>, whence <span class=\"keyword\">int</span>) (<span class=\"keyword\">int64</span>, error)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    SeekStart   = <span class=\"number\">0</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    SeekCurrent = <span class=\"number\">1</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    SeekEnd     = <span class=\"number\">2</span> <span class=\"comment\">// </span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,Read  EOF.</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> EOF = errors.New(<span class=\"string\">\"EOF\"</span>)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"io-\"><a href=\"#io-\" class=\"headerlink\" title=\"io \"></a><code>io</code> </h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  src  dst.</span></span><br><span class=\"line\"><span class=\"comment\">//  `CopyBuffer(dst, src, nil)`, , 32 * 1024</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Copy</span><span class=\"params\">(dst Writer, src Reader)</span> <span class=\"params\">(written <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  src  n  dst, EOF.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">CopyN</span><span class=\"params\">(dst Writer, src Reader, n <span class=\"keyword\">int64</span>)</span> <span class=\"params\">(written <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  src  dst.. buf </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">CopyBuffer</span><span class=\"params\">(dst Writer, src Reader, buf []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(written <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  r  min  buf .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadAtLeast</span><span class=\"params\">(r Reader, buf []<span class=\"keyword\">byte</span>, min <span class=\"keyword\">int</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  r  len(buf)  buf .</span></span><br><span class=\"line\"><span class=\"comment\">// ,ReadAtLeast(r, buf, len(buf)). n&lt;len(buf), io.EOF </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadFull</span><span class=\"params\">(r Reader, buf []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//   s  w .</span></span><br><span class=\"line\"><span class=\"comment\">//   w  StringWriter , `w.WriteString()` . https://github.com/golang/go/blob/master/src/io/io.go#L293</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WriteString</span><span class=\"params\">(w Writer, s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">copyFileExample</span><span class=\"params\">(src, dest <span class=\"keyword\">string</span>)</span> <span class=\"params\">(err error)</span></span> &#123;</span><br><span class=\"line\">    srcFile, err := os.Open(src)</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> srcFile.Close()</span><br><span class=\"line\">    destFile, err := os.OpenFile(dest, os.O_CREATE|os.O_RDWR|os.O_SYNC, <span class=\"number\">0</span>)</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> destFile.Close()</span><br><span class=\"line\">    _, err = io.Copy(destFile, srcFile)</span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    err := copyFileExample(<span class=\"string\">\"src\"</span>, <span class=\"string\">\"dest\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>io</code>  IO . ( os ),.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Reader <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">     <span class=\"comment\">//  len(p)  p.(0&lt;=n&lt;=len(p).,  0 io.EOF </span></span><br><span class=\"line\">    Read(p []<span class=\"keyword\">byte</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ReaderAt <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  off  len(p)  p.(0&lt;=n&lt;=len(p)</span></span><br><span class=\"line\">    ReadAt(p []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ReaderFrom <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  r (EOF).  n (EOF)</span></span><br><span class=\"line\">    ReadFrom(r Reader) (n <span class=\"keyword\">int64</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByteReader <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ReadByte() (c <span class=\"keyword\">byte</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Writer <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  p  len(p) .(0&lt;=n&lt;=len(p).</span></span><br><span class=\"line\">    Write(p []<span class=\"keyword\">byte</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> WriterAt <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  off , p  len(p) .(0&lt;=n&lt;=len(p).</span></span><br><span class=\"line\">    WriteAt(p []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> WriterTo <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  w . n </span></span><br><span class=\"line\">    WriteTo(w Writer) (n <span class=\"keyword\">int64</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> StringWriter <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  s ,(0&lt;=n&lt;=len(s)</span></span><br><span class=\"line\">    WriteString(s <span class=\"keyword\">string</span>) (n <span class=\"keyword\">int</span>, err error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ReadWriter <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Reader</span><br><span class=\"line\">    Writer</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Closer <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Close() error</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Seeker <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ,whence ,offset .</span></span><br><span class=\"line\">    <span class=\"comment\">// whence  `io.SeekStart`(0,),`io.SeekCurrent`(1,),`io.SeekEnd`(2,).</span></span><br><span class=\"line\">    Seek(offset <span class=\"keyword\">int64</span>, whence <span class=\"keyword\">int</span>) (<span class=\"keyword\">int64</span>, error)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    SeekStart   = <span class=\"number\">0</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    SeekCurrent = <span class=\"number\">1</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    SeekEnd     = <span class=\"number\">2</span> <span class=\"comment\">// </span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,Read  EOF.</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> EOF = errors.New(<span class=\"string\">\"EOF\"</span>)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"io-\"><a href=\"#io-\" class=\"headerlink\" title=\"io \"></a><code>io</code> </h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  src  dst.</span></span><br><span class=\"line\"><span class=\"comment\">//  `CopyBuffer(dst, src, nil)`, , 32 * 1024</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Copy</span><span class=\"params\">(dst Writer, src Reader)</span> <span class=\"params\">(written <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  src  n  dst, EOF.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">CopyN</span><span class=\"params\">(dst Writer, src Reader, n <span class=\"keyword\">int64</span>)</span> <span class=\"params\">(written <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  src  dst.. buf </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">CopyBuffer</span><span class=\"params\">(dst Writer, src Reader, buf []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(written <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  r  min  buf .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadAtLeast</span><span class=\"params\">(r Reader, buf []<span class=\"keyword\">byte</span>, min <span class=\"keyword\">int</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  r  len(buf)  buf .</span></span><br><span class=\"line\"><span class=\"comment\">// ,ReadAtLeast(r, buf, len(buf)). n&lt;len(buf), io.EOF </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadFull</span><span class=\"params\">(r Reader, buf []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//   s  w .</span></span><br><span class=\"line\"><span class=\"comment\">//   w  StringWriter , `w.WriteString()` . https://github.com/golang/go/blob/master/src/io/io.go#L293</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WriteString</span><span class=\"params\">(w Writer, s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">copyFileExample</span><span class=\"params\">(src, dest <span class=\"keyword\">string</span>)</span> <span class=\"params\">(err error)</span></span> &#123;</span><br><span class=\"line\">    srcFile, err := os.Open(src)</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> srcFile.Close()</span><br><span class=\"line\">    destFile, err := os.OpenFile(dest, os.O_CREATE|os.O_RDWR|os.O_SYNC, <span class=\"number\">0</span>)</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> destFile.Close()</span><br><span class=\"line\">    _, err = io.Copy(destFile, srcFile)</span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    err := copyFileExample(<span class=\"string\">\"src\"</span>, <span class=\"string\">\"dest\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go  http ","abbrlink":10194,"description":" Go http ,,.http  HTTP .","_content":"\n`http`  HTTP . HTTP . `import \"net/http\"`\n\n, `Get`,`Head`,`Post``PostForm`  HTTP , `Client` , HTTP .\n\n```go\n// ,\nresp, err := http.Get(\"http://example.com/\")\nresp, err := http.PostForm(\"http://example.com/form\",\n    url.Values{\"key\": {\"Value\"}, \"id\": {\"123\"}})\n// \ndefer resp.Body.Close()\n```\n```go\n//  Client ,\nclient := &http.Client{\n    CheckRedirect: redirectPolicyFunc,\n}\nresp, err := client.Get(\"http://example.com\")\n\n// ,\nreq, err := http.NewRequest(\"GET\", \"http://example.com\", nil)\n// ...\nreq.Header.Add(\"If-None-Match\", `W/\"wyzzy\"`)\nresp, err := client.Do(req)\n// ...\n```\n\n,,TLS ,keep-alive, `Transport` \n\n```go\n//  Transport ,\ntr := &http.Transport{\n    MaxIdleConns:       10,\n    IdleConnTimeout:    30 * time.Second,\n    DisableCompression: true,\n}\nclient := &http.Client{Transport: tr}\nresp, err := client.Get(\"https://example.com\")\n```\n\n, `ListenAndServe`  HTTP , `Server` \n\n```go\nhttp.Handle(\"/foo\", fooHandler)\nhttp.HandleFunc(\"/bar\", func(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello, %q\", html.EscapeString(r.URL.Path))\n})\nlog.Fatal(http.ListenAndServe(\":8080\", nil))\n```\n```go\ns := &http.Server{\n    Addr:           \":8080\",\n    Handler:        myHandler,\n    ReadTimeout:    10 * time.Second,\n    WriteTimeout:   10 * time.Second,\n    MaxHeaderBytes: 1 << 20,\n}\nlog.Fatal(s.ListenAndServe())\n```\n\n`http`  `Transport`  `Server`  HTTP/2 . HTTP/2 , `golang.org/x/net/http2`, `ConfigureTransport`  `ConfigureServer` .\n\n# \n\n```\n// ,\ntype Client struct {\n    //  HTTP . `DefaultTransport`\n    Transport RoundTripper\n    // . nil, HTTP ., 10 \n    // req  via .\n    CheckRedirect func(req *Request, via []*Request) error\n    Jar CookieJar  //  CookieJar\n    Timeout time.Duration  // \n}\n\n// \ntype Handler interface {\n    ServeHTTP(ResponseWriter, *Request)\n}\n\n// \ntype HandlerFunc func(ResponseWriter, *Request)\n\n// \ntype Header map[string][]string\n\n// \ntype Request struct {\n    Method string  // \n    URL *url.URL  //  URL\n    Proto      string // ,, HTTP/1.1  HTTP/2\n    Header Header  // \n    Body io.ReadCloser  // \n    GetBody func() (io.ReadCloser, error) // \n    ContentLength int64  // ,-1 \n    TransferEncoding []string\n    Close bool  //  TCP \n    Host string  // ,, URL.Host \n    \n    // `ParseForm`  `ParseMultipartForm` \n    Form url.Values  // , URL ,PATCH,POST,PUT .\n    PostForm url.Values // , PATCH,POST,PUT \n    MultipartForm *multipart.Form // ,\n\n    RemoteAddr string  // \n    RequestURI string  //  URI\n    TLS *tls.ConnectionState  // TLS \n    Response *Response // \n    // contains filtered or unexported fields\n}\n// \ntype Response struct {\n    Status     string // \n    StatusCode int    // \n    Proto      string // \n    Header Header  // \n    Body io.ReadCloser  // \n    ContentLength int64  // \n    Uncompressed bool // \n    Request *Request  // \n    TLS *tls.ConnectionState // TLS \n}\n// ,\ntype Server struct {\n    Addr string  // HTTP ,\":80\"\n    Handler Handler // , `http.DefaultServeMux`\n    TLSConfig *tls.Config  // TLS \n    ReadTimeout time.Duration  //  \n    ReadHeaderTimeout time.Duration // \n    WriteTimeout time.Duration  // \n    IdleTimeout time.Duration //  keep-alived ,,\n    MaxHeaderBytes int // \n    ConnState func(net.Conn, ConnState) // \n    ErrorLog *log.Logger // . log  logger\n    // contains filtered or unexported fields\n}\n```\n\n# \n\n```go\n//  HTTP (), https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml\nconst (\n    StatusOK                   = 200 // RFC 7231, 6.3.1\n    StatusNoContent            = 204 // RFC 7231, 6.3.5\n\n    StatusMovedPermanently = 301 // RFC 7231, 6.4.2\n    StatusFound            = 302 // RFC 7231, 6.4.3\n    StatusTemporaryRedirect = 307 // RFC 7231, 6.4.7\n    StatusPermanentRedirect = 308 // RFC 7538, 3\n\n    StatusBadRequest                   = 400 // RFC 7231, 6.5.1\n    StatusUnauthorized                 = 401 // RFC 7235, 3.1\n    StatusPaymentRequired              = 402 // RFC 7231, 6.5.2\n    StatusForbidden                    = 403 // RFC 7231, 6.5.3\n    StatusNotFound                     = 404 // RFC 7231, 6.5.4\n    StatusMethodNotAllowed             = 405 // RFC 7231, 6.5.5\n    StatusRequestTimeout               = 408 // RFC 7231, 6.5.7\n    StatusRequestEntityTooLarge        = 413 // RFC 7231, 6.5.11\n    StatusRequestURITooLong            = 414 // RFC 7231, 6.5.12\n    StatusUnsupportedMediaType         = 415 // RFC 7231, 6.5.13\n    StatusTooManyRequests              = 429 // RFC 6585, 4\n\n    StatusInternalServerError           = 500 // RFC 7231, 6.6.1\n    StatusNotImplemented                = 501 // RFC 7231, 6.6.2\n    StatusBadGateway                    = 502 // RFC 7231, 6.6.3\n    StatusServiceUnavailable            = 503 // RFC 7231, 6.6.4\n    StatusGatewayTimeout                = 504 // RFC 7231, 6.6.5\n)\n// \nvar DefaultTransport RoundTripper = &Transport{\n    Proxy: ProxyFromEnvironment,\n    DialContext: (&net.Dialer{\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n        DualStack: true,\n    }).DialContext,\n    ForceAttemptHTTP2:     true,\n    MaxIdleConns:          100,\n    IdleConnTimeout:       90 * time.Second,\n    TLSHandshakeTimeout:   10 * time.Second,\n    ExpectContinueTimeout: 1 * time.Second,\n}\n// , Handler \nvar DefaultServeMux = &defaultServeMux\n```\n\n# \n\n## `http` \n\n```go\n//  DefaultServeMux  pattern \nfunc Handle(pattern string, handler Handler)\nfunc HandleFunc(pattern string, handler func(ResponseWriter, *Request))\n\n//  handler . handler  nil, `DefaultServeMux`\nfunc ListenAndServe(addr string, handler Handler) error\nfunc ListenAndServeTLS(addr, certFile, keyFile string, handler Handler) error\n\n//  Listener  handler \nfunc Serve(l net.Listener, handler Handler) error\nfunc ServeTLS(l net.Listener, handler Handler, certFile, keyFile string) error\n\n// \nfunc NewRequest(method, url string, body io.Reader) (*Request, error)\nfunc NewRequestWithContext(ctx context.Context, method, url string, body io.Reader) (*Request, error)\n\n//  ServeMux \nfunc NewServeMux() *ServeMux\n\n//  Handler , Handle\n//  root  HTTP \nfunc FileServer(root FileSystem) Handler\n//  \"404 page not found\" , 404\nfunc NotFoundHandler() Handler\n// \nfunc RedirectHandler(url string, code int) Handler\n//  URL \nfunc StripPrefix(prefix string, h Handler) Handler\n//  h  Handler, msg\nfunc TimeoutHandler(h Handler, dt time.Duration, msg string) Handler\n\n//  handler  HandleFunc  Handler \nfunc NotFound(w ResponseWriter, r *Request)\n// \nfunc ServeFile(w ResponseWriter, r *Request, name string)\n//  cookie\nfunc SetCookie(w ResponseWriter, cookie *Cookie)\n```\n\n## `Client` \n\n``go\n// \nfunc (c *Client) CloseIdleConnections()\n// \nfunc (c *Client) Do(req *Request) (*Response, error)\n//  url  Get,Head,Post,Post() \nfunc (c *Client) Get(url string) (resp *Response, err error)\nfunc (c *Client) Head(url string) (resp *Response, err error)\nfunc (c *Client) Post(url, contentType string, body io.Reader) (resp *Response, err error)\n//  url  Post ,data .(`url.Values`  `map[string][]string` )\n//  Content-Type  application/x-www-form-urlencoded\nfunc (c *Client) PostForm(url string, data url.Values) (resp *Response, err error)\n```\n\n## `Header` \n\n```go\nfunc (h Header) Add(key, value string)\nfunc (h Header) Clone() Header\nfunc (h Header) Del(key string)\nfunc (h Header) Get(key string) string\nfunc (h Header) Set(key, value string)\nfunc (h Header) Values(key string) []string\nfunc (h Header) Write(w io.Writer) error\nfunc (h Header) WriteSubset(w io.Writer, exclude map[string]bool) error\n```\n\n## `Request` \n```\nfunc (r *Request) AddCookie(c *Cookie)  //  cookie\nfunc (r *Request) BasicAuth() (username, password string, ok bool) // \nfunc (r *Request) Cookie(name string) (*Cookie, error) //  Cookie\nfunc (r *Request) Cookies() []*Cookie  //  cookie\n//  key \nfunc (r *Request) FormFile(key string) (multipart.File, *multipart.FileHeader, error)\nfunc (r *Request) FormValue(key string) string //  key \nfunc (r *Request) ParseForm() error  // \nfunc (r *Request) ParseMultipartForm(maxMemory int64) error // \nfunc (r *Request) Referer() string  //  URL\nfunc (r *Request) SetBasicAuth(username, password string)  // \nfunc (r *Request) UserAgent() string // \nfunc (r *Request) Write(w io.Writer) error // \n```\n## `Response` \n```\nfunc (r *Response) Cookies() []*Cookie  //  cookie\nfunc (r *Response) Location() (*url.URL, error) // `Location` \n```\n\n## `ServeMux` \n\n```go\n// \nfunc (mux *ServeMux) Handle(pattern string, handler Handler)\nfunc (mux *ServeMux) HandleFunc(pattern string, handler func(ResponseWriter, *Request))\n// \nfunc (mux *ServeMux) Handler(r *Request) (h Handler, pattern string)\n```\n## `Server` \n```\n// \nfunc (srv *Server) Close() error\n // \nfunc (srv *Server) ListenAndServe() error\nfunc (srv *Server) ListenAndServeTLS(certFile, keyFile string) error\n// , server \nfunc (srv *Server) RegisterOnShutdown(f func())\n//  listener , goroutine \nfunc (srv *Server) Serve(l net.Listener) error\nfunc (srv *Server) ServeTLS(l net.Listener, certFile, keyFile string) error\n//  keep-alive\nfunc (srv *Server) SetKeepAlivesEnabled(v bool)\n// \nfunc (srv *Server) Shutdown(ctx context.Context) error\n```\n\n# \n\n## \n\n```go\nimport \"net/http\"\n\nfunc main() {\n    // StripPrefix , `/tmpfiles/`  `/`\n    // http.Handle(\"/tmpfiles/\", http.StripPrefix(\"/tmpfiles/\", http.FileServer(http.Dir(\"/usr/share/doc\"))))\n\n    //  index.html.,\n    http.ListenAndServe(\":8080\", http.FileServer(http.Dir(\"/usr/share/doc\")))\n}\n```\n\n##  `PostForm` \n\n```go\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"net/url\"\n)\n\nfunc main() {\n    data := url.Values{\n        \"name\": []string{\"name\"},\n        \"age\":  []string{\"20\"},\n        \"addr\": []string{\"beijing\", \"shanghai\", \"guangzhou\"},\n    }\n    res, _ := http.PostForm(\"http://www.httpbin.org/post\", data)\n    defer res.Body.Close()\n    buf := make([]byte, 1024)\n    n, _ := res.Body.Read(buf)\n    fmt.Println(string(buf[:n]))\n```\n\n## `Handle`  `HandleFunc`\n\n```\nimport (\n    \"io\"\n    \"net/http\"\n)\n\nfunc main() {\n    h1 := func(w http.ResponseWriter, _ *http.Request) {\n        io.WriteString(w, \"Hello from a HandleFunc #1!\\n\")\n    h2 := func(w http.ResponseWriter, _ *http.Request) {\n        io.WriteString(w, \"Hello from a HandleFunc #2!\\n\")\n    }\n    http.HandleFunc(\"/h1\", h1)\n    http.HandleFunc(\"/h2\", h2)\n    http.Handle(\"/notfount\", http.NotFoundHandler())\n    http.ListenAndServe(\":8080\", nil)\n}\n```\n\n\n## `Handler`\n\n```go\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"net/url\"\n    \"time\"\n)\n\ntype CustomHandler struct {\n    name string\n}\n\nfunc (c CustomHandler) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    time.Sleep(time.Second)\n    fmt.Fprintf(w, \"respose: %v\", c.name) //  w \n    http.ServeFile(w, req, c.name)  // \n}\n\nfunc main() {\n    handler := CustomHandler{\"index.html\"}\n    http.ListenAndServe(\":80\", http.TimeoutHandler(handler, time.Nanosecond, \"\"))\n}\n```","source":"_posts/go-study-notes-package-http.md","raw":"---\ntitle: go  http \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 10194\ndescription: ' Go http ,,.http  HTTP .'\n---\n\n`http`  HTTP . HTTP . `import \"net/http\"`\n\n, `Get`,`Head`,`Post``PostForm`  HTTP , `Client` , HTTP .\n\n```go\n// ,\nresp, err := http.Get(\"http://example.com/\")\nresp, err := http.PostForm(\"http://example.com/form\",\n    url.Values{\"key\": {\"Value\"}, \"id\": {\"123\"}})\n// \ndefer resp.Body.Close()\n```\n```go\n//  Client ,\nclient := &http.Client{\n    CheckRedirect: redirectPolicyFunc,\n}\nresp, err := client.Get(\"http://example.com\")\n\n// ,\nreq, err := http.NewRequest(\"GET\", \"http://example.com\", nil)\n// ...\nreq.Header.Add(\"If-None-Match\", `W/\"wyzzy\"`)\nresp, err := client.Do(req)\n// ...\n```\n\n,,TLS ,keep-alive, `Transport` \n\n```go\n//  Transport ,\ntr := &http.Transport{\n    MaxIdleConns:       10,\n    IdleConnTimeout:    30 * time.Second,\n    DisableCompression: true,\n}\nclient := &http.Client{Transport: tr}\nresp, err := client.Get(\"https://example.com\")\n```\n\n, `ListenAndServe`  HTTP , `Server` \n\n```go\nhttp.Handle(\"/foo\", fooHandler)\nhttp.HandleFunc(\"/bar\", func(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello, %q\", html.EscapeString(r.URL.Path))\n})\nlog.Fatal(http.ListenAndServe(\":8080\", nil))\n```\n```go\ns := &http.Server{\n    Addr:           \":8080\",\n    Handler:        myHandler,\n    ReadTimeout:    10 * time.Second,\n    WriteTimeout:   10 * time.Second,\n    MaxHeaderBytes: 1 << 20,\n}\nlog.Fatal(s.ListenAndServe())\n```\n\n`http`  `Transport`  `Server`  HTTP/2 . HTTP/2 , `golang.org/x/net/http2`, `ConfigureTransport`  `ConfigureServer` .\n\n# \n\n```\n// ,\ntype Client struct {\n    //  HTTP . `DefaultTransport`\n    Transport RoundTripper\n    // . nil, HTTP ., 10 \n    // req  via .\n    CheckRedirect func(req *Request, via []*Request) error\n    Jar CookieJar  //  CookieJar\n    Timeout time.Duration  // \n}\n\n// \ntype Handler interface {\n    ServeHTTP(ResponseWriter, *Request)\n}\n\n// \ntype HandlerFunc func(ResponseWriter, *Request)\n\n// \ntype Header map[string][]string\n\n// \ntype Request struct {\n    Method string  // \n    URL *url.URL  //  URL\n    Proto      string // ,, HTTP/1.1  HTTP/2\n    Header Header  // \n    Body io.ReadCloser  // \n    GetBody func() (io.ReadCloser, error) // \n    ContentLength int64  // ,-1 \n    TransferEncoding []string\n    Close bool  //  TCP \n    Host string  // ,, URL.Host \n    \n    // `ParseForm`  `ParseMultipartForm` \n    Form url.Values  // , URL ,PATCH,POST,PUT .\n    PostForm url.Values // , PATCH,POST,PUT \n    MultipartForm *multipart.Form // ,\n\n    RemoteAddr string  // \n    RequestURI string  //  URI\n    TLS *tls.ConnectionState  // TLS \n    Response *Response // \n    // contains filtered or unexported fields\n}\n// \ntype Response struct {\n    Status     string // \n    StatusCode int    // \n    Proto      string // \n    Header Header  // \n    Body io.ReadCloser  // \n    ContentLength int64  // \n    Uncompressed bool // \n    Request *Request  // \n    TLS *tls.ConnectionState // TLS \n}\n// ,\ntype Server struct {\n    Addr string  // HTTP ,\":80\"\n    Handler Handler // , `http.DefaultServeMux`\n    TLSConfig *tls.Config  // TLS \n    ReadTimeout time.Duration  //  \n    ReadHeaderTimeout time.Duration // \n    WriteTimeout time.Duration  // \n    IdleTimeout time.Duration //  keep-alived ,,\n    MaxHeaderBytes int // \n    ConnState func(net.Conn, ConnState) // \n    ErrorLog *log.Logger // . log  logger\n    // contains filtered or unexported fields\n}\n```\n\n# \n\n```go\n//  HTTP (), https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml\nconst (\n    StatusOK                   = 200 // RFC 7231, 6.3.1\n    StatusNoContent            = 204 // RFC 7231, 6.3.5\n\n    StatusMovedPermanently = 301 // RFC 7231, 6.4.2\n    StatusFound            = 302 // RFC 7231, 6.4.3\n    StatusTemporaryRedirect = 307 // RFC 7231, 6.4.7\n    StatusPermanentRedirect = 308 // RFC 7538, 3\n\n    StatusBadRequest                   = 400 // RFC 7231, 6.5.1\n    StatusUnauthorized                 = 401 // RFC 7235, 3.1\n    StatusPaymentRequired              = 402 // RFC 7231, 6.5.2\n    StatusForbidden                    = 403 // RFC 7231, 6.5.3\n    StatusNotFound                     = 404 // RFC 7231, 6.5.4\n    StatusMethodNotAllowed             = 405 // RFC 7231, 6.5.5\n    StatusRequestTimeout               = 408 // RFC 7231, 6.5.7\n    StatusRequestEntityTooLarge        = 413 // RFC 7231, 6.5.11\n    StatusRequestURITooLong            = 414 // RFC 7231, 6.5.12\n    StatusUnsupportedMediaType         = 415 // RFC 7231, 6.5.13\n    StatusTooManyRequests              = 429 // RFC 6585, 4\n\n    StatusInternalServerError           = 500 // RFC 7231, 6.6.1\n    StatusNotImplemented                = 501 // RFC 7231, 6.6.2\n    StatusBadGateway                    = 502 // RFC 7231, 6.6.3\n    StatusServiceUnavailable            = 503 // RFC 7231, 6.6.4\n    StatusGatewayTimeout                = 504 // RFC 7231, 6.6.5\n)\n// \nvar DefaultTransport RoundTripper = &Transport{\n    Proxy: ProxyFromEnvironment,\n    DialContext: (&net.Dialer{\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n        DualStack: true,\n    }).DialContext,\n    ForceAttemptHTTP2:     true,\n    MaxIdleConns:          100,\n    IdleConnTimeout:       90 * time.Second,\n    TLSHandshakeTimeout:   10 * time.Second,\n    ExpectContinueTimeout: 1 * time.Second,\n}\n// , Handler \nvar DefaultServeMux = &defaultServeMux\n```\n\n# \n\n## `http` \n\n```go\n//  DefaultServeMux  pattern \nfunc Handle(pattern string, handler Handler)\nfunc HandleFunc(pattern string, handler func(ResponseWriter, *Request))\n\n//  handler . handler  nil, `DefaultServeMux`\nfunc ListenAndServe(addr string, handler Handler) error\nfunc ListenAndServeTLS(addr, certFile, keyFile string, handler Handler) error\n\n//  Listener  handler \nfunc Serve(l net.Listener, handler Handler) error\nfunc ServeTLS(l net.Listener, handler Handler, certFile, keyFile string) error\n\n// \nfunc NewRequest(method, url string, body io.Reader) (*Request, error)\nfunc NewRequestWithContext(ctx context.Context, method, url string, body io.Reader) (*Request, error)\n\n//  ServeMux \nfunc NewServeMux() *ServeMux\n\n//  Handler , Handle\n//  root  HTTP \nfunc FileServer(root FileSystem) Handler\n//  \"404 page not found\" , 404\nfunc NotFoundHandler() Handler\n// \nfunc RedirectHandler(url string, code int) Handler\n//  URL \nfunc StripPrefix(prefix string, h Handler) Handler\n//  h  Handler, msg\nfunc TimeoutHandler(h Handler, dt time.Duration, msg string) Handler\n\n//  handler  HandleFunc  Handler \nfunc NotFound(w ResponseWriter, r *Request)\n// \nfunc ServeFile(w ResponseWriter, r *Request, name string)\n//  cookie\nfunc SetCookie(w ResponseWriter, cookie *Cookie)\n```\n\n## `Client` \n\n``go\n// \nfunc (c *Client) CloseIdleConnections()\n// \nfunc (c *Client) Do(req *Request) (*Response, error)\n//  url  Get,Head,Post,Post() \nfunc (c *Client) Get(url string) (resp *Response, err error)\nfunc (c *Client) Head(url string) (resp *Response, err error)\nfunc (c *Client) Post(url, contentType string, body io.Reader) (resp *Response, err error)\n//  url  Post ,data .(`url.Values`  `map[string][]string` )\n//  Content-Type  application/x-www-form-urlencoded\nfunc (c *Client) PostForm(url string, data url.Values) (resp *Response, err error)\n```\n\n## `Header` \n\n```go\nfunc (h Header) Add(key, value string)\nfunc (h Header) Clone() Header\nfunc (h Header) Del(key string)\nfunc (h Header) Get(key string) string\nfunc (h Header) Set(key, value string)\nfunc (h Header) Values(key string) []string\nfunc (h Header) Write(w io.Writer) error\nfunc (h Header) WriteSubset(w io.Writer, exclude map[string]bool) error\n```\n\n## `Request` \n```\nfunc (r *Request) AddCookie(c *Cookie)  //  cookie\nfunc (r *Request) BasicAuth() (username, password string, ok bool) // \nfunc (r *Request) Cookie(name string) (*Cookie, error) //  Cookie\nfunc (r *Request) Cookies() []*Cookie  //  cookie\n//  key \nfunc (r *Request) FormFile(key string) (multipart.File, *multipart.FileHeader, error)\nfunc (r *Request) FormValue(key string) string //  key \nfunc (r *Request) ParseForm() error  // \nfunc (r *Request) ParseMultipartForm(maxMemory int64) error // \nfunc (r *Request) Referer() string  //  URL\nfunc (r *Request) SetBasicAuth(username, password string)  // \nfunc (r *Request) UserAgent() string // \nfunc (r *Request) Write(w io.Writer) error // \n```\n## `Response` \n```\nfunc (r *Response) Cookies() []*Cookie  //  cookie\nfunc (r *Response) Location() (*url.URL, error) // `Location` \n```\n\n## `ServeMux` \n\n```go\n// \nfunc (mux *ServeMux) Handle(pattern string, handler Handler)\nfunc (mux *ServeMux) HandleFunc(pattern string, handler func(ResponseWriter, *Request))\n// \nfunc (mux *ServeMux) Handler(r *Request) (h Handler, pattern string)\n```\n## `Server` \n```\n// \nfunc (srv *Server) Close() error\n // \nfunc (srv *Server) ListenAndServe() error\nfunc (srv *Server) ListenAndServeTLS(certFile, keyFile string) error\n// , server \nfunc (srv *Server) RegisterOnShutdown(f func())\n//  listener , goroutine \nfunc (srv *Server) Serve(l net.Listener) error\nfunc (srv *Server) ServeTLS(l net.Listener, certFile, keyFile string) error\n//  keep-alive\nfunc (srv *Server) SetKeepAlivesEnabled(v bool)\n// \nfunc (srv *Server) Shutdown(ctx context.Context) error\n```\n\n# \n\n## \n\n```go\nimport \"net/http\"\n\nfunc main() {\n    // StripPrefix , `/tmpfiles/`  `/`\n    // http.Handle(\"/tmpfiles/\", http.StripPrefix(\"/tmpfiles/\", http.FileServer(http.Dir(\"/usr/share/doc\"))))\n\n    //  index.html.,\n    http.ListenAndServe(\":8080\", http.FileServer(http.Dir(\"/usr/share/doc\")))\n}\n```\n\n##  `PostForm` \n\n```go\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"net/url\"\n)\n\nfunc main() {\n    data := url.Values{\n        \"name\": []string{\"name\"},\n        \"age\":  []string{\"20\"},\n        \"addr\": []string{\"beijing\", \"shanghai\", \"guangzhou\"},\n    }\n    res, _ := http.PostForm(\"http://www.httpbin.org/post\", data)\n    defer res.Body.Close()\n    buf := make([]byte, 1024)\n    n, _ := res.Body.Read(buf)\n    fmt.Println(string(buf[:n]))\n```\n\n## `Handle`  `HandleFunc`\n\n```\nimport (\n    \"io\"\n    \"net/http\"\n)\n\nfunc main() {\n    h1 := func(w http.ResponseWriter, _ *http.Request) {\n        io.WriteString(w, \"Hello from a HandleFunc #1!\\n\")\n    h2 := func(w http.ResponseWriter, _ *http.Request) {\n        io.WriteString(w, \"Hello from a HandleFunc #2!\\n\")\n    }\n    http.HandleFunc(\"/h1\", h1)\n    http.HandleFunc(\"/h2\", h2)\n    http.Handle(\"/notfount\", http.NotFoundHandler())\n    http.ListenAndServe(\":8080\", nil)\n}\n```\n\n\n## `Handler`\n\n```go\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"net/url\"\n    \"time\"\n)\n\ntype CustomHandler struct {\n    name string\n}\n\nfunc (c CustomHandler) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    time.Sleep(time.Second)\n    fmt.Fprintf(w, \"respose: %v\", c.name) //  w \n    http.ServeFile(w, req, c.name)  // \n}\n\nfunc main() {\n    handler := CustomHandler{\"index.html\"}\n    http.ListenAndServe(\":80\", http.TimeoutHandler(handler, time.Nanosecond, \"\"))\n}\n```","slug":"go-study-notes-package-http","published":1,"date":"2020-05-10T07:11:31.864Z","updated":"2020-05-10T11:39:37.375Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvh0019k8u79ti564pp","content":"<p><code>http</code>  HTTP . HTTP . <code>import &quot;net/http&quot;</code></p>\n<p>, <code>Get</code>,<code>Head</code>,<code>Post</code><code>PostForm</code>  HTTP , <code>Client</code> , HTTP .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\">resp, err := http.Get(<span class=\"string\">\"http://example.com/\"</span>)</span><br><span class=\"line\">resp, err := http.PostForm(<span class=\"string\">\"http://example.com/form\"</span>,</span><br><span class=\"line\">    url.Values&#123;<span class=\"string\">\"key\"</span>: &#123;<span class=\"string\">\"Value\"</span>&#125;, <span class=\"string\">\"id\"</span>: &#123;<span class=\"string\">\"123\"</span>&#125;&#125;)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">defer</span> resp.Body.Close()</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Client ,</span></span><br><span class=\"line\">client := &amp;http.Client&#123;</span><br><span class=\"line\">    CheckRedirect: redirectPolicyFunc,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">resp, err := client.Get(<span class=\"string\">\"http://example.com\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\">req, err := http.NewRequest(<span class=\"string\">\"GET\"</span>, <span class=\"string\">\"http://example.com\"</span>, <span class=\"literal\">nil</span>)</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\">req.Header.Add(<span class=\"string\">\"If-None-Match\"</span>, <span class=\"string\">`W/\"wyzzy\"`</span>)</span><br><span class=\"line\">resp, err := client.Do(req)</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<p>,,TLS ,keep-alive, <code>Transport</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Transport ,</span></span><br><span class=\"line\">tr := &amp;http.Transport&#123;</span><br><span class=\"line\">    MaxIdleConns:       <span class=\"number\">10</span>,</span><br><span class=\"line\">    IdleConnTimeout:    <span class=\"number\">30</span> * time.Second,</span><br><span class=\"line\">    DisableCompression: <span class=\"literal\">true</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">client := &amp;http.Client&#123;Transport: tr&#125;</span><br><span class=\"line\">resp, err := client.Get(<span class=\"string\">\"https://example.com\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p>, <code>ListenAndServe</code>  HTTP , <code>Server</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http.Handle(<span class=\"string\">\"/foo\"</span>, fooHandler)</span><br><span class=\"line\">http.HandleFunc(<span class=\"string\">\"/bar\"</span>, <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class=\"line\">    fmt.Fprintf(w, <span class=\"string\">\"Hello, %q\"</span>, html.EscapeString(r.URL.Path))</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">log.Fatal(http.ListenAndServe(<span class=\"string\">\":8080\"</span>, <span class=\"literal\">nil</span>))</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">s := &amp;http.Server&#123;</span><br><span class=\"line\">    Addr:           <span class=\"string\">\":8080\"</span>,</span><br><span class=\"line\">    Handler:        myHandler,</span><br><span class=\"line\">    ReadTimeout:    <span class=\"number\">10</span> * time.Second,</span><br><span class=\"line\">    WriteTimeout:   <span class=\"number\">10</span> * time.Second,</span><br><span class=\"line\">    MaxHeaderBytes: <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">20</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">log.Fatal(s.ListenAndServe())</span><br></pre></td></tr></table></figure>\n\n<p><code>http</code>  <code>Transport</code>  <code>Server</code>  HTTP/2 . HTTP/2 , <code>golang.org/x/net/http2</code>, <code>ConfigureTransport</code>  <code>ConfigureServer</code> .</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight elm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ,</span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Client</span> struct &#123;</span><br><span class=\"line\">    //  <span class=\"type\">HTTP</span> . `<span class=\"type\">DefaultTransport</span>`</span><br><span class=\"line\">    <span class=\"type\">Transport</span> <span class=\"type\">RoundTripper</span></span><br><span class=\"line\">    // . nil, <span class=\"type\">HTTP</span> ., 10 </span><br><span class=\"line\">    // req  via .</span><br><span class=\"line\">    <span class=\"type\">CheckRedirect</span> func(req *<span class=\"type\">Request</span>, via []*<span class=\"type\">Request</span>) error</span><br><span class=\"line\">    <span class=\"type\">Jar</span> <span class=\"type\">CookieJar</span>  //  <span class=\"type\">CookieJar</span></span><br><span class=\"line\">    <span class=\"type\">Timeout</span> time.<span class=\"type\">Duration</span>  // </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Handler</span> interface &#123;</span><br><span class=\"line\">    <span class=\"type\">ServeHTTP</span>(<span class=\"type\">ResponseWriter</span>, *<span class=\"type\">Request</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">HandlerFunc</span> func(<span class=\"type\">ResponseWriter</span>, *<span class=\"type\">Request</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Header</span> map[string][]string</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Request</span> struct &#123;</span><br><span class=\"line\">    <span class=\"type\">Method</span> string  // </span><br><span class=\"line\">    <span class=\"type\">URL</span> *url.<span class=\"type\">URL</span>  //  <span class=\"type\">URL</span></span><br><span class=\"line\">    <span class=\"type\">Proto</span>      string // ,, <span class=\"type\">HTTP</span>/1.1  <span class=\"type\">HTTP</span>/2</span><br><span class=\"line\">    <span class=\"type\">Header</span> <span class=\"type\">Header</span>  // </span><br><span class=\"line\">    <span class=\"type\">Body</span> io.<span class=\"type\">ReadCloser</span>  // </span><br><span class=\"line\">    <span class=\"type\">GetBody</span> func() (io.<span class=\"type\">ReadCloser</span>, error) // </span><br><span class=\"line\">    <span class=\"type\">ContentLength</span> int64  // ,-1 </span><br><span class=\"line\">    <span class=\"type\">TransferEncoding</span> []string</span><br><span class=\"line\">    <span class=\"type\">Close</span> bool  //  <span class=\"type\">TCP</span> </span><br><span class=\"line\">    <span class=\"type\">Host</span> string  // ,, <span class=\"type\">URL</span>.<span class=\"type\">Host</span> </span><br><span class=\"line\">    </span><br><span class=\"line\">    // `<span class=\"type\">ParseForm</span>`  `<span class=\"type\">ParseMultipartForm</span>` </span><br><span class=\"line\">    <span class=\"type\">Form</span> url.<span class=\"type\">Values</span>  // , <span class=\"type\">URL</span> ,<span class=\"type\">PATCH</span>,<span class=\"type\">POST</span>,<span class=\"type\">PUT</span> .</span><br><span class=\"line\">    <span class=\"type\">PostForm</span> url.<span class=\"type\">Values</span> // , <span class=\"type\">PATCH</span>,<span class=\"type\">POST</span>,<span class=\"type\">PUT</span> </span><br><span class=\"line\">    <span class=\"type\">MultipartForm</span> *multipart.<span class=\"type\">Form</span> // ,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">RemoteAddr</span> string  // </span><br><span class=\"line\">    <span class=\"type\">RequestURI</span> string  //  <span class=\"type\">URI</span></span><br><span class=\"line\">    <span class=\"type\">TLS</span> *tls.<span class=\"type\">ConnectionState</span>  // <span class=\"type\">TLS</span> </span><br><span class=\"line\">    <span class=\"type\">Response</span> *<span class=\"type\">Response</span> // </span><br><span class=\"line\">    // contains filtered or unexported fields</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Response</span> struct &#123;</span><br><span class=\"line\">    <span class=\"type\">Status</span>     string // </span><br><span class=\"line\">    <span class=\"type\">StatusCode</span> int    // </span><br><span class=\"line\">    <span class=\"type\">Proto</span>      string // </span><br><span class=\"line\">    <span class=\"type\">Header</span> <span class=\"type\">Header</span>  // </span><br><span class=\"line\">    <span class=\"type\">Body</span> io.<span class=\"type\">ReadCloser</span>  // </span><br><span class=\"line\">    <span class=\"type\">ContentLength</span> int64  // </span><br><span class=\"line\">    <span class=\"type\">Uncompressed</span> bool // </span><br><span class=\"line\">    <span class=\"type\">Request</span> *<span class=\"type\">Request</span>  // </span><br><span class=\"line\">    <span class=\"type\">TLS</span> *tls.<span class=\"type\">ConnectionState</span> // <span class=\"type\">TLS</span> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// ,</span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Server</span> struct &#123;</span><br><span class=\"line\">    <span class=\"type\">Addr</span> string  // <span class=\"type\">HTTP</span> ,\":80\"</span><br><span class=\"line\">    <span class=\"type\">Handler</span> <span class=\"type\">Handler</span> // , `http.<span class=\"type\">DefaultServeMux</span>`</span><br><span class=\"line\">    <span class=\"type\">TLSConfig</span> *tls.<span class=\"type\">Config</span>  // <span class=\"type\">TLS</span> </span><br><span class=\"line\">    <span class=\"type\">ReadTimeout</span> time.<span class=\"type\">Duration</span>  //  </span><br><span class=\"line\">    <span class=\"type\">ReadHeaderTimeout</span> time.<span class=\"type\">Duration</span> // </span><br><span class=\"line\">    <span class=\"type\">WriteTimeout</span> time.<span class=\"type\">Duration</span>  // </span><br><span class=\"line\">    <span class=\"type\">IdleTimeout</span> time.<span class=\"type\">Duration</span> //  keep-alived ,,</span><br><span class=\"line\">    <span class=\"type\">MaxHeaderBytes</span> int // </span><br><span class=\"line\">    <span class=\"type\">ConnState</span> func(net.<span class=\"type\">Conn</span>, <span class=\"type\">ConnState</span>) // </span><br><span class=\"line\">    <span class=\"type\">ErrorLog</span> *log.<span class=\"type\">Logger</span> // . log  logger</span><br><span class=\"line\">    // contains filtered or unexported fields</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  HTTP (), https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    StatusOK                   = <span class=\"number\">200</span> <span class=\"comment\">// RFC 7231, 6.3.1</span></span><br><span class=\"line\">    StatusNoContent            = <span class=\"number\">204</span> <span class=\"comment\">// RFC 7231, 6.3.5</span></span><br><span class=\"line\"></span><br><span class=\"line\">    StatusMovedPermanently = <span class=\"number\">301</span> <span class=\"comment\">// RFC 7231, 6.4.2</span></span><br><span class=\"line\">    StatusFound            = <span class=\"number\">302</span> <span class=\"comment\">// RFC 7231, 6.4.3</span></span><br><span class=\"line\">    StatusTemporaryRedirect = <span class=\"number\">307</span> <span class=\"comment\">// RFC 7231, 6.4.7</span></span><br><span class=\"line\">    StatusPermanentRedirect = <span class=\"number\">308</span> <span class=\"comment\">// RFC 7538, 3</span></span><br><span class=\"line\"></span><br><span class=\"line\">    StatusBadRequest                   = <span class=\"number\">400</span> <span class=\"comment\">// RFC 7231, 6.5.1</span></span><br><span class=\"line\">    StatusUnauthorized                 = <span class=\"number\">401</span> <span class=\"comment\">// RFC 7235, 3.1</span></span><br><span class=\"line\">    StatusPaymentRequired              = <span class=\"number\">402</span> <span class=\"comment\">// RFC 7231, 6.5.2</span></span><br><span class=\"line\">    StatusForbidden                    = <span class=\"number\">403</span> <span class=\"comment\">// RFC 7231, 6.5.3</span></span><br><span class=\"line\">    StatusNotFound                     = <span class=\"number\">404</span> <span class=\"comment\">// RFC 7231, 6.5.4</span></span><br><span class=\"line\">    StatusMethodNotAllowed             = <span class=\"number\">405</span> <span class=\"comment\">// RFC 7231, 6.5.5</span></span><br><span class=\"line\">    StatusRequestTimeout               = <span class=\"number\">408</span> <span class=\"comment\">// RFC 7231, 6.5.7</span></span><br><span class=\"line\">    StatusRequestEntityTooLarge        = <span class=\"number\">413</span> <span class=\"comment\">// RFC 7231, 6.5.11</span></span><br><span class=\"line\">    StatusRequestURITooLong            = <span class=\"number\">414</span> <span class=\"comment\">// RFC 7231, 6.5.12</span></span><br><span class=\"line\">    StatusUnsupportedMediaType         = <span class=\"number\">415</span> <span class=\"comment\">// RFC 7231, 6.5.13</span></span><br><span class=\"line\">    StatusTooManyRequests              = <span class=\"number\">429</span> <span class=\"comment\">// RFC 6585, 4</span></span><br><span class=\"line\"></span><br><span class=\"line\">    StatusInternalServerError           = <span class=\"number\">500</span> <span class=\"comment\">// RFC 7231, 6.6.1</span></span><br><span class=\"line\">    StatusNotImplemented                = <span class=\"number\">501</span> <span class=\"comment\">// RFC 7231, 6.6.2</span></span><br><span class=\"line\">    StatusBadGateway                    = <span class=\"number\">502</span> <span class=\"comment\">// RFC 7231, 6.6.3</span></span><br><span class=\"line\">    StatusServiceUnavailable            = <span class=\"number\">503</span> <span class=\"comment\">// RFC 7231, 6.6.4</span></span><br><span class=\"line\">    StatusGatewayTimeout                = <span class=\"number\">504</span> <span class=\"comment\">// RFC 7231, 6.6.5</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> DefaultTransport RoundTripper = &amp;Transport&#123;</span><br><span class=\"line\">    Proxy: ProxyFromEnvironment,</span><br><span class=\"line\">    DialContext: (&amp;net.Dialer&#123;</span><br><span class=\"line\">        Timeout:   <span class=\"number\">30</span> * time.Second,</span><br><span class=\"line\">        KeepAlive: <span class=\"number\">30</span> * time.Second,</span><br><span class=\"line\">        DualStack: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;).DialContext,</span><br><span class=\"line\">    ForceAttemptHTTP2:     <span class=\"literal\">true</span>,</span><br><span class=\"line\">    MaxIdleConns:          <span class=\"number\">100</span>,</span><br><span class=\"line\">    IdleConnTimeout:       <span class=\"number\">90</span> * time.Second,</span><br><span class=\"line\">    TLSHandshakeTimeout:   <span class=\"number\">10</span> * time.Second,</span><br><span class=\"line\">    ExpectContinueTimeout: <span class=\"number\">1</span> * time.Second,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// , Handler </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> DefaultServeMux = &amp;defaultServeMux</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"http-\"><a href=\"#http-\" class=\"headerlink\" title=\"http \"></a><code>http</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  DefaultServeMux  pattern </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Handle</span><span class=\"params\">(pattern <span class=\"keyword\">string</span>, handler Handler)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">HandleFunc</span><span class=\"params\">(pattern <span class=\"keyword\">string</span>, handler <span class=\"keyword\">func</span>(ResponseWriter, *Request)</span>)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  handler . handler  nil, `DefaultServeMux`</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ListenAndServe</span><span class=\"params\">(addr <span class=\"keyword\">string</span>, handler Handler)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ListenAndServeTLS</span><span class=\"params\">(addr, certFile, keyFile <span class=\"keyword\">string</span>, handler Handler)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Listener  handler </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Serve</span><span class=\"params\">(l net.Listener, handler Handler)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ServeTLS</span><span class=\"params\">(l net.Listener, handler Handler, certFile, keyFile <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewRequest</span><span class=\"params\">(method, url <span class=\"keyword\">string</span>, body io.Reader)</span> <span class=\"params\">(*Request, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewRequestWithContext</span><span class=\"params\">(ctx context.Context, method, url <span class=\"keyword\">string</span>, body io.Reader)</span> <span class=\"params\">(*Request, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  ServeMux </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewServeMux</span><span class=\"params\">()</span> *<span class=\"title\">ServeMux</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Handler , Handle</span></span><br><span class=\"line\"><span class=\"comment\">//  root  HTTP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FileServer</span><span class=\"params\">(root FileSystem)</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"><span class=\"comment\">//  \"404 page not found\" , 404</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NotFoundHandler</span><span class=\"params\">()</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">RedirectHandler</span><span class=\"params\">(url <span class=\"keyword\">string</span>, code <span class=\"keyword\">int</span>)</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"><span class=\"comment\">//  URL </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">StripPrefix</span><span class=\"params\">(prefix <span class=\"keyword\">string</span>, h Handler)</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"><span class=\"comment\">//  h  Handler, msg</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TimeoutHandler</span><span class=\"params\">(h Handler, dt time.Duration, msg <span class=\"keyword\">string</span>)</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  handler  HandleFunc  Handler </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NotFound</span><span class=\"params\">(w ResponseWriter, r *Request)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ServeFile</span><span class=\"params\">(w ResponseWriter, r *Request, name <span class=\"keyword\">string</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  cookie</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SetCookie</span><span class=\"params\">(w ResponseWriter, cookie *Cookie)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Client-\"><a href=\"#Client-\" class=\"headerlink\" title=\"Client \"></a><code>Client</code> </h2><p>``go<br>// <br>func (c <em>Client) CloseIdleConnections()<br>// <br>func (c *Client) Do(req *Request) (</em>Response, error)<br>//  url  Get,Head,Post,Post() <br>func (c *Client) Get(url string) (resp *Response, err error)<br>func (c *Client) Head(url string) (resp *Response, err error)<br>func (c *Client) Post(url, contentType string, body io.Reader) (resp *Response, err error)<br>//  url  Post ,data .(<code>url.Values</code>  <code>map[string][]string</code> )<br>//  Content-Type  application/x-www-form-urlencoded<br>func (c *Client) PostForm(url string, data url.Values) (resp *Response, err error)</p>\n<figure class=\"highlight reasonml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">## `Header` </span><br><span class=\"line\"></span><br><span class=\"line\">```go</span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Add(<span class=\"params\">key</span>, <span class=\"params\">value</span> <span class=\"params\">string</span>)</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Clone()</span> Header</span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Del(<span class=\"params\">key</span> <span class=\"params\">string</span>)</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Get(<span class=\"params\">key</span> <span class=\"params\">string</span>)</span> <span class=\"built_in\">string</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Set(<span class=\"params\">key</span>, <span class=\"params\">value</span> <span class=\"params\">string</span>)</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Values(<span class=\"params\">key</span> <span class=\"params\">string</span>)</span> <span class=\"literal\">[]</span><span class=\"built_in\">string</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Write(<span class=\"params\">w</span> <span class=\"params\">io</span>.Writer)</span> error</span><br><span class=\"line\">func (h Header) <span class=\"constructor\">WriteSubset(<span class=\"params\">w</span> <span class=\"params\">io</span>.Writer, <span class=\"params\">exclude</span> <span class=\"params\">map</span>[<span class=\"params\">string</span>]<span class=\"params\">bool</span>)</span> error</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Request-\"><a href=\"#Request-\" class=\"headerlink\" title=\"Request \"></a><code>Request</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">AddCookie</span><span class=\"params\">(c *Cookie)</span>  //  <span class=\"title\">cookie</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">BasicAuth</span><span class=\"params\">()</span> <span class=\"params\">(username, password <span class=\"keyword\">string</span>, ok <span class=\"keyword\">bool</span>)</span> // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">Cookie</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*Cookie, error)</span> //  <span class=\"title\">Cookie</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">Cookies</span><span class=\"params\">()</span> []*<span class=\"title\">Cookie</span>  //  <span class=\"title\">cookie</span></span></span><br><span class=\"line\"><span class=\"comment\">//  key </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">FormFile</span><span class=\"params\">(key <span class=\"keyword\">string</span>)</span> <span class=\"params\">(multipart.File, *multipart.FileHeader, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">FormValue</span><span class=\"params\">(key <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span> //  <span class=\"title\">key</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">ParseForm</span><span class=\"params\">()</span> <span class=\"title\">error</span>  // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">ParseMultipartForm</span><span class=\"params\">(maxMemory <span class=\"keyword\">int64</span>)</span> <span class=\"title\">error</span> // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">Referer</span><span class=\"params\">()</span> <span class=\"title\">string</span>  //  <span class=\"title\">URL</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">SetBasicAuth</span><span class=\"params\">(username, password <span class=\"keyword\">string</span>)</span>  // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">UserAgent</span><span class=\"params\">()</span> <span class=\"title\">string</span> // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">Write</span><span class=\"params\">(w io.Writer)</span> <span class=\"title\">error</span> // </span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Response-\"><a href=\"#Response-\" class=\"headerlink\" title=\"Response \"></a><code>Response</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Response)</span> <span class=\"title\">Cookies</span><span class=\"params\">()</span> []*<span class=\"title\">Cookie</span>  //  <span class=\"title\">cookie</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Response)</span> <span class=\"title\">Location</span><span class=\"params\">()</span> <span class=\"params\">(*url.URL, error)</span> // `<span class=\"title\">Location</span>` </span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ServeMux-\"><a href=\"#ServeMux-\" class=\"headerlink\" title=\"ServeMux \"></a><code>ServeMux</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mux *ServeMux)</span> <span class=\"title\">Handle</span><span class=\"params\">(pattern <span class=\"keyword\">string</span>, handler Handler)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mux *ServeMux)</span> <span class=\"title\">HandleFunc</span><span class=\"params\">(pattern <span class=\"keyword\">string</span>, handler <span class=\"keyword\">func</span>(ResponseWriter, *Request)</span>)</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mux *ServeMux)</span> <span class=\"title\">Handler</span><span class=\"params\">(r *Request)</span> <span class=\"params\">(h Handler, pattern <span class=\"keyword\">string</span>)</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Server-\"><a href=\"#Server-\" class=\"headerlink\" title=\"Server \"></a><code>Server</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">ListenAndServe</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">ListenAndServeTLS</span><span class=\"params\">(certFile, keyFile <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// , server </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">RegisterOnShutdown</span><span class=\"params\">(f <span class=\"keyword\">func</span>()</span>)</span></span><br><span class=\"line\"><span class=\"comment\">//  listener , goroutine </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">Serve</span><span class=\"params\">(l net.Listener)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">ServeTLS</span><span class=\"params\">(l net.Listener, certFile, keyFile <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  keep-alive</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">SetKeepAlivesEnabled</span><span class=\"params\">(v <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">Shutdown</span><span class=\"params\">(ctx context.Context)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// StripPrefix , `/tmpfiles/`  `/`</span></span><br><span class=\"line\">    <span class=\"comment\">// http.Handle(\"/tmpfiles/\", http.StripPrefix(\"/tmpfiles/\", http.FileServer(http.Dir(\"/usr/share/doc\"))))</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  index.html.,</span></span><br><span class=\"line\">    http.ListenAndServe(<span class=\"string\">\":8080\"</span>, http.FileServer(http.Dir(<span class=\"string\">\"/usr/share/doc\"</span>)))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-PostForm-\"><a href=\"#-PostForm-\" class=\"headerlink\" title=\" PostForm \"></a> <code>PostForm</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/url\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    data := url.Values&#123;</span><br><span class=\"line\">        <span class=\"string\">\"name\"</span>: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"name\"</span>&#125;,</span><br><span class=\"line\">        <span class=\"string\">\"age\"</span>:  []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"20\"</span>&#125;,</span><br><span class=\"line\">        <span class=\"string\">\"addr\"</span>: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"beijing\"</span>, <span class=\"string\">\"shanghai\"</span>, <span class=\"string\">\"guangzhou\"</span>&#125;,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    res, _ := http.PostForm(<span class=\"string\">\"http://www.httpbin.org/post\"</span>, data)</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> res.Body.Close()</span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    n, _ := res.Body.Read(buf)</span><br><span class=\"line\">    fmt.Println(<span class=\"keyword\">string</span>(buf[:n]))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Handle--HandleFunc\"><a href=\"#Handle--HandleFunc\" class=\"headerlink\" title=\"Handle  HandleFunc\"></a><code>Handle</code>  <code>HandleFunc</code></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    h1 := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class=\"line\">        io.WriteString(w, <span class=\"string\">\"Hello from a HandleFunc #1!\\n\"</span>)</span><br><span class=\"line\">    h2 := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class=\"line\">        io.WriteString(w, <span class=\"string\">\"Hello from a HandleFunc #2!\\n\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    http.HandleFunc(<span class=\"string\">\"/h1\"</span>, h1)</span><br><span class=\"line\">    http.HandleFunc(<span class=\"string\">\"/h2\"</span>, h2)</span><br><span class=\"line\">    http.Handle(<span class=\"string\">\"/notfount\"</span>, http.NotFoundHandler())</span><br><span class=\"line\">    http.ListenAndServe(<span class=\"string\">\":8080\"</span>, <span class=\"literal\">nil</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"Handler\"><a href=\"#Handler\" class=\"headerlink\" title=\"Handler\"></a><code>Handler</code></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/url\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> CustomHandler <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    name <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c CustomHandler)</span> <span class=\"title\">ServeHTTP</span><span class=\"params\">(w http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class=\"line\">    time.Sleep(time.Second)</span><br><span class=\"line\">    fmt.Fprintf(w, <span class=\"string\">\"respose: %v\"</span>, c.name) <span class=\"comment\">//  w </span></span><br><span class=\"line\">    http.ServeFile(w, req, c.name)  <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    handler := CustomHandler&#123;<span class=\"string\">\"index.html\"</span>&#125;</span><br><span class=\"line\">    http.ListenAndServe(<span class=\"string\">\":80\"</span>, http.TimeoutHandler(handler, time.Nanosecond, <span class=\"string\">\"\"</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>http</code>  HTTP . HTTP . <code>import &quot;net/http&quot;</code></p>\n<p>, <code>Get</code>,<code>Head</code>,<code>Post</code><code>PostForm</code>  HTTP , <code>Client</code> , HTTP .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\">resp, err := http.Get(<span class=\"string\">\"http://example.com/\"</span>)</span><br><span class=\"line\">resp, err := http.PostForm(<span class=\"string\">\"http://example.com/form\"</span>,</span><br><span class=\"line\">    url.Values&#123;<span class=\"string\">\"key\"</span>: &#123;<span class=\"string\">\"Value\"</span>&#125;, <span class=\"string\">\"id\"</span>: &#123;<span class=\"string\">\"123\"</span>&#125;&#125;)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">defer</span> resp.Body.Close()</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Client ,</span></span><br><span class=\"line\">client := &amp;http.Client&#123;</span><br><span class=\"line\">    CheckRedirect: redirectPolicyFunc,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">resp, err := client.Get(<span class=\"string\">\"http://example.com\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\">req, err := http.NewRequest(<span class=\"string\">\"GET\"</span>, <span class=\"string\">\"http://example.com\"</span>, <span class=\"literal\">nil</span>)</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\">req.Header.Add(<span class=\"string\">\"If-None-Match\"</span>, <span class=\"string\">`W/\"wyzzy\"`</span>)</span><br><span class=\"line\">resp, err := client.Do(req)</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<p>,,TLS ,keep-alive, <code>Transport</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Transport ,</span></span><br><span class=\"line\">tr := &amp;http.Transport&#123;</span><br><span class=\"line\">    MaxIdleConns:       <span class=\"number\">10</span>,</span><br><span class=\"line\">    IdleConnTimeout:    <span class=\"number\">30</span> * time.Second,</span><br><span class=\"line\">    DisableCompression: <span class=\"literal\">true</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">client := &amp;http.Client&#123;Transport: tr&#125;</span><br><span class=\"line\">resp, err := client.Get(<span class=\"string\">\"https://example.com\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p>, <code>ListenAndServe</code>  HTTP , <code>Server</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http.Handle(<span class=\"string\">\"/foo\"</span>, fooHandler)</span><br><span class=\"line\">http.HandleFunc(<span class=\"string\">\"/bar\"</span>, <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class=\"line\">    fmt.Fprintf(w, <span class=\"string\">\"Hello, %q\"</span>, html.EscapeString(r.URL.Path))</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">log.Fatal(http.ListenAndServe(<span class=\"string\">\":8080\"</span>, <span class=\"literal\">nil</span>))</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">s := &amp;http.Server&#123;</span><br><span class=\"line\">    Addr:           <span class=\"string\">\":8080\"</span>,</span><br><span class=\"line\">    Handler:        myHandler,</span><br><span class=\"line\">    ReadTimeout:    <span class=\"number\">10</span> * time.Second,</span><br><span class=\"line\">    WriteTimeout:   <span class=\"number\">10</span> * time.Second,</span><br><span class=\"line\">    MaxHeaderBytes: <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">20</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">log.Fatal(s.ListenAndServe())</span><br></pre></td></tr></table></figure>\n\n<p><code>http</code>  <code>Transport</code>  <code>Server</code>  HTTP/2 . HTTP/2 , <code>golang.org/x/net/http2</code>, <code>ConfigureTransport</code>  <code>ConfigureServer</code> .</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight elm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ,</span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Client</span> struct &#123;</span><br><span class=\"line\">    //  <span class=\"type\">HTTP</span> . `<span class=\"type\">DefaultTransport</span>`</span><br><span class=\"line\">    <span class=\"type\">Transport</span> <span class=\"type\">RoundTripper</span></span><br><span class=\"line\">    // . nil, <span class=\"type\">HTTP</span> ., 10 </span><br><span class=\"line\">    // req  via .</span><br><span class=\"line\">    <span class=\"type\">CheckRedirect</span> func(req *<span class=\"type\">Request</span>, via []*<span class=\"type\">Request</span>) error</span><br><span class=\"line\">    <span class=\"type\">Jar</span> <span class=\"type\">CookieJar</span>  //  <span class=\"type\">CookieJar</span></span><br><span class=\"line\">    <span class=\"type\">Timeout</span> time.<span class=\"type\">Duration</span>  // </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Handler</span> interface &#123;</span><br><span class=\"line\">    <span class=\"type\">ServeHTTP</span>(<span class=\"type\">ResponseWriter</span>, *<span class=\"type\">Request</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">HandlerFunc</span> func(<span class=\"type\">ResponseWriter</span>, *<span class=\"type\">Request</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Header</span> map[string][]string</span><br><span class=\"line\"></span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Request</span> struct &#123;</span><br><span class=\"line\">    <span class=\"type\">Method</span> string  // </span><br><span class=\"line\">    <span class=\"type\">URL</span> *url.<span class=\"type\">URL</span>  //  <span class=\"type\">URL</span></span><br><span class=\"line\">    <span class=\"type\">Proto</span>      string // ,, <span class=\"type\">HTTP</span>/1.1  <span class=\"type\">HTTP</span>/2</span><br><span class=\"line\">    <span class=\"type\">Header</span> <span class=\"type\">Header</span>  // </span><br><span class=\"line\">    <span class=\"type\">Body</span> io.<span class=\"type\">ReadCloser</span>  // </span><br><span class=\"line\">    <span class=\"type\">GetBody</span> func() (io.<span class=\"type\">ReadCloser</span>, error) // </span><br><span class=\"line\">    <span class=\"type\">ContentLength</span> int64  // ,-1 </span><br><span class=\"line\">    <span class=\"type\">TransferEncoding</span> []string</span><br><span class=\"line\">    <span class=\"type\">Close</span> bool  //  <span class=\"type\">TCP</span> </span><br><span class=\"line\">    <span class=\"type\">Host</span> string  // ,, <span class=\"type\">URL</span>.<span class=\"type\">Host</span> </span><br><span class=\"line\">    </span><br><span class=\"line\">    // `<span class=\"type\">ParseForm</span>`  `<span class=\"type\">ParseMultipartForm</span>` </span><br><span class=\"line\">    <span class=\"type\">Form</span> url.<span class=\"type\">Values</span>  // , <span class=\"type\">URL</span> ,<span class=\"type\">PATCH</span>,<span class=\"type\">POST</span>,<span class=\"type\">PUT</span> .</span><br><span class=\"line\">    <span class=\"type\">PostForm</span> url.<span class=\"type\">Values</span> // , <span class=\"type\">PATCH</span>,<span class=\"type\">POST</span>,<span class=\"type\">PUT</span> </span><br><span class=\"line\">    <span class=\"type\">MultipartForm</span> *multipart.<span class=\"type\">Form</span> // ,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">RemoteAddr</span> string  // </span><br><span class=\"line\">    <span class=\"type\">RequestURI</span> string  //  <span class=\"type\">URI</span></span><br><span class=\"line\">    <span class=\"type\">TLS</span> *tls.<span class=\"type\">ConnectionState</span>  // <span class=\"type\">TLS</span> </span><br><span class=\"line\">    <span class=\"type\">Response</span> *<span class=\"type\">Response</span> // </span><br><span class=\"line\">    // contains filtered or unexported fields</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// </span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Response</span> struct &#123;</span><br><span class=\"line\">    <span class=\"type\">Status</span>     string // </span><br><span class=\"line\">    <span class=\"type\">StatusCode</span> int    // </span><br><span class=\"line\">    <span class=\"type\">Proto</span>      string // </span><br><span class=\"line\">    <span class=\"type\">Header</span> <span class=\"type\">Header</span>  // </span><br><span class=\"line\">    <span class=\"type\">Body</span> io.<span class=\"type\">ReadCloser</span>  // </span><br><span class=\"line\">    <span class=\"type\">ContentLength</span> int64  // </span><br><span class=\"line\">    <span class=\"type\">Uncompressed</span> bool // </span><br><span class=\"line\">    <span class=\"type\">Request</span> *<span class=\"type\">Request</span>  // </span><br><span class=\"line\">    <span class=\"type\">TLS</span> *tls.<span class=\"type\">ConnectionState</span> // <span class=\"type\">TLS</span> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// ,</span><br><span class=\"line\"><span class=\"keyword\">type</span> <span class=\"type\">Server</span> struct &#123;</span><br><span class=\"line\">    <span class=\"type\">Addr</span> string  // <span class=\"type\">HTTP</span> ,\":80\"</span><br><span class=\"line\">    <span class=\"type\">Handler</span> <span class=\"type\">Handler</span> // , `http.<span class=\"type\">DefaultServeMux</span>`</span><br><span class=\"line\">    <span class=\"type\">TLSConfig</span> *tls.<span class=\"type\">Config</span>  // <span class=\"type\">TLS</span> </span><br><span class=\"line\">    <span class=\"type\">ReadTimeout</span> time.<span class=\"type\">Duration</span>  //  </span><br><span class=\"line\">    <span class=\"type\">ReadHeaderTimeout</span> time.<span class=\"type\">Duration</span> // </span><br><span class=\"line\">    <span class=\"type\">WriteTimeout</span> time.<span class=\"type\">Duration</span>  // </span><br><span class=\"line\">    <span class=\"type\">IdleTimeout</span> time.<span class=\"type\">Duration</span> //  keep-alived ,,</span><br><span class=\"line\">    <span class=\"type\">MaxHeaderBytes</span> int // </span><br><span class=\"line\">    <span class=\"type\">ConnState</span> func(net.<span class=\"type\">Conn</span>, <span class=\"type\">ConnState</span>) // </span><br><span class=\"line\">    <span class=\"type\">ErrorLog</span> *log.<span class=\"type\">Logger</span> // . log  logger</span><br><span class=\"line\">    // contains filtered or unexported fields</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  HTTP (), https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    StatusOK                   = <span class=\"number\">200</span> <span class=\"comment\">// RFC 7231, 6.3.1</span></span><br><span class=\"line\">    StatusNoContent            = <span class=\"number\">204</span> <span class=\"comment\">// RFC 7231, 6.3.5</span></span><br><span class=\"line\"></span><br><span class=\"line\">    StatusMovedPermanently = <span class=\"number\">301</span> <span class=\"comment\">// RFC 7231, 6.4.2</span></span><br><span class=\"line\">    StatusFound            = <span class=\"number\">302</span> <span class=\"comment\">// RFC 7231, 6.4.3</span></span><br><span class=\"line\">    StatusTemporaryRedirect = <span class=\"number\">307</span> <span class=\"comment\">// RFC 7231, 6.4.7</span></span><br><span class=\"line\">    StatusPermanentRedirect = <span class=\"number\">308</span> <span class=\"comment\">// RFC 7538, 3</span></span><br><span class=\"line\"></span><br><span class=\"line\">    StatusBadRequest                   = <span class=\"number\">400</span> <span class=\"comment\">// RFC 7231, 6.5.1</span></span><br><span class=\"line\">    StatusUnauthorized                 = <span class=\"number\">401</span> <span class=\"comment\">// RFC 7235, 3.1</span></span><br><span class=\"line\">    StatusPaymentRequired              = <span class=\"number\">402</span> <span class=\"comment\">// RFC 7231, 6.5.2</span></span><br><span class=\"line\">    StatusForbidden                    = <span class=\"number\">403</span> <span class=\"comment\">// RFC 7231, 6.5.3</span></span><br><span class=\"line\">    StatusNotFound                     = <span class=\"number\">404</span> <span class=\"comment\">// RFC 7231, 6.5.4</span></span><br><span class=\"line\">    StatusMethodNotAllowed             = <span class=\"number\">405</span> <span class=\"comment\">// RFC 7231, 6.5.5</span></span><br><span class=\"line\">    StatusRequestTimeout               = <span class=\"number\">408</span> <span class=\"comment\">// RFC 7231, 6.5.7</span></span><br><span class=\"line\">    StatusRequestEntityTooLarge        = <span class=\"number\">413</span> <span class=\"comment\">// RFC 7231, 6.5.11</span></span><br><span class=\"line\">    StatusRequestURITooLong            = <span class=\"number\">414</span> <span class=\"comment\">// RFC 7231, 6.5.12</span></span><br><span class=\"line\">    StatusUnsupportedMediaType         = <span class=\"number\">415</span> <span class=\"comment\">// RFC 7231, 6.5.13</span></span><br><span class=\"line\">    StatusTooManyRequests              = <span class=\"number\">429</span> <span class=\"comment\">// RFC 6585, 4</span></span><br><span class=\"line\"></span><br><span class=\"line\">    StatusInternalServerError           = <span class=\"number\">500</span> <span class=\"comment\">// RFC 7231, 6.6.1</span></span><br><span class=\"line\">    StatusNotImplemented                = <span class=\"number\">501</span> <span class=\"comment\">// RFC 7231, 6.6.2</span></span><br><span class=\"line\">    StatusBadGateway                    = <span class=\"number\">502</span> <span class=\"comment\">// RFC 7231, 6.6.3</span></span><br><span class=\"line\">    StatusServiceUnavailable            = <span class=\"number\">503</span> <span class=\"comment\">// RFC 7231, 6.6.4</span></span><br><span class=\"line\">    StatusGatewayTimeout                = <span class=\"number\">504</span> <span class=\"comment\">// RFC 7231, 6.6.5</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> DefaultTransport RoundTripper = &amp;Transport&#123;</span><br><span class=\"line\">    Proxy: ProxyFromEnvironment,</span><br><span class=\"line\">    DialContext: (&amp;net.Dialer&#123;</span><br><span class=\"line\">        Timeout:   <span class=\"number\">30</span> * time.Second,</span><br><span class=\"line\">        KeepAlive: <span class=\"number\">30</span> * time.Second,</span><br><span class=\"line\">        DualStack: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;).DialContext,</span><br><span class=\"line\">    ForceAttemptHTTP2:     <span class=\"literal\">true</span>,</span><br><span class=\"line\">    MaxIdleConns:          <span class=\"number\">100</span>,</span><br><span class=\"line\">    IdleConnTimeout:       <span class=\"number\">90</span> * time.Second,</span><br><span class=\"line\">    TLSHandshakeTimeout:   <span class=\"number\">10</span> * time.Second,</span><br><span class=\"line\">    ExpectContinueTimeout: <span class=\"number\">1</span> * time.Second,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// , Handler </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> DefaultServeMux = &amp;defaultServeMux</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"http-\"><a href=\"#http-\" class=\"headerlink\" title=\"http \"></a><code>http</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  DefaultServeMux  pattern </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Handle</span><span class=\"params\">(pattern <span class=\"keyword\">string</span>, handler Handler)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">HandleFunc</span><span class=\"params\">(pattern <span class=\"keyword\">string</span>, handler <span class=\"keyword\">func</span>(ResponseWriter, *Request)</span>)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  handler . handler  nil, `DefaultServeMux`</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ListenAndServe</span><span class=\"params\">(addr <span class=\"keyword\">string</span>, handler Handler)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ListenAndServeTLS</span><span class=\"params\">(addr, certFile, keyFile <span class=\"keyword\">string</span>, handler Handler)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Listener  handler </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Serve</span><span class=\"params\">(l net.Listener, handler Handler)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ServeTLS</span><span class=\"params\">(l net.Listener, handler Handler, certFile, keyFile <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewRequest</span><span class=\"params\">(method, url <span class=\"keyword\">string</span>, body io.Reader)</span> <span class=\"params\">(*Request, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewRequestWithContext</span><span class=\"params\">(ctx context.Context, method, url <span class=\"keyword\">string</span>, body io.Reader)</span> <span class=\"params\">(*Request, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  ServeMux </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewServeMux</span><span class=\"params\">()</span> *<span class=\"title\">ServeMux</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Handler , Handle</span></span><br><span class=\"line\"><span class=\"comment\">//  root  HTTP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FileServer</span><span class=\"params\">(root FileSystem)</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"><span class=\"comment\">//  \"404 page not found\" , 404</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NotFoundHandler</span><span class=\"params\">()</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">RedirectHandler</span><span class=\"params\">(url <span class=\"keyword\">string</span>, code <span class=\"keyword\">int</span>)</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"><span class=\"comment\">//  URL </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">StripPrefix</span><span class=\"params\">(prefix <span class=\"keyword\">string</span>, h Handler)</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"><span class=\"comment\">//  h  Handler, msg</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TimeoutHandler</span><span class=\"params\">(h Handler, dt time.Duration, msg <span class=\"keyword\">string</span>)</span> <span class=\"title\">Handler</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  handler  HandleFunc  Handler </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NotFound</span><span class=\"params\">(w ResponseWriter, r *Request)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ServeFile</span><span class=\"params\">(w ResponseWriter, r *Request, name <span class=\"keyword\">string</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  cookie</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SetCookie</span><span class=\"params\">(w ResponseWriter, cookie *Cookie)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Client-\"><a href=\"#Client-\" class=\"headerlink\" title=\"Client \"></a><code>Client</code> </h2><p>``go<br>// <br>func (c <em>Client) CloseIdleConnections()<br>// <br>func (c *Client) Do(req *Request) (</em>Response, error)<br>//  url  Get,Head,Post,Post() <br>func (c *Client) Get(url string) (resp *Response, err error)<br>func (c *Client) Head(url string) (resp *Response, err error)<br>func (c *Client) Post(url, contentType string, body io.Reader) (resp *Response, err error)<br>//  url  Post ,data .(<code>url.Values</code>  <code>map[string][]string</code> )<br>//  Content-Type  application/x-www-form-urlencoded<br>func (c *Client) PostForm(url string, data url.Values) (resp *Response, err error)</p>\n<figure class=\"highlight reasonml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">## `Header` </span><br><span class=\"line\"></span><br><span class=\"line\">```go</span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Add(<span class=\"params\">key</span>, <span class=\"params\">value</span> <span class=\"params\">string</span>)</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Clone()</span> Header</span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Del(<span class=\"params\">key</span> <span class=\"params\">string</span>)</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Get(<span class=\"params\">key</span> <span class=\"params\">string</span>)</span> <span class=\"built_in\">string</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Set(<span class=\"params\">key</span>, <span class=\"params\">value</span> <span class=\"params\">string</span>)</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Values(<span class=\"params\">key</span> <span class=\"params\">string</span>)</span> <span class=\"literal\">[]</span><span class=\"built_in\">string</span></span><br><span class=\"line\">func (h Header) <span class=\"constructor\">Write(<span class=\"params\">w</span> <span class=\"params\">io</span>.Writer)</span> error</span><br><span class=\"line\">func (h Header) <span class=\"constructor\">WriteSubset(<span class=\"params\">w</span> <span class=\"params\">io</span>.Writer, <span class=\"params\">exclude</span> <span class=\"params\">map</span>[<span class=\"params\">string</span>]<span class=\"params\">bool</span>)</span> error</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Request-\"><a href=\"#Request-\" class=\"headerlink\" title=\"Request \"></a><code>Request</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">AddCookie</span><span class=\"params\">(c *Cookie)</span>  //  <span class=\"title\">cookie</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">BasicAuth</span><span class=\"params\">()</span> <span class=\"params\">(username, password <span class=\"keyword\">string</span>, ok <span class=\"keyword\">bool</span>)</span> // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">Cookie</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*Cookie, error)</span> //  <span class=\"title\">Cookie</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">Cookies</span><span class=\"params\">()</span> []*<span class=\"title\">Cookie</span>  //  <span class=\"title\">cookie</span></span></span><br><span class=\"line\"><span class=\"comment\">//  key </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">FormFile</span><span class=\"params\">(key <span class=\"keyword\">string</span>)</span> <span class=\"params\">(multipart.File, *multipart.FileHeader, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">FormValue</span><span class=\"params\">(key <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span> //  <span class=\"title\">key</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">ParseForm</span><span class=\"params\">()</span> <span class=\"title\">error</span>  // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">ParseMultipartForm</span><span class=\"params\">(maxMemory <span class=\"keyword\">int64</span>)</span> <span class=\"title\">error</span> // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">Referer</span><span class=\"params\">()</span> <span class=\"title\">string</span>  //  <span class=\"title\">URL</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">SetBasicAuth</span><span class=\"params\">(username, password <span class=\"keyword\">string</span>)</span>  // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">UserAgent</span><span class=\"params\">()</span> <span class=\"title\">string</span> // </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Request)</span> <span class=\"title\">Write</span><span class=\"params\">(w io.Writer)</span> <span class=\"title\">error</span> // </span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Response-\"><a href=\"#Response-\" class=\"headerlink\" title=\"Response \"></a><code>Response</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Response)</span> <span class=\"title\">Cookies</span><span class=\"params\">()</span> []*<span class=\"title\">Cookie</span>  //  <span class=\"title\">cookie</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Response)</span> <span class=\"title\">Location</span><span class=\"params\">()</span> <span class=\"params\">(*url.URL, error)</span> // `<span class=\"title\">Location</span>` </span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ServeMux-\"><a href=\"#ServeMux-\" class=\"headerlink\" title=\"ServeMux \"></a><code>ServeMux</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mux *ServeMux)</span> <span class=\"title\">Handle</span><span class=\"params\">(pattern <span class=\"keyword\">string</span>, handler Handler)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mux *ServeMux)</span> <span class=\"title\">HandleFunc</span><span class=\"params\">(pattern <span class=\"keyword\">string</span>, handler <span class=\"keyword\">func</span>(ResponseWriter, *Request)</span>)</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mux *ServeMux)</span> <span class=\"title\">Handler</span><span class=\"params\">(r *Request)</span> <span class=\"params\">(h Handler, pattern <span class=\"keyword\">string</span>)</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Server-\"><a href=\"#Server-\" class=\"headerlink\" title=\"Server \"></a><code>Server</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">ListenAndServe</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">ListenAndServeTLS</span><span class=\"params\">(certFile, keyFile <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// , server </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">RegisterOnShutdown</span><span class=\"params\">(f <span class=\"keyword\">func</span>()</span>)</span></span><br><span class=\"line\"><span class=\"comment\">//  listener , goroutine </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">Serve</span><span class=\"params\">(l net.Listener)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">ServeTLS</span><span class=\"params\">(l net.Listener, certFile, keyFile <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  keep-alive</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">SetKeepAlivesEnabled</span><span class=\"params\">(v <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(srv *Server)</span> <span class=\"title\">Shutdown</span><span class=\"params\">(ctx context.Context)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// StripPrefix , `/tmpfiles/`  `/`</span></span><br><span class=\"line\">    <span class=\"comment\">// http.Handle(\"/tmpfiles/\", http.StripPrefix(\"/tmpfiles/\", http.FileServer(http.Dir(\"/usr/share/doc\"))))</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  index.html.,</span></span><br><span class=\"line\">    http.ListenAndServe(<span class=\"string\">\":8080\"</span>, http.FileServer(http.Dir(<span class=\"string\">\"/usr/share/doc\"</span>)))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-PostForm-\"><a href=\"#-PostForm-\" class=\"headerlink\" title=\" PostForm \"></a> <code>PostForm</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/url\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    data := url.Values&#123;</span><br><span class=\"line\">        <span class=\"string\">\"name\"</span>: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"name\"</span>&#125;,</span><br><span class=\"line\">        <span class=\"string\">\"age\"</span>:  []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"20\"</span>&#125;,</span><br><span class=\"line\">        <span class=\"string\">\"addr\"</span>: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"beijing\"</span>, <span class=\"string\">\"shanghai\"</span>, <span class=\"string\">\"guangzhou\"</span>&#125;,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    res, _ := http.PostForm(<span class=\"string\">\"http://www.httpbin.org/post\"</span>, data)</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> res.Body.Close()</span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    n, _ := res.Body.Read(buf)</span><br><span class=\"line\">    fmt.Println(<span class=\"keyword\">string</span>(buf[:n]))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Handle--HandleFunc\"><a href=\"#Handle--HandleFunc\" class=\"headerlink\" title=\"Handle  HandleFunc\"></a><code>Handle</code>  <code>HandleFunc</code></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"io\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    h1 := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class=\"line\">        io.WriteString(w, <span class=\"string\">\"Hello from a HandleFunc #1!\\n\"</span>)</span><br><span class=\"line\">    h2 := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class=\"line\">        io.WriteString(w, <span class=\"string\">\"Hello from a HandleFunc #2!\\n\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    http.HandleFunc(<span class=\"string\">\"/h1\"</span>, h1)</span><br><span class=\"line\">    http.HandleFunc(<span class=\"string\">\"/h2\"</span>, h2)</span><br><span class=\"line\">    http.Handle(<span class=\"string\">\"/notfount\"</span>, http.NotFoundHandler())</span><br><span class=\"line\">    http.ListenAndServe(<span class=\"string\">\":8080\"</span>, <span class=\"literal\">nil</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"Handler\"><a href=\"#Handler\" class=\"headerlink\" title=\"Handler\"></a><code>Handler</code></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/url\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> CustomHandler <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    name <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c CustomHandler)</span> <span class=\"title\">ServeHTTP</span><span class=\"params\">(w http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class=\"line\">    time.Sleep(time.Second)</span><br><span class=\"line\">    fmt.Fprintf(w, <span class=\"string\">\"respose: %v\"</span>, c.name) <span class=\"comment\">//  w </span></span><br><span class=\"line\">    http.ServeFile(w, req, c.name)  <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    handler := CustomHandler&#123;<span class=\"string\">\"index.html\"</span>&#125;</span><br><span class=\"line\">    http.ListenAndServe(<span class=\"string\">\":80\"</span>, http.TimeoutHandler(handler, time.Nanosecond, <span class=\"string\">\"\"</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go  ioutil ","abbrlink":10272,"description":" Go ioutil .ioutil  IO ","_content":"\n`ioutil`  `io` , IO . `import \"io/ioutil\"`\n\n# \n\n `ioutil` \n\n```go\n//  r , EOF.\nfunc ReadAll(r io.Reader) ([]byte, error)\n// . `os.FileInfo` .\n// .\nfunc ReadDir(dirname string) ([]os.FileInfo, error)\n// \nfunc ReadFile(filename string) ([]byte, error)\n\n//  dir  prefix .\n// dir , `os.TempDir()`.\nfunc TempDir(dir, prefix string) (name string, err error)\n//  dir  pattern . `*os.File` \n// dir , `os.TempDir()`.\nfunc TempFile(dir, pattern string) (f *os.File, err error)\n//  data  filename.\n// , perm ;\nfunc WriteFile(filename string, data []byte, perm os.FileMode) error\n```\n\n# \n\n## \n\n```go\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc copyFileExample(src, dest string) (err error) {\n    data, err := ioutil.ReadFile(src)\n    err = ioutil.WriteFile(dest, data, 0)\n    return\n}\n\nfunc main() {\n    err := copyFileExample(\"src\", \"dest\")\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n```\n\n## \n\n```go\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"strings\"\n)\n\nfunc findFile(dir string) {\n    PathSeparator := string(os.PathSeparator)\n    fileInfos, err := ioutil.ReadDir(dir)\n    if err != nil {\n        return\n    }\n    for _, fileInfo := range fileInfos {\n        if fileInfo.IsDir() {\n            dirname := strings.Join([]string{dir, fileInfo.Name()}, PathSeparator)\n            findFile(dirname)\n        } else {\n            fmt.Printf(\"%v%v%v\\n\", dir, PathSeparator, fileInfo.Name())\n        }\n    }\n\n}\nfunc main() {\n    findFile(\".\")\n}\n```","source":"_posts/go-study-notes-package-ioutil.md","raw":"---\ntitle: go  ioutil \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 10272\ndescription:  Go ioutil .ioutil  IO \n---\n\n`ioutil`  `io` , IO . `import \"io/ioutil\"`\n\n# \n\n `ioutil` \n\n```go\n//  r , EOF.\nfunc ReadAll(r io.Reader) ([]byte, error)\n// . `os.FileInfo` .\n// .\nfunc ReadDir(dirname string) ([]os.FileInfo, error)\n// \nfunc ReadFile(filename string) ([]byte, error)\n\n//  dir  prefix .\n// dir , `os.TempDir()`.\nfunc TempDir(dir, prefix string) (name string, err error)\n//  dir  pattern . `*os.File` \n// dir , `os.TempDir()`.\nfunc TempFile(dir, pattern string) (f *os.File, err error)\n//  data  filename.\n// , perm ;\nfunc WriteFile(filename string, data []byte, perm os.FileMode) error\n```\n\n# \n\n## \n\n```go\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc copyFileExample(src, dest string) (err error) {\n    data, err := ioutil.ReadFile(src)\n    err = ioutil.WriteFile(dest, data, 0)\n    return\n}\n\nfunc main() {\n    err := copyFileExample(\"src\", \"dest\")\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n```\n\n## \n\n```go\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"strings\"\n)\n\nfunc findFile(dir string) {\n    PathSeparator := string(os.PathSeparator)\n    fileInfos, err := ioutil.ReadDir(dir)\n    if err != nil {\n        return\n    }\n    for _, fileInfo := range fileInfos {\n        if fileInfo.IsDir() {\n            dirname := strings.Join([]string{dir, fileInfo.Name()}, PathSeparator)\n            findFile(dirname)\n        } else {\n            fmt.Printf(\"%v%v%v\\n\", dir, PathSeparator, fileInfo.Name())\n        }\n    }\n\n}\nfunc main() {\n    findFile(\".\")\n}\n```","slug":"go-study-notes-package-ioutil","published":1,"date":"2020-05-03T11:57:56.009Z","updated":"2020-05-04T13:30:40.018Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvi001ck8u76lyd2acy","content":"<p><code>ioutil</code>  <code>io</code> , IO . <code>import &quot;io/ioutil&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>ioutil</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  r , EOF.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadAll</span><span class=\"params\">(r io.Reader)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// . `os.FileInfo` .</span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadDir</span><span class=\"params\">(dirname <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]os.FileInfo, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadFile</span><span class=\"params\">(filename <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  dir  prefix .</span></span><br><span class=\"line\"><span class=\"comment\">// dir , `os.TempDir()`.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TempDir</span><span class=\"params\">(dir, prefix <span class=\"keyword\">string</span>)</span> <span class=\"params\">(name <span class=\"keyword\">string</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  dir  pattern . `*os.File` </span></span><br><span class=\"line\"><span class=\"comment\">// dir , `os.TempDir()`.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TempFile</span><span class=\"params\">(dir, pattern <span class=\"keyword\">string</span>)</span> <span class=\"params\">(f *os.File, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  data  filename.</span></span><br><span class=\"line\"><span class=\"comment\">// , perm ;</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WriteFile</span><span class=\"params\">(filename <span class=\"keyword\">string</span>, data []<span class=\"keyword\">byte</span>, perm os.FileMode)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">copyFileExample</span><span class=\"params\">(src, dest <span class=\"keyword\">string</span>)</span> <span class=\"params\">(err error)</span></span> &#123;</span><br><span class=\"line\">    data, err := ioutil.ReadFile(src)</span><br><span class=\"line\">    err = ioutil.WriteFile(dest, data, <span class=\"number\">0</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    err := copyFileExample(<span class=\"string\">\"src\"</span>, <span class=\"string\">\"dest\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strings\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findFile</span><span class=\"params\">(dir <span class=\"keyword\">string</span>)</span></span> &#123;</span><br><span class=\"line\">    PathSeparator := <span class=\"keyword\">string</span>(os.PathSeparator)</span><br><span class=\"line\">    fileInfos, err := ioutil.ReadDir(dir)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> _, fileInfo := <span class=\"keyword\">range</span> fileInfos &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> fileInfo.IsDir() &#123;</span><br><span class=\"line\">            dirname := strings.Join([]<span class=\"keyword\">string</span>&#123;dir, fileInfo.Name()&#125;, PathSeparator)</span><br><span class=\"line\">            findFile(dirname)</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\"%v%v%v\\n\"</span>, dir, PathSeparator, fileInfo.Name())</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    findFile(<span class=\"string\">\".\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>ioutil</code>  <code>io</code> , IO . <code>import &quot;io/ioutil&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>ioutil</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  r , EOF.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadAll</span><span class=\"params\">(r io.Reader)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// . `os.FileInfo` .</span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadDir</span><span class=\"params\">(dirname <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]os.FileInfo, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ReadFile</span><span class=\"params\">(filename <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  dir  prefix .</span></span><br><span class=\"line\"><span class=\"comment\">// dir , `os.TempDir()`.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TempDir</span><span class=\"params\">(dir, prefix <span class=\"keyword\">string</span>)</span> <span class=\"params\">(name <span class=\"keyword\">string</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  dir  pattern . `*os.File` </span></span><br><span class=\"line\"><span class=\"comment\">// dir , `os.TempDir()`.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TempFile</span><span class=\"params\">(dir, pattern <span class=\"keyword\">string</span>)</span> <span class=\"params\">(f *os.File, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  data  filename.</span></span><br><span class=\"line\"><span class=\"comment\">// , perm ;</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">WriteFile</span><span class=\"params\">(filename <span class=\"keyword\">string</span>, data []<span class=\"keyword\">byte</span>, perm os.FileMode)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">copyFileExample</span><span class=\"params\">(src, dest <span class=\"keyword\">string</span>)</span> <span class=\"params\">(err error)</span></span> &#123;</span><br><span class=\"line\">    data, err := ioutil.ReadFile(src)</span><br><span class=\"line\">    err = ioutil.WriteFile(dest, data, <span class=\"number\">0</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    err := copyFileExample(<span class=\"string\">\"src\"</span>, <span class=\"string\">\"dest\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strings\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findFile</span><span class=\"params\">(dir <span class=\"keyword\">string</span>)</span></span> &#123;</span><br><span class=\"line\">    PathSeparator := <span class=\"keyword\">string</span>(os.PathSeparator)</span><br><span class=\"line\">    fileInfos, err := ioutil.ReadDir(dir)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> _, fileInfo := <span class=\"keyword\">range</span> fileInfos &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> fileInfo.IsDir() &#123;</span><br><span class=\"line\">            dirname := strings.Join([]<span class=\"keyword\">string</span>&#123;dir, fileInfo.Name()&#125;, PathSeparator)</span><br><span class=\"line\">            findFile(dirname)</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\"%v%v%v\\n\"</span>, dir, PathSeparator, fileInfo.Name())</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    findFile(<span class=\"string\">\".\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go  net ","abbrlink":63612,"description":" Go net ,,, net .","_content":"\n`net`  I/O , TCP/IP,UDP, Unix .\n\n, `net`  `Dial`  `Listen` , `Conn`  `Listener`  `Accept` . `crypto/tls`  `Dial`  `Listen` .\n\n:\n\n```go\n// ...\n// , tcp localhost:8080 \nln, err := net.Listen(\"tcp\", \"localhost:8080\")\nif err != nil {\n    // handle error\n}\nfor {\n    conn, err := ln.Accept()  // \n    if err != nil {\n        // handle error\n    }\n    go handleConnection(conn)  // \n}\n\n//  Dial  tcp localhost:8080 .\nconn, err := net.Dial(\"tcp\", \"localhost:8080\")\nif err != nil {\n    // handle error\n}\n//  conn ,,\nfmt.Fprintf(conn, \"GET / HTTP/1.0\\r\\n\\r\\n\")\n//  conn,\nstatus, err := bufio.NewReader(conn).ReadString('\\n')  \n// ...\n```\n\n> \n\n.\n\nUnix , Go  DNS  `/etc/resolv.conf`  DNS , cgo  C , getaddrinfo  getnameinfo.\n Go ,\n```bash\nexport GODEBUG=netdns=go    #  Go \nexport GODEBUG=netdns=cgo   #  cgo \n```\n\nWindows , C , GetAddrInfo  DnsQuery\n\n# \n\n```go\n// \n//  IPAddr,IPNet,TCPAddr,UDPAddr,UnixAddr\ntype Addr interface {\n    Network() string // \n    String() string  // +\n}\n// , goroutine  Conn \n//  tls.Conn,IPConn,TCPConn,UDPConn,UnixConn\ntype Conn interface {\n    Read(b []byte) (n int, err error) // \n    Write(b []byte) (n int, err error) // \n    Close() error // \n    LocalAddr() Addr // \n    RemoteAddr() Addr // \n    SetDeadline(t time.Time) error // ,0 \n    SetReadDeadline(t time.Time) error\n    SetWriteDeadline(t time.Time) error\n}\n// \n//  TCPListener,UnixListener\ntype Listener interface {\n    Accept() (Conn, error)  // \n    Close() error  // \n    Addr() Addr  // \n}\n```\n# \n\n# `net` \n\n```go\n//  network, address \nfunc Dial(network, address string) (Conn, error)\nfunc DialTimeout(network, address string, timeout time.Duration) (Conn, error)\n\n//  network, address .\nfunc Listen(network, address string) (Listener, error)\n\n//  host  IP , IP \nfunc LookupIP(host string) ([]IP, error)\n//  IP \nfunc ParseIP(s string) IP\n```\n\n# \n\n## \n\n- server.go\n\n```go\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    listener, err := net.Listen(\"tcp\", \"localhost:9090\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Printf(\"server listen %v\\n\", listener.Addr())\n    for {\n        conn, err := listener.Accept()\n        if err != nil {\n            fmt.Println(err)\n            break\n        }\n        go handleConn(conn)\n    }\n}\nfunc handleConn(conn net.Conn) {\n    fmt.Printf(\"conn established from remote %v\\n\", conn.RemoteAddr())\n    buf := make([]byte, 1024)\n    for {\n        rn, err := conn.Read(buf)\n        if err != nil {\n            fmt.Println(err)\n            break\n        }\n        message := string(buf[:rn])\n        fmt.Printf(\"client send: %v\\n\", message)\n        response := \"response:\" + message\n        conn.Write([]byte(response))\n    }\n}\n```\n\n- client.go\n\n```go\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    conn, err := net.Dial(\"tcp\", \"localhost:9090\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Printf(\"conn from %v to %v\\n\", conn.LocalAddr(), conn.RemoteAddr())\n\n    conn.Write([]byte(\"send message\"))\n    buf := make([]byte, 1024)\n    n, err := conn.Read(buf)\n    fmt.Printf(\"recv response: %v\", string(buf[:n]))\n}\n```\n\n\n","source":"_posts/go-study-notes-package-net.md","raw":"---\ntitle: go  net \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 63612\ndescription: ' Go net ,,, net .'\n---\n\n`net`  I/O , TCP/IP,UDP, Unix .\n\n, `net`  `Dial`  `Listen` , `Conn`  `Listener`  `Accept` . `crypto/tls`  `Dial`  `Listen` .\n\n:\n\n```go\n// ...\n// , tcp localhost:8080 \nln, err := net.Listen(\"tcp\", \"localhost:8080\")\nif err != nil {\n    // handle error\n}\nfor {\n    conn, err := ln.Accept()  // \n    if err != nil {\n        // handle error\n    }\n    go handleConnection(conn)  // \n}\n\n//  Dial  tcp localhost:8080 .\nconn, err := net.Dial(\"tcp\", \"localhost:8080\")\nif err != nil {\n    // handle error\n}\n//  conn ,,\nfmt.Fprintf(conn, \"GET / HTTP/1.0\\r\\n\\r\\n\")\n//  conn,\nstatus, err := bufio.NewReader(conn).ReadString('\\n')  \n// ...\n```\n\n> \n\n.\n\nUnix , Go  DNS  `/etc/resolv.conf`  DNS , cgo  C , getaddrinfo  getnameinfo.\n Go ,\n```bash\nexport GODEBUG=netdns=go    #  Go \nexport GODEBUG=netdns=cgo   #  cgo \n```\n\nWindows , C , GetAddrInfo  DnsQuery\n\n# \n\n```go\n// \n//  IPAddr,IPNet,TCPAddr,UDPAddr,UnixAddr\ntype Addr interface {\n    Network() string // \n    String() string  // +\n}\n// , goroutine  Conn \n//  tls.Conn,IPConn,TCPConn,UDPConn,UnixConn\ntype Conn interface {\n    Read(b []byte) (n int, err error) // \n    Write(b []byte) (n int, err error) // \n    Close() error // \n    LocalAddr() Addr // \n    RemoteAddr() Addr // \n    SetDeadline(t time.Time) error // ,0 \n    SetReadDeadline(t time.Time) error\n    SetWriteDeadline(t time.Time) error\n}\n// \n//  TCPListener,UnixListener\ntype Listener interface {\n    Accept() (Conn, error)  // \n    Close() error  // \n    Addr() Addr  // \n}\n```\n# \n\n# `net` \n\n```go\n//  network, address \nfunc Dial(network, address string) (Conn, error)\nfunc DialTimeout(network, address string, timeout time.Duration) (Conn, error)\n\n//  network, address .\nfunc Listen(network, address string) (Listener, error)\n\n//  host  IP , IP \nfunc LookupIP(host string) ([]IP, error)\n//  IP \nfunc ParseIP(s string) IP\n```\n\n# \n\n## \n\n- server.go\n\n```go\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    listener, err := net.Listen(\"tcp\", \"localhost:9090\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Printf(\"server listen %v\\n\", listener.Addr())\n    for {\n        conn, err := listener.Accept()\n        if err != nil {\n            fmt.Println(err)\n            break\n        }\n        go handleConn(conn)\n    }\n}\nfunc handleConn(conn net.Conn) {\n    fmt.Printf(\"conn established from remote %v\\n\", conn.RemoteAddr())\n    buf := make([]byte, 1024)\n    for {\n        rn, err := conn.Read(buf)\n        if err != nil {\n            fmt.Println(err)\n            break\n        }\n        message := string(buf[:rn])\n        fmt.Printf(\"client send: %v\\n\", message)\n        response := \"response:\" + message\n        conn.Write([]byte(response))\n    }\n}\n```\n\n- client.go\n\n```go\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    conn, err := net.Dial(\"tcp\", \"localhost:9090\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Printf(\"conn from %v to %v\\n\", conn.LocalAddr(), conn.RemoteAddr())\n\n    conn.Write([]byte(\"send message\"))\n    buf := make([]byte, 1024)\n    n, err := conn.Read(buf)\n    fmt.Printf(\"recv response: %v\", string(buf[:n]))\n}\n```\n\n\n","slug":"go-study-notes-package-net","published":1,"date":"2020-05-10T02:29:37.572Z","updated":"2020-05-10T11:39:06.774Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvj001gk8u77i4pdkdj","content":"<p><code>net</code>  I/O , TCP/IP,UDP, Unix .</p>\n<p>, <code>net</code>  <code>Dial</code>  <code>Listen</code> , <code>Conn</code>  <code>Listener</code>  <code>Accept</code> . <code>crypto/tls</code>  <code>Dial</code>  <code>Listen</code> .</p>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\"><span class=\"comment\">// , tcp localhost:8080 </span></span><br><span class=\"line\">ln, err := net.Listen(<span class=\"string\">\"tcp\"</span>, <span class=\"string\">\"localhost:8080\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// handle error</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">    conn, err := ln.Accept()  <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle error</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">go</span> handleConnection(conn)  <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Dial  tcp localhost:8080 .</span></span><br><span class=\"line\">conn, err := net.Dial(<span class=\"string\">\"tcp\"</span>, <span class=\"string\">\"localhost:8080\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// handle error</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//  conn ,,</span></span><br><span class=\"line\">fmt.Fprintf(conn, <span class=\"string\">\"GET / HTTP/1.0\\r\\n\\r\\n\"</span>)</span><br><span class=\"line\"><span class=\"comment\">//  conn,</span></span><br><span class=\"line\">status, err := bufio.NewReader(conn).ReadString(<span class=\"string\">'\\n'</span>)  </span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<p>.</p>\n<p>Unix , Go  DNS  <code>/etc/resolv.conf</code>  DNS , cgo  C , getaddrinfo  getnameinfo.<br> Go ,</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> GODEBUG=netdns=go    <span class=\"comment\">#  Go </span></span><br><span class=\"line\"><span class=\"built_in\">export</span> GODEBUG=netdns=cgo   <span class=\"comment\">#  cgo </span></span><br></pre></td></tr></table></figure>\n\n<p>Windows , C , GetAddrInfo  DnsQuery</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">//  IPAddr,IPNet,TCPAddr,UDPAddr,UnixAddr</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Addr <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Network() <span class=\"keyword\">string</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    String() <span class=\"keyword\">string</span>  <span class=\"comment\">// +</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// , goroutine  Conn </span></span><br><span class=\"line\"><span class=\"comment\">//  tls.Conn,IPConn,TCPConn,UDPConn,UnixConn</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Conn <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Read(b []<span class=\"keyword\">byte</span>) (n <span class=\"keyword\">int</span>, err error) <span class=\"comment\">// </span></span><br><span class=\"line\">    Write(b []<span class=\"keyword\">byte</span>) (n <span class=\"keyword\">int</span>, err error) <span class=\"comment\">// </span></span><br><span class=\"line\">    Close() error <span class=\"comment\">// </span></span><br><span class=\"line\">    LocalAddr() Addr <span class=\"comment\">// </span></span><br><span class=\"line\">    RemoteAddr() Addr <span class=\"comment\">// </span></span><br><span class=\"line\">    SetDeadline(t time.Time) error <span class=\"comment\">// ,0 </span></span><br><span class=\"line\">    SetReadDeadline(t time.Time) error</span><br><span class=\"line\">    SetWriteDeadline(t time.Time) error</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">//  TCPListener,UnixListener</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Listener <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Accept() (Conn, error)  <span class=\"comment\">// </span></span><br><span class=\"line\">    Close() error  <span class=\"comment\">// </span></span><br><span class=\"line\">    Addr() Addr  <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"net-\"><a href=\"#net-\" class=\"headerlink\" title=\"net \"></a><code>net</code> </h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  network, address </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Dial</span><span class=\"params\">(network, address <span class=\"keyword\">string</span>)</span> <span class=\"params\">(Conn, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DialTimeout</span><span class=\"params\">(network, address <span class=\"keyword\">string</span>, timeout time.Duration)</span> <span class=\"params\">(Conn, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  network, address .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Listen</span><span class=\"params\">(network, address <span class=\"keyword\">string</span>)</span> <span class=\"params\">(Listener, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  host  IP , IP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">LookupIP</span><span class=\"params\">(host <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]IP, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  IP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseIP</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">IP</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>server.go</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    listener, err := net.Listen(<span class=\"string\">\"tcp\"</span>, <span class=\"string\">\"localhost:9090\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"server listen %v\\n\"</span>, listener.Addr())</span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        conn, err := listener.Accept()</span><br><span class=\"line\">        <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            fmt.Println(err)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">go</span> handleConn(conn)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">handleConn</span><span class=\"params\">(conn net.Conn)</span></span> &#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"conn established from remote %v\\n\"</span>, conn.RemoteAddr())</span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        rn, err := conn.Read(buf)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            fmt.Println(err)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        message := <span class=\"keyword\">string</span>(buf[:rn])</span><br><span class=\"line\">        fmt.Printf(<span class=\"string\">\"client send: %v\\n\"</span>, message)</span><br><span class=\"line\">        response := <span class=\"string\">\"response:\"</span> + message</span><br><span class=\"line\">        conn.Write([]<span class=\"keyword\">byte</span>(response))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>client.go</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    conn, err := net.Dial(<span class=\"string\">\"tcp\"</span>, <span class=\"string\">\"localhost:9090\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"conn from %v to %v\\n\"</span>, conn.LocalAddr(), conn.RemoteAddr())</span><br><span class=\"line\"></span><br><span class=\"line\">    conn.Write([]<span class=\"keyword\">byte</span>(<span class=\"string\">\"send message\"</span>))</span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    n, err := conn.Read(buf)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"recv response: %v\"</span>, <span class=\"keyword\">string</span>(buf[:n]))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n","site":{"data":{}},"excerpt":"","more":"<p><code>net</code>  I/O , TCP/IP,UDP, Unix .</p>\n<p>, <code>net</code>  <code>Dial</code>  <code>Listen</code> , <code>Conn</code>  <code>Listener</code>  <code>Accept</code> . <code>crypto/tls</code>  <code>Dial</code>  <code>Listen</code> .</p>\n<p>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\"><span class=\"comment\">// , tcp localhost:8080 </span></span><br><span class=\"line\">ln, err := net.Listen(<span class=\"string\">\"tcp\"</span>, <span class=\"string\">\"localhost:8080\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// handle error</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">    conn, err := ln.Accept()  <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle error</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">go</span> handleConnection(conn)  <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Dial  tcp localhost:8080 .</span></span><br><span class=\"line\">conn, err := net.Dial(<span class=\"string\">\"tcp\"</span>, <span class=\"string\">\"localhost:8080\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// handle error</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//  conn ,,</span></span><br><span class=\"line\">fmt.Fprintf(conn, <span class=\"string\">\"GET / HTTP/1.0\\r\\n\\r\\n\"</span>)</span><br><span class=\"line\"><span class=\"comment\">//  conn,</span></span><br><span class=\"line\">status, err := bufio.NewReader(conn).ReadString(<span class=\"string\">'\\n'</span>)  </span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<p>.</p>\n<p>Unix , Go  DNS  <code>/etc/resolv.conf</code>  DNS , cgo  C , getaddrinfo  getnameinfo.<br> Go ,</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> GODEBUG=netdns=go    <span class=\"comment\">#  Go </span></span><br><span class=\"line\"><span class=\"built_in\">export</span> GODEBUG=netdns=cgo   <span class=\"comment\">#  cgo </span></span><br></pre></td></tr></table></figure>\n\n<p>Windows , C , GetAddrInfo  DnsQuery</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">//  IPAddr,IPNet,TCPAddr,UDPAddr,UnixAddr</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Addr <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Network() <span class=\"keyword\">string</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    String() <span class=\"keyword\">string</span>  <span class=\"comment\">// +</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// , goroutine  Conn </span></span><br><span class=\"line\"><span class=\"comment\">//  tls.Conn,IPConn,TCPConn,UDPConn,UnixConn</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Conn <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Read(b []<span class=\"keyword\">byte</span>) (n <span class=\"keyword\">int</span>, err error) <span class=\"comment\">// </span></span><br><span class=\"line\">    Write(b []<span class=\"keyword\">byte</span>) (n <span class=\"keyword\">int</span>, err error) <span class=\"comment\">// </span></span><br><span class=\"line\">    Close() error <span class=\"comment\">// </span></span><br><span class=\"line\">    LocalAddr() Addr <span class=\"comment\">// </span></span><br><span class=\"line\">    RemoteAddr() Addr <span class=\"comment\">// </span></span><br><span class=\"line\">    SetDeadline(t time.Time) error <span class=\"comment\">// ,0 </span></span><br><span class=\"line\">    SetReadDeadline(t time.Time) error</span><br><span class=\"line\">    SetWriteDeadline(t time.Time) error</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">//  TCPListener,UnixListener</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Listener <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Accept() (Conn, error)  <span class=\"comment\">// </span></span><br><span class=\"line\">    Close() error  <span class=\"comment\">// </span></span><br><span class=\"line\">    Addr() Addr  <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"net-\"><a href=\"#net-\" class=\"headerlink\" title=\"net \"></a><code>net</code> </h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  network, address </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Dial</span><span class=\"params\">(network, address <span class=\"keyword\">string</span>)</span> <span class=\"params\">(Conn, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DialTimeout</span><span class=\"params\">(network, address <span class=\"keyword\">string</span>, timeout time.Duration)</span> <span class=\"params\">(Conn, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  network, address .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Listen</span><span class=\"params\">(network, address <span class=\"keyword\">string</span>)</span> <span class=\"params\">(Listener, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  host  IP , IP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">LookupIP</span><span class=\"params\">(host <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]IP, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  IP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseIP</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">IP</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>server.go</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    listener, err := net.Listen(<span class=\"string\">\"tcp\"</span>, <span class=\"string\">\"localhost:9090\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"server listen %v\\n\"</span>, listener.Addr())</span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        conn, err := listener.Accept()</span><br><span class=\"line\">        <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            fmt.Println(err)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">go</span> handleConn(conn)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">handleConn</span><span class=\"params\">(conn net.Conn)</span></span> &#123;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"conn established from remote %v\\n\"</span>, conn.RemoteAddr())</span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        rn, err := conn.Read(buf)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            fmt.Println(err)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        message := <span class=\"keyword\">string</span>(buf[:rn])</span><br><span class=\"line\">        fmt.Printf(<span class=\"string\">\"client send: %v\\n\"</span>, message)</span><br><span class=\"line\">        response := <span class=\"string\">\"response:\"</span> + message</span><br><span class=\"line\">        conn.Write([]<span class=\"keyword\">byte</span>(response))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>client.go</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    conn, err := net.Dial(<span class=\"string\">\"tcp\"</span>, <span class=\"string\">\"localhost:9090\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"conn from %v to %v\\n\"</span>, conn.LocalAddr(), conn.RemoteAddr())</span><br><span class=\"line\"></span><br><span class=\"line\">    conn.Write([]<span class=\"keyword\">byte</span>(<span class=\"string\">\"send message\"</span>))</span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    n, err := conn.Read(buf)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"recv response: %v\"</span>, <span class=\"keyword\">string</span>(buf[:n]))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n"},{"title":"go  os ","abbrlink":45949,"description":" Go os .os .","_content":"\n`os` . `import \"os\"`\n\n# \n\n```go\n// \ntype FileMode uint32\n\n// \ntype File struct {\n    // \n}\n\n// \ntype FileInfo interface {\n    Name() string       // \n    Size() int64        // ,\n    Mode() FileMode     // \n    ModTime() time.Time // \n    IsDir() bool        // Mode().IsDir()\n    Sys() interface{}   // nil\n}\n```\n\n# \n\n `os` ,,\n\n````go\nconst (\n    //  String() \n    ModeDir        FileMode = 1 << (32 - 1 - iota) // d: \n    ModeAppend                                     // a: \n    ModeExclusive                                  // l: \n    ModeTemporary                                  // T: \n    ModeSymlink                                    // L: \n    ModeDevice                                     // D: \n    ModeNamedPipe                                  // p: (FIFO)\n    ModeSocket                                     // S: Unix \n    ModeSetuid                                     // u: setuid\n    ModeSetgid                                     // g: setgid\n    ModeCharDevice                                 // c: Unix \n    ModeSticky                                     // t: sticky\n    ModeIrregular                                  // ?: \n\n    // ,, none\n    ModeType = ModeDir | ModeSymlink | ModeNamedPipe | ModeSocket | ModeDevice | ModeCharDevice | ModeIrregular\n\n    ModePerm FileMode = 0777 // Unix \n)\nconst (\n    //  O_RDONLY, O_WRONLY, O_RDWR \n    O_RDONLY int = syscall.O_RDONLY // \n    O_WRONLY int = syscall.O_WRONLY // \n    O_RDWR   int = syscall.O_RDWR   // \n    // \n    O_APPEND int = syscall.O_APPEND // \n    O_CREATE int = syscall.O_CREAT  // \n    O_EXCL   int = syscall.O_EXCL   //  O_CREATE ,\n    O_SYNC   int = syscall.O_SYNC   //  I/O \n    O_TRUNC  int = syscall.O_TRUNC  // \n)\nconst (\n    SEEK_SET int = 0 // ,, io.SeekStart\n    SEEK_CUR int = 1 // ,, io.SeekCurrent\n    SEEK_END int = 2 // ,, io.SeekEnd\n)\nconst (\n    PathSeparator     = '/' // Unix \n    PathListSeparator = ':' // Unix \n)\nconst (\n    PathSeparator     = '\\\\' // Windows \n    PathListSeparator = ';' // Windows \n)\n\nvar (\n    Stdin  = NewFile(uintptr(syscall.Stdin), \"/dev/stdin\")\n    Stdout = NewFile(uintptr(syscall.Stdout), \"/dev/stdout\")\n    Stderr = NewFile(uintptr(syscall.Stderr), \"/dev/stderr\")\n)\n```\n\n# \n\n## `os` \n\n### \n\n```go\n// \nfunc Hostname() (name string, err error)\n// , \"key=value\"\nfunc Environ() []string\n// \nfunc Getenv(key string) string  \n// (),\nfunc Setenv(key, value string) error\n// \nfunc Clearenv()\n// ,, defer \nfunc Exit(code int)\nfunc Getuid() int  // ID\nfunc Getgid() int  // ID\nfunc Getpid() int  // ID\nfunc Getppid() int  // ID\n```\n\n### \n\n```go\n//  FileInfo \nfunc Stat(name string) (fi FileInfo, err error)\n//  0666 ,. O_RDWR  IO \nfunc Create(name string) (file *File, err error)\n// . O_RDONLY \nfunc Open(name string) (file *File, err error)\n//  flag,.\nfunc OpenFile(name string, flag int, perm FileMode) (file *File, err error)\n// \nfunc IsExist(err error) bool\n// \nfunc IsExist(err error) bool\n// \nfunc IsPermission(err error) bool\n// . $GOPATH/src\nfunc Getwd() (dir string, err error)\n// ,\nfunc Chdir(dir string) error\n// .\nfunc Chmod(name string, mode FileMode) error\n// .\nfunc Chown(name string, uid, gid int) error\n// .\nfunc Chtimes(name string, atime time.Time, mtime time.Time) error\n// .,.\nfunc Mkdir(name string, perm FileMode) error\n// .,..\nfunc MkdirAll(path string, perm FileMode) error\n// .\nfunc Rename(oldpath, newpath string) error\n// .,.\nfunc Remove(name string) error\n//  path \nfunc RemoveAll(path string) error\n//  newname  oldname .\nfunc Symlink(oldname, newname string) error\n// .\n// windows  C:\\Users\\<Username>\\AppData\\Local\\Temp, linux  /tmp\nfunc TempDir() string\n```\n\n## `File` \n\n```go\n// \nfunc (f *File) Name() string\n//  FileInfo \nfunc (f *File) Stat() (fi FileInfo, err error)\n// Unix\nfunc (f *File) Fd() uintptr\n// ,\nfunc (f *File) Chmod(mode FileMode) error\n// ,\nfunc (f *File) Chown(uid, gid int) error\n//  size ,.\nfunc (f *File) Truncate(size int64) error\n//  len(b)  b.. 0 err  io.EOF\nfunc (f *File) Read(b []byte) (n int, err error)\n// len(b)b\nfunc (f *File) ReadAt(b []byte, off int64) (n int, err error)\n// len(b),, n!=len(b), nil \nfunc (f *File) Write(b []byte) (n int, err error)\n// , Write\nfunc (f *File) WriteString(s string) (ret int, err error)\n// , Write\nfunc (f *File) WriteAt(b []byte, off int64) (n int, err error)\n// /,().\n// offset ,whence : 0,1,2\nfunc (f *File) Seek(offset int64, whence int) (ret int64, err error)\n// \nfunc (f *File) Sync() (err error)\n// .\nfunc (f *File) Close() error\n```\n\n# \n\n## \n\n```go\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    file, err := os.OpenFile(\"filename\", os.O_RDWR|os.O_CREATE|os.O_SYNC|os.O_APPEND, 0)  //  ,, , \n    if err != nil {\n        fmt.Println(\"err\", err)\n        return\n    }\n    defer file.Close()\n\n    // \n    var bytes = []byte{'a', 'b', 'c', 'd', '\\n'}\n    file.Write(bytes)  //  []bete \n    str := \"this is string to write\\n\"\n    var strBytes = []byte(str)\n    file.Write(strBytes)\n    file.WriteString(str)  // \n    // file.Sync() //  OpenFile  os.O_TRUNC ,,\n\n    // \n    buffer := make([]byte, 1024)\n    file.Seek(0, 0)  // ,,. ,\n    for {\n        len, err := file.Read(buffer)  //  buffer \n        if len == 0 && err != nil {\n            break\n        }\n        fmt.Print(string(buffer[:len]))  // \n    }\n}\n```\n\n`os` , `{% post_link go-study-notes-package-time bufio%}` \n","source":"_posts/go-study-notes-package-os.md","raw":"---\ntitle: go  os \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 45949\ndescription:  Go os .os .\n---\n\n`os` . `import \"os\"`\n\n# \n\n```go\n// \ntype FileMode uint32\n\n// \ntype File struct {\n    // \n}\n\n// \ntype FileInfo interface {\n    Name() string       // \n    Size() int64        // ,\n    Mode() FileMode     // \n    ModTime() time.Time // \n    IsDir() bool        // Mode().IsDir()\n    Sys() interface{}   // nil\n}\n```\n\n# \n\n `os` ,,\n\n````go\nconst (\n    //  String() \n    ModeDir        FileMode = 1 << (32 - 1 - iota) // d: \n    ModeAppend                                     // a: \n    ModeExclusive                                  // l: \n    ModeTemporary                                  // T: \n    ModeSymlink                                    // L: \n    ModeDevice                                     // D: \n    ModeNamedPipe                                  // p: (FIFO)\n    ModeSocket                                     // S: Unix \n    ModeSetuid                                     // u: setuid\n    ModeSetgid                                     // g: setgid\n    ModeCharDevice                                 // c: Unix \n    ModeSticky                                     // t: sticky\n    ModeIrregular                                  // ?: \n\n    // ,, none\n    ModeType = ModeDir | ModeSymlink | ModeNamedPipe | ModeSocket | ModeDevice | ModeCharDevice | ModeIrregular\n\n    ModePerm FileMode = 0777 // Unix \n)\nconst (\n    //  O_RDONLY, O_WRONLY, O_RDWR \n    O_RDONLY int = syscall.O_RDONLY // \n    O_WRONLY int = syscall.O_WRONLY // \n    O_RDWR   int = syscall.O_RDWR   // \n    // \n    O_APPEND int = syscall.O_APPEND // \n    O_CREATE int = syscall.O_CREAT  // \n    O_EXCL   int = syscall.O_EXCL   //  O_CREATE ,\n    O_SYNC   int = syscall.O_SYNC   //  I/O \n    O_TRUNC  int = syscall.O_TRUNC  // \n)\nconst (\n    SEEK_SET int = 0 // ,, io.SeekStart\n    SEEK_CUR int = 1 // ,, io.SeekCurrent\n    SEEK_END int = 2 // ,, io.SeekEnd\n)\nconst (\n    PathSeparator     = '/' // Unix \n    PathListSeparator = ':' // Unix \n)\nconst (\n    PathSeparator     = '\\\\' // Windows \n    PathListSeparator = ';' // Windows \n)\n\nvar (\n    Stdin  = NewFile(uintptr(syscall.Stdin), \"/dev/stdin\")\n    Stdout = NewFile(uintptr(syscall.Stdout), \"/dev/stdout\")\n    Stderr = NewFile(uintptr(syscall.Stderr), \"/dev/stderr\")\n)\n```\n\n# \n\n## `os` \n\n### \n\n```go\n// \nfunc Hostname() (name string, err error)\n// , \"key=value\"\nfunc Environ() []string\n// \nfunc Getenv(key string) string  \n// (),\nfunc Setenv(key, value string) error\n// \nfunc Clearenv()\n// ,, defer \nfunc Exit(code int)\nfunc Getuid() int  // ID\nfunc Getgid() int  // ID\nfunc Getpid() int  // ID\nfunc Getppid() int  // ID\n```\n\n### \n\n```go\n//  FileInfo \nfunc Stat(name string) (fi FileInfo, err error)\n//  0666 ,. O_RDWR  IO \nfunc Create(name string) (file *File, err error)\n// . O_RDONLY \nfunc Open(name string) (file *File, err error)\n//  flag,.\nfunc OpenFile(name string, flag int, perm FileMode) (file *File, err error)\n// \nfunc IsExist(err error) bool\n// \nfunc IsExist(err error) bool\n// \nfunc IsPermission(err error) bool\n// . $GOPATH/src\nfunc Getwd() (dir string, err error)\n// ,\nfunc Chdir(dir string) error\n// .\nfunc Chmod(name string, mode FileMode) error\n// .\nfunc Chown(name string, uid, gid int) error\n// .\nfunc Chtimes(name string, atime time.Time, mtime time.Time) error\n// .,.\nfunc Mkdir(name string, perm FileMode) error\n// .,..\nfunc MkdirAll(path string, perm FileMode) error\n// .\nfunc Rename(oldpath, newpath string) error\n// .,.\nfunc Remove(name string) error\n//  path \nfunc RemoveAll(path string) error\n//  newname  oldname .\nfunc Symlink(oldname, newname string) error\n// .\n// windows  C:\\Users\\<Username>\\AppData\\Local\\Temp, linux  /tmp\nfunc TempDir() string\n```\n\n## `File` \n\n```go\n// \nfunc (f *File) Name() string\n//  FileInfo \nfunc (f *File) Stat() (fi FileInfo, err error)\n// Unix\nfunc (f *File) Fd() uintptr\n// ,\nfunc (f *File) Chmod(mode FileMode) error\n// ,\nfunc (f *File) Chown(uid, gid int) error\n//  size ,.\nfunc (f *File) Truncate(size int64) error\n//  len(b)  b.. 0 err  io.EOF\nfunc (f *File) Read(b []byte) (n int, err error)\n// len(b)b\nfunc (f *File) ReadAt(b []byte, off int64) (n int, err error)\n// len(b),, n!=len(b), nil \nfunc (f *File) Write(b []byte) (n int, err error)\n// , Write\nfunc (f *File) WriteString(s string) (ret int, err error)\n// , Write\nfunc (f *File) WriteAt(b []byte, off int64) (n int, err error)\n// /,().\n// offset ,whence : 0,1,2\nfunc (f *File) Seek(offset int64, whence int) (ret int64, err error)\n// \nfunc (f *File) Sync() (err error)\n// .\nfunc (f *File) Close() error\n```\n\n# \n\n## \n\n```go\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    file, err := os.OpenFile(\"filename\", os.O_RDWR|os.O_CREATE|os.O_SYNC|os.O_APPEND, 0)  //  ,, , \n    if err != nil {\n        fmt.Println(\"err\", err)\n        return\n    }\n    defer file.Close()\n\n    // \n    var bytes = []byte{'a', 'b', 'c', 'd', '\\n'}\n    file.Write(bytes)  //  []bete \n    str := \"this is string to write\\n\"\n    var strBytes = []byte(str)\n    file.Write(strBytes)\n    file.WriteString(str)  // \n    // file.Sync() //  OpenFile  os.O_TRUNC ,,\n\n    // \n    buffer := make([]byte, 1024)\n    file.Seek(0, 0)  // ,,. ,\n    for {\n        len, err := file.Read(buffer)  //  buffer \n        if len == 0 && err != nil {\n            break\n        }\n        fmt.Print(string(buffer[:len]))  // \n    }\n}\n```\n\n`os` , `{% post_link go-study-notes-package-time bufio%}` \n","slug":"go-study-notes-package-os","published":1,"date":"2020-05-02T00:43:36.446Z","updated":"2020-05-04T13:37:58.659Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvk001jk8u764me09lm","content":"<p><code>os</code> . <code>import &quot;os&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> FileMode <span class=\"keyword\">uint32</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> File <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> FileInfo <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Name() <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    Size() <span class=\"keyword\">int64</span>        <span class=\"comment\">// ,</span></span><br><span class=\"line\">    Mode() FileMode     <span class=\"comment\">// </span></span><br><span class=\"line\">    ModTime() time.Time <span class=\"comment\">// </span></span><br><span class=\"line\">    IsDir() <span class=\"keyword\">bool</span>        <span class=\"comment\">// Mode().IsDir()</span></span><br><span class=\"line\">    Sys() <span class=\"keyword\">interface</span>&#123;&#125;   <span class=\"comment\">// nil</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>os</code> ,,</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const (</span><br><span class=\"line\">    &#x2F;&#x2F;  String() </span><br><span class=\"line\">    ModeDir        FileMode &#x3D; 1 &lt;&lt; (32 - 1 - iota) &#x2F;&#x2F; d: </span><br><span class=\"line\">    ModeAppend                                     &#x2F;&#x2F; a: </span><br><span class=\"line\">    ModeExclusive                                  &#x2F;&#x2F; l: </span><br><span class=\"line\">    ModeTemporary                                  &#x2F;&#x2F; T: </span><br><span class=\"line\">    ModeSymlink                                    &#x2F;&#x2F; L: </span><br><span class=\"line\">    ModeDevice                                     &#x2F;&#x2F; D: </span><br><span class=\"line\">    ModeNamedPipe                                  &#x2F;&#x2F; p: (FIFO)</span><br><span class=\"line\">    ModeSocket                                     &#x2F;&#x2F; S: Unix </span><br><span class=\"line\">    ModeSetuid                                     &#x2F;&#x2F; u: setuid</span><br><span class=\"line\">    ModeSetgid                                     &#x2F;&#x2F; g: setgid</span><br><span class=\"line\">    ModeCharDevice                                 &#x2F;&#x2F; c: Unix </span><br><span class=\"line\">    ModeSticky                                     &#x2F;&#x2F; t: sticky</span><br><span class=\"line\">    ModeIrregular                                  &#x2F;&#x2F; ?: </span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F; ,, none</span><br><span class=\"line\">    ModeType &#x3D; ModeDir | ModeSymlink | ModeNamedPipe | ModeSocket | ModeDevice | ModeCharDevice | ModeIrregular</span><br><span class=\"line\"></span><br><span class=\"line\">    ModePerm FileMode &#x3D; 0777 &#x2F;&#x2F; Unix </span><br><span class=\"line\">)</span><br><span class=\"line\">const (</span><br><span class=\"line\">    &#x2F;&#x2F;  O_RDONLY, O_WRONLY, O_RDWR </span><br><span class=\"line\">    O_RDONLY int &#x3D; syscall.O_RDONLY &#x2F;&#x2F; </span><br><span class=\"line\">    O_WRONLY int &#x3D; syscall.O_WRONLY &#x2F;&#x2F; </span><br><span class=\"line\">    O_RDWR   int &#x3D; syscall.O_RDWR   &#x2F;&#x2F; </span><br><span class=\"line\">    &#x2F;&#x2F; </span><br><span class=\"line\">    O_APPEND int &#x3D; syscall.O_APPEND &#x2F;&#x2F; </span><br><span class=\"line\">    O_CREATE int &#x3D; syscall.O_CREAT  &#x2F;&#x2F; </span><br><span class=\"line\">    O_EXCL   int &#x3D; syscall.O_EXCL   &#x2F;&#x2F;  O_CREATE ,</span><br><span class=\"line\">    O_SYNC   int &#x3D; syscall.O_SYNC   &#x2F;&#x2F;  I&#x2F;O </span><br><span class=\"line\">    O_TRUNC  int &#x3D; syscall.O_TRUNC  &#x2F;&#x2F; </span><br><span class=\"line\">)</span><br><span class=\"line\">const (</span><br><span class=\"line\">    SEEK_SET int &#x3D; 0 &#x2F;&#x2F; ,, io.SeekStart</span><br><span class=\"line\">    SEEK_CUR int &#x3D; 1 &#x2F;&#x2F; ,, io.SeekCurrent</span><br><span class=\"line\">    SEEK_END int &#x3D; 2 &#x2F;&#x2F; ,, io.SeekEnd</span><br><span class=\"line\">)</span><br><span class=\"line\">const (</span><br><span class=\"line\">    PathSeparator     &#x3D; &#39;&#x2F;&#39; &#x2F;&#x2F; Unix </span><br><span class=\"line\">    PathListSeparator &#x3D; &#39;:&#39; &#x2F;&#x2F; Unix </span><br><span class=\"line\">)</span><br><span class=\"line\">const (</span><br><span class=\"line\">    PathSeparator     &#x3D; &#39;\\\\&#39; &#x2F;&#x2F; Windows </span><br><span class=\"line\">    PathListSeparator &#x3D; &#39;;&#39; &#x2F;&#x2F; Windows </span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">var (</span><br><span class=\"line\">    Stdin  &#x3D; NewFile(uintptr(syscall.Stdin), &quot;&#x2F;dev&#x2F;stdin&quot;)</span><br><span class=\"line\">    Stdout &#x3D; NewFile(uintptr(syscall.Stdout), &quot;&#x2F;dev&#x2F;stdout&quot;)</span><br><span class=\"line\">    Stderr &#x3D; NewFile(uintptr(syscall.Stderr), &quot;&#x2F;dev&#x2F;stderr&quot;)</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"os-\"><a href=\"#os-\" class=\"headerlink\" title=\"os \"></a><code>os</code> </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Hostname</span><span class=\"params\">()</span> <span class=\"params\">(name <span class=\"keyword\">string</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , \"key=value\"</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Environ</span><span class=\"params\">()</span> []<span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getenv</span><span class=\"params\">(key <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span>  </span><br><span class=\"line\"><span class=\"comment\">// (),</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Setenv</span><span class=\"params\">(key, value <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Clearenv</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,, defer </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Exit</span><span class=\"params\">(code <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getuid</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // <span class=\"title\">ID</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getgid</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // <span class=\"title\">ID</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getpid</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // <span class=\"title\">ID</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getppid</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // <span class=\"title\">ID</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  FileInfo </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Stat</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(fi FileInfo, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  0666 ,. O_RDWR  IO </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Create</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(file *File, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// . O_RDONLY </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Open</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(file *File, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  flag,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">OpenFile</span><span class=\"params\">(name <span class=\"keyword\">string</span>, flag <span class=\"keyword\">int</span>, perm FileMode)</span> <span class=\"params\">(file *File, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsExist</span><span class=\"params\">(err error)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsExist</span><span class=\"params\">(err error)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsPermission</span><span class=\"params\">(err error)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// . $GOPATH/src</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getwd</span><span class=\"params\">()</span> <span class=\"params\">(dir <span class=\"keyword\">string</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Chdir</span><span class=\"params\">(dir <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Chmod</span><span class=\"params\">(name <span class=\"keyword\">string</span>, mode FileMode)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Chown</span><span class=\"params\">(name <span class=\"keyword\">string</span>, uid, gid <span class=\"keyword\">int</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Chtimes</span><span class=\"params\">(name <span class=\"keyword\">string</span>, atime time.Time, mtime time.Time)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Mkdir</span><span class=\"params\">(name <span class=\"keyword\">string</span>, perm FileMode)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .,..</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">MkdirAll</span><span class=\"params\">(path <span class=\"keyword\">string</span>, perm FileMode)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Rename</span><span class=\"params\">(oldpath, newpath <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Remove</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  path </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">RemoveAll</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  newname  oldname .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Symlink</span><span class=\"params\">(oldname, newname <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"comment\">// windows  C:\\Users\\&lt;Username&gt;\\AppData\\Local\\Temp, linux  /tmp</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TempDir</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"File-\"><a href=\"#File-\" class=\"headerlink\" title=\"File \"></a><code>File</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Name</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  FileInfo </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Stat</span><span class=\"params\">()</span> <span class=\"params\">(fi FileInfo, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// Unix</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Fd</span><span class=\"params\">()</span> <span class=\"title\">uintptr</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Chmod</span><span class=\"params\">(mode FileMode)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Chown</span><span class=\"params\">(uid, gid <span class=\"keyword\">int</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  size ,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Truncate</span><span class=\"params\">(size <span class=\"keyword\">int64</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  len(b)  b.. 0 err  io.EOF</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Read</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// len(b)b</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">ReadAt</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// len(b),, n!=len(b), nil </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Write</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , Write</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">WriteString</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(ret <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , Write</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">WriteAt</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// /,().</span></span><br><span class=\"line\"><span class=\"comment\">// offset ,whence : 0,1,2</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Seek</span><span class=\"params\">(offset <span class=\"keyword\">int64</span>, whence <span class=\"keyword\">int</span>)</span> <span class=\"params\">(ret <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Sync</span><span class=\"params\">()</span> <span class=\"params\">(err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    file, err := os.OpenFile(<span class=\"string\">\"filename\"</span>, os.O_RDWR|os.O_CREATE|os.O_SYNC|os.O_APPEND, <span class=\"number\">0</span>)  <span class=\"comment\">//  ,, , </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"err\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> file.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> bytes = []<span class=\"keyword\">byte</span>&#123;<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'c'</span>, <span class=\"string\">'d'</span>, <span class=\"string\">'\\n'</span>&#125;</span><br><span class=\"line\">    file.Write(bytes)  <span class=\"comment\">//  []bete </span></span><br><span class=\"line\">    str := <span class=\"string\">\"this is string to write\\n\"</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> strBytes = []<span class=\"keyword\">byte</span>(str)</span><br><span class=\"line\">    file.Write(strBytes)</span><br><span class=\"line\">    file.WriteString(str)  <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">// file.Sync() //  OpenFile  os.O_TRUNC ,,</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    buffer := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    file.Seek(<span class=\"number\">0</span>, <span class=\"number\">0</span>)  <span class=\"comment\">// ,,. ,</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">len</span>, err := file.Read(buffer)  <span class=\"comment\">//  buffer </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span> == <span class=\"number\">0</span> &amp;&amp; err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Print(<span class=\"keyword\">string</span>(buffer[:<span class=\"built_in\">len</span>]))  <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>os</code> , <code><a href=\"/2020/05/01/go-study-notes-package-time/\" title=\"bufio\">bufio</a></code> </p>\n","site":{"data":{}},"excerpt":"","more":"<p><code>os</code> . <code>import &quot;os&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> FileMode <span class=\"keyword\">uint32</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> File <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> FileInfo <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Name() <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    Size() <span class=\"keyword\">int64</span>        <span class=\"comment\">// ,</span></span><br><span class=\"line\">    Mode() FileMode     <span class=\"comment\">// </span></span><br><span class=\"line\">    ModTime() time.Time <span class=\"comment\">// </span></span><br><span class=\"line\">    IsDir() <span class=\"keyword\">bool</span>        <span class=\"comment\">// Mode().IsDir()</span></span><br><span class=\"line\">    Sys() <span class=\"keyword\">interface</span>&#123;&#125;   <span class=\"comment\">// nil</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>os</code> ,,</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const (</span><br><span class=\"line\">    &#x2F;&#x2F;  String() </span><br><span class=\"line\">    ModeDir        FileMode &#x3D; 1 &lt;&lt; (32 - 1 - iota) &#x2F;&#x2F; d: </span><br><span class=\"line\">    ModeAppend                                     &#x2F;&#x2F; a: </span><br><span class=\"line\">    ModeExclusive                                  &#x2F;&#x2F; l: </span><br><span class=\"line\">    ModeTemporary                                  &#x2F;&#x2F; T: </span><br><span class=\"line\">    ModeSymlink                                    &#x2F;&#x2F; L: </span><br><span class=\"line\">    ModeDevice                                     &#x2F;&#x2F; D: </span><br><span class=\"line\">    ModeNamedPipe                                  &#x2F;&#x2F; p: (FIFO)</span><br><span class=\"line\">    ModeSocket                                     &#x2F;&#x2F; S: Unix </span><br><span class=\"line\">    ModeSetuid                                     &#x2F;&#x2F; u: setuid</span><br><span class=\"line\">    ModeSetgid                                     &#x2F;&#x2F; g: setgid</span><br><span class=\"line\">    ModeCharDevice                                 &#x2F;&#x2F; c: Unix </span><br><span class=\"line\">    ModeSticky                                     &#x2F;&#x2F; t: sticky</span><br><span class=\"line\">    ModeIrregular                                  &#x2F;&#x2F; ?: </span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F; ,, none</span><br><span class=\"line\">    ModeType &#x3D; ModeDir | ModeSymlink | ModeNamedPipe | ModeSocket | ModeDevice | ModeCharDevice | ModeIrregular</span><br><span class=\"line\"></span><br><span class=\"line\">    ModePerm FileMode &#x3D; 0777 &#x2F;&#x2F; Unix </span><br><span class=\"line\">)</span><br><span class=\"line\">const (</span><br><span class=\"line\">    &#x2F;&#x2F;  O_RDONLY, O_WRONLY, O_RDWR </span><br><span class=\"line\">    O_RDONLY int &#x3D; syscall.O_RDONLY &#x2F;&#x2F; </span><br><span class=\"line\">    O_WRONLY int &#x3D; syscall.O_WRONLY &#x2F;&#x2F; </span><br><span class=\"line\">    O_RDWR   int &#x3D; syscall.O_RDWR   &#x2F;&#x2F; </span><br><span class=\"line\">    &#x2F;&#x2F; </span><br><span class=\"line\">    O_APPEND int &#x3D; syscall.O_APPEND &#x2F;&#x2F; </span><br><span class=\"line\">    O_CREATE int &#x3D; syscall.O_CREAT  &#x2F;&#x2F; </span><br><span class=\"line\">    O_EXCL   int &#x3D; syscall.O_EXCL   &#x2F;&#x2F;  O_CREATE ,</span><br><span class=\"line\">    O_SYNC   int &#x3D; syscall.O_SYNC   &#x2F;&#x2F;  I&#x2F;O </span><br><span class=\"line\">    O_TRUNC  int &#x3D; syscall.O_TRUNC  &#x2F;&#x2F; </span><br><span class=\"line\">)</span><br><span class=\"line\">const (</span><br><span class=\"line\">    SEEK_SET int &#x3D; 0 &#x2F;&#x2F; ,, io.SeekStart</span><br><span class=\"line\">    SEEK_CUR int &#x3D; 1 &#x2F;&#x2F; ,, io.SeekCurrent</span><br><span class=\"line\">    SEEK_END int &#x3D; 2 &#x2F;&#x2F; ,, io.SeekEnd</span><br><span class=\"line\">)</span><br><span class=\"line\">const (</span><br><span class=\"line\">    PathSeparator     &#x3D; &#39;&#x2F;&#39; &#x2F;&#x2F; Unix </span><br><span class=\"line\">    PathListSeparator &#x3D; &#39;:&#39; &#x2F;&#x2F; Unix </span><br><span class=\"line\">)</span><br><span class=\"line\">const (</span><br><span class=\"line\">    PathSeparator     &#x3D; &#39;\\\\&#39; &#x2F;&#x2F; Windows </span><br><span class=\"line\">    PathListSeparator &#x3D; &#39;;&#39; &#x2F;&#x2F; Windows </span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">var (</span><br><span class=\"line\">    Stdin  &#x3D; NewFile(uintptr(syscall.Stdin), &quot;&#x2F;dev&#x2F;stdin&quot;)</span><br><span class=\"line\">    Stdout &#x3D; NewFile(uintptr(syscall.Stdout), &quot;&#x2F;dev&#x2F;stdout&quot;)</span><br><span class=\"line\">    Stderr &#x3D; NewFile(uintptr(syscall.Stderr), &quot;&#x2F;dev&#x2F;stderr&quot;)</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"os-\"><a href=\"#os-\" class=\"headerlink\" title=\"os \"></a><code>os</code> </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Hostname</span><span class=\"params\">()</span> <span class=\"params\">(name <span class=\"keyword\">string</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , \"key=value\"</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Environ</span><span class=\"params\">()</span> []<span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getenv</span><span class=\"params\">(key <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span>  </span><br><span class=\"line\"><span class=\"comment\">// (),</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Setenv</span><span class=\"params\">(key, value <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Clearenv</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,, defer </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Exit</span><span class=\"params\">(code <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getuid</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // <span class=\"title\">ID</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getgid</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // <span class=\"title\">ID</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getpid</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // <span class=\"title\">ID</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getppid</span><span class=\"params\">()</span> <span class=\"title\">int</span>  // <span class=\"title\">ID</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  FileInfo </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Stat</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(fi FileInfo, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  0666 ,. O_RDWR  IO </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Create</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(file *File, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// . O_RDONLY </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Open</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(file *File, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  flag,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">OpenFile</span><span class=\"params\">(name <span class=\"keyword\">string</span>, flag <span class=\"keyword\">int</span>, perm FileMode)</span> <span class=\"params\">(file *File, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsExist</span><span class=\"params\">(err error)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsExist</span><span class=\"params\">(err error)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsPermission</span><span class=\"params\">(err error)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// . $GOPATH/src</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Getwd</span><span class=\"params\">()</span> <span class=\"params\">(dir <span class=\"keyword\">string</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Chdir</span><span class=\"params\">(dir <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Chmod</span><span class=\"params\">(name <span class=\"keyword\">string</span>, mode FileMode)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Chown</span><span class=\"params\">(name <span class=\"keyword\">string</span>, uid, gid <span class=\"keyword\">int</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Chtimes</span><span class=\"params\">(name <span class=\"keyword\">string</span>, atime time.Time, mtime time.Time)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Mkdir</span><span class=\"params\">(name <span class=\"keyword\">string</span>, perm FileMode)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .,..</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">MkdirAll</span><span class=\"params\">(path <span class=\"keyword\">string</span>, perm FileMode)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Rename</span><span class=\"params\">(oldpath, newpath <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Remove</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  path </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">RemoveAll</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  newname  oldname .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Symlink</span><span class=\"params\">(oldname, newname <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"comment\">// windows  C:\\Users\\&lt;Username&gt;\\AppData\\Local\\Temp, linux  /tmp</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TempDir</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"File-\"><a href=\"#File-\" class=\"headerlink\" title=\"File \"></a><code>File</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Name</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  FileInfo </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Stat</span><span class=\"params\">()</span> <span class=\"params\">(fi FileInfo, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// Unix</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Fd</span><span class=\"params\">()</span> <span class=\"title\">uintptr</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Chmod</span><span class=\"params\">(mode FileMode)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Chown</span><span class=\"params\">(uid, gid <span class=\"keyword\">int</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  size ,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Truncate</span><span class=\"params\">(size <span class=\"keyword\">int64</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  len(b)  b.. 0 err  io.EOF</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Read</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// len(b)b</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">ReadAt</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// len(b),, n!=len(b), nil </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Write</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , Write</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">WriteString</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(ret <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , Write</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">WriteAt</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// /,().</span></span><br><span class=\"line\"><span class=\"comment\">// offset ,whence : 0,1,2</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Seek</span><span class=\"params\">(offset <span class=\"keyword\">int64</span>, whence <span class=\"keyword\">int</span>)</span> <span class=\"params\">(ret <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Sync</span><span class=\"params\">()</span> <span class=\"params\">(err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *File)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    file, err := os.OpenFile(<span class=\"string\">\"filename\"</span>, os.O_RDWR|os.O_CREATE|os.O_SYNC|os.O_APPEND, <span class=\"number\">0</span>)  <span class=\"comment\">//  ,, , </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"err\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> file.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> bytes = []<span class=\"keyword\">byte</span>&#123;<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'c'</span>, <span class=\"string\">'d'</span>, <span class=\"string\">'\\n'</span>&#125;</span><br><span class=\"line\">    file.Write(bytes)  <span class=\"comment\">//  []bete </span></span><br><span class=\"line\">    str := <span class=\"string\">\"this is string to write\\n\"</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> strBytes = []<span class=\"keyword\">byte</span>(str)</span><br><span class=\"line\">    file.Write(strBytes)</span><br><span class=\"line\">    file.WriteString(str)  <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">// file.Sync() //  OpenFile  os.O_TRUNC ,,</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    buffer := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    file.Seek(<span class=\"number\">0</span>, <span class=\"number\">0</span>)  <span class=\"comment\">// ,,. ,</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">len</span>, err := file.Read(buffer)  <span class=\"comment\">//  buffer </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span> == <span class=\"number\">0</span> &amp;&amp; err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Print(<span class=\"keyword\">string</span>(buffer[:<span class=\"built_in\">len</span>]))  <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>os</code> , <code><a href=\"/2020/05/01/go-study-notes-package-time/\" title=\"bufio\">bufio</a></code> </p>\n"},{"title":"go  sort ","abbrlink":16328,"description":" Go sort ,,.sort ","_content":"\n`sort` , 3 : ,. `sort` .. `sort` .\n\n `sort` ,, `sort.Interface` .:\n\n```go\ntype Interface interface {\n    // \n    Len() int\n    // , i   j \n    Less(i, j int) bool\n    //  i  j  \n    Swap(i, j int)\n}\n```\n\n# \n\n```go\n// sort  sort.Interface \ntype Float64Slice []float64\ntype IntSlice []int\ntype StringSlice []string\n\ntype Interface interface {\n    Len() int\n    Less(i, j int) bool\n    Swap(i, j int)\n}\n```\n\n# \n\n```go\n// ,,\nfunc Float64s(a []float64)\nfunc Ints(a []int)\nfunc Strings(a []string)\n\n// ,,\nfunc Float64sAreSorted(a []float64) bool\nfunc IntsAreSorted(a []int) bool\nfunc StringsAreSorted(a []string) bool\n\n//  sort.Interface \nfunc IsSorted(data Interface) bool\n\n//  [0, n)  f(i)  true .\n// (: >=)(: <=)\nfunc Search(n int, f func(int) bool) int\n\n//  x,,; x  a ,x \nfunc SearchFloat64s(a []float64, x float64) int\nfunc SearchInts(a []int, x int) int\nfunc SearchStrings(a []string, x string) int\n\n//  less  slice . SliceStable .\n//  slice , panics\nfunc Slice(slice interface{}, less func(i, j int) bool)\nfunc SliceStable(slice interface{}, less func(i, j int) bool)\n//  less \nfunc SliceIsSorted(slice interface{}, less func(i, j int) bool) bool\n\n//  sort.Interface  . Stable \nfunc Sort(data Interface)\nfunc Stable(data Interface)\n// , sort.Sort(sort.Reverse(data)) \nfunc Reverse(data Interface) Interface\n```\n\n# \n\n## \n\n###  `sort.Sort`  `sort.Slice` \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\ntype Person struct {\n\tName string\n\tAge  int\n}\n\nfunc (p Person) String() string {\n\treturn fmt.Sprintf(\"%s: %d\", p.Name, p.Age)\n}\n\n//  sort.Interface , []Person \ntype ByAge []Person\n\nfunc (a ByAge) Len() int           { return len(a) }\nfunc (a ByAge) Swap(i, j int)      { a[i], a[j] = a[j], a[i] }\n//  Person  Age ,\nfunc (a ByAge) Less(i, j int) bool { return a[i].Age < a[j].Age }\n\nfunc main() {\n\tpeople := []Person{\n\t\t{\"Bob\", 31},\n\t\t{\"John\", 42},\n\t\t{\"Michael\", 17},\n\t\t{\"Jenny\", 26},\n\t}\n\tfmt.Println(people)\n\n\t//  sort.Sort \n\tsort.Sort(ByAge(people))\n\tfmt.Println(people)\n\n\t//  sort.Slice  less \n\tsort.Slice(people, func(i, j int) bool {\n\t\treturn people[i].Age > people[j].Age\n\t})\n\tfmt.Println(people)\n}\n```\n\n### \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\ntype Person struct {\n\tName  string\n\tAge   int\n\tScore float64\n}\n\nfunc (p Person) String() string {\n\treturn fmt.Sprintf(\"%s: %d, %.2f\", p.Name, p.Age, p.Score)\n}\n\n//  \"less\" , Person \ntype By func(p1, p2 *Person) bool\n\n// , people  personSorter ,\nfunc (by By) Sort(people []Person) {\n\tps := &personSorter{\n\t\tpeople: people,\n\t\tby:     by, //  by () personSorter ,\n\t}\n\tsort.Sort(ps)\n}\n\n// personSorter \ntype personSorter struct {\n\tpeople []Person\n\tby     func(p1, p2 *Person) bool // Closure used in the Less method.\n}\n\nfunc (s *personSorter) Len() int      { return len(s.people) }\nfunc (s *personSorter) Swap(i, j int) { s.people[i], s.people[j] = s.people[j], s.people[i] }\n// Less  by (by ),\nfunc (s *personSorter) Less(i, j int) bool {\n\treturn s.by(&s.people[i], &s.people[j])\n}\n\nfunc main() {\n\tpeople := []Person{\n\t\t{\"Bob\", 31, 83.5},\n\t\t{\"John\", 42, 86.0},\n\t\t{\"Michael\", 17, 79.6},\n\t\t{\"Jenny\", 26, 89.3},\n\t}\n\t// , Person ,\n\tname := func(p1, p2 *Person) bool {\n\t\treturn p1.Name < p2.Name\n\t}\n\tage := func(p1, p2 *Person) bool {\n\t\treturn p1.Age < p2.Age\n\t}\n\tscore := func(p1, p2 *Person) bool {\n\t\treturn p1.Score < p2.Score\n\t}\n\t//  score , p1,p2 ,\n\tdecreasingScore := func(p1, p2 *Person) bool {\n\t\treturn score(p2, p1)\n\t}\n\n\t// \n\tBy(name).Sort(people)\n\tfmt.Println(\"By Name:\", people)\n\tBy(age).Sort(people)\n\tfmt.Println(\"By Age:\", people)\n\tBy(score).Sort(people)\n\tfmt.Println(\"By Score:\", people)\n\tBy(decreasingScore).Sort(people)\n\tfmt.Println(\"By decreasing Score:\", people)\n}\n```\n\n### \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\n// \ntype Change struct {\n\tuser     string\n\tlanguage string\n\tlines    int\n}\n\n//  \"less\" ,\ntype lessFunc func(p1, p2 *Change) bool\n\n// multiSorter  sort.Interface , changes \ntype multiSorter struct {\n\tchanges []Change\n\tless    []lessFunc\n}\n\nfunc (ms *multiSorter) Len() int      { return len(ms.changes) }\nfunc (ms *multiSorter) Swap(i, j int) { ms.changes[i], ms.changes[j] = ms.changes[j], ms.changes[i] }\n\n//  Less \nfunc (ms *multiSorter) Less(i, j int) bool {\n\tp, q := &ms.changes[i], &ms.changes[j]\n\t//  ms  less ,\n\tvar k int\n\tfor k = 0; k < len(ms.less)-1; k++ {\n\t\tless := ms.less[k]\n\t\tswitch {\n\t\tcase less(p, q):\n\t\t\t// p < q, so we have a decision.\n\t\t\treturn true\n\t\tcase less(q, p):\n\t\t\t// p > q, so we have a decision.\n\t\t\treturn false\n\t\t}\n\t\t// p == q; \n\t}\n\t// ,, k = len(ms.less)-1,\n\treturn ms.less[k](p, q)\n}\n\n// , changes \nfunc (ms *multiSorter) Sort(changes []Change) {\n\tms.changes = changes\n\tsort.Sort(ms)\n}\n\n//  multiSorter  Sort \n//  Sort , less \nfunc OrderedBy(less ...lessFunc) *multiSorter {\n\treturn &multiSorter{\n\t\tless: less,\n\t}\n}\n\nvar changes = []Change{\n\t{\"gri\", \"Go\", 100},\n\t{\"ken\", \"C\", 150},\n\t{\"glenda\", \"Go\", 200},\n\t{\"rsc\", \"Go\", 200},\n\t{\"r\", \"Go\", 100},\n\t{\"ken\", \"Go\", 200},\n\t{\"dmr\", \"C\", 100},\n\t{\"r\", \"C\", 150},\n\t{\"gri\", \"Smalltalk\", 80},\n}\n\nfunc main() {\n\n\t// \n\tuser := func(c1, c2 *Change) bool { return c1.user < c2.user }\n\tlanguage := func(c1, c2 *Change) bool { return c1.language < c2.language }\n\tincreasingLines := func(c1, c2 *Change) bool { return c1.lines < c2.lines }\n\tdecreasingLines := func(c1, c2 *Change) bool { return increasingLines(c2, c1) }\n\n\tOrderedBy(user).Sort(changes)\n\tfmt.Println(\"By user:\", changes)\n\t// \n\tOrderedBy(user, increasingLines).Sort(changes)\n\tfmt.Println(\"By user,<lines:\", changes)\n\tOrderedBy(user, decreasingLines).Sort(changes)\n\tfmt.Println(\"By user,>lines:\", changes)\n\tOrderedBy(language, increasingLines).Sort(changes)\n\tfmt.Println(\"By language,<lines:\", changes)\n\tOrderedBy(language, increasingLines, user).Sort(changes)\n\tfmt.Println(\"By language,<lines,user:\", changes)\n}\n```\n\n### \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\ntype Grams int\n\nfunc (g Grams) String() string { return fmt.Sprintf(\"%dg\", int(g)) }\n\ntype Organ struct {\n\tName   string\n\tWeight Grams\n}\n\ntype Organs []*Organ\n\nfunc (s Organs) Len() int      { return len(s) }\nfunc (s Organs) Swap(i, j int) { s[i], s[j] = s[j], s[i] }\n\n//  Organs  Less , Interface \ntype ByName struct{ Organs }\n\nfunc (s ByName) Less(i, j int) bool { return s.Organs[i].Name < s.Organs[j].Name }\n\n//  Organs  Less , Interface \ntype ByWeight struct{ Organs }\n\nfunc (s ByWeight) Less(i, j int) bool { return s.Organs[i].Weight < s.Organs[j].Weight }\n\nfunc main() {\n\ts := []*Organ{\n\t\t{\"brain\", 1340},\n\t\t{\"heart\", 290},\n\t\t{\"liver\", 1494},\n\t\t{\"pancreas\", 131},\n\t\t{\"prostate\", 62},\n\t\t{\"spleen\", 162},\n\t}\n\tsort.Sort(ByWeight{s})\n\tfmt.Println(\"Organs by weight:\")\n\tprintOrgans(s)\n\tsort.Sort(ByName{s})\n\tfmt.Println(\"Organs by name:\")\n\tprintOrgans(s)\n}\n\nfunc printOrgans(s []*Organ) {\n\tfor _, o := range s {\n\t\tfmt.Printf(\"%-8s (%v)\\n\", o.Name, o.Weight)\n\t}\n}\n```\n\n##  `sort.Search` \n\n- \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\nfunc main() {\n\ta := []int{1, 3, 6, 10, 15, 21, 28, 36, 45, 55}\n\tx := 6\n\n\ti := sort.Search(len(a), func(i int) bool { return a[i] >= x })\n\tif i < len(a) && a[i] == x {\n\t\tfmt.Printf(\"found %d at index %d in %v\\n\", x, i, a)\n\t} else {\n\t\tfmt.Printf(\"%d not found in %v\\n\", x, a)\n\t}\n}\n```\n\n- \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\nfunc main() {\n\ta := []int{55, 45, 36, 28, 21, 15, 10, 6, 3, 1}\n\tx := 6\n\n\ti := sort.Search(len(a), func(i int) bool { return a[i] <= x })\n\tif i < len(a) && a[i] == x {\n\t\tfmt.Printf(\"found %d at index %d in %v\\n\", x, i, a)\n\t} else {\n\t\tfmt.Printf(\"%d not found in %v\\n\", x, a)\n\t}\n}\n```\n","source":"_posts/go-study-notes-package-sort.md","raw":"---\ntitle: go  sort \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 16328\ndescription: ' Go sort ,,.sort '\n---\n\n`sort` , 3 : ,. `sort` .. `sort` .\n\n `sort` ,, `sort.Interface` .:\n\n```go\ntype Interface interface {\n    // \n    Len() int\n    // , i   j \n    Less(i, j int) bool\n    //  i  j  \n    Swap(i, j int)\n}\n```\n\n# \n\n```go\n// sort  sort.Interface \ntype Float64Slice []float64\ntype IntSlice []int\ntype StringSlice []string\n\ntype Interface interface {\n    Len() int\n    Less(i, j int) bool\n    Swap(i, j int)\n}\n```\n\n# \n\n```go\n// ,,\nfunc Float64s(a []float64)\nfunc Ints(a []int)\nfunc Strings(a []string)\n\n// ,,\nfunc Float64sAreSorted(a []float64) bool\nfunc IntsAreSorted(a []int) bool\nfunc StringsAreSorted(a []string) bool\n\n//  sort.Interface \nfunc IsSorted(data Interface) bool\n\n//  [0, n)  f(i)  true .\n// (: >=)(: <=)\nfunc Search(n int, f func(int) bool) int\n\n//  x,,; x  a ,x \nfunc SearchFloat64s(a []float64, x float64) int\nfunc SearchInts(a []int, x int) int\nfunc SearchStrings(a []string, x string) int\n\n//  less  slice . SliceStable .\n//  slice , panics\nfunc Slice(slice interface{}, less func(i, j int) bool)\nfunc SliceStable(slice interface{}, less func(i, j int) bool)\n//  less \nfunc SliceIsSorted(slice interface{}, less func(i, j int) bool) bool\n\n//  sort.Interface  . Stable \nfunc Sort(data Interface)\nfunc Stable(data Interface)\n// , sort.Sort(sort.Reverse(data)) \nfunc Reverse(data Interface) Interface\n```\n\n# \n\n## \n\n###  `sort.Sort`  `sort.Slice` \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\ntype Person struct {\n\tName string\n\tAge  int\n}\n\nfunc (p Person) String() string {\n\treturn fmt.Sprintf(\"%s: %d\", p.Name, p.Age)\n}\n\n//  sort.Interface , []Person \ntype ByAge []Person\n\nfunc (a ByAge) Len() int           { return len(a) }\nfunc (a ByAge) Swap(i, j int)      { a[i], a[j] = a[j], a[i] }\n//  Person  Age ,\nfunc (a ByAge) Less(i, j int) bool { return a[i].Age < a[j].Age }\n\nfunc main() {\n\tpeople := []Person{\n\t\t{\"Bob\", 31},\n\t\t{\"John\", 42},\n\t\t{\"Michael\", 17},\n\t\t{\"Jenny\", 26},\n\t}\n\tfmt.Println(people)\n\n\t//  sort.Sort \n\tsort.Sort(ByAge(people))\n\tfmt.Println(people)\n\n\t//  sort.Slice  less \n\tsort.Slice(people, func(i, j int) bool {\n\t\treturn people[i].Age > people[j].Age\n\t})\n\tfmt.Println(people)\n}\n```\n\n### \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\ntype Person struct {\n\tName  string\n\tAge   int\n\tScore float64\n}\n\nfunc (p Person) String() string {\n\treturn fmt.Sprintf(\"%s: %d, %.2f\", p.Name, p.Age, p.Score)\n}\n\n//  \"less\" , Person \ntype By func(p1, p2 *Person) bool\n\n// , people  personSorter ,\nfunc (by By) Sort(people []Person) {\n\tps := &personSorter{\n\t\tpeople: people,\n\t\tby:     by, //  by () personSorter ,\n\t}\n\tsort.Sort(ps)\n}\n\n// personSorter \ntype personSorter struct {\n\tpeople []Person\n\tby     func(p1, p2 *Person) bool // Closure used in the Less method.\n}\n\nfunc (s *personSorter) Len() int      { return len(s.people) }\nfunc (s *personSorter) Swap(i, j int) { s.people[i], s.people[j] = s.people[j], s.people[i] }\n// Less  by (by ),\nfunc (s *personSorter) Less(i, j int) bool {\n\treturn s.by(&s.people[i], &s.people[j])\n}\n\nfunc main() {\n\tpeople := []Person{\n\t\t{\"Bob\", 31, 83.5},\n\t\t{\"John\", 42, 86.0},\n\t\t{\"Michael\", 17, 79.6},\n\t\t{\"Jenny\", 26, 89.3},\n\t}\n\t// , Person ,\n\tname := func(p1, p2 *Person) bool {\n\t\treturn p1.Name < p2.Name\n\t}\n\tage := func(p1, p2 *Person) bool {\n\t\treturn p1.Age < p2.Age\n\t}\n\tscore := func(p1, p2 *Person) bool {\n\t\treturn p1.Score < p2.Score\n\t}\n\t//  score , p1,p2 ,\n\tdecreasingScore := func(p1, p2 *Person) bool {\n\t\treturn score(p2, p1)\n\t}\n\n\t// \n\tBy(name).Sort(people)\n\tfmt.Println(\"By Name:\", people)\n\tBy(age).Sort(people)\n\tfmt.Println(\"By Age:\", people)\n\tBy(score).Sort(people)\n\tfmt.Println(\"By Score:\", people)\n\tBy(decreasingScore).Sort(people)\n\tfmt.Println(\"By decreasing Score:\", people)\n}\n```\n\n### \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\n// \ntype Change struct {\n\tuser     string\n\tlanguage string\n\tlines    int\n}\n\n//  \"less\" ,\ntype lessFunc func(p1, p2 *Change) bool\n\n// multiSorter  sort.Interface , changes \ntype multiSorter struct {\n\tchanges []Change\n\tless    []lessFunc\n}\n\nfunc (ms *multiSorter) Len() int      { return len(ms.changes) }\nfunc (ms *multiSorter) Swap(i, j int) { ms.changes[i], ms.changes[j] = ms.changes[j], ms.changes[i] }\n\n//  Less \nfunc (ms *multiSorter) Less(i, j int) bool {\n\tp, q := &ms.changes[i], &ms.changes[j]\n\t//  ms  less ,\n\tvar k int\n\tfor k = 0; k < len(ms.less)-1; k++ {\n\t\tless := ms.less[k]\n\t\tswitch {\n\t\tcase less(p, q):\n\t\t\t// p < q, so we have a decision.\n\t\t\treturn true\n\t\tcase less(q, p):\n\t\t\t// p > q, so we have a decision.\n\t\t\treturn false\n\t\t}\n\t\t// p == q; \n\t}\n\t// ,, k = len(ms.less)-1,\n\treturn ms.less[k](p, q)\n}\n\n// , changes \nfunc (ms *multiSorter) Sort(changes []Change) {\n\tms.changes = changes\n\tsort.Sort(ms)\n}\n\n//  multiSorter  Sort \n//  Sort , less \nfunc OrderedBy(less ...lessFunc) *multiSorter {\n\treturn &multiSorter{\n\t\tless: less,\n\t}\n}\n\nvar changes = []Change{\n\t{\"gri\", \"Go\", 100},\n\t{\"ken\", \"C\", 150},\n\t{\"glenda\", \"Go\", 200},\n\t{\"rsc\", \"Go\", 200},\n\t{\"r\", \"Go\", 100},\n\t{\"ken\", \"Go\", 200},\n\t{\"dmr\", \"C\", 100},\n\t{\"r\", \"C\", 150},\n\t{\"gri\", \"Smalltalk\", 80},\n}\n\nfunc main() {\n\n\t// \n\tuser := func(c1, c2 *Change) bool { return c1.user < c2.user }\n\tlanguage := func(c1, c2 *Change) bool { return c1.language < c2.language }\n\tincreasingLines := func(c1, c2 *Change) bool { return c1.lines < c2.lines }\n\tdecreasingLines := func(c1, c2 *Change) bool { return increasingLines(c2, c1) }\n\n\tOrderedBy(user).Sort(changes)\n\tfmt.Println(\"By user:\", changes)\n\t// \n\tOrderedBy(user, increasingLines).Sort(changes)\n\tfmt.Println(\"By user,<lines:\", changes)\n\tOrderedBy(user, decreasingLines).Sort(changes)\n\tfmt.Println(\"By user,>lines:\", changes)\n\tOrderedBy(language, increasingLines).Sort(changes)\n\tfmt.Println(\"By language,<lines:\", changes)\n\tOrderedBy(language, increasingLines, user).Sort(changes)\n\tfmt.Println(\"By language,<lines,user:\", changes)\n}\n```\n\n### \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\ntype Grams int\n\nfunc (g Grams) String() string { return fmt.Sprintf(\"%dg\", int(g)) }\n\ntype Organ struct {\n\tName   string\n\tWeight Grams\n}\n\ntype Organs []*Organ\n\nfunc (s Organs) Len() int      { return len(s) }\nfunc (s Organs) Swap(i, j int) { s[i], s[j] = s[j], s[i] }\n\n//  Organs  Less , Interface \ntype ByName struct{ Organs }\n\nfunc (s ByName) Less(i, j int) bool { return s.Organs[i].Name < s.Organs[j].Name }\n\n//  Organs  Less , Interface \ntype ByWeight struct{ Organs }\n\nfunc (s ByWeight) Less(i, j int) bool { return s.Organs[i].Weight < s.Organs[j].Weight }\n\nfunc main() {\n\ts := []*Organ{\n\t\t{\"brain\", 1340},\n\t\t{\"heart\", 290},\n\t\t{\"liver\", 1494},\n\t\t{\"pancreas\", 131},\n\t\t{\"prostate\", 62},\n\t\t{\"spleen\", 162},\n\t}\n\tsort.Sort(ByWeight{s})\n\tfmt.Println(\"Organs by weight:\")\n\tprintOrgans(s)\n\tsort.Sort(ByName{s})\n\tfmt.Println(\"Organs by name:\")\n\tprintOrgans(s)\n}\n\nfunc printOrgans(s []*Organ) {\n\tfor _, o := range s {\n\t\tfmt.Printf(\"%-8s (%v)\\n\", o.Name, o.Weight)\n\t}\n}\n```\n\n##  `sort.Search` \n\n- \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\nfunc main() {\n\ta := []int{1, 3, 6, 10, 15, 21, 28, 36, 45, 55}\n\tx := 6\n\n\ti := sort.Search(len(a), func(i int) bool { return a[i] >= x })\n\tif i < len(a) && a[i] == x {\n\t\tfmt.Printf(\"found %d at index %d in %v\\n\", x, i, a)\n\t} else {\n\t\tfmt.Printf(\"%d not found in %v\\n\", x, a)\n\t}\n}\n```\n\n- \n\n```go\nimport (\n\t\"fmt\"\n\t\"sort\"\n)\n\nfunc main() {\n\ta := []int{55, 45, 36, 28, 21, 15, 10, 6, 3, 1}\n\tx := 6\n\n\ti := sort.Search(len(a), func(i int) bool { return a[i] <= x })\n\tif i < len(a) && a[i] == x {\n\t\tfmt.Printf(\"found %d at index %d in %v\\n\", x, i, a)\n\t} else {\n\t\tfmt.Printf(\"%d not found in %v\\n\", x, a)\n\t}\n}\n```\n","slug":"go-study-notes-package-sort","published":1,"date":"2020-05-16T02:05:06.415Z","updated":"2020-05-17T03:56:59.122Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvl001mk8u7eh56b50t","content":"<p><code>sort</code> , 3 : ,. <code>sort</code> .. <code>sort</code> .</p>\n<p> <code>sort</code> ,, <code>sort.Interface</code> .:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Interface <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Len() <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"comment\">// , i   j </span></span><br><span class=\"line\">    Less(i, j <span class=\"keyword\">int</span>) <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">//  i  j  </span></span><br><span class=\"line\">    Swap(i, j <span class=\"keyword\">int</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// sort  sort.Interface </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Float64Slice []<span class=\"keyword\">float64</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> IntSlice []<span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> StringSlice []<span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Interface <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Len() <span class=\"keyword\">int</span></span><br><span class=\"line\">    Less(i, j <span class=\"keyword\">int</span>) <span class=\"keyword\">bool</span></span><br><span class=\"line\">    Swap(i, j <span class=\"keyword\">int</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Float64s</span><span class=\"params\">(a []<span class=\"keyword\">float64</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Ints</span><span class=\"params\">(a []<span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Strings</span><span class=\"params\">(a []<span class=\"keyword\">string</span>)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Float64sAreSorted</span><span class=\"params\">(a []<span class=\"keyword\">float64</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IntsAreSorted</span><span class=\"params\">(a []<span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">StringsAreSorted</span><span class=\"params\">(a []<span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  sort.Interface </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsSorted</span><span class=\"params\">(data Interface)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  [0, n)  f(i)  true .</span></span><br><span class=\"line\"><span class=\"comment\">// (: &gt;=)(: &lt;=)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Search</span><span class=\"params\">(n <span class=\"keyword\">int</span>, f <span class=\"keyword\">func</span>(<span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span>) <span class=\"title\">int</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  x,,; x  a ,x </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SearchFloat64s</span><span class=\"params\">(a []<span class=\"keyword\">float64</span>, x <span class=\"keyword\">float64</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SearchInts</span><span class=\"params\">(a []<span class=\"keyword\">int</span>, x <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SearchStrings</span><span class=\"params\">(a []<span class=\"keyword\">string</span>, x <span class=\"keyword\">string</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  less  slice . SliceStable .</span></span><br><span class=\"line\"><span class=\"comment\">//  slice , panics</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Slice</span><span class=\"params\">(slice <span class=\"keyword\">interface</span>&#123;&#125;, less <span class=\"keyword\">func</span>(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span>)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SliceStable</span><span class=\"params\">(slice <span class=\"keyword\">interface</span>&#123;&#125;, less <span class=\"keyword\">func</span>(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span>)</span></span><br><span class=\"line\"><span class=\"comment\">//  less </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SliceIsSorted</span><span class=\"params\">(slice <span class=\"keyword\">interface</span>&#123;&#125;, less <span class=\"keyword\">func</span>(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span>) <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  sort.Interface  . Stable </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sort</span><span class=\"params\">(data Interface)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Stable</span><span class=\"params\">(data Interface)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , sort.Sort(sort.Reverse(data)) </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Reverse</span><span class=\"params\">(data Interface)</span> <span class=\"title\">Interface</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-sort-Sort--sort-Slice-\"><a href=\"#-sort-Sort--sort-Slice-\" class=\"headerlink\" title=\" sort.Sort  sort.Slice \"></a> <code>sort.Sort</code>  <code>sort.Slice</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Person <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge  <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p Person)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> fmt.Sprintf(<span class=\"string\">\"%s: %d\"</span>, p.Name, p.Age)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  sort.Interface , []Person </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByAge []Person</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(a ByAge)</span> <span class=\"title\">Len</span><span class=\"params\">()</span> <span class=\"title\">int</span></span>           &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(a) &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(a ByAge)</span> <span class=\"title\">Swap</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span></span>      &#123; a[i], a[j] = a[j], a[i] &#125;</span><br><span class=\"line\"><span class=\"comment\">//  Person  Age ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(a ByAge)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> a[i].Age &lt; a[j].Age &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tpeople := []Person&#123;</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Bob\"</span>, <span class=\"number\">31</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"John\"</span>, <span class=\"number\">42</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Michael\"</span>, <span class=\"number\">17</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Jenny\"</span>, <span class=\"number\">26</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Println(people)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//  sort.Sort </span></span><br><span class=\"line\">\tsort.Sort(ByAge(people))</span><br><span class=\"line\">\tfmt.Println(people)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//  sort.Slice  less </span></span><br><span class=\"line\">\tsort.Slice(people, <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> people[i].Age &gt; people[j].Age</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">\tfmt.Println(people)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Person <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span></span><br><span class=\"line\">\tScore <span class=\"keyword\">float64</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p Person)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> fmt.Sprintf(<span class=\"string\">\"%s: %d, %.2f\"</span>, p.Name, p.Age, p.Score)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  \"less\" , Person </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> By <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// , people  personSorter ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(by By)</span> <span class=\"title\">Sort</span><span class=\"params\">(people []Person)</span></span> &#123;</span><br><span class=\"line\">\tps := &amp;personSorter&#123;</span><br><span class=\"line\">\t\tpeople: people,</span><br><span class=\"line\">\t\tby:     by, <span class=\"comment\">//  by () personSorter ,</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tsort.Sort(ps)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// personSorter </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> personSorter <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tpeople []Person</span><br><span class=\"line\">\tby     <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span> // <span class=\"title\">Closure</span> <span class=\"title\">used</span> <span class=\"title\">in</span> <span class=\"title\">the</span> <span class=\"title\">Less</span> <span class=\"title\">method</span>.</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *personSorter)</span> <span class=\"title\">Len</span><span class=\"params\">()</span> <span class=\"title\">int</span></span>      &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(s.people) &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *personSorter)</span> <span class=\"title\">Swap</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span></span> &#123; s.people[i], s.people[j] = s.people[j], s.people[i] &#125;</span><br><span class=\"line\"><span class=\"comment\">// Less  by (by ),</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *personSorter)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> s.by(&amp;s.people[i], &amp;s.people[j])</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tpeople := []Person&#123;</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Bob\"</span>, <span class=\"number\">31</span>, <span class=\"number\">83.5</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"John\"</span>, <span class=\"number\">42</span>, <span class=\"number\">86.0</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Michael\"</span>, <span class=\"number\">17</span>, <span class=\"number\">79.6</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Jenny\"</span>, <span class=\"number\">26</span>, <span class=\"number\">89.3</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// , Person ,</span></span><br><span class=\"line\">\tname := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> p1.Name &lt; p2.Name</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tage := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> p1.Age &lt; p2.Age</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tscore := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> p1.Score &lt; p2.Score</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//  score , p1,p2 ,</span></span><br><span class=\"line\">\tdecreasingScore := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> score(p2, p1)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// </span></span><br><span class=\"line\">\tBy(name).Sort(people)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By Name:\"</span>, people)</span><br><span class=\"line\">\tBy(age).Sort(people)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By Age:\"</span>, people)</span><br><span class=\"line\">\tBy(score).Sort(people)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By Score:\"</span>, people)</span><br><span class=\"line\">\tBy(decreasingScore).Sort(people)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By decreasing Score:\"</span>, people)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Change <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tuser     <span class=\"keyword\">string</span></span><br><span class=\"line\">\tlanguage <span class=\"keyword\">string</span></span><br><span class=\"line\">\tlines    <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  \"less\" ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> lessFunc <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Change)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// multiSorter  sort.Interface , changes </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> multiSorter <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tchanges []Change</span><br><span class=\"line\">\tless    []lessFunc</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ms *multiSorter)</span> <span class=\"title\">Len</span><span class=\"params\">()</span> <span class=\"title\">int</span></span>      &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(ms.changes) &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ms *multiSorter)</span> <span class=\"title\">Swap</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span></span> &#123; ms.changes[i], ms.changes[j] = ms.changes[j], ms.changes[i] &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Less </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ms *multiSorter)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\tp, q := &amp;ms.changes[i], &amp;ms.changes[j]</span><br><span class=\"line\">\t<span class=\"comment\">//  ms  less ,</span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> k <span class=\"keyword\">int</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> k = <span class=\"number\">0</span>; k &lt; <span class=\"built_in\">len</span>(ms.less)<span class=\"number\">-1</span>; k++ &#123;</span><br><span class=\"line\">\t\tless := ms.less[k]</span><br><span class=\"line\">\t\t<span class=\"keyword\">switch</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> less(p, q):</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// p &lt; q, so we have a decision.</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> less(q, p):</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// p &gt; q, so we have a decision.</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">// p == q; </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// ,, k = len(ms.less)-1,</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> ms.less[k](p, q)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// , changes </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ms *multiSorter)</span> <span class=\"title\">Sort</span><span class=\"params\">(changes []Change)</span></span> &#123;</span><br><span class=\"line\">\tms.changes = changes</span><br><span class=\"line\">\tsort.Sort(ms)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  multiSorter  Sort </span></span><br><span class=\"line\"><span class=\"comment\">//  Sort , less </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">OrderedBy</span><span class=\"params\">(less ...lessFunc)</span> *<span class=\"title\">multiSorter</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &amp;multiSorter&#123;</span><br><span class=\"line\">\t\tless: less,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> changes = []Change&#123;</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"gri\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">100</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"ken\"</span>, <span class=\"string\">\"C\"</span>, <span class=\"number\">150</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"glenda\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">200</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"rsc\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">200</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"r\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">100</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"ken\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">200</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"dmr\"</span>, <span class=\"string\">\"C\"</span>, <span class=\"number\">100</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"r\"</span>, <span class=\"string\">\"C\"</span>, <span class=\"number\">150</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"gri\"</span>, <span class=\"string\">\"Smalltalk\"</span>, <span class=\"number\">80</span>&#125;,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// </span></span><br><span class=\"line\">\tuser := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(c1, c2 *Change)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> c1.user &lt; c2.user &#125;</span><br><span class=\"line\">\tlanguage := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(c1, c2 *Change)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> c1.language &lt; c2.language &#125;</span><br><span class=\"line\">\tincreasingLines := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(c1, c2 *Change)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> c1.lines &lt; c2.lines &#125;</span><br><span class=\"line\">\tdecreasingLines := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(c1, c2 *Change)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> increasingLines(c2, c1) &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tOrderedBy(user).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By user:\"</span>, changes)</span><br><span class=\"line\">\t<span class=\"comment\">// </span></span><br><span class=\"line\">\tOrderedBy(user, increasingLines).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By user,&lt;lines:\"</span>, changes)</span><br><span class=\"line\">\tOrderedBy(user, decreasingLines).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By user,&gt;lines:\"</span>, changes)</span><br><span class=\"line\">\tOrderedBy(language, increasingLines).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By language,&lt;lines:\"</span>, changes)</span><br><span class=\"line\">\tOrderedBy(language, increasingLines, user).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By language,&lt;lines,user:\"</span>, changes)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Grams <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(g Grams)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123; <span class=\"keyword\">return</span> fmt.Sprintf(<span class=\"string\">\"%dg\"</span>, <span class=\"keyword\">int</span>(g)) &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Organ <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName   <span class=\"keyword\">string</span></span><br><span class=\"line\">\tWeight Grams</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Organs []*Organ</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s Organs)</span> <span class=\"title\">Len</span><span class=\"params\">()</span> <span class=\"title\">int</span></span>      &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(s) &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s Organs)</span> <span class=\"title\">Swap</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span></span> &#123; s[i], s[j] = s[j], s[i] &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Organs  Less , Interface </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByName <span class=\"keyword\">struct</span>&#123; Organs &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s ByName)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> s.Organs[i].Name &lt; s.Organs[j].Name &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Organs  Less , Interface </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByWeight <span class=\"keyword\">struct</span>&#123; Organs &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s ByWeight)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> s.Organs[i].Weight &lt; s.Organs[j].Weight &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ts := []*Organ&#123;</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"brain\"</span>, <span class=\"number\">1340</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"heart\"</span>, <span class=\"number\">290</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"liver\"</span>, <span class=\"number\">1494</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"pancreas\"</span>, <span class=\"number\">131</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"prostate\"</span>, <span class=\"number\">62</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"spleen\"</span>, <span class=\"number\">162</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tsort.Sort(ByWeight&#123;s&#125;)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"Organs by weight:\"</span>)</span><br><span class=\"line\">\tprintOrgans(s)</span><br><span class=\"line\">\tsort.Sort(ByName&#123;s&#125;)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"Organs by name:\"</span>)</span><br><span class=\"line\">\tprintOrgans(s)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">printOrgans</span><span class=\"params\">(s []*Organ)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, o := <span class=\"keyword\">range</span> s &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%-8s (%v)\\n\"</span>, o.Name, o.Weight)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-sort-Search-\"><a href=\"#-sort-Search-\" class=\"headerlink\" title=\" sort.Search \"></a> <code>sort.Search</code> </h2><ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ta := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">6</span>, <span class=\"number\">10</span>, <span class=\"number\">15</span>, <span class=\"number\">21</span>, <span class=\"number\">28</span>, <span class=\"number\">36</span>, <span class=\"number\">45</span>, <span class=\"number\">55</span>&#125;</span><br><span class=\"line\">\tx := <span class=\"number\">6</span></span><br><span class=\"line\"></span><br><span class=\"line\">\ti := sort.Search(<span class=\"built_in\">len</span>(a), <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> a[i] &gt;= x &#125;)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> i &lt; <span class=\"built_in\">len</span>(a) &amp;&amp; a[i] == x &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"found %d at index %d in %v\\n\"</span>, x, i, a)</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%d not found in %v\\n\"</span>, x, a)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ta := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">55</span>, <span class=\"number\">45</span>, <span class=\"number\">36</span>, <span class=\"number\">28</span>, <span class=\"number\">21</span>, <span class=\"number\">15</span>, <span class=\"number\">10</span>, <span class=\"number\">6</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>&#125;</span><br><span class=\"line\">\tx := <span class=\"number\">6</span></span><br><span class=\"line\"></span><br><span class=\"line\">\ti := sort.Search(<span class=\"built_in\">len</span>(a), <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> a[i] &lt;= x &#125;)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> i &lt; <span class=\"built_in\">len</span>(a) &amp;&amp; a[i] == x &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"found %d at index %d in %v\\n\"</span>, x, i, a)</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%d not found in %v\\n\"</span>, x, a)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><code>sort</code> , 3 : ,. <code>sort</code> .. <code>sort</code> .</p>\n<p> <code>sort</code> ,, <code>sort.Interface</code> .:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Interface <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Len() <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"comment\">// , i   j </span></span><br><span class=\"line\">    Less(i, j <span class=\"keyword\">int</span>) <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">//  i  j  </span></span><br><span class=\"line\">    Swap(i, j <span class=\"keyword\">int</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// sort  sort.Interface </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Float64Slice []<span class=\"keyword\">float64</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> IntSlice []<span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> StringSlice []<span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Interface <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Len() <span class=\"keyword\">int</span></span><br><span class=\"line\">    Less(i, j <span class=\"keyword\">int</span>) <span class=\"keyword\">bool</span></span><br><span class=\"line\">    Swap(i, j <span class=\"keyword\">int</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Float64s</span><span class=\"params\">(a []<span class=\"keyword\">float64</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Ints</span><span class=\"params\">(a []<span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Strings</span><span class=\"params\">(a []<span class=\"keyword\">string</span>)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Float64sAreSorted</span><span class=\"params\">(a []<span class=\"keyword\">float64</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IntsAreSorted</span><span class=\"params\">(a []<span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">StringsAreSorted</span><span class=\"params\">(a []<span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  sort.Interface </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsSorted</span><span class=\"params\">(data Interface)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  [0, n)  f(i)  true .</span></span><br><span class=\"line\"><span class=\"comment\">// (: &gt;=)(: &lt;=)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Search</span><span class=\"params\">(n <span class=\"keyword\">int</span>, f <span class=\"keyword\">func</span>(<span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span>) <span class=\"title\">int</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  x,,; x  a ,x </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SearchFloat64s</span><span class=\"params\">(a []<span class=\"keyword\">float64</span>, x <span class=\"keyword\">float64</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SearchInts</span><span class=\"params\">(a []<span class=\"keyword\">int</span>, x <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SearchStrings</span><span class=\"params\">(a []<span class=\"keyword\">string</span>, x <span class=\"keyword\">string</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  less  slice . SliceStable .</span></span><br><span class=\"line\"><span class=\"comment\">//  slice , panics</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Slice</span><span class=\"params\">(slice <span class=\"keyword\">interface</span>&#123;&#125;, less <span class=\"keyword\">func</span>(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span>)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SliceStable</span><span class=\"params\">(slice <span class=\"keyword\">interface</span>&#123;&#125;, less <span class=\"keyword\">func</span>(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span>)</span></span><br><span class=\"line\"><span class=\"comment\">//  less </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SliceIsSorted</span><span class=\"params\">(slice <span class=\"keyword\">interface</span>&#123;&#125;, less <span class=\"keyword\">func</span>(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span>) <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  sort.Interface  . Stable </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sort</span><span class=\"params\">(data Interface)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Stable</span><span class=\"params\">(data Interface)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , sort.Sort(sort.Reverse(data)) </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Reverse</span><span class=\"params\">(data Interface)</span> <span class=\"title\">Interface</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-sort-Sort--sort-Slice-\"><a href=\"#-sort-Sort--sort-Slice-\" class=\"headerlink\" title=\" sort.Sort  sort.Slice \"></a> <code>sort.Sort</code>  <code>sort.Slice</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Person <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge  <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p Person)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> fmt.Sprintf(<span class=\"string\">\"%s: %d\"</span>, p.Name, p.Age)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  sort.Interface , []Person </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByAge []Person</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(a ByAge)</span> <span class=\"title\">Len</span><span class=\"params\">()</span> <span class=\"title\">int</span></span>           &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(a) &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(a ByAge)</span> <span class=\"title\">Swap</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span></span>      &#123; a[i], a[j] = a[j], a[i] &#125;</span><br><span class=\"line\"><span class=\"comment\">//  Person  Age ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(a ByAge)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> a[i].Age &lt; a[j].Age &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tpeople := []Person&#123;</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Bob\"</span>, <span class=\"number\">31</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"John\"</span>, <span class=\"number\">42</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Michael\"</span>, <span class=\"number\">17</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Jenny\"</span>, <span class=\"number\">26</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Println(people)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//  sort.Sort </span></span><br><span class=\"line\">\tsort.Sort(ByAge(people))</span><br><span class=\"line\">\tfmt.Println(people)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//  sort.Slice  less </span></span><br><span class=\"line\">\tsort.Slice(people, <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> people[i].Age &gt; people[j].Age</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">\tfmt.Println(people)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Person <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span></span><br><span class=\"line\">\tScore <span class=\"keyword\">float64</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p Person)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> fmt.Sprintf(<span class=\"string\">\"%s: %d, %.2f\"</span>, p.Name, p.Age, p.Score)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  \"less\" , Person </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> By <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// , people  personSorter ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(by By)</span> <span class=\"title\">Sort</span><span class=\"params\">(people []Person)</span></span> &#123;</span><br><span class=\"line\">\tps := &amp;personSorter&#123;</span><br><span class=\"line\">\t\tpeople: people,</span><br><span class=\"line\">\t\tby:     by, <span class=\"comment\">//  by () personSorter ,</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tsort.Sort(ps)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// personSorter </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> personSorter <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tpeople []Person</span><br><span class=\"line\">\tby     <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span> // <span class=\"title\">Closure</span> <span class=\"title\">used</span> <span class=\"title\">in</span> <span class=\"title\">the</span> <span class=\"title\">Less</span> <span class=\"title\">method</span>.</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *personSorter)</span> <span class=\"title\">Len</span><span class=\"params\">()</span> <span class=\"title\">int</span></span>      &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(s.people) &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *personSorter)</span> <span class=\"title\">Swap</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span></span> &#123; s.people[i], s.people[j] = s.people[j], s.people[i] &#125;</span><br><span class=\"line\"><span class=\"comment\">// Less  by (by ),</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *personSorter)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> s.by(&amp;s.people[i], &amp;s.people[j])</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tpeople := []Person&#123;</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Bob\"</span>, <span class=\"number\">31</span>, <span class=\"number\">83.5</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"John\"</span>, <span class=\"number\">42</span>, <span class=\"number\">86.0</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Michael\"</span>, <span class=\"number\">17</span>, <span class=\"number\">79.6</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"Jenny\"</span>, <span class=\"number\">26</span>, <span class=\"number\">89.3</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// , Person ,</span></span><br><span class=\"line\">\tname := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> p1.Name &lt; p2.Name</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tage := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> p1.Age &lt; p2.Age</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tscore := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> p1.Score &lt; p2.Score</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//  score , p1,p2 ,</span></span><br><span class=\"line\">\tdecreasingScore := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Person)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> score(p2, p1)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// </span></span><br><span class=\"line\">\tBy(name).Sort(people)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By Name:\"</span>, people)</span><br><span class=\"line\">\tBy(age).Sort(people)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By Age:\"</span>, people)</span><br><span class=\"line\">\tBy(score).Sort(people)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By Score:\"</span>, people)</span><br><span class=\"line\">\tBy(decreasingScore).Sort(people)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By decreasing Score:\"</span>, people)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Change <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tuser     <span class=\"keyword\">string</span></span><br><span class=\"line\">\tlanguage <span class=\"keyword\">string</span></span><br><span class=\"line\">\tlines    <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  \"less\" ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> lessFunc <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(p1, p2 *Change)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// multiSorter  sort.Interface , changes </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> multiSorter <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tchanges []Change</span><br><span class=\"line\">\tless    []lessFunc</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ms *multiSorter)</span> <span class=\"title\">Len</span><span class=\"params\">()</span> <span class=\"title\">int</span></span>      &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(ms.changes) &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ms *multiSorter)</span> <span class=\"title\">Swap</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span></span> &#123; ms.changes[i], ms.changes[j] = ms.changes[j], ms.changes[i] &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Less </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ms *multiSorter)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\tp, q := &amp;ms.changes[i], &amp;ms.changes[j]</span><br><span class=\"line\">\t<span class=\"comment\">//  ms  less ,</span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> k <span class=\"keyword\">int</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> k = <span class=\"number\">0</span>; k &lt; <span class=\"built_in\">len</span>(ms.less)<span class=\"number\">-1</span>; k++ &#123;</span><br><span class=\"line\">\t\tless := ms.less[k]</span><br><span class=\"line\">\t\t<span class=\"keyword\">switch</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> less(p, q):</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// p &lt; q, so we have a decision.</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> less(q, p):</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// p &gt; q, so we have a decision.</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">// p == q; </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// ,, k = len(ms.less)-1,</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> ms.less[k](p, q)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// , changes </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ms *multiSorter)</span> <span class=\"title\">Sort</span><span class=\"params\">(changes []Change)</span></span> &#123;</span><br><span class=\"line\">\tms.changes = changes</span><br><span class=\"line\">\tsort.Sort(ms)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  multiSorter  Sort </span></span><br><span class=\"line\"><span class=\"comment\">//  Sort , less </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">OrderedBy</span><span class=\"params\">(less ...lessFunc)</span> *<span class=\"title\">multiSorter</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &amp;multiSorter&#123;</span><br><span class=\"line\">\t\tless: less,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> changes = []Change&#123;</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"gri\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">100</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"ken\"</span>, <span class=\"string\">\"C\"</span>, <span class=\"number\">150</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"glenda\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">200</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"rsc\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">200</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"r\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">100</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"ken\"</span>, <span class=\"string\">\"Go\"</span>, <span class=\"number\">200</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"dmr\"</span>, <span class=\"string\">\"C\"</span>, <span class=\"number\">100</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"r\"</span>, <span class=\"string\">\"C\"</span>, <span class=\"number\">150</span>&#125;,</span><br><span class=\"line\">\t&#123;<span class=\"string\">\"gri\"</span>, <span class=\"string\">\"Smalltalk\"</span>, <span class=\"number\">80</span>&#125;,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// </span></span><br><span class=\"line\">\tuser := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(c1, c2 *Change)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> c1.user &lt; c2.user &#125;</span><br><span class=\"line\">\tlanguage := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(c1, c2 *Change)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> c1.language &lt; c2.language &#125;</span><br><span class=\"line\">\tincreasingLines := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(c1, c2 *Change)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> c1.lines &lt; c2.lines &#125;</span><br><span class=\"line\">\tdecreasingLines := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(c1, c2 *Change)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> increasingLines(c2, c1) &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tOrderedBy(user).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By user:\"</span>, changes)</span><br><span class=\"line\">\t<span class=\"comment\">// </span></span><br><span class=\"line\">\tOrderedBy(user, increasingLines).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By user,&lt;lines:\"</span>, changes)</span><br><span class=\"line\">\tOrderedBy(user, decreasingLines).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By user,&gt;lines:\"</span>, changes)</span><br><span class=\"line\">\tOrderedBy(language, increasingLines).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By language,&lt;lines:\"</span>, changes)</span><br><span class=\"line\">\tOrderedBy(language, increasingLines, user).Sort(changes)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"By language,&lt;lines,user:\"</span>, changes)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Grams <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(g Grams)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123; <span class=\"keyword\">return</span> fmt.Sprintf(<span class=\"string\">\"%dg\"</span>, <span class=\"keyword\">int</span>(g)) &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Organ <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName   <span class=\"keyword\">string</span></span><br><span class=\"line\">\tWeight Grams</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Organs []*Organ</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s Organs)</span> <span class=\"title\">Len</span><span class=\"params\">()</span> <span class=\"title\">int</span></span>      &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(s) &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s Organs)</span> <span class=\"title\">Swap</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span></span> &#123; s[i], s[j] = s[j], s[i] &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Organs  Less , Interface </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByName <span class=\"keyword\">struct</span>&#123; Organs &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s ByName)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> s.Organs[i].Name &lt; s.Organs[j].Name &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Organs  Less , Interface </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ByWeight <span class=\"keyword\">struct</span>&#123; Organs &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s ByWeight)</span> <span class=\"title\">Less</span><span class=\"params\">(i, j <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> s.Organs[i].Weight &lt; s.Organs[j].Weight &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ts := []*Organ&#123;</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"brain\"</span>, <span class=\"number\">1340</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"heart\"</span>, <span class=\"number\">290</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"liver\"</span>, <span class=\"number\">1494</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"pancreas\"</span>, <span class=\"number\">131</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"prostate\"</span>, <span class=\"number\">62</span>&#125;,</span><br><span class=\"line\">\t\t&#123;<span class=\"string\">\"spleen\"</span>, <span class=\"number\">162</span>&#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tsort.Sort(ByWeight&#123;s&#125;)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"Organs by weight:\"</span>)</span><br><span class=\"line\">\tprintOrgans(s)</span><br><span class=\"line\">\tsort.Sort(ByName&#123;s&#125;)</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"Organs by name:\"</span>)</span><br><span class=\"line\">\tprintOrgans(s)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">printOrgans</span><span class=\"params\">(s []*Organ)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, o := <span class=\"keyword\">range</span> s &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%-8s (%v)\\n\"</span>, o.Name, o.Weight)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-sort-Search-\"><a href=\"#-sort-Search-\" class=\"headerlink\" title=\" sort.Search \"></a> <code>sort.Search</code> </h2><ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ta := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">6</span>, <span class=\"number\">10</span>, <span class=\"number\">15</span>, <span class=\"number\">21</span>, <span class=\"number\">28</span>, <span class=\"number\">36</span>, <span class=\"number\">45</span>, <span class=\"number\">55</span>&#125;</span><br><span class=\"line\">\tx := <span class=\"number\">6</span></span><br><span class=\"line\"></span><br><span class=\"line\">\ti := sort.Search(<span class=\"built_in\">len</span>(a), <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> a[i] &gt;= x &#125;)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> i &lt; <span class=\"built_in\">len</span>(a) &amp;&amp; a[i] == x &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"found %d at index %d in %v\\n\"</span>, x, i, a)</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%d not found in %v\\n\"</span>, x, a)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"sort\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\ta := []<span class=\"keyword\">int</span>&#123;<span class=\"number\">55</span>, <span class=\"number\">45</span>, <span class=\"number\">36</span>, <span class=\"number\">28</span>, <span class=\"number\">21</span>, <span class=\"number\">15</span>, <span class=\"number\">10</span>, <span class=\"number\">6</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>&#125;</span><br><span class=\"line\">\tx := <span class=\"number\">6</span></span><br><span class=\"line\"></span><br><span class=\"line\">\ti := sort.Search(<span class=\"built_in\">len</span>(a), <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span> <span class=\"title\">bool</span></span> &#123; <span class=\"keyword\">return</span> a[i] &lt;= x &#125;)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> i &lt; <span class=\"built_in\">len</span>(a) &amp;&amp; a[i] == x &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"found %d at index %d in %v\\n\"</span>, x, i, a)</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"%d not found in %v\\n\"</span>, x, a)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"go  sql ","abbrlink":6060,"description":" Go database/sql  driver .database/sql  SQL .driver sql .","_content":"\n`database/sql/driver`  `database/sql` \n`database/sql`  SQL . sql ., [https://github.com/golang/go/wiki/SQLDrivers](https://github.com/golang/go/wiki/SQLDrivers)\n\n mysql  mysql \n\n```go\nimport \"database/sql\"\nimport _ \"github.com/go-sql-driver/mysql\"\n\ndb, err := sql.Open(\"mysql\", \"user:password@/dbname\")\n```\n\n# \n\n```go\n// \ntype ColumnType struct {\n    // contains filtered or unexported fields\n}\n// ., DB \ntype Conn struct {\n    // contains filtered or unexported fields\n}\n// , goroutine .\ntype DB struct {\n    // contains filtered or unexported fields\n}\n\n// \ntype DBStats struct {\n    MaxOpenConnections int // \n\n    // \n    OpenConnections int // \n    InUse           int // \n    Idle            int // \n\n    // \n    //\n    WaitCount         int64         // \n    WaitDuration      time.Duration // \n    MaxIdleClosed     int64         //  SetMaxIdleConns \n    MaxLifetimeClosed int64         //  SetConnMaxLifetime \n}\n\n// \ntype Result interface {\n    // .\n    LastInsertId() (int64, error)\n    // ,.\n    RowsAffected() (int64, error)\n}\n// QueryRow \ntype Row struct {\n    // contains filtered or unexported fields\n}\n// ., `Next()` \ntype Rows struct {\n    // contains filtered or unexported fields\n}\n\n// . goroutine \ntype Stmt struct {\n    // contains filtered or unexported fields\n}\n\n// \ntype Tx struct {\n    // contains filtered or unexported fields\n}\n// ,\ntype TxOptions struct {\n    // \n    Isolation IsolationLevel\n    ReadOnly  bool\n}\n```\n\n# \n\n```go\n// \nconst (\n    LevelDefault IsolationLevel = iota\n    LevelReadUncommitted\n    LevelReadCommitted\n    LevelWriteCommitted\n    LevelRepeatableRead\n    LevelSnapshot\n    LevelSerializable\n    LevelLinearizable\n)\n```\n\n# \n\n## `sql` \n\n```go\n// \nfunc Drivers() []string\n// \nfunc Register(name string, driver driver.Driver)\n\n//  driverName  dataSourceName \n// ., Ping \n//  goroutine ,.\n// dataSourceName  `username:password@protocol(address)/dbname?param=value`\nfunc Open(driverName, dataSourceName string) (*DB, error)\n// ,\nfunc OpenDB(c driver.Connector) *DB\n```\n\n## `ColumnType` \n\n`ColumnType` ,\n\n```go\n// \nfunc (ci *ColumnType) DatabaseTypeName() string\n// \nfunc (ci *ColumnType) DecimalSize() (precision, scale int64, ok bool)\n// ( text  binary)\nfunc (ci *ColumnType) Length() (length int64, ok bool)\n// \nfunc (ci *ColumnType) Name() string\n// \nfunc (ci *ColumnType) Nullable() (nullable, ok bool)\n//  Rows.Scan  Go \nfunc (ci *ColumnType) ScanType() reflect.Type\n```\n## `DB` \n\n`DB` .\n\n```go\n// ,\nfunc (db *DB) Begin() (*Tx, error)\n// ,,.,\nfunc (db *DB) BeginTx(ctx context.Context, opts *TxOptions) (*Tx, error)\n// ,.\nfunc (db *DB) Close() error\n// . Conn , ctx. Conn.Close  Conn \n//  Conn .\nfunc (db *DB) Conn(ctx context.Context) (*Conn, error)\n// \nfunc (db *DB) Driver() driver.Driver\n//  query ,.args \nfunc (db *DB) ExecContext(ctx context.Context, query string, args ...interface{}) (Result, error)\n// ,\nfunc (db *DB) PingContext(ctx context.Context) error\n// .Stmt , Stmt , Stmt.Close \nfunc (db *DB) PrepareContext(ctx context.Context, query string) (*Stmt, error)\n// ,\nfunc (db *DB) QueryContext(ctx context.Context, query string, args ...interface{}) (*Rows, error)\n// ,\nfunc (db *DB) QueryRowContext(ctx context.Context, query string, args ...interface{}) *Row\n// \nfunc (db *DB) SetConnMaxLifetime(d time.Duration)\n// \nfunc (db *DB) SetMaxIdleConns(n int)\n// \nfunc (db *DB) SetMaxOpenConns(n int)\n// \nfunc (db *DB) Stats() DBStats\n```\n\n## `Rows` \n\n```go\n// ,,,.\nfunc (rs *Rows) ColumnTypes() ([]*ColumnType, error)\n// \nfunc (rs *Rows) Columns() ([]string, error)\n// , Scan ., ture. Scan ,\nfunc (rs *Rows) Next() bool\n// .\nfunc (rs *Rows) NextResultSet() bool\n//  dest . dest \"\".\nfunc (rs *Rows) Scan(dest ...interface{}) error\n```\n\n## `Stmt` \n\n```go\n// \nfunc (s *Stmt) Close() error\n// , Result \nfunc (s *Stmt) Exec(args ...interface{}) (Result, error)\nfunc (s *Stmt) ExecContext(ctx context.Context, args ...interface{}) (Result, error)\n// ,\nfunc (s *Stmt) Query(args ...interface{}) (*Rows, error)\nfunc (s *Stmt) QueryContext(ctx context.Context, args ...interface{}) (*Rows, error)\nfunc (s *Stmt) QueryRow(args ...interface{}) *Row\nfunc (s *Stmt) QueryRowContext(ctx context.Context, args ...interface{}) *Row\n```\n\n## `Tx` \n\n```go\n// \nfunc (tx *Tx) Commit() error\n// ,\nfunc (tx *Tx) Exec(query string, args ...interface{}) (Result, error)\nfunc (tx *Tx) ExecContext(ctx context.Context, query string, args ...interface{}) (Result, error)\n//  Stmt\nfunc (tx *Tx) Prepare(query string) (*Stmt, error)\nfunc (tx *Tx) PrepareContext(ctx context.Context, query string) (*Stmt, error)\n// \nfunc (tx *Tx) Query(query string, args ...interface{}) (*Rows, error)\nfunc (tx *Tx) QueryContext(ctx context.Context, query string, args ...interface{}) (*Rows, error)\nfunc (tx *Tx) QueryRow(query string, args ...interface{}) *Row\nfunc (tx *Tx) QueryRowContext(ctx context.Context, query string, args ...interface{}) *Row\n// \nfunc (tx *Tx) Rollback() error\n\n//  Stmt  Stmt\nfunc (tx *Tx) Stmt(stmt *Stmt) *Stmt\nfunc (tx *Tx) StmtContext(ctx context.Context, stmt *Stmt) *Stmt\n```\n\n# \n\n```go\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"github.com/go-sql-driver/mysql\"\n)\n\nfunc main() {\n    cfg := mysql.Config{\n        User:                 \"username\",\n        Passwd:               \"password\",\n        Net:                  \"tcp\",\n        Addr:                 \"10.71.1.27:3306\",\n        DBName:               \"datastream-info\",\n        AllowNativePasswords: true,\n    }\n    dataSourceName := cfg.FormatDSN() //  mysql  dataSourceName,\n    // dataSourceName := \"username:password@tcp(10.71.1.27:3306)/test\"\n    db, err := sql.Open(\"mysql\", dataSourceName)\n    rows, err := db.Query(\"select * from province_num\")\n    var (\n        id    int\n        name  string\n        value int\n    )\n    for rows.Next() {\n        if err = rows.Scan(&id, &name, &value); err != nil {\n            fmt.Println(err)\n        }\n        fmt.Println(id, name, value)\n    }\n}\n```","source":"_posts/go-study-notes-package-sql.md","raw":"---\ntitle: go  sql \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 6060\ndescription: ' Go database/sql  driver .database/sql  SQL .driver sql .'\n---\n\n`database/sql/driver`  `database/sql` \n`database/sql`  SQL . sql ., [https://github.com/golang/go/wiki/SQLDrivers](https://github.com/golang/go/wiki/SQLDrivers)\n\n mysql  mysql \n\n```go\nimport \"database/sql\"\nimport _ \"github.com/go-sql-driver/mysql\"\n\ndb, err := sql.Open(\"mysql\", \"user:password@/dbname\")\n```\n\n# \n\n```go\n// \ntype ColumnType struct {\n    // contains filtered or unexported fields\n}\n// ., DB \ntype Conn struct {\n    // contains filtered or unexported fields\n}\n// , goroutine .\ntype DB struct {\n    // contains filtered or unexported fields\n}\n\n// \ntype DBStats struct {\n    MaxOpenConnections int // \n\n    // \n    OpenConnections int // \n    InUse           int // \n    Idle            int // \n\n    // \n    //\n    WaitCount         int64         // \n    WaitDuration      time.Duration // \n    MaxIdleClosed     int64         //  SetMaxIdleConns \n    MaxLifetimeClosed int64         //  SetConnMaxLifetime \n}\n\n// \ntype Result interface {\n    // .\n    LastInsertId() (int64, error)\n    // ,.\n    RowsAffected() (int64, error)\n}\n// QueryRow \ntype Row struct {\n    // contains filtered or unexported fields\n}\n// ., `Next()` \ntype Rows struct {\n    // contains filtered or unexported fields\n}\n\n// . goroutine \ntype Stmt struct {\n    // contains filtered or unexported fields\n}\n\n// \ntype Tx struct {\n    // contains filtered or unexported fields\n}\n// ,\ntype TxOptions struct {\n    // \n    Isolation IsolationLevel\n    ReadOnly  bool\n}\n```\n\n# \n\n```go\n// \nconst (\n    LevelDefault IsolationLevel = iota\n    LevelReadUncommitted\n    LevelReadCommitted\n    LevelWriteCommitted\n    LevelRepeatableRead\n    LevelSnapshot\n    LevelSerializable\n    LevelLinearizable\n)\n```\n\n# \n\n## `sql` \n\n```go\n// \nfunc Drivers() []string\n// \nfunc Register(name string, driver driver.Driver)\n\n//  driverName  dataSourceName \n// ., Ping \n//  goroutine ,.\n// dataSourceName  `username:password@protocol(address)/dbname?param=value`\nfunc Open(driverName, dataSourceName string) (*DB, error)\n// ,\nfunc OpenDB(c driver.Connector) *DB\n```\n\n## `ColumnType` \n\n`ColumnType` ,\n\n```go\n// \nfunc (ci *ColumnType) DatabaseTypeName() string\n// \nfunc (ci *ColumnType) DecimalSize() (precision, scale int64, ok bool)\n// ( text  binary)\nfunc (ci *ColumnType) Length() (length int64, ok bool)\n// \nfunc (ci *ColumnType) Name() string\n// \nfunc (ci *ColumnType) Nullable() (nullable, ok bool)\n//  Rows.Scan  Go \nfunc (ci *ColumnType) ScanType() reflect.Type\n```\n## `DB` \n\n`DB` .\n\n```go\n// ,\nfunc (db *DB) Begin() (*Tx, error)\n// ,,.,\nfunc (db *DB) BeginTx(ctx context.Context, opts *TxOptions) (*Tx, error)\n// ,.\nfunc (db *DB) Close() error\n// . Conn , ctx. Conn.Close  Conn \n//  Conn .\nfunc (db *DB) Conn(ctx context.Context) (*Conn, error)\n// \nfunc (db *DB) Driver() driver.Driver\n//  query ,.args \nfunc (db *DB) ExecContext(ctx context.Context, query string, args ...interface{}) (Result, error)\n// ,\nfunc (db *DB) PingContext(ctx context.Context) error\n// .Stmt , Stmt , Stmt.Close \nfunc (db *DB) PrepareContext(ctx context.Context, query string) (*Stmt, error)\n// ,\nfunc (db *DB) QueryContext(ctx context.Context, query string, args ...interface{}) (*Rows, error)\n// ,\nfunc (db *DB) QueryRowContext(ctx context.Context, query string, args ...interface{}) *Row\n// \nfunc (db *DB) SetConnMaxLifetime(d time.Duration)\n// \nfunc (db *DB) SetMaxIdleConns(n int)\n// \nfunc (db *DB) SetMaxOpenConns(n int)\n// \nfunc (db *DB) Stats() DBStats\n```\n\n## `Rows` \n\n```go\n// ,,,.\nfunc (rs *Rows) ColumnTypes() ([]*ColumnType, error)\n// \nfunc (rs *Rows) Columns() ([]string, error)\n// , Scan ., ture. Scan ,\nfunc (rs *Rows) Next() bool\n// .\nfunc (rs *Rows) NextResultSet() bool\n//  dest . dest \"\".\nfunc (rs *Rows) Scan(dest ...interface{}) error\n```\n\n## `Stmt` \n\n```go\n// \nfunc (s *Stmt) Close() error\n// , Result \nfunc (s *Stmt) Exec(args ...interface{}) (Result, error)\nfunc (s *Stmt) ExecContext(ctx context.Context, args ...interface{}) (Result, error)\n// ,\nfunc (s *Stmt) Query(args ...interface{}) (*Rows, error)\nfunc (s *Stmt) QueryContext(ctx context.Context, args ...interface{}) (*Rows, error)\nfunc (s *Stmt) QueryRow(args ...interface{}) *Row\nfunc (s *Stmt) QueryRowContext(ctx context.Context, args ...interface{}) *Row\n```\n\n## `Tx` \n\n```go\n// \nfunc (tx *Tx) Commit() error\n// ,\nfunc (tx *Tx) Exec(query string, args ...interface{}) (Result, error)\nfunc (tx *Tx) ExecContext(ctx context.Context, query string, args ...interface{}) (Result, error)\n//  Stmt\nfunc (tx *Tx) Prepare(query string) (*Stmt, error)\nfunc (tx *Tx) PrepareContext(ctx context.Context, query string) (*Stmt, error)\n// \nfunc (tx *Tx) Query(query string, args ...interface{}) (*Rows, error)\nfunc (tx *Tx) QueryContext(ctx context.Context, query string, args ...interface{}) (*Rows, error)\nfunc (tx *Tx) QueryRow(query string, args ...interface{}) *Row\nfunc (tx *Tx) QueryRowContext(ctx context.Context, query string, args ...interface{}) *Row\n// \nfunc (tx *Tx) Rollback() error\n\n//  Stmt  Stmt\nfunc (tx *Tx) Stmt(stmt *Stmt) *Stmt\nfunc (tx *Tx) StmtContext(ctx context.Context, stmt *Stmt) *Stmt\n```\n\n# \n\n```go\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"github.com/go-sql-driver/mysql\"\n)\n\nfunc main() {\n    cfg := mysql.Config{\n        User:                 \"username\",\n        Passwd:               \"password\",\n        Net:                  \"tcp\",\n        Addr:                 \"10.71.1.27:3306\",\n        DBName:               \"datastream-info\",\n        AllowNativePasswords: true,\n    }\n    dataSourceName := cfg.FormatDSN() //  mysql  dataSourceName,\n    // dataSourceName := \"username:password@tcp(10.71.1.27:3306)/test\"\n    db, err := sql.Open(\"mysql\", dataSourceName)\n    rows, err := db.Query(\"select * from province_num\")\n    var (\n        id    int\n        name  string\n        value int\n    )\n    for rows.Next() {\n        if err = rows.Scan(&id, &name, &value); err != nil {\n            fmt.Println(err)\n        }\n        fmt.Println(id, name, value)\n    }\n}\n```","slug":"go-study-notes-package-sql","published":1,"date":"2020-05-06T15:42:08.353Z","updated":"2020-05-10T11:40:50.878Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvo001pk8u7hum9c4ix","content":"<p><code>database/sql/driver</code>  <code>database/sql</code> <br><code>database/sql</code>  SQL . sql ., <a href=\"https://github.com/golang/go/wiki/SQLDrivers\" target=\"_blank\" rel=\"noopener\">https://github.com/golang/go/wiki/SQLDrivers</a></p>\n<p> mysql  mysql </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"database/sql\"</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> _ <span class=\"string\">\"github.com/go-sql-driver/mysql\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">db, err := sql.Open(<span class=\"string\">\"mysql\"</span>, <span class=\"string\">\"user:password@/dbname\"</span>)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ColumnType <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ., DB </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Conn <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// , goroutine .</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> DB <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> DBStats <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    MaxOpenConnections <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    OpenConnections <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    InUse           <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    Idle            <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    WaitCount         <span class=\"keyword\">int64</span>         <span class=\"comment\">// </span></span><br><span class=\"line\">    WaitDuration      time.Duration <span class=\"comment\">// </span></span><br><span class=\"line\">    MaxIdleClosed     <span class=\"keyword\">int64</span>         <span class=\"comment\">//  SetMaxIdleConns </span></span><br><span class=\"line\">    MaxLifetimeClosed <span class=\"keyword\">int64</span>         <span class=\"comment\">//  SetConnMaxLifetime </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Result <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// .</span></span><br><span class=\"line\">    LastInsertId() (<span class=\"keyword\">int64</span>, error)</span><br><span class=\"line\">    <span class=\"comment\">// ,.</span></span><br><span class=\"line\">    RowsAffected() (<span class=\"keyword\">int64</span>, error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// QueryRow </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Row <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ., `Next()` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Rows <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// . goroutine </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Stmt <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Tx <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> TxOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Isolation IsolationLevel</span><br><span class=\"line\">    ReadOnly  <span class=\"keyword\">bool</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    LevelDefault IsolationLevel = <span class=\"literal\">iota</span></span><br><span class=\"line\">    LevelReadUncommitted</span><br><span class=\"line\">    LevelReadCommitted</span><br><span class=\"line\">    LevelWriteCommitted</span><br><span class=\"line\">    LevelRepeatableRead</span><br><span class=\"line\">    LevelSnapshot</span><br><span class=\"line\">    LevelSerializable</span><br><span class=\"line\">    LevelLinearizable</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"sql-\"><a href=\"#sql-\" class=\"headerlink\" title=\"sql \"></a><code>sql</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Drivers</span><span class=\"params\">()</span> []<span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Register</span><span class=\"params\">(name <span class=\"keyword\">string</span>, driver driver.Driver)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  driverName  dataSourceName </span></span><br><span class=\"line\"><span class=\"comment\">// ., Ping </span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine ,.</span></span><br><span class=\"line\"><span class=\"comment\">// dataSourceName  `username:password@protocol(address)/dbname?param=value`</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Open</span><span class=\"params\">(driverName, dataSourceName <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*DB, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">OpenDB</span><span class=\"params\">(c driver.Connector)</span> *<span class=\"title\">DB</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ColumnType-\"><a href=\"#ColumnType-\" class=\"headerlink\" title=\"ColumnType \"></a><code>ColumnType</code> </h2><p><code>ColumnType</code> ,</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">DatabaseTypeName</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">DecimalSize</span><span class=\"params\">()</span> <span class=\"params\">(precision, scale <span class=\"keyword\">int64</span>, ok <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ( text  binary)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">Length</span><span class=\"params\">()</span> <span class=\"params\">(length <span class=\"keyword\">int64</span>, ok <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">Name</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">Nullable</span><span class=\"params\">()</span> <span class=\"params\">(nullable, ok <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Rows.Scan  Go </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">ScanType</span><span class=\"params\">()</span> <span class=\"title\">reflect</span>.<span class=\"title\">Type</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"DB-\"><a href=\"#DB-\" class=\"headerlink\" title=\"DB \"></a><code>DB</code> </h2><p><code>DB</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Begin</span><span class=\"params\">()</span> <span class=\"params\">(*Tx, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,,.,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">BeginTx</span><span class=\"params\">(ctx context.Context, opts *TxOptions)</span> <span class=\"params\">(*Tx, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// . Conn , ctx. Conn.Close  Conn </span></span><br><span class=\"line\"><span class=\"comment\">//  Conn .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Conn</span><span class=\"params\">(ctx context.Context)</span> <span class=\"params\">(*Conn, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Driver</span><span class=\"params\">()</span> <span class=\"title\">driver</span>.<span class=\"title\">Driver</span></span></span><br><span class=\"line\"><span class=\"comment\">//  query ,.args </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">ExecContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">PingContext</span><span class=\"params\">(ctx context.Context)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .Stmt , Stmt , Stmt.Close </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">PrepareContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*Stmt, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">QueryContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">QueryRowContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">SetConnMaxLifetime</span><span class=\"params\">(d time.Duration)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">SetMaxIdleConns</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">SetMaxOpenConns</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Stats</span><span class=\"params\">()</span> <span class=\"title\">DBStats</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Rows-\"><a href=\"#Rows-\" class=\"headerlink\" title=\"Rows \"></a><code>Rows</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,,,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">ColumnTypes</span><span class=\"params\">()</span> <span class=\"params\">([]*ColumnType, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">Columns</span><span class=\"params\">()</span> <span class=\"params\">([]<span class=\"keyword\">string</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , Scan ., ture. Scan ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">Next</span><span class=\"params\">()</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">NextResultSet</span><span class=\"params\">()</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  dest . dest \"\".</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">Scan</span><span class=\"params\">(dest ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Stmt-\"><a href=\"#Stmt-\" class=\"headerlink\" title=\"Stmt \"></a><code>Stmt</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// , Result </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">Exec</span><span class=\"params\">(args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">ExecContext</span><span class=\"params\">(ctx context.Context, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">Query</span><span class=\"params\">(args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">QueryContext</span><span class=\"params\">(ctx context.Context, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">QueryRow</span><span class=\"params\">(args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">QueryRowContext</span><span class=\"params\">(ctx context.Context, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Tx-\"><a href=\"#Tx-\" class=\"headerlink\" title=\"Tx \"></a><code>Tx</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Commit</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Exec</span><span class=\"params\">(query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">ExecContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Stmt</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Prepare</span><span class=\"params\">(query <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*Stmt, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">PrepareContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*Stmt, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Query</span><span class=\"params\">(query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">QueryContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">QueryRow</span><span class=\"params\">(query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">QueryRowContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Rollback</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Stmt  Stmt</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Stmt</span><span class=\"params\">(stmt *Stmt)</span> *<span class=\"title\">Stmt</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">StmtContext</span><span class=\"params\">(ctx context.Context, stmt *Stmt)</span> *<span class=\"title\">Stmt</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"database/sql\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"github.com/go-sql-driver/mysql\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    cfg := mysql.Config&#123;</span><br><span class=\"line\">        User:                 <span class=\"string\">\"username\"</span>,</span><br><span class=\"line\">        Passwd:               <span class=\"string\">\"password\"</span>,</span><br><span class=\"line\">        Net:                  <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">        Addr:                 <span class=\"string\">\"10.71.1.27:3306\"</span>,</span><br><span class=\"line\">        DBName:               <span class=\"string\">\"datastream-info\"</span>,</span><br><span class=\"line\">        AllowNativePasswords: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    dataSourceName := cfg.FormatDSN() <span class=\"comment\">//  mysql  dataSourceName,</span></span><br><span class=\"line\">    <span class=\"comment\">// dataSourceName := \"username:password@tcp(10.71.1.27:3306)/test\"</span></span><br><span class=\"line\">    db, err := sql.Open(<span class=\"string\">\"mysql\"</span>, dataSourceName)</span><br><span class=\"line\">    rows, err := db.Query(<span class=\"string\">\"select * from province_num\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">var</span> (</span><br><span class=\"line\">        id    <span class=\"keyword\">int</span></span><br><span class=\"line\">        name  <span class=\"keyword\">string</span></span><br><span class=\"line\">        value <span class=\"keyword\">int</span></span><br><span class=\"line\">    )</span><br><span class=\"line\">    <span class=\"keyword\">for</span> rows.Next() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> err = rows.Scan(&amp;id, &amp;name, &amp;value); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            fmt.Println(err)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Println(id, name, value)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>database/sql/driver</code>  <code>database/sql</code> <br><code>database/sql</code>  SQL . sql ., <a href=\"https://github.com/golang/go/wiki/SQLDrivers\" target=\"_blank\" rel=\"noopener\">https://github.com/golang/go/wiki/SQLDrivers</a></p>\n<p> mysql  mysql </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"database/sql\"</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> _ <span class=\"string\">\"github.com/go-sql-driver/mysql\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">db, err := sql.Open(<span class=\"string\">\"mysql\"</span>, <span class=\"string\">\"user:password@/dbname\"</span>)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ColumnType <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ., DB </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Conn <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// , goroutine .</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> DB <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> DBStats <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    MaxOpenConnections <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    OpenConnections <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    InUse           <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\">    Idle            <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    WaitCount         <span class=\"keyword\">int64</span>         <span class=\"comment\">// </span></span><br><span class=\"line\">    WaitDuration      time.Duration <span class=\"comment\">// </span></span><br><span class=\"line\">    MaxIdleClosed     <span class=\"keyword\">int64</span>         <span class=\"comment\">//  SetMaxIdleConns </span></span><br><span class=\"line\">    MaxLifetimeClosed <span class=\"keyword\">int64</span>         <span class=\"comment\">//  SetConnMaxLifetime </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Result <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// .</span></span><br><span class=\"line\">    LastInsertId() (<span class=\"keyword\">int64</span>, error)</span><br><span class=\"line\">    <span class=\"comment\">// ,.</span></span><br><span class=\"line\">    RowsAffected() (<span class=\"keyword\">int64</span>, error)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// QueryRow </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Row <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ., `Next()` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Rows <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// . goroutine </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Stmt <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Tx <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> TxOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Isolation IsolationLevel</span><br><span class=\"line\">    ReadOnly  <span class=\"keyword\">bool</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    LevelDefault IsolationLevel = <span class=\"literal\">iota</span></span><br><span class=\"line\">    LevelReadUncommitted</span><br><span class=\"line\">    LevelReadCommitted</span><br><span class=\"line\">    LevelWriteCommitted</span><br><span class=\"line\">    LevelRepeatableRead</span><br><span class=\"line\">    LevelSnapshot</span><br><span class=\"line\">    LevelSerializable</span><br><span class=\"line\">    LevelLinearizable</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"sql-\"><a href=\"#sql-\" class=\"headerlink\" title=\"sql \"></a><code>sql</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Drivers</span><span class=\"params\">()</span> []<span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Register</span><span class=\"params\">(name <span class=\"keyword\">string</span>, driver driver.Driver)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  driverName  dataSourceName </span></span><br><span class=\"line\"><span class=\"comment\">// ., Ping </span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine ,.</span></span><br><span class=\"line\"><span class=\"comment\">// dataSourceName  `username:password@protocol(address)/dbname?param=value`</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Open</span><span class=\"params\">(driverName, dataSourceName <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*DB, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">OpenDB</span><span class=\"params\">(c driver.Connector)</span> *<span class=\"title\">DB</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ColumnType-\"><a href=\"#ColumnType-\" class=\"headerlink\" title=\"ColumnType \"></a><code>ColumnType</code> </h2><p><code>ColumnType</code> ,</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">DatabaseTypeName</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">DecimalSize</span><span class=\"params\">()</span> <span class=\"params\">(precision, scale <span class=\"keyword\">int64</span>, ok <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ( text  binary)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">Length</span><span class=\"params\">()</span> <span class=\"params\">(length <span class=\"keyword\">int64</span>, ok <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">Name</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">Nullable</span><span class=\"params\">()</span> <span class=\"params\">(nullable, ok <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Rows.Scan  Go </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(ci *ColumnType)</span> <span class=\"title\">ScanType</span><span class=\"params\">()</span> <span class=\"title\">reflect</span>.<span class=\"title\">Type</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"DB-\"><a href=\"#DB-\" class=\"headerlink\" title=\"DB \"></a><code>DB</code> </h2><p><code>DB</code> .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Begin</span><span class=\"params\">()</span> <span class=\"params\">(*Tx, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,,.,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">BeginTx</span><span class=\"params\">(ctx context.Context, opts *TxOptions)</span> <span class=\"params\">(*Tx, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// . Conn , ctx. Conn.Close  Conn </span></span><br><span class=\"line\"><span class=\"comment\">//  Conn .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Conn</span><span class=\"params\">(ctx context.Context)</span> <span class=\"params\">(*Conn, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Driver</span><span class=\"params\">()</span> <span class=\"title\">driver</span>.<span class=\"title\">Driver</span></span></span><br><span class=\"line\"><span class=\"comment\">//  query ,.args </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">ExecContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">PingContext</span><span class=\"params\">(ctx context.Context)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// .Stmt , Stmt , Stmt.Close </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">PrepareContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*Stmt, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">QueryContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">QueryRowContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">SetConnMaxLifetime</span><span class=\"params\">(d time.Duration)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">SetMaxIdleConns</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">SetMaxOpenConns</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(db *DB)</span> <span class=\"title\">Stats</span><span class=\"params\">()</span> <span class=\"title\">DBStats</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Rows-\"><a href=\"#Rows-\" class=\"headerlink\" title=\"Rows \"></a><code>Rows</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,,,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">ColumnTypes</span><span class=\"params\">()</span> <span class=\"params\">([]*ColumnType, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">Columns</span><span class=\"params\">()</span> <span class=\"params\">([]<span class=\"keyword\">string</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , Scan ., ture. Scan ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">Next</span><span class=\"params\">()</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">NextResultSet</span><span class=\"params\">()</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  dest . dest \"\".</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(rs *Rows)</span> <span class=\"title\">Scan</span><span class=\"params\">(dest ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Stmt-\"><a href=\"#Stmt-\" class=\"headerlink\" title=\"Stmt \"></a><code>Stmt</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// , Result </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">Exec</span><span class=\"params\">(args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">ExecContext</span><span class=\"params\">(ctx context.Context, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">Query</span><span class=\"params\">(args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">QueryContext</span><span class=\"params\">(ctx context.Context, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">QueryRow</span><span class=\"params\">(args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stmt)</span> <span class=\"title\">QueryRowContext</span><span class=\"params\">(ctx context.Context, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Tx-\"><a href=\"#Tx-\" class=\"headerlink\" title=\"Tx \"></a><code>Tx</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Commit</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Exec</span><span class=\"params\">(query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">ExecContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(Result, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Stmt</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Prepare</span><span class=\"params\">(query <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*Stmt, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">PrepareContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>)</span> <span class=\"params\">(*Stmt, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Query</span><span class=\"params\">(query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">QueryContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(*Rows, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">QueryRow</span><span class=\"params\">(query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">QueryRowContext</span><span class=\"params\">(ctx context.Context, query <span class=\"keyword\">string</span>, args ...<span class=\"keyword\">interface</span>&#123;&#125;)</span> *<span class=\"title\">Row</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Rollback</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Stmt  Stmt</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">Stmt</span><span class=\"params\">(stmt *Stmt)</span> *<span class=\"title\">Stmt</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(tx *Tx)</span> <span class=\"title\">StmtContext</span><span class=\"params\">(ctx context.Context, stmt *Stmt)</span> *<span class=\"title\">Stmt</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"database/sql\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"github.com/go-sql-driver/mysql\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    cfg := mysql.Config&#123;</span><br><span class=\"line\">        User:                 <span class=\"string\">\"username\"</span>,</span><br><span class=\"line\">        Passwd:               <span class=\"string\">\"password\"</span>,</span><br><span class=\"line\">        Net:                  <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">        Addr:                 <span class=\"string\">\"10.71.1.27:3306\"</span>,</span><br><span class=\"line\">        DBName:               <span class=\"string\">\"datastream-info\"</span>,</span><br><span class=\"line\">        AllowNativePasswords: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    dataSourceName := cfg.FormatDSN() <span class=\"comment\">//  mysql  dataSourceName,</span></span><br><span class=\"line\">    <span class=\"comment\">// dataSourceName := \"username:password@tcp(10.71.1.27:3306)/test\"</span></span><br><span class=\"line\">    db, err := sql.Open(<span class=\"string\">\"mysql\"</span>, dataSourceName)</span><br><span class=\"line\">    rows, err := db.Query(<span class=\"string\">\"select * from province_num\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">var</span> (</span><br><span class=\"line\">        id    <span class=\"keyword\">int</span></span><br><span class=\"line\">        name  <span class=\"keyword\">string</span></span><br><span class=\"line\">        value <span class=\"keyword\">int</span></span><br><span class=\"line\">    )</span><br><span class=\"line\">    <span class=\"keyword\">for</span> rows.Next() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> err = rows.Scan(&amp;id, &amp;name, &amp;value); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            fmt.Println(err)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Println(id, name, value)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go  strings ","abbrlink":33042,"description":" Go strings .","_content":"\n`strings` . `import \"strings\"`\n\n# \n\n```go\n// , `io.Reader`,`io.Seeker`,`io.ReaderAt`,`io.WriterTo``io.ByteScanner`,`io.RuneScanner` \ntype Reader struct {\n    // \n}\n\n// \ntype Replacer struct {\n    // \n}\n```\n\n# \n\n# `strings` \n\n`strings` \n\n```go\n//  Reader . Reader \nfunc NewReader(s string) *Reader\n//  old,new  Replacer . Replacer \nfunc NewReplacer(oldnew ...string) *Replacer\n//  s  prefix \nfunc HasPrefix(s, prefix string) bool\n//  s  suffix \nfunc HasSuffix(s, suffix string) bool\n//  s  substr\nfunc Contains(s, substr string) bool\n//  s  chars \nfunc ContainsAny(s, chars string) bool\n//  s  sep \nfunc Count(s, sep string) int\n//  sep  s ,  -1\nfunc Index(s, sep string) int\n//  c  s , -1\nfunc IndexByte(s string, c byte) int\n//  sep  s ,  -1\nfunc LastIndex(s, chars string) int\n// s \nfunc Title(s string) string\n// \nfunc ToLower(s string) string\n// \nfunc ToUpper(s string) string\n//  count  s \nfunc Repeat(s string, count int) string\n//  s  n  old  new ,  n<0  old \nfunc Replace(s, old, new string, n int) string\n//  s  cutset \nfunc Trim(s string, cutset string) string\n//  s \nfunc TrimSpace(s string) string\n//  s  cutset \nfunc TrimLeft(s string, cutset string) string\n//  s  cutset \nfunc TrimRight(s string, cutset string) string\n//  sep  s ,\nfunc Split(s, sep string) []string\n// .n>0, s  n , , . n  0 ,  nil. n<0,\nfunc SplitN(s, sep string, n int) []string\n//  a , sep \nfunc Join(a []string, sep string) string\n```\n\n## `Reader` \n\n```go\n//  `io` \nfunc (r *Reader) Read(b []byte) (n int, err error)\nfunc (r *Reader) ReadByte() (b byte, err error)\nfunc (r *Reader) Seek(offset int64, whence int) (int64, error)\nfunc (r *Reader) ReadAt(b []byte, off int64) (n int, err error)\nfunc (r *Reader) WriteTo(w io.Writer) (n int64, err error)\n```\n\n## `Replacer` \n\n```go\n//  s \nfunc (r *Replacer) Replace(s string) string\n//  w  s \nfunc (r *Replacer) WriteString(w io.Writer, s string) (n int, err error)\n```","source":"_posts/go-study-notes-package-strings.md","raw":"---\ntitle: go  strings \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 33042\ndescription:  Go strings .\n---\n\n`strings` . `import \"strings\"`\n\n# \n\n```go\n// , `io.Reader`,`io.Seeker`,`io.ReaderAt`,`io.WriterTo``io.ByteScanner`,`io.RuneScanner` \ntype Reader struct {\n    // \n}\n\n// \ntype Replacer struct {\n    // \n}\n```\n\n# \n\n# `strings` \n\n`strings` \n\n```go\n//  Reader . Reader \nfunc NewReader(s string) *Reader\n//  old,new  Replacer . Replacer \nfunc NewReplacer(oldnew ...string) *Replacer\n//  s  prefix \nfunc HasPrefix(s, prefix string) bool\n//  s  suffix \nfunc HasSuffix(s, suffix string) bool\n//  s  substr\nfunc Contains(s, substr string) bool\n//  s  chars \nfunc ContainsAny(s, chars string) bool\n//  s  sep \nfunc Count(s, sep string) int\n//  sep  s ,  -1\nfunc Index(s, sep string) int\n//  c  s , -1\nfunc IndexByte(s string, c byte) int\n//  sep  s ,  -1\nfunc LastIndex(s, chars string) int\n// s \nfunc Title(s string) string\n// \nfunc ToLower(s string) string\n// \nfunc ToUpper(s string) string\n//  count  s \nfunc Repeat(s string, count int) string\n//  s  n  old  new ,  n<0  old \nfunc Replace(s, old, new string, n int) string\n//  s  cutset \nfunc Trim(s string, cutset string) string\n//  s \nfunc TrimSpace(s string) string\n//  s  cutset \nfunc TrimLeft(s string, cutset string) string\n//  s  cutset \nfunc TrimRight(s string, cutset string) string\n//  sep  s ,\nfunc Split(s, sep string) []string\n// .n>0, s  n , , . n  0 ,  nil. n<0,\nfunc SplitN(s, sep string, n int) []string\n//  a , sep \nfunc Join(a []string, sep string) string\n```\n\n## `Reader` \n\n```go\n//  `io` \nfunc (r *Reader) Read(b []byte) (n int, err error)\nfunc (r *Reader) ReadByte() (b byte, err error)\nfunc (r *Reader) Seek(offset int64, whence int) (int64, error)\nfunc (r *Reader) ReadAt(b []byte, off int64) (n int, err error)\nfunc (r *Reader) WriteTo(w io.Writer) (n int64, err error)\n```\n\n## `Replacer` \n\n```go\n//  s \nfunc (r *Replacer) Replace(s string) string\n//  w  s \nfunc (r *Replacer) WriteString(w io.Writer, s string) (n int, err error)\n```","slug":"go-study-notes-package-strings","published":1,"date":"2020-05-01T10:00:37.273Z","updated":"2020-05-04T13:46:26.811Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvo001sk8u7harkby37","content":"<p><code>strings</code> . <code>import &quot;strings&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , `io.Reader`,`io.Seeker`,`io.ReaderAt`,`io.WriterTo``io.ByteScanner`,`io.RuneScanner` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Reader <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Replacer <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"strings-\"><a href=\"#strings-\" class=\"headerlink\" title=\"strings \"></a><code>strings</code> </h1><p><code>strings</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Reader . Reader </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReader</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> *<span class=\"title\">Reader</span></span></span><br><span class=\"line\"><span class=\"comment\">//  old,new  Replacer . Replacer </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReplacer</span><span class=\"params\">(oldnew ...<span class=\"keyword\">string</span>)</span> *<span class=\"title\">Replacer</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  prefix </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">HasPrefix</span><span class=\"params\">(s, prefix <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  suffix </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">HasSuffix</span><span class=\"params\">(s, suffix <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  substr</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Contains</span><span class=\"params\">(s, substr <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  chars </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ContainsAny</span><span class=\"params\">(s, chars <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  sep </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Count</span><span class=\"params\">(s, sep <span class=\"keyword\">string</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  sep  s ,  -1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Index</span><span class=\"params\">(s, sep <span class=\"keyword\">string</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  c  s , -1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IndexByte</span><span class=\"params\">(s <span class=\"keyword\">string</span>, c <span class=\"keyword\">byte</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  sep  s ,  -1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">LastIndex</span><span class=\"params\">(s, chars <span class=\"keyword\">string</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Title</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ToLower</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ToUpper</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  count  s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Repeat</span><span class=\"params\">(s <span class=\"keyword\">string</span>, count <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  n  old  new ,  n&lt;0  old </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Replace</span><span class=\"params\">(s, old, <span class=\"built_in\">new</span> <span class=\"keyword\">string</span>, n <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  cutset </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Trim</span><span class=\"params\">(s <span class=\"keyword\">string</span>, cutset <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TrimSpace</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  cutset </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TrimLeft</span><span class=\"params\">(s <span class=\"keyword\">string</span>, cutset <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  cutset </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TrimRight</span><span class=\"params\">(s <span class=\"keyword\">string</span>, cutset <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  sep  s ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Split</span><span class=\"params\">(s, sep <span class=\"keyword\">string</span>)</span> []<span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// .n&gt;0, s  n , , . n  0 ,  nil. n&lt;0,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SplitN</span><span class=\"params\">(s, sep <span class=\"keyword\">string</span>, n <span class=\"keyword\">int</span>)</span> []<span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  a , sep </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Join</span><span class=\"params\">(a []<span class=\"keyword\">string</span>, sep <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Reader-\"><a href=\"#Reader-\" class=\"headerlink\" title=\"Reader \"></a><code>Reader</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `io` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">Read</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">ReadByte</span><span class=\"params\">()</span> <span class=\"params\">(b <span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">Seek</span><span class=\"params\">(offset <span class=\"keyword\">int64</span>, whence <span class=\"keyword\">int</span>)</span> <span class=\"params\">(<span class=\"keyword\">int64</span>, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">ReadAt</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">WriteTo</span><span class=\"params\">(w io.Writer)</span> <span class=\"params\">(n <span class=\"keyword\">int64</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Replacer-\"><a href=\"#Replacer-\" class=\"headerlink\" title=\"Replacer \"></a><code>Replacer</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Replacer)</span> <span class=\"title\">Replace</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  w  s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Replacer)</span> <span class=\"title\">WriteString</span><span class=\"params\">(w io.Writer, s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>strings</code> . <code>import &quot;strings&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , `io.Reader`,`io.Seeker`,`io.ReaderAt`,`io.WriterTo``io.ByteScanner`,`io.RuneScanner` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Reader <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Replacer <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"strings-\"><a href=\"#strings-\" class=\"headerlink\" title=\"strings \"></a><code>strings</code> </h1><p><code>strings</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Reader . Reader </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReader</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> *<span class=\"title\">Reader</span></span></span><br><span class=\"line\"><span class=\"comment\">//  old,new  Replacer . Replacer </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewReplacer</span><span class=\"params\">(oldnew ...<span class=\"keyword\">string</span>)</span> *<span class=\"title\">Replacer</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  prefix </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">HasPrefix</span><span class=\"params\">(s, prefix <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  suffix </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">HasSuffix</span><span class=\"params\">(s, suffix <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  substr</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Contains</span><span class=\"params\">(s, substr <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  chars </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ContainsAny</span><span class=\"params\">(s, chars <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  sep </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Count</span><span class=\"params\">(s, sep <span class=\"keyword\">string</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  sep  s ,  -1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Index</span><span class=\"params\">(s, sep <span class=\"keyword\">string</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  c  s , -1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IndexByte</span><span class=\"params\">(s <span class=\"keyword\">string</span>, c <span class=\"keyword\">byte</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  sep  s ,  -1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">LastIndex</span><span class=\"params\">(s, chars <span class=\"keyword\">string</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Title</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ToLower</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ToUpper</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  count  s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Repeat</span><span class=\"params\">(s <span class=\"keyword\">string</span>, count <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  n  old  new ,  n&lt;0  old </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Replace</span><span class=\"params\">(s, old, <span class=\"built_in\">new</span> <span class=\"keyword\">string</span>, n <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  cutset </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Trim</span><span class=\"params\">(s <span class=\"keyword\">string</span>, cutset <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TrimSpace</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  cutset </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TrimLeft</span><span class=\"params\">(s <span class=\"keyword\">string</span>, cutset <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  s  cutset </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TrimRight</span><span class=\"params\">(s <span class=\"keyword\">string</span>, cutset <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  sep  s ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Split</span><span class=\"params\">(s, sep <span class=\"keyword\">string</span>)</span> []<span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// .n&gt;0, s  n , , . n  0 ,  nil. n&lt;0,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SplitN</span><span class=\"params\">(s, sep <span class=\"keyword\">string</span>, n <span class=\"keyword\">int</span>)</span> []<span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  a , sep </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Join</span><span class=\"params\">(a []<span class=\"keyword\">string</span>, sep <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Reader-\"><a href=\"#Reader-\" class=\"headerlink\" title=\"Reader \"></a><code>Reader</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `io` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">Read</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">ReadByte</span><span class=\"params\">()</span> <span class=\"params\">(b <span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">Seek</span><span class=\"params\">(offset <span class=\"keyword\">int64</span>, whence <span class=\"keyword\">int</span>)</span> <span class=\"params\">(<span class=\"keyword\">int64</span>, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">ReadAt</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>, off <span class=\"keyword\">int64</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Reader)</span> <span class=\"title\">WriteTo</span><span class=\"params\">(w io.Writer)</span> <span class=\"params\">(n <span class=\"keyword\">int64</span>, err error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Replacer-\"><a href=\"#Replacer-\" class=\"headerlink\" title=\"Replacer \"></a><code>Replacer</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Replacer)</span> <span class=\"title\">Replace</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  w  s </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(r *Replacer)</span> <span class=\"title\">WriteString</span><span class=\"params\">(w io.Writer, s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(n <span class=\"keyword\">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>"},{"title":"go  strconv ","abbrlink":42830,"description":" Go strconv .","_content":"\n`strconv` . `import \"strconv\"`\n\n\n# \n\n `strconv` \n\n```go\n// bool,\n// `1,0,t,f,T,F,true,false,True,False,TRUE,FALSE` \nfunc ParseBool(str string) (value bool, err error)\n// ,. \n// base , 0, s (\"0x\"16,\"0\"8,10)\nfunc ParseInt(s string, base int, bitSize int) (i int64, err error)\n// \nfunc ParseFloat(s string, bitSize int) (f float64, err error)\n// , \"true\"  \"false\"\nfunc FormatBool(b bool) string\n// ibase\nfunc FormatInt(i int64, base int) string\n// \nfunc FormatFloat(f float64, fmt byte, prec, bitSize int) string\n//  ParseInt(s, 10, 0). int\nfunc Atoi(s string) (i int, err error)\n//  FormatInt(i, 10) . int \nfunc Itoa(i int) string\n```","source":"_posts/go-study-notes-package-strconv.md","raw":"---\ntitle: go  strconv \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 42830\ndescription:  Go strconv .\n---\n\n`strconv` . `import \"strconv\"`\n\n\n# \n\n `strconv` \n\n```go\n// bool,\n// `1,0,t,f,T,F,true,false,True,False,TRUE,FALSE` \nfunc ParseBool(str string) (value bool, err error)\n// ,. \n// base , 0, s (\"0x\"16,\"0\"8,10)\nfunc ParseInt(s string, base int, bitSize int) (i int64, err error)\n// \nfunc ParseFloat(s string, bitSize int) (f float64, err error)\n// , \"true\"  \"false\"\nfunc FormatBool(b bool) string\n// ibase\nfunc FormatInt(i int64, base int) string\n// \nfunc FormatFloat(f float64, fmt byte, prec, bitSize int) string\n//  ParseInt(s, 10, 0). int\nfunc Atoi(s string) (i int, err error)\n//  FormatInt(i, 10) . int \nfunc Itoa(i int) string\n```","slug":"go-study-notes-package-strconv","published":1,"date":"2020-05-03T02:40:21.795Z","updated":"2020-05-04T13:43:12.017Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvp001vk8u705880786","content":"<p><code>strconv</code> . <code>import &quot;strconv&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>strconv</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// bool,</span></span><br><span class=\"line\"><span class=\"comment\">// `1,0,t,f,T,F,true,false,True,False,TRUE,FALSE` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseBool</span><span class=\"params\">(str <span class=\"keyword\">string</span>)</span> <span class=\"params\">(value <span class=\"keyword\">bool</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,. </span></span><br><span class=\"line\"><span class=\"comment\">// base , 0, s (\"0x\"16,\"0\"8,10)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseInt</span><span class=\"params\">(s <span class=\"keyword\">string</span>, base <span class=\"keyword\">int</span>, bitSize <span class=\"keyword\">int</span>)</span> <span class=\"params\">(i <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseFloat</span><span class=\"params\">(s <span class=\"keyword\">string</span>, bitSize <span class=\"keyword\">int</span>)</span> <span class=\"params\">(f <span class=\"keyword\">float64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , \"true\"  \"false\"</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FormatBool</span><span class=\"params\">(b <span class=\"keyword\">bool</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// ibase</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FormatInt</span><span class=\"params\">(i <span class=\"keyword\">int64</span>, base <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FormatFloat</span><span class=\"params\">(f <span class=\"keyword\">float64</span>, fmt <span class=\"keyword\">byte</span>, prec, bitSize <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  ParseInt(s, 10, 0). int</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Atoi</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(i <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  FormatInt(i, 10) . int </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Itoa</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>strconv</code> . <code>import &quot;strconv&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>strconv</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// bool,</span></span><br><span class=\"line\"><span class=\"comment\">// `1,0,t,f,T,F,true,false,True,False,TRUE,FALSE` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseBool</span><span class=\"params\">(str <span class=\"keyword\">string</span>)</span> <span class=\"params\">(value <span class=\"keyword\">bool</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,. </span></span><br><span class=\"line\"><span class=\"comment\">// base , 0, s (\"0x\"16,\"0\"8,10)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseInt</span><span class=\"params\">(s <span class=\"keyword\">string</span>, base <span class=\"keyword\">int</span>, bitSize <span class=\"keyword\">int</span>)</span> <span class=\"params\">(i <span class=\"keyword\">int64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseFloat</span><span class=\"params\">(s <span class=\"keyword\">string</span>, bitSize <span class=\"keyword\">int</span>)</span> <span class=\"params\">(f <span class=\"keyword\">float64</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// , \"true\"  \"false\"</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FormatBool</span><span class=\"params\">(b <span class=\"keyword\">bool</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// ibase</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FormatInt</span><span class=\"params\">(i <span class=\"keyword\">int64</span>, base <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FormatFloat</span><span class=\"params\">(f <span class=\"keyword\">float64</span>, fmt <span class=\"keyword\">byte</span>, prec, bitSize <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  ParseInt(s, 10, 0). int</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Atoi</span><span class=\"params\">(s <span class=\"keyword\">string</span>)</span> <span class=\"params\">(i <span class=\"keyword\">int</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  FormatInt(i, 10) . int </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Itoa</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>"},{"title":"go  runtime ","abbrlink":17440,"description":" Go runtime .runtime  Go , goroutine .","_content":"\n`runtime`  Go . `import \"runtime\"`\n\n# \n\n Go ,\n\n## `GOGC`\n\n`GOGC` .,. `GOGC=100`. `GOGC=off` .`runtime/debug`  `SetGCPercent`  Go . [https://golang.org/pkg/runtime/debug/#SetGCPercent](https://golang.org/pkg/runtime/debug/#SetGCPercent)\n\n## `GODEBUG`\n\n`GODEBUG` , `name=val` ,\n\n```\nallocfreetrace: setting allocfreetrace=1 causes every allocation to be profiled and a stack trace printed on each object's allocation and free\n\nclobberfree: setting clobberfree=1 causes the garbage collector to clobber the memory content of an object with bad content when it freesthe object.\n\ncgocheck: setting cgocheck=0 disables all checks for packages using cgo to incorrectly pass Go pointers to non-Go code.\nSetting cgocheck=1 (the default) enables relatively cheap checks that may miss some errors.\nSetting cgocheck=2 enables expensive checks that should not miss any errors, but will cause your program to run slower.\n\nefence: setting efence=1 causes the allocator to run in a mode where each object is allocated on a unique page and addresses are never recycled.\n```\n\n- allocfreetrace:  allocfreetrace=1 ,\n- clobberfree:  clobberfree=1 \n- cgocheck cgocheck=0  cgo  Go ;cgocheck=1() ,;cgocheck=2 ,,\n- efence efence=1 ,\n\n## `GOMAXPROCS`\n\n`GOMAXPROCS`  Go . Go . `GOMAXPROCS` . `runtime.GOMAXPROCS()` .\n\n## `GORACE`\n\n`GORACE`  `-race` . [https://golang.org/doc/articles/race_detector.html](https://golang.org/doc/articles/race_detector.html )\n\n## `GOTRACEBACK`\n\n`GOTRACEBACK`  Go ., goroutine ,, 2 . goroutine , goroutine .\n\n- `GOTRACEBACK=none`  goroutine \n- `GOTRACEBACK=single`()\n- `GOTRACEBACK=all`  goroutine \n- `GOTRACEBACK=system`  `all`,, goroutine\n- `GOTRACEBACK=crash`  `system`,\n\nGOTRACEBACK  0,1  2  none,all  system .`runtime/debug` `SetTraceback` ,. [https://golang.org/pkg/runtime/debug/#SetTraceback](https://golang.org/pkg/runtime/debug/#SetTraceback)\n\n## `GOARCH`,`GOOS`,`GOPATH`,`GOROOT`\n\n`GOARCH`,`GOOS`,`GOPATH`,`GOROOT`  Go . Go ( [https://golang.org/cmd/go](https://golang.org/cmd/go)  [https://golang.org/pkg/go/build](https://golang.org/pkg/go/build)).`GOARCH`,`GOOS`,`GOROOT` ,,.\n\n# \n\n```go\ntype Func struct {\n    // \n}\n```\n\n# \n\n```go\nconst Compiler = \"gc\"  // \nconst GOOS string = sys.GOOS // ,windows,linux,freebsd,darwin\nconst GOARCH string = sys.GOARCH // ,386,amd64  arm\nvar MemProfileRate int = 512 * 1024\n```\n\n# \n\n## `runtime` \n\n```go\n//  Go . GOROOT ,\nfunc GOROOT() string\n//  Go \nfunc Version() string\n//  CPU \nfunc NumCPU() int\n// () CPU .. n<1,.\nfunc GOMAXPROCS(n int) int\n//  CPU profile hz . hz<=0, profile \nfunc SetCPUProfileRate(hz int)\n// \nfunc GC()\n//  goroutine. goroutine .\n//  goroutine , recover  nil. \n//  goroutine  goroutine,. goroutine. goroutine ,\nfunc Goexit()\n//  goroutine , goroutine . goroutine, goroutine  \nfunc Gosched()\n//  goroutine . goroutine, goroutine , UnlockOSThread.\n//  goroutine ,.\nfunc LockOSThread()\n//  goroutine . goroutine  LockOSThread,\nfunc UnlockOSThread()\n//  cgo \nfunc NumCgoCall() int64\n//  goroutine \nfunc NumGoroutine() int\n//  *Func  nil. pc , *Func,\nfunc FuncForPC(pc uintptr) *Func\n```\n\n## `Func` \n\n```go\n// \nfunc (f *Func) Entry() uintptr\n// \nfunc (f *Func) Name() string\n```","source":"_posts/go-study-notes-package-runtime.md","raw":"---\ntitle: go  runtime \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 17440\ndescription: >-\n   Go runtime .runtime  Go , goroutine\n  .\n---\n\n`runtime`  Go . `import \"runtime\"`\n\n# \n\n Go ,\n\n## `GOGC`\n\n`GOGC` .,. `GOGC=100`. `GOGC=off` .`runtime/debug`  `SetGCPercent`  Go . [https://golang.org/pkg/runtime/debug/#SetGCPercent](https://golang.org/pkg/runtime/debug/#SetGCPercent)\n\n## `GODEBUG`\n\n`GODEBUG` , `name=val` ,\n\n```\nallocfreetrace: setting allocfreetrace=1 causes every allocation to be profiled and a stack trace printed on each object's allocation and free\n\nclobberfree: setting clobberfree=1 causes the garbage collector to clobber the memory content of an object with bad content when it freesthe object.\n\ncgocheck: setting cgocheck=0 disables all checks for packages using cgo to incorrectly pass Go pointers to non-Go code.\nSetting cgocheck=1 (the default) enables relatively cheap checks that may miss some errors.\nSetting cgocheck=2 enables expensive checks that should not miss any errors, but will cause your program to run slower.\n\nefence: setting efence=1 causes the allocator to run in a mode where each object is allocated on a unique page and addresses are never recycled.\n```\n\n- allocfreetrace:  allocfreetrace=1 ,\n- clobberfree:  clobberfree=1 \n- cgocheck cgocheck=0  cgo  Go ;cgocheck=1() ,;cgocheck=2 ,,\n- efence efence=1 ,\n\n## `GOMAXPROCS`\n\n`GOMAXPROCS`  Go . Go . `GOMAXPROCS` . `runtime.GOMAXPROCS()` .\n\n## `GORACE`\n\n`GORACE`  `-race` . [https://golang.org/doc/articles/race_detector.html](https://golang.org/doc/articles/race_detector.html )\n\n## `GOTRACEBACK`\n\n`GOTRACEBACK`  Go ., goroutine ,, 2 . goroutine , goroutine .\n\n- `GOTRACEBACK=none`  goroutine \n- `GOTRACEBACK=single`()\n- `GOTRACEBACK=all`  goroutine \n- `GOTRACEBACK=system`  `all`,, goroutine\n- `GOTRACEBACK=crash`  `system`,\n\nGOTRACEBACK  0,1  2  none,all  system .`runtime/debug` `SetTraceback` ,. [https://golang.org/pkg/runtime/debug/#SetTraceback](https://golang.org/pkg/runtime/debug/#SetTraceback)\n\n## `GOARCH`,`GOOS`,`GOPATH`,`GOROOT`\n\n`GOARCH`,`GOOS`,`GOPATH`,`GOROOT`  Go . Go ( [https://golang.org/cmd/go](https://golang.org/cmd/go)  [https://golang.org/pkg/go/build](https://golang.org/pkg/go/build)).`GOARCH`,`GOOS`,`GOROOT` ,,.\n\n# \n\n```go\ntype Func struct {\n    // \n}\n```\n\n# \n\n```go\nconst Compiler = \"gc\"  // \nconst GOOS string = sys.GOOS // ,windows,linux,freebsd,darwin\nconst GOARCH string = sys.GOARCH // ,386,amd64  arm\nvar MemProfileRate int = 512 * 1024\n```\n\n# \n\n## `runtime` \n\n```go\n//  Go . GOROOT ,\nfunc GOROOT() string\n//  Go \nfunc Version() string\n//  CPU \nfunc NumCPU() int\n// () CPU .. n<1,.\nfunc GOMAXPROCS(n int) int\n//  CPU profile hz . hz<=0, profile \nfunc SetCPUProfileRate(hz int)\n// \nfunc GC()\n//  goroutine. goroutine .\n//  goroutine , recover  nil. \n//  goroutine  goroutine,. goroutine. goroutine ,\nfunc Goexit()\n//  goroutine , goroutine . goroutine, goroutine  \nfunc Gosched()\n//  goroutine . goroutine, goroutine , UnlockOSThread.\n//  goroutine ,.\nfunc LockOSThread()\n//  goroutine . goroutine  LockOSThread,\nfunc UnlockOSThread()\n//  cgo \nfunc NumCgoCall() int64\n//  goroutine \nfunc NumGoroutine() int\n//  *Func  nil. pc , *Func,\nfunc FuncForPC(pc uintptr) *Func\n```\n\n## `Func` \n\n```go\n// \nfunc (f *Func) Entry() uintptr\n// \nfunc (f *Func) Name() string\n```","slug":"go-study-notes-package-runtime","published":1,"date":"2020-05-03T13:26:24.495Z","updated":"2020-05-04T13:40:47.523Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvq001yk8u771qba60k","content":"<p><code>runtime</code>  Go . <code>import &quot;runtime&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Go ,</p>\n<h2 id=\"GOGC\"><a href=\"#GOGC\" class=\"headerlink\" title=\"GOGC\"></a><code>GOGC</code></h2><p><code>GOGC</code> .,. <code>GOGC=100</code>. <code>GOGC=off</code> .<code>runtime/debug</code>  <code>SetGCPercent</code>  Go . <a href=\"https://golang.org/pkg/runtime/debug/#SetGCPercent\" target=\"_blank\" rel=\"noopener\">https://golang.org/pkg/runtime/debug/#SetGCPercent</a></p>\n<h2 id=\"GODEBUG\"><a href=\"#GODEBUG\" class=\"headerlink\" title=\"GODEBUG\"></a><code>GODEBUG</code></h2><p><code>GODEBUG</code> , <code>name=val</code> ,</p>\n<figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">allocfreetrace</span>: setting allocfreetrace=1 causes every allocation to be profiled and a stack trace printed on each object's allocation and free</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">clobberfree</span>: setting clobberfree=1 causes the garbage collector to clobber the memory content of an object with bad content when it freesthe object.</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">cgocheck</span>: setting cgocheck=0 disables all checks for packages using cgo to incorrectly pass Go pointers to non-Go code.</span><br><span class=\"line\">Setting cgocheck=1 (the default) enables relatively cheap checks that may miss some errors.</span><br><span class=\"line\">Setting cgocheck=2 enables expensive checks that should not miss any errors, but will cause your program to run slower.</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">efence</span>: setting efence=1 causes the allocator to run in a mode where each object is allocated on a unique page and addresses are never recycled.</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>allocfreetrace:  allocfreetrace=1 ,</li>\n<li>clobberfree:  clobberfree=1 </li>\n<li>cgocheck cgocheck=0  cgo  Go ;cgocheck=1() ,;cgocheck=2 ,,</li>\n<li>efence efence=1 ,</li>\n</ul>\n<h2 id=\"GOMAXPROCS\"><a href=\"#GOMAXPROCS\" class=\"headerlink\" title=\"GOMAXPROCS\"></a><code>GOMAXPROCS</code></h2><p><code>GOMAXPROCS</code>  Go . Go . <code>GOMAXPROCS</code> . <code>runtime.GOMAXPROCS()</code> .</p>\n<h2 id=\"GORACE\"><a href=\"#GORACE\" class=\"headerlink\" title=\"GORACE\"></a><code>GORACE</code></h2><p><code>GORACE</code>  <code>-race</code> . <a href=\"https://golang.org/doc/articles/race_detector.html\" target=\"_blank\" rel=\"noopener\">https://golang.org/doc/articles/race_detector.html</a></p>\n<h2 id=\"GOTRACEBACK\"><a href=\"#GOTRACEBACK\" class=\"headerlink\" title=\"GOTRACEBACK\"></a><code>GOTRACEBACK</code></h2><p><code>GOTRACEBACK</code>  Go ., goroutine ,, 2 . goroutine , goroutine .</p>\n<ul>\n<li><code>GOTRACEBACK=none</code>  goroutine </li>\n<li><code>GOTRACEBACK=single</code>()</li>\n<li><code>GOTRACEBACK=all</code>  goroutine </li>\n<li><code>GOTRACEBACK=system</code>  <code>all</code>,, goroutine</li>\n<li><code>GOTRACEBACK=crash</code>  <code>system</code>,</li>\n</ul>\n<p>GOTRACEBACK  0,1  2  none,all  system .<code>runtime/debug</code> <code>SetTraceback</code> ,. <a href=\"https://golang.org/pkg/runtime/debug/#SetTraceback\" target=\"_blank\" rel=\"noopener\">https://golang.org/pkg/runtime/debug/#SetTraceback</a></p>\n<h2 id=\"GOARCH-GOOS-GOPATH-GOROOT\"><a href=\"#GOARCH-GOOS-GOPATH-GOROOT\" class=\"headerlink\" title=\"GOARCH,GOOS,GOPATH,GOROOT\"></a><code>GOARCH</code>,<code>GOOS</code>,<code>GOPATH</code>,<code>GOROOT</code></h2><p><code>GOARCH</code>,<code>GOOS</code>,<code>GOPATH</code>,<code>GOROOT</code>  Go . Go ( <a href=\"https://golang.org/cmd/go\" target=\"_blank\" rel=\"noopener\">https://golang.org/cmd/go</a>  <a href=\"https://golang.org/pkg/go/build\" target=\"_blank\" rel=\"noopener\">https://golang.org/pkg/go/build</a>).<code>GOARCH</code>,<code>GOOS</code>,<code>GOROOT</code> ,,.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Func <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Compiler = <span class=\"string\">\"gc\"</span>  <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> GOOS <span class=\"keyword\">string</span> = sys.GOOS <span class=\"comment\">// ,windows,linux,freebsd,darwin</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> GOARCH <span class=\"keyword\">string</span> = sys.GOARCH <span class=\"comment\">// ,386,amd64  arm</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> MemProfileRate <span class=\"keyword\">int</span> = <span class=\"number\">512</span> * <span class=\"number\">1024</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"runtime-\"><a href=\"#runtime-\" class=\"headerlink\" title=\"runtime \"></a><code>runtime</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Go . GOROOT ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GOROOT</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Go </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Version</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  CPU </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NumCPU</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// () CPU .. n&lt;1,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GOMAXPROCS</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  CPU profile hz . hz&lt;=0, profile </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SetCPUProfileRate</span><span class=\"params\">(hz <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GC</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine. goroutine .</span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine , recover  nil. </span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine  goroutine,. goroutine. goroutine ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Goexit</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine , goroutine . goroutine, goroutine  </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Gosched</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine . goroutine, goroutine , UnlockOSThread.</span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine ,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">LockOSThread</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine . goroutine  LockOSThread,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">UnlockOSThread</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  cgo </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NumCgoCall</span><span class=\"params\">()</span> <span class=\"title\">int64</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NumGoroutine</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  *Func  nil. pc , *Func,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FuncForPC</span><span class=\"params\">(pc <span class=\"keyword\">uintptr</span>)</span> *<span class=\"title\">Func</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Func-\"><a href=\"#Func-\" class=\"headerlink\" title=\"Func \"></a><code>Func</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *Func)</span> <span class=\"title\">Entry</span><span class=\"params\">()</span> <span class=\"title\">uintptr</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *Func)</span> <span class=\"title\">Name</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>runtime</code>  Go . <code>import &quot;runtime&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Go ,</p>\n<h2 id=\"GOGC\"><a href=\"#GOGC\" class=\"headerlink\" title=\"GOGC\"></a><code>GOGC</code></h2><p><code>GOGC</code> .,. <code>GOGC=100</code>. <code>GOGC=off</code> .<code>runtime/debug</code>  <code>SetGCPercent</code>  Go . <a href=\"https://golang.org/pkg/runtime/debug/#SetGCPercent\" target=\"_blank\" rel=\"noopener\">https://golang.org/pkg/runtime/debug/#SetGCPercent</a></p>\n<h2 id=\"GODEBUG\"><a href=\"#GODEBUG\" class=\"headerlink\" title=\"GODEBUG\"></a><code>GODEBUG</code></h2><p><code>GODEBUG</code> , <code>name=val</code> ,</p>\n<figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">allocfreetrace</span>: setting allocfreetrace=1 causes every allocation to be profiled and a stack trace printed on each object's allocation and free</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">clobberfree</span>: setting clobberfree=1 causes the garbage collector to clobber the memory content of an object with bad content when it freesthe object.</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">cgocheck</span>: setting cgocheck=0 disables all checks for packages using cgo to incorrectly pass Go pointers to non-Go code.</span><br><span class=\"line\">Setting cgocheck=1 (the default) enables relatively cheap checks that may miss some errors.</span><br><span class=\"line\">Setting cgocheck=2 enables expensive checks that should not miss any errors, but will cause your program to run slower.</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">efence</span>: setting efence=1 causes the allocator to run in a mode where each object is allocated on a unique page and addresses are never recycled.</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>allocfreetrace:  allocfreetrace=1 ,</li>\n<li>clobberfree:  clobberfree=1 </li>\n<li>cgocheck cgocheck=0  cgo  Go ;cgocheck=1() ,;cgocheck=2 ,,</li>\n<li>efence efence=1 ,</li>\n</ul>\n<h2 id=\"GOMAXPROCS\"><a href=\"#GOMAXPROCS\" class=\"headerlink\" title=\"GOMAXPROCS\"></a><code>GOMAXPROCS</code></h2><p><code>GOMAXPROCS</code>  Go . Go . <code>GOMAXPROCS</code> . <code>runtime.GOMAXPROCS()</code> .</p>\n<h2 id=\"GORACE\"><a href=\"#GORACE\" class=\"headerlink\" title=\"GORACE\"></a><code>GORACE</code></h2><p><code>GORACE</code>  <code>-race</code> . <a href=\"https://golang.org/doc/articles/race_detector.html\" target=\"_blank\" rel=\"noopener\">https://golang.org/doc/articles/race_detector.html</a></p>\n<h2 id=\"GOTRACEBACK\"><a href=\"#GOTRACEBACK\" class=\"headerlink\" title=\"GOTRACEBACK\"></a><code>GOTRACEBACK</code></h2><p><code>GOTRACEBACK</code>  Go ., goroutine ,, 2 . goroutine , goroutine .</p>\n<ul>\n<li><code>GOTRACEBACK=none</code>  goroutine </li>\n<li><code>GOTRACEBACK=single</code>()</li>\n<li><code>GOTRACEBACK=all</code>  goroutine </li>\n<li><code>GOTRACEBACK=system</code>  <code>all</code>,, goroutine</li>\n<li><code>GOTRACEBACK=crash</code>  <code>system</code>,</li>\n</ul>\n<p>GOTRACEBACK  0,1  2  none,all  system .<code>runtime/debug</code> <code>SetTraceback</code> ,. <a href=\"https://golang.org/pkg/runtime/debug/#SetTraceback\" target=\"_blank\" rel=\"noopener\">https://golang.org/pkg/runtime/debug/#SetTraceback</a></p>\n<h2 id=\"GOARCH-GOOS-GOPATH-GOROOT\"><a href=\"#GOARCH-GOOS-GOPATH-GOROOT\" class=\"headerlink\" title=\"GOARCH,GOOS,GOPATH,GOROOT\"></a><code>GOARCH</code>,<code>GOOS</code>,<code>GOPATH</code>,<code>GOROOT</code></h2><p><code>GOARCH</code>,<code>GOOS</code>,<code>GOPATH</code>,<code>GOROOT</code>  Go . Go ( <a href=\"https://golang.org/cmd/go\" target=\"_blank\" rel=\"noopener\">https://golang.org/cmd/go</a>  <a href=\"https://golang.org/pkg/go/build\" target=\"_blank\" rel=\"noopener\">https://golang.org/pkg/go/build</a>).<code>GOARCH</code>,<code>GOOS</code>,<code>GOROOT</code> ,,.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Func <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> Compiler = <span class=\"string\">\"gc\"</span>  <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> GOOS <span class=\"keyword\">string</span> = sys.GOOS <span class=\"comment\">// ,windows,linux,freebsd,darwin</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> GOARCH <span class=\"keyword\">string</span> = sys.GOARCH <span class=\"comment\">// ,386,amd64  arm</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> MemProfileRate <span class=\"keyword\">int</span> = <span class=\"number\">512</span> * <span class=\"number\">1024</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"runtime-\"><a href=\"#runtime-\" class=\"headerlink\" title=\"runtime \"></a><code>runtime</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Go . GOROOT ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GOROOT</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Go </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Version</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  CPU </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NumCPU</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// () CPU .. n&lt;1,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GOMAXPROCS</span><span class=\"params\">(n <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  CPU profile hz . hz&lt;=0, profile </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SetCPUProfileRate</span><span class=\"params\">(hz <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GC</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine. goroutine .</span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine , recover  nil. </span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine  goroutine,. goroutine. goroutine ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Goexit</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine , goroutine . goroutine, goroutine  </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Gosched</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine . goroutine, goroutine , UnlockOSThread.</span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine ,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">LockOSThread</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine . goroutine  LockOSThread,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">UnlockOSThread</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  cgo </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NumCgoCall</span><span class=\"params\">()</span> <span class=\"title\">int64</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NumGoroutine</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//  *Func  nil. pc , *Func,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">FuncForPC</span><span class=\"params\">(pc <span class=\"keyword\">uintptr</span>)</span> *<span class=\"title\">Func</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Func-\"><a href=\"#Func-\" class=\"headerlink\" title=\"Func \"></a><code>Func</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *Func)</span> <span class=\"title\">Entry</span><span class=\"params\">()</span> <span class=\"title\">uintptr</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(f *Func)</span> <span class=\"title\">Name</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>"},{"title":"go  sync ","abbrlink":41417,"description":" Go sync .sync ,. Once  WaitGroup ,.","_content":"\n`sync` . `import \"sync\"`\n\n# \n\n```go\n// Locker ,\ntype Locker interface {\n    Lock()\n    Unlock()\n}\n\n// \n//  goroutine , goroutine , goroutine \ntype Mutex struct {\n    // \n}\n\n// \ntype Once struct {\n    // \n}\n\n// \n// ,.,\n//  goroutine \ntype Pool struct {\n\n    // , Get . Get  nil\n    New func() interface{}\n    // \n}\n\n//  goroutine \n//  Add  goroutine , goroutine  Done., Wait , goroutine \ntype WaitGroup struct {\n    // contains filtered or unexported fields\n}\n```\n\n# \n\n## `Mutex` \n\n goroutine , goroutine , goroutine \n\n```go\n//  `var m sync.Mutex`\n\n// .,,\nfunc (m *Mutex) Lock()\n// .,\nfunc (m *Mutex) Unlock()\n```\n\n## `Once` \n\n```go\n//  `var o sync.Once`\n\n//  o  Do , f.\nfunc (o *Once) Do(f func())\n```\n\n## `Pool` \n\n```go\n//  `var p sync.Pool`  `var bufPool sync.Pool = sync.Pool{New: funName}`\n\n// ,., p.New ,Get  p.New \nfunc (p *Pool) Get() interface{}\n//  x  p \nfunc (p *Pool) Put(x interface{})\n```\n\n## `WaitGroup` \n\n```go\n//  `var wg sync.WaitGroup`\n\n//  delta .\n//  0, Wait  goroutine\n// ,\nfunc (wg *WaitGroup) Add(delta int)\n//  wg  1\nfunc (wg *WaitGroup) Done()\n//  goroutine  wg  0\nfunc (wg *WaitGroup) Wait()\n```\n\n# \n\n## `Once` \n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var once sync.Once\n    for i := 0; i < 5; i++ {\n        once.Do(func() {\n            fmt.Printf(\" i=%v \\n\", i)\n        })\n    }\n}\n// .  `once.Do()` ,\n//  i=0 \n```\n\n## `Pool` \n\n-  `Pool`  5 \n\n```go\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n    var p sync.Pool = sync.Pool{\n        New: func() interface{} {\n            return rand.Intn(100)\n        },\n    }\n    for i := 0; i < 5; i++ {\n        fmt.Println(p.Get())\n    }\n}\n```\n\n## `WaitGroup` \n\n-  `WaitGroup`  goroutine \n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n\n    var wg sync.WaitGroup\n    for i := 0; i < 5; i++ {\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            fmt.Printf(\"goroutine %v done\\n\", i)\n        }(i)\n    }\n    wg.Wait()\n    fmt.Println(\"main goroutine done\")\n}\n```","source":"_posts/go-study-notes-package-sync.md","raw":"---\ntitle: go  sync \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 41417\ndescription: >-\n   Go sync .sync ,. Once  WaitGroup\n  ,.\n---\n\n`sync` . `import \"sync\"`\n\n# \n\n```go\n// Locker ,\ntype Locker interface {\n    Lock()\n    Unlock()\n}\n\n// \n//  goroutine , goroutine , goroutine \ntype Mutex struct {\n    // \n}\n\n// \ntype Once struct {\n    // \n}\n\n// \n// ,.,\n//  goroutine \ntype Pool struct {\n\n    // , Get . Get  nil\n    New func() interface{}\n    // \n}\n\n//  goroutine \n//  Add  goroutine , goroutine  Done., Wait , goroutine \ntype WaitGroup struct {\n    // contains filtered or unexported fields\n}\n```\n\n# \n\n## `Mutex` \n\n goroutine , goroutine , goroutine \n\n```go\n//  `var m sync.Mutex`\n\n// .,,\nfunc (m *Mutex) Lock()\n// .,\nfunc (m *Mutex) Unlock()\n```\n\n## `Once` \n\n```go\n//  `var o sync.Once`\n\n//  o  Do , f.\nfunc (o *Once) Do(f func())\n```\n\n## `Pool` \n\n```go\n//  `var p sync.Pool`  `var bufPool sync.Pool = sync.Pool{New: funName}`\n\n// ,., p.New ,Get  p.New \nfunc (p *Pool) Get() interface{}\n//  x  p \nfunc (p *Pool) Put(x interface{})\n```\n\n## `WaitGroup` \n\n```go\n//  `var wg sync.WaitGroup`\n\n//  delta .\n//  0, Wait  goroutine\n// ,\nfunc (wg *WaitGroup) Add(delta int)\n//  wg  1\nfunc (wg *WaitGroup) Done()\n//  goroutine  wg  0\nfunc (wg *WaitGroup) Wait()\n```\n\n# \n\n## `Once` \n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var once sync.Once\n    for i := 0; i < 5; i++ {\n        once.Do(func() {\n            fmt.Printf(\" i=%v \\n\", i)\n        })\n    }\n}\n// .  `once.Do()` ,\n//  i=0 \n```\n\n## `Pool` \n\n-  `Pool`  5 \n\n```go\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n    var p sync.Pool = sync.Pool{\n        New: func() interface{} {\n            return rand.Intn(100)\n        },\n    }\n    for i := 0; i < 5; i++ {\n        fmt.Println(p.Get())\n    }\n}\n```\n\n## `WaitGroup` \n\n-  `WaitGroup`  goroutine \n\n```go\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n\n    var wg sync.WaitGroup\n    for i := 0; i < 5; i++ {\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            fmt.Printf(\"goroutine %v done\\n\", i)\n        }(i)\n    }\n    wg.Wait()\n    fmt.Println(\"main goroutine done\")\n}\n```","slug":"go-study-notes-package-sync","published":1,"date":"2020-05-04T01:49:48.393Z","updated":"2020-05-05T09:21:23.531Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvr0021k8u7ezxjepkk","content":"<p><code>sync</code> . <code>import &quot;sync&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Locker ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Locker <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Lock()</span><br><span class=\"line\">    Unlock()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine , goroutine , goroutine </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Mutex <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Once <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// ,.,</span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Pool <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// , Get . Get  nil</span></span><br><span class=\"line\">    New <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span> <span class=\"title\">interface</span></span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  goroutine </span></span><br><span class=\"line\"><span class=\"comment\">//  Add  goroutine , goroutine  Done., Wait , goroutine </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> WaitGroup <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Mutex-\"><a href=\"#Mutex-\" class=\"headerlink\" title=\"Mutex \"></a><code>Mutex</code> </h2><p> goroutine , goroutine , goroutine </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `var m sync.Mutex`</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// .,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(m *Mutex)</span> <span class=\"title\">Lock</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">// .,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(m *Mutex)</span> <span class=\"title\">Unlock</span><span class=\"params\">()</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Once-\"><a href=\"#Once-\" class=\"headerlink\" title=\"Once \"></a><code>Once</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `var o sync.Once`</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  o  Do , f.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(o *Once)</span> <span class=\"title\">Do</span><span class=\"params\">(f <span class=\"keyword\">func</span>()</span>)</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Pool-\"><a href=\"#Pool-\" class=\"headerlink\" title=\"Pool \"></a><code>Pool</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `var p sync.Pool`  `var bufPool sync.Pool = sync.Pool&#123;New: funName&#125;`</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,., p.New ,Get  p.New </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p *Pool)</span> <span class=\"title\">Get</span><span class=\"params\">()</span> <span class=\"title\">interface</span></span>&#123;&#125;</span><br><span class=\"line\"><span class=\"comment\">//  x  p </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p *Pool)</span> <span class=\"title\">Put</span><span class=\"params\">(x <span class=\"keyword\">interface</span>&#123;&#125;)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"WaitGroup-\"><a href=\"#WaitGroup-\" class=\"headerlink\" title=\"WaitGroup \"></a><code>WaitGroup</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `var wg sync.WaitGroup`</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  delta .</span></span><br><span class=\"line\"><span class=\"comment\">//  0, Wait  goroutine</span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(wg *WaitGroup)</span> <span class=\"title\">Add</span><span class=\"params\">(delta <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  wg  1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(wg *WaitGroup)</span> <span class=\"title\">Done</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine  wg  0</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(wg *WaitGroup)</span> <span class=\"title\">Wait</span><span class=\"params\">()</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Once-\"><a href=\"#Once-\" class=\"headerlink\" title=\"Once \"></a><code>Once</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> once sync.Once</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++ &#123;</span><br><span class=\"line\">        once.Do(<span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\" i=%v \\n\"</span>, i)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// .  `once.Do()` ,</span></span><br><span class=\"line\"><span class=\"comment\">//  i=0 </span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Pool-\"><a href=\"#Pool-\" class=\"headerlink\" title=\"Pool \"></a><code>Pool</code> </h2><ul>\n<li> <code>Pool</code>  5 </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"math/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    rand.Seed(time.Now().UnixNano())</span><br><span class=\"line\">    <span class=\"keyword\">var</span> p sync.Pool = sync.Pool&#123;</span><br><span class=\"line\">        New: <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span> <span class=\"title\">interface</span></span>&#123;&#125; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> rand.Intn(<span class=\"number\">100</span>)</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++ &#123;</span><br><span class=\"line\">        fmt.Println(p.Get())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"WaitGroup-\"><a href=\"#WaitGroup-\" class=\"headerlink\" title=\"WaitGroup \"></a><code>WaitGroup</code> </h2><ul>\n<li> <code>WaitGroup</code>  goroutine </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++ &#123;</span><br><span class=\"line\">        wg.Add(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">defer</span> wg.Done()</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\"goroutine %v done\\n\"</span>, i)</span><br><span class=\"line\">        &#125;(i)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    wg.Wait()</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"main goroutine done\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>sync</code> . <code>import &quot;sync&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Locker ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Locker <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Lock()</span><br><span class=\"line\">    Unlock()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine , goroutine , goroutine </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Mutex <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Once <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// ,.,</span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Pool <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// , Get . Get  nil</span></span><br><span class=\"line\">    New <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span> <span class=\"title\">interface</span></span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  goroutine </span></span><br><span class=\"line\"><span class=\"comment\">//  Add  goroutine , goroutine  Done., Wait , goroutine </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> WaitGroup <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Mutex-\"><a href=\"#Mutex-\" class=\"headerlink\" title=\"Mutex \"></a><code>Mutex</code> </h2><p> goroutine , goroutine , goroutine </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `var m sync.Mutex`</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// .,,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(m *Mutex)</span> <span class=\"title\">Lock</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">// .,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(m *Mutex)</span> <span class=\"title\">Unlock</span><span class=\"params\">()</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Once-\"><a href=\"#Once-\" class=\"headerlink\" title=\"Once \"></a><code>Once</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `var o sync.Once`</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  o  Do , f.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(o *Once)</span> <span class=\"title\">Do</span><span class=\"params\">(f <span class=\"keyword\">func</span>()</span>)</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Pool-\"><a href=\"#Pool-\" class=\"headerlink\" title=\"Pool \"></a><code>Pool</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `var p sync.Pool`  `var bufPool sync.Pool = sync.Pool&#123;New: funName&#125;`</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,., p.New ,Get  p.New </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p *Pool)</span> <span class=\"title\">Get</span><span class=\"params\">()</span> <span class=\"title\">interface</span></span>&#123;&#125;</span><br><span class=\"line\"><span class=\"comment\">//  x  p </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p *Pool)</span> <span class=\"title\">Put</span><span class=\"params\">(x <span class=\"keyword\">interface</span>&#123;&#125;)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"WaitGroup-\"><a href=\"#WaitGroup-\" class=\"headerlink\" title=\"WaitGroup \"></a><code>WaitGroup</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `var wg sync.WaitGroup`</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  delta .</span></span><br><span class=\"line\"><span class=\"comment\">//  0, Wait  goroutine</span></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(wg *WaitGroup)</span> <span class=\"title\">Add</span><span class=\"params\">(delta <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  wg  1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(wg *WaitGroup)</span> <span class=\"title\">Done</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"comment\">//  goroutine  wg  0</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(wg *WaitGroup)</span> <span class=\"title\">Wait</span><span class=\"params\">()</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Once-\"><a href=\"#Once-\" class=\"headerlink\" title=\"Once \"></a><code>Once</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> once sync.Once</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++ &#123;</span><br><span class=\"line\">        once.Do(<span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\" i=%v \\n\"</span>, i)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// .  `once.Do()` ,</span></span><br><span class=\"line\"><span class=\"comment\">//  i=0 </span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Pool-\"><a href=\"#Pool-\" class=\"headerlink\" title=\"Pool \"></a><code>Pool</code> </h2><ul>\n<li> <code>Pool</code>  5 </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"math/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    rand.Seed(time.Now().UnixNano())</span><br><span class=\"line\">    <span class=\"keyword\">var</span> p sync.Pool = sync.Pool&#123;</span><br><span class=\"line\">        New: <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span> <span class=\"title\">interface</span></span>&#123;&#125; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> rand.Intn(<span class=\"number\">100</span>)</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++ &#123;</span><br><span class=\"line\">        fmt.Println(p.Get())</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"WaitGroup-\"><a href=\"#WaitGroup-\" class=\"headerlink\" title=\"WaitGroup \"></a><code>WaitGroup</code> </h2><ul>\n<li> <code>WaitGroup</code>  goroutine </li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> wg sync.WaitGroup</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++ &#123;</span><br><span class=\"line\">        wg.Add(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">defer</span> wg.Done()</span><br><span class=\"line\">            fmt.Printf(<span class=\"string\">\"goroutine %v done\\n\"</span>, i)</span><br><span class=\"line\">        &#125;(i)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    wg.Wait()</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"main goroutine done\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"go  time ","abbrlink":46353,"description":" Go time .time ,.","_content":"\n`time` , . `import \"time\"`\n\n# \n\n```go\n// \ntype Weekday int\n\n// \ntype Month int\n\n// ,\ntype Location struct {\n    // \n}\n\n// \ntype Time struct {\n    // \n}\n\n// \ntype Duration int64\n```\n\n# \n\n`time` \n\n```go\n// , 2006-01-02 15:04:05,\n// 2006: , 01: , 02: \n// 15: , 04: , 05: \n// , 2006/06 \nconst (\n    January Month = 1 + iota\n    February\n    March\n    April\n    May\n    June\n    July\n    August\n    September\n    October\n    November\n    December\n)\nconst (\n    Sunday Weekday = iota\n    Monday\n    Tuesday\n    Wednesday\n    Thursday\n    Friday\n    Saturday\n)\nconst (\n    Nanosecond  Duration = 1\n    Microsecond          = 1000 * Nanosecond\n    Millisecond          = 1000 * Microsecond\n    Second               = 1000 * Millisecond\n    Minute               = 60 * Second\n    Hour                 = 60 * Minute\n)\nvar UTC *Location = &utcLoc  // UTC \nvar Local *Location = &localLoc  // \n```\n\n# \n\n## `time` \n\n```go\n//  `Time` \nfunc Now() Time\n//  `Time` \nfunc Date(year int, month Month, day, hour, min, sec, nsec int, loc *Location) Time\n//  layout  `Time` , `error = nil`.\n//  layout  `2006-01-02 15:04:05` , .\nfunc Parse(layout, value string) (Time, error)\n// \nfunc Sleep(d Duration)\n```\n\n## `Time` \n\n```go\n//  layout  t . \nfunc (t Time) Format(layout string) string\n//  January 1, 1970 UTC \nfunc (t Time) Unix() int64\n//  January 1, 1970 UTC \nfunc (t Time) UnixNano() int64\n//  UTC `Time` \nfunc (t Time) UTC() Time\n//  t \nfunc (t Time) Date() (year int, month Month, day int)\n//  t \nfunc (t Time) Clock() (hour, min, sec int)\n//  t  d \nfunc (t Time) Add(d Duration) Time\n// \nfunc (t Time) AddDate(years int, months int, days int) Time\n// \nfunc (t Time) Year() int\n//. Month , int() \nfunc (t Time) Month() Month\n// \nfunc (t Time) Day() int\n// ,[1, 365][1, 366]\nfunc (t Time) YearDay() int\n//   \nfunc (t Time) Hour() int\n// \nfunc (t Time) Minute() int\n// \nfunc (t Time) Second() int\n// \nfunc (t Time) Nanosecond() int\n// ,Weekday, int() \nfunc (t Time) Weekday() Weekday\n//  Location \nfunc (t Time) Location() *Location\n//  Time (\"CET\") UTC \nfunc (t Time) Zone() (name string, offset int)\n// ,  u \nfunc (t Time) After(u Time) bool\n// ,  u \nfunc (t Time) Before(u Time) bool\n//  u \nfunc (t Time) Equal(u Time) bool\n//  t-u \nfunc (t Time) Sub(u Time) Duration\n```\n\n# \n\n## \n\n```go\n// \nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    now := time.Now()\n    // layout ,  1 2 3 4 5 6  , , , , \n    // layout , \n    //  \"yyyy-mm-dd hh:MM:ss\" \n    nowStr := now.Format(\"2006-01-02 15:04:05\")\n\n    // nowStr := now.Format(\"06-1-2 15:4:5\")\n    // nowStr := now.Format(\"01-02 15:04\")\n    \n    fmt.Println(nowStr)\n    str := \"202051 15\"\n    // , layout \n    t := time.Parse(\"200612\", str)\n    fmt.Printf(\"%v, %T\\n\", t, t)\n```","source":"_posts/go-study-notes-package-time.md","raw":"---\ntitle: go  time \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 46353\ndescription: ' Go time .time ,.'\n---\n\n`time` , . `import \"time\"`\n\n# \n\n```go\n// \ntype Weekday int\n\n// \ntype Month int\n\n// ,\ntype Location struct {\n    // \n}\n\n// \ntype Time struct {\n    // \n}\n\n// \ntype Duration int64\n```\n\n# \n\n`time` \n\n```go\n// , 2006-01-02 15:04:05,\n// 2006: , 01: , 02: \n// 15: , 04: , 05: \n// , 2006/06 \nconst (\n    January Month = 1 + iota\n    February\n    March\n    April\n    May\n    June\n    July\n    August\n    September\n    October\n    November\n    December\n)\nconst (\n    Sunday Weekday = iota\n    Monday\n    Tuesday\n    Wednesday\n    Thursday\n    Friday\n    Saturday\n)\nconst (\n    Nanosecond  Duration = 1\n    Microsecond          = 1000 * Nanosecond\n    Millisecond          = 1000 * Microsecond\n    Second               = 1000 * Millisecond\n    Minute               = 60 * Second\n    Hour                 = 60 * Minute\n)\nvar UTC *Location = &utcLoc  // UTC \nvar Local *Location = &localLoc  // \n```\n\n# \n\n## `time` \n\n```go\n//  `Time` \nfunc Now() Time\n//  `Time` \nfunc Date(year int, month Month, day, hour, min, sec, nsec int, loc *Location) Time\n//  layout  `Time` , `error = nil`.\n//  layout  `2006-01-02 15:04:05` , .\nfunc Parse(layout, value string) (Time, error)\n// \nfunc Sleep(d Duration)\n```\n\n## `Time` \n\n```go\n//  layout  t . \nfunc (t Time) Format(layout string) string\n//  January 1, 1970 UTC \nfunc (t Time) Unix() int64\n//  January 1, 1970 UTC \nfunc (t Time) UnixNano() int64\n//  UTC `Time` \nfunc (t Time) UTC() Time\n//  t \nfunc (t Time) Date() (year int, month Month, day int)\n//  t \nfunc (t Time) Clock() (hour, min, sec int)\n//  t  d \nfunc (t Time) Add(d Duration) Time\n// \nfunc (t Time) AddDate(years int, months int, days int) Time\n// \nfunc (t Time) Year() int\n//. Month , int() \nfunc (t Time) Month() Month\n// \nfunc (t Time) Day() int\n// ,[1, 365][1, 366]\nfunc (t Time) YearDay() int\n//   \nfunc (t Time) Hour() int\n// \nfunc (t Time) Minute() int\n// \nfunc (t Time) Second() int\n// \nfunc (t Time) Nanosecond() int\n// ,Weekday, int() \nfunc (t Time) Weekday() Weekday\n//  Location \nfunc (t Time) Location() *Location\n//  Time (\"CET\") UTC \nfunc (t Time) Zone() (name string, offset int)\n// ,  u \nfunc (t Time) After(u Time) bool\n// ,  u \nfunc (t Time) Before(u Time) bool\n//  u \nfunc (t Time) Equal(u Time) bool\n//  t-u \nfunc (t Time) Sub(u Time) Duration\n```\n\n# \n\n## \n\n```go\n// \nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    now := time.Now()\n    // layout ,  1 2 3 4 5 6  , , , , \n    // layout , \n    //  \"yyyy-mm-dd hh:MM:ss\" \n    nowStr := now.Format(\"2006-01-02 15:04:05\")\n\n    // nowStr := now.Format(\"06-1-2 15:4:5\")\n    // nowStr := now.Format(\"01-02 15:04\")\n    \n    fmt.Println(nowStr)\n    str := \"202051 15\"\n    // , layout \n    t := time.Parse(\"200612\", str)\n    fmt.Printf(\"%v, %T\\n\", t, t)\n```","slug":"go-study-notes-package-time","published":1,"date":"2020-05-01T08:18:50.646Z","updated":"2020-05-10T07:10:17.548Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvs0024k8u7hqdy8jub","content":"<p><code>time</code> , . <code>import &quot;time&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Weekday <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Month <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Location <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Time <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Duration <span class=\"keyword\">int64</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>time</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , 2006-01-02 15:04:05,</span></span><br><span class=\"line\"><span class=\"comment\">// 2006: , 01: , 02: </span></span><br><span class=\"line\"><span class=\"comment\">// 15: , 04: , 05: </span></span><br><span class=\"line\"><span class=\"comment\">// , 2006/06 </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    January Month = <span class=\"number\">1</span> + <span class=\"literal\">iota</span></span><br><span class=\"line\">    February</span><br><span class=\"line\">    March</span><br><span class=\"line\">    April</span><br><span class=\"line\">    May</span><br><span class=\"line\">    June</span><br><span class=\"line\">    July</span><br><span class=\"line\">    August</span><br><span class=\"line\">    September</span><br><span class=\"line\">    October</span><br><span class=\"line\">    November</span><br><span class=\"line\">    December</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    Sunday Weekday = <span class=\"literal\">iota</span></span><br><span class=\"line\">    Monday</span><br><span class=\"line\">    Tuesday</span><br><span class=\"line\">    Wednesday</span><br><span class=\"line\">    Thursday</span><br><span class=\"line\">    Friday</span><br><span class=\"line\">    Saturday</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    Nanosecond  Duration = <span class=\"number\">1</span></span><br><span class=\"line\">    Microsecond          = <span class=\"number\">1000</span> * Nanosecond</span><br><span class=\"line\">    Millisecond          = <span class=\"number\">1000</span> * Microsecond</span><br><span class=\"line\">    Second               = <span class=\"number\">1000</span> * Millisecond</span><br><span class=\"line\">    Minute               = <span class=\"number\">60</span> * Second</span><br><span class=\"line\">    Hour                 = <span class=\"number\">60</span> * Minute</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">var</span> UTC *Location = &amp;utcLoc  <span class=\"comment\">// UTC </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Local *Location = &amp;localLoc  <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"time-\"><a href=\"#time-\" class=\"headerlink\" title=\"time \"></a><code>time</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `Time` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Now</span><span class=\"params\">()</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Time` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Date</span><span class=\"params\">(year <span class=\"keyword\">int</span>, month Month, day, hour, min, sec, nsec <span class=\"keyword\">int</span>, loc *Location)</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">//  layout  `Time` , `error = nil`.</span></span><br><span class=\"line\"><span class=\"comment\">//  layout  `2006-01-02 15:04:05` , .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Parse</span><span class=\"params\">(layout, value <span class=\"keyword\">string</span>)</span> <span class=\"params\">(Time, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sleep</span><span class=\"params\">(d Duration)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Time-\"><a href=\"#Time-\" class=\"headerlink\" title=\"Time \"></a><code>Time</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  layout  t . </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Format</span><span class=\"params\">(layout <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  January 1, 1970 UTC </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Unix</span><span class=\"params\">()</span> <span class=\"title\">int64</span></span></span><br><span class=\"line\"><span class=\"comment\">//  January 1, 1970 UTC </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">UnixNano</span><span class=\"params\">()</span> <span class=\"title\">int64</span></span></span><br><span class=\"line\"><span class=\"comment\">//  UTC `Time` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">UTC</span><span class=\"params\">()</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">//  t </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Date</span><span class=\"params\">()</span> <span class=\"params\">(year <span class=\"keyword\">int</span>, month Month, day <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  t </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Clock</span><span class=\"params\">()</span> <span class=\"params\">(hour, min, sec <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  t  d </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Add</span><span class=\"params\">(d Duration)</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">AddDate</span><span class=\"params\">(years <span class=\"keyword\">int</span>, months <span class=\"keyword\">int</span>, days <span class=\"keyword\">int</span>)</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Year</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//. Month , int() </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Month</span><span class=\"params\">()</span> <span class=\"title\">Month</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Day</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,[1, 365][1, 366]</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">YearDay</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//   </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Hour</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Minute</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Second</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Nanosecond</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,Weekday, int() </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Weekday</span><span class=\"params\">()</span> <span class=\"title\">Weekday</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Location </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Location</span><span class=\"params\">()</span> *<span class=\"title\">Location</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Time (\"CET\") UTC </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Zone</span><span class=\"params\">()</span> <span class=\"params\">(name <span class=\"keyword\">string</span>, offset <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,  u </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">After</span><span class=\"params\">(u Time)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,  u </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Before</span><span class=\"params\">(u Time)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  u </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Equal</span><span class=\"params\">(u Time)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  t-u </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Sub</span><span class=\"params\">(u Time)</span> <span class=\"title\">Duration</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    now := time.Now()</span><br><span class=\"line\">    <span class=\"comment\">// layout ,  1 2 3 4 5 6  , , , , </span></span><br><span class=\"line\">    <span class=\"comment\">// layout , </span></span><br><span class=\"line\">    <span class=\"comment\">//  \"yyyy-mm-dd hh:MM:ss\" </span></span><br><span class=\"line\">    nowStr := now.Format(<span class=\"string\">\"2006-01-02 15:04:05\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// nowStr := now.Format(\"06-1-2 15:4:5\")</span></span><br><span class=\"line\">    <span class=\"comment\">// nowStr := now.Format(\"01-02 15:04\")</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    fmt.Println(nowStr)</span><br><span class=\"line\">    str := <span class=\"string\">\"202051 15\"</span></span><br><span class=\"line\">    <span class=\"comment\">// , layout </span></span><br><span class=\"line\">    t := time.Parse(<span class=\"string\">\"200612\"</span>, str)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v, %T\\n\"</span>, t, t)</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p><code>time</code> , . <code>import &quot;time&quot;</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Weekday <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Month <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Location <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Time <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Duration <span class=\"keyword\">int64</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>time</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , 2006-01-02 15:04:05,</span></span><br><span class=\"line\"><span class=\"comment\">// 2006: , 01: , 02: </span></span><br><span class=\"line\"><span class=\"comment\">// 15: , 04: , 05: </span></span><br><span class=\"line\"><span class=\"comment\">// , 2006/06 </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    January Month = <span class=\"number\">1</span> + <span class=\"literal\">iota</span></span><br><span class=\"line\">    February</span><br><span class=\"line\">    March</span><br><span class=\"line\">    April</span><br><span class=\"line\">    May</span><br><span class=\"line\">    June</span><br><span class=\"line\">    July</span><br><span class=\"line\">    August</span><br><span class=\"line\">    September</span><br><span class=\"line\">    October</span><br><span class=\"line\">    November</span><br><span class=\"line\">    December</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    Sunday Weekday = <span class=\"literal\">iota</span></span><br><span class=\"line\">    Monday</span><br><span class=\"line\">    Tuesday</span><br><span class=\"line\">    Wednesday</span><br><span class=\"line\">    Thursday</span><br><span class=\"line\">    Friday</span><br><span class=\"line\">    Saturday</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    Nanosecond  Duration = <span class=\"number\">1</span></span><br><span class=\"line\">    Microsecond          = <span class=\"number\">1000</span> * Nanosecond</span><br><span class=\"line\">    Millisecond          = <span class=\"number\">1000</span> * Microsecond</span><br><span class=\"line\">    Second               = <span class=\"number\">1000</span> * Millisecond</span><br><span class=\"line\">    Minute               = <span class=\"number\">60</span> * Second</span><br><span class=\"line\">    Hour                 = <span class=\"number\">60</span> * Minute</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">var</span> UTC *Location = &amp;utcLoc  <span class=\"comment\">// UTC </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Local *Location = &amp;localLoc  <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"time-\"><a href=\"#time-\" class=\"headerlink\" title=\"time \"></a><code>time</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  `Time` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Now</span><span class=\"params\">()</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">//  `Time` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Date</span><span class=\"params\">(year <span class=\"keyword\">int</span>, month Month, day, hour, min, sec, nsec <span class=\"keyword\">int</span>, loc *Location)</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">//  layout  `Time` , `error = nil`.</span></span><br><span class=\"line\"><span class=\"comment\">//  layout  `2006-01-02 15:04:05` , .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Parse</span><span class=\"params\">(layout, value <span class=\"keyword\">string</span>)</span> <span class=\"params\">(Time, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sleep</span><span class=\"params\">(d Duration)</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Time-\"><a href=\"#Time-\" class=\"headerlink\" title=\"Time \"></a><code>Time</code> </h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  layout  t . </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Format</span><span class=\"params\">(layout <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"comment\">//  January 1, 1970 UTC </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Unix</span><span class=\"params\">()</span> <span class=\"title\">int64</span></span></span><br><span class=\"line\"><span class=\"comment\">//  January 1, 1970 UTC </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">UnixNano</span><span class=\"params\">()</span> <span class=\"title\">int64</span></span></span><br><span class=\"line\"><span class=\"comment\">//  UTC `Time` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">UTC</span><span class=\"params\">()</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">//  t </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Date</span><span class=\"params\">()</span> <span class=\"params\">(year <span class=\"keyword\">int</span>, month Month, day <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  t </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Clock</span><span class=\"params\">()</span> <span class=\"params\">(hour, min, sec <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  t  d </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Add</span><span class=\"params\">(d Duration)</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">AddDate</span><span class=\"params\">(years <span class=\"keyword\">int</span>, months <span class=\"keyword\">int</span>, days <span class=\"keyword\">int</span>)</span> <span class=\"title\">Time</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Year</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//. Month , int() </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Month</span><span class=\"params\">()</span> <span class=\"title\">Month</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Day</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,[1, 365][1, 366]</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">YearDay</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">//   </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Hour</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Minute</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Second</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Nanosecond</span><span class=\"params\">()</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,Weekday, int() </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Weekday</span><span class=\"params\">()</span> <span class=\"title\">Weekday</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Location </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Location</span><span class=\"params\">()</span> *<span class=\"title\">Location</span></span></span><br><span class=\"line\"><span class=\"comment\">//  Time (\"CET\") UTC </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Zone</span><span class=\"params\">()</span> <span class=\"params\">(name <span class=\"keyword\">string</span>, offset <span class=\"keyword\">int</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,  u </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">After</span><span class=\"params\">(u Time)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">// ,  u </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Before</span><span class=\"params\">(u Time)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  u </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Equal</span><span class=\"params\">(u Time)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"comment\">//  t-u </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(t Time)</span> <span class=\"title\">Sub</span><span class=\"params\">(u Time)</span> <span class=\"title\">Duration</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    now := time.Now()</span><br><span class=\"line\">    <span class=\"comment\">// layout ,  1 2 3 4 5 6  , , , , </span></span><br><span class=\"line\">    <span class=\"comment\">// layout , </span></span><br><span class=\"line\">    <span class=\"comment\">//  \"yyyy-mm-dd hh:MM:ss\" </span></span><br><span class=\"line\">    nowStr := now.Format(<span class=\"string\">\"2006-01-02 15:04:05\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// nowStr := now.Format(\"06-1-2 15:4:5\")</span></span><br><span class=\"line\">    <span class=\"comment\">// nowStr := now.Format(\"01-02 15:04\")</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    fmt.Println(nowStr)</span><br><span class=\"line\">    str := <span class=\"string\">\"202051 15\"</span></span><br><span class=\"line\">    <span class=\"comment\">// , layout </span></span><br><span class=\"line\">    t := time.Parse(<span class=\"string\">\"200612\"</span>, str)</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%v, %T\\n\"</span>, t, t)</span><br></pre></td></tr></table></figure>"},{"title":"go ","abbrlink":19238,"description":" Go , ,  Go .","_content":"\n## \n\n `GOPATH` ( `go env` ),  src, bin, pkg . `src` , `bin,pkg`  `go install/get` , (), .\n\n GOPATH . , GOPATH , Unix  `:`, Windows  `;`. `go get` .\n\n## \n\nGo (package), (package) Go .\n\n,  `package pacakgeName ` .\n\n, :\n\n- , \n- , ,  `-` \n- ,,  GitHub  `GOPATH/src/github.com/userName/projectName` \n-  `main` ,  main \n- , \n\n### \n\n,  `import` . `import` . :\n\n```go\nimport \"path/to/package\"\n// \nimport (\n    \"path/to/package1\"\n    //\"path/to/package2\"\n)\n```\n\n,  `\"\"` ,  `GOPATG/src/` ,  `/` . , `import \"custom/lib\"`  `GOPATH/src/custom/lib` .\n\n 4 :\n\n1. : `import \"fmt\"`\n2. : `import f \"fmt\"`,  `f.`  `fmt.`  fmt . \n3. : `import . \"fmt\"`,  `fmt.`  `fmt` ,  `fmt.Println()` -> `Println()`\n4. : `import _ \"fmt\"`,  `init()` , \n\n, :\n\n- \n-  `init()` ,  `init()` , ,  `init()`  `init()` .\n- ,  a  b, b  c, c  a, \n- ,  Go  `init()` \n- ** `internal` ()()**\n\n```\nsrc/\n|\n+-- main.go\n|\n+-- lib/            #  internal/{a, b}  lib, lib/x, lib/x/y \n|    |\n|\t +-- internal/  # \n|\t |      |\n|    |      +-- a/  # ,  lib/x/y\n|\t |      |\n|    |      +-- b/\n|\t |\n|    +-- x/\n|        |\n|        +-- y\n|\n+-- z/              # z  lib/internal ,  lib/x \n```\n\n main  main , Go . , ,  `init()` ,,  `main.main` .\n\n1.  main , , \n2. , , ,  init \n\n![Go ](go-study-notes-package/package_initialization_process_in_go.jpg)\n\n### \n\n, . , ,  java  `public`. , ,  `private`.\n\n, ,  Get/Set .\n```go\n// src/model/person.go\npackage model\n\ntype person struct {\n    Name string\n    age int // \n}\n\nfunc NewPerson(name string) *person {\n    return &person{name}\n}\n\nfunc (p *person) SetAge(age int) {\n    p.age = age\n}\nfunc (p *person) GetAge() int {\n    return p.age\n}\n```\n```go\n// src/main.go\npackage main\n\nimport (\n    \"fmt\"\n    \"model\"\n)\nfunc main() {\n    p := model.NewPerson(\"smith\")\n    p.SetAge(18)\n    fmt.Println(p)\n    fmt.Println(p.Name, \" age =\", p.GetAge())\n}\n```\n\n## \n\nGo Modules  Go ,  Go 1.11 ,  Go 1.12 , Go 1.13 , .\n\nGo Modules  `go.mod`  `go.sum` . \n\n`go.mod` (), Go , `module`, `require`, `replace`  `exclude`  go module .\n\n- `module` ()\n- `require` \n- `replace` \n- `exclude` \n\n\n[github.com/gin-gonic/gin](https://github.com/gin-gonic) :  \n```\nmodule github.com/gin-gonic/gin\n\ngo 1.13\n\nrequire (\n\tgithub.com/gin-contrib/sse v0.1.0\n\tgithub.com/go-playground/validator/v10 v10.2.0\n\tgithub.com/golang/protobuf v1.3.3\n\tgithub.com/json-iterator/go v1.1.9\n\tgithub.com/mattn/go-isatty v0.0.12\n\tgithub.com/stretchr/testify v1.4.0\n\tgithub.com/ugorji/go/codec v1.1.7\n\tgopkg.in/yaml.v2 v2.2.8\n)\n```\n\n`go.sum` , :\n\n```\ngithub.com/davecgh/go-spew v1.1.0/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/davecgh/go-spew v1.1.1 h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=\ngithub.com/davecgh/go-spew v1.1.1/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/gin-contrib/sse v0.1.0 h1:Y/yl/+YNO8GZSjAhjMsSuLt29uWRFHdHYUb5lYOV9qE=\n// ...\n```\n\n Go Modules ?\n\n###  go module \n\n- go  >= v1.11\n-  `GO111MODULE`  on. \n\n`GO111MODULE` ,  `auto`\n- `on`:  go module,  GOPATH  vendor  go.mod \n- `off`:  go module,  GOPATH  vendor \n- `auto`:  GOPATH/src ,  go.mod  go module\n\n `GOPROXY` .\n\n```\ngo env -w GOPROXY=https://goproxy.cn,direct\n\nexport GOPROXY=https://goproxy.cn\n```\n: \n\n```\nhttps://goproxy.io/\nhttps://goproxy.cn/\nhttps://mirrors.aliyun.com/goproxy/\n````\n\n###  go module \n\n```\n#  go module,  go.mod , module  go \ngo mod init  [module_name]\n#  module,  go.mod , ,\ngo mod tidy\n```","source":"_posts/go-study-notes-package.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 19238\ndescription: ' Go , ,  Go .'\n---\n\n## \n\n `GOPATH` ( `go env` ),  src, bin, pkg . `src` , `bin,pkg`  `go install/get` , (), .\n\n GOPATH . , GOPATH , Unix  `:`, Windows  `;`. `go get` .\n\n## \n\nGo (package), (package) Go .\n\n,  `package pacakgeName ` .\n\n, :\n\n- , \n- , ,  `-` \n- ,,  GitHub  `GOPATH/src/github.com/userName/projectName` \n-  `main` ,  main \n- , \n\n### \n\n,  `import` . `import` . :\n\n```go\nimport \"path/to/package\"\n// \nimport (\n    \"path/to/package1\"\n    //\"path/to/package2\"\n)\n```\n\n,  `\"\"` ,  `GOPATG/src/` ,  `/` . , `import \"custom/lib\"`  `GOPATH/src/custom/lib` .\n\n 4 :\n\n1. : `import \"fmt\"`\n2. : `import f \"fmt\"`,  `f.`  `fmt.`  fmt . \n3. : `import . \"fmt\"`,  `fmt.`  `fmt` ,  `fmt.Println()` -> `Println()`\n4. : `import _ \"fmt\"`,  `init()` , \n\n, :\n\n- \n-  `init()` ,  `init()` , ,  `init()`  `init()` .\n- ,  a  b, b  c, c  a, \n- ,  Go  `init()` \n- ** `internal` ()()**\n\n```\nsrc/\n|\n+-- main.go\n|\n+-- lib/            #  internal/{a, b}  lib, lib/x, lib/x/y \n|    |\n|\t +-- internal/  # \n|\t |      |\n|    |      +-- a/  # ,  lib/x/y\n|\t |      |\n|    |      +-- b/\n|\t |\n|    +-- x/\n|        |\n|        +-- y\n|\n+-- z/              # z  lib/internal ,  lib/x \n```\n\n main  main , Go . , ,  `init()` ,,  `main.main` .\n\n1.  main , , \n2. , , ,  init \n\n![Go ](go-study-notes-package/package_initialization_process_in_go.jpg)\n\n### \n\n, . , ,  java  `public`. , ,  `private`.\n\n, ,  Get/Set .\n```go\n// src/model/person.go\npackage model\n\ntype person struct {\n    Name string\n    age int // \n}\n\nfunc NewPerson(name string) *person {\n    return &person{name}\n}\n\nfunc (p *person) SetAge(age int) {\n    p.age = age\n}\nfunc (p *person) GetAge() int {\n    return p.age\n}\n```\n```go\n// src/main.go\npackage main\n\nimport (\n    \"fmt\"\n    \"model\"\n)\nfunc main() {\n    p := model.NewPerson(\"smith\")\n    p.SetAge(18)\n    fmt.Println(p)\n    fmt.Println(p.Name, \" age =\", p.GetAge())\n}\n```\n\n## \n\nGo Modules  Go ,  Go 1.11 ,  Go 1.12 , Go 1.13 , .\n\nGo Modules  `go.mod`  `go.sum` . \n\n`go.mod` (), Go , `module`, `require`, `replace`  `exclude`  go module .\n\n- `module` ()\n- `require` \n- `replace` \n- `exclude` \n\n\n[github.com/gin-gonic/gin](https://github.com/gin-gonic) :  \n```\nmodule github.com/gin-gonic/gin\n\ngo 1.13\n\nrequire (\n\tgithub.com/gin-contrib/sse v0.1.0\n\tgithub.com/go-playground/validator/v10 v10.2.0\n\tgithub.com/golang/protobuf v1.3.3\n\tgithub.com/json-iterator/go v1.1.9\n\tgithub.com/mattn/go-isatty v0.0.12\n\tgithub.com/stretchr/testify v1.4.0\n\tgithub.com/ugorji/go/codec v1.1.7\n\tgopkg.in/yaml.v2 v2.2.8\n)\n```\n\n`go.sum` , :\n\n```\ngithub.com/davecgh/go-spew v1.1.0/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/davecgh/go-spew v1.1.1 h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=\ngithub.com/davecgh/go-spew v1.1.1/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/gin-contrib/sse v0.1.0 h1:Y/yl/+YNO8GZSjAhjMsSuLt29uWRFHdHYUb5lYOV9qE=\n// ...\n```\n\n Go Modules ?\n\n###  go module \n\n- go  >= v1.11\n-  `GO111MODULE`  on. \n\n`GO111MODULE` ,  `auto`\n- `on`:  go module,  GOPATH  vendor  go.mod \n- `off`:  go module,  GOPATH  vendor \n- `auto`:  GOPATH/src ,  go.mod  go module\n\n `GOPROXY` .\n\n```\ngo env -w GOPROXY=https://goproxy.cn,direct\n\nexport GOPROXY=https://goproxy.cn\n```\n: \n\n```\nhttps://goproxy.io/\nhttps://goproxy.cn/\nhttps://mirrors.aliyun.com/goproxy/\n````\n\n###  go module \n\n```\n#  go module,  go.mod , module  go \ngo mod init  [module_name]\n#  module,  go.mod , ,\ngo mod tidy\n```","slug":"go-study-notes-package","published":1,"date":"2020-04-30T10:55:23.489Z","updated":"2020-05-04T13:55:21.930Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvt0027k8u736ychkpd","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> <code>GOPATH</code> ( <code>go env</code> ),  src, bin, pkg . <code>src</code> , <code>bin,pkg</code>  <code>go install/get</code> , (), .</p>\n<p> GOPATH . , GOPATH , Unix  <code>:</code>, Windows  <code>;</code>. <code>go get</code> .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Go (package), (package) Go .</p>\n<p>,  <code>package pacakgeName</code> .</p>\n<p>, :</p>\n<ul>\n<li>, </li>\n<li>, ,  <code>-</code> </li>\n<li>,,  GitHub  <code>GOPATH/src/github.com/userName/projectName</code> </li>\n<li> <code>main</code> ,  main </li>\n<li>, </li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,  <code>import</code> . <code>import</code> . :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"path/to/package\"</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"path/to/package1\"</span></span><br><span class=\"line\">    <span class=\"comment\">//\"path/to/package2\"</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>,  <code>&quot;&quot;</code> ,  <code>GOPATG/src/</code> ,  <code>/</code> . , <code>import &quot;custom/lib&quot;</code>  <code>GOPATH/src/custom/lib</code> .</p>\n<p> 4 :</p>\n<ol>\n<li>: <code>import &quot;fmt&quot;</code></li>\n<li>: <code>import f &quot;fmt&quot;</code>,  <code>f.</code>  <code>fmt.</code>  fmt . </li>\n<li>: <code>import . &quot;fmt&quot;</code>,  <code>fmt.</code>  <code>fmt</code> ,  <code>fmt.Println()</code> -&gt; <code>Println()</code></li>\n<li>: <code>import _ &quot;fmt&quot;</code>,  <code>init()</code> , </li>\n</ol>\n<p>, :</p>\n<ul>\n<li></li>\n<li> <code>init()</code> ,  <code>init()</code> , ,  <code>init()</code>  <code>init()</code> .</li>\n<li>,  a  b, b  c, c  a, </li>\n<li>,  Go  <code>init()</code> </li>\n<li><strong> <code>internal</code> ()()</strong></li>\n</ul>\n<figure class=\"highlight gherkin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">src/</span><br><span class=\"line\">|</span><br><span class=\"line\"><span class=\"string\">+-- main.go</span></span><br><span class=\"line\">|</span><br><span class=\"line\">+-- lib/            <span class=\"comment\">#  internal/&#123;a, b&#125;  lib, lib/x, lib/x/y </span></span><br><span class=\"line\">|<span class=\"string\">    </span>|</span><br><span class=\"line\">|<span class=\"string\">\t +-- internal/  # </span></span><br><span class=\"line\">|<span class=\"string\">\t </span>|<span class=\"string\">      </span>|</span><br><span class=\"line\">|<span class=\"string\">    </span>|<span class=\"string\">      +-- a/  # ,  lib/x/y</span></span><br><span class=\"line\">|<span class=\"string\">\t </span>|<span class=\"string\">      </span>|</span><br><span class=\"line\">|<span class=\"string\">    </span>|<span class=\"string\">      +-- b/</span></span><br><span class=\"line\">|<span class=\"string\">\t </span>|</span><br><span class=\"line\">|<span class=\"string\">    +-- x/</span></span><br><span class=\"line\">|<span class=\"string\">        </span>|</span><br><span class=\"line\">|<span class=\"string\">        +-- y</span></span><br><span class=\"line\">|</span><br><span class=\"line\">+-- z/              <span class=\"comment\"># z  lib/internal ,  lib/x </span></span><br></pre></td></tr></table></figure>\n\n<p> main  main , Go . , ,  <code>init()</code> ,,  <code>main.main</code> .</p>\n<ol>\n<li> main , , </li>\n<li>, , ,  init </li>\n</ol>\n<p><img src=\"/2020/04/30/go-study-notes-package/package_initialization_process_in_go.jpg\" alt=\"Go \"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>, . , ,  java  <code>public</code>. , ,  <code>private</code>.</p>\n<p>, ,  Get/Set .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/model/person.go</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> model</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> person <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Name <span class=\"keyword\">string</span></span><br><span class=\"line\">    age <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewPerson</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> *<span class=\"title\">person</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &amp;person&#123;name&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p *person)</span> <span class=\"title\">SetAge</span><span class=\"params\">(age <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    p.age = age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p *person)</span> <span class=\"title\">GetAge</span><span class=\"params\">()</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p.age</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/main.go</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"model\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    p := model.NewPerson(<span class=\"string\">\"smith\"</span>)</span><br><span class=\"line\">    p.SetAge(<span class=\"number\">18</span>)</span><br><span class=\"line\">    fmt.Println(p)</span><br><span class=\"line\">    fmt.Println(p.Name, <span class=\"string\">\" age =\"</span>, p.GetAge())</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Go Modules  Go ,  Go 1.11 ,  Go 1.12 , Go 1.13 , .</p>\n<p>Go Modules  <code>go.mod</code>  <code>go.sum</code> . </p>\n<p><code>go.mod</code> (), Go , <code>module</code>, <code>require</code>, <code>replace</code>  <code>exclude</code>  go module .</p>\n<ul>\n<li><code>module</code> ()</li>\n<li><code>require</code> </li>\n<li><code>replace</code> </li>\n<li><code>exclude</code> </li>\n</ul>\n<p><a href=\"https://github.com/gin-gonic\" target=\"_blank\" rel=\"noopener\">github.com/gin-gonic/gin</a> :  </p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">module github.com/gin-gonic/gin</span><br><span class=\"line\"></span><br><span class=\"line\">go <span class=\"number\">1.13</span></span><br><span class=\"line\"></span><br><span class=\"line\">require (</span><br><span class=\"line\">\tgithub.com/gin-contrib/sse v0<span class=\"number\">.1</span><span class=\"number\">.0</span></span><br><span class=\"line\">\tgithub.com/go-playground/validator/v10 v10<span class=\"number\">.2</span><span class=\"number\">.0</span></span><br><span class=\"line\">\tgithub.com/golang/protobuf v1<span class=\"number\">.3</span><span class=\"number\">.3</span></span><br><span class=\"line\">\tgithub.com/json-iterator/go v1<span class=\"number\">.1</span><span class=\"number\">.9</span></span><br><span class=\"line\">\tgithub.com/mattn/go-isatty v0<span class=\"number\">.0</span><span class=\"number\">.12</span></span><br><span class=\"line\">\tgithub.com/stretchr/testify v1<span class=\"number\">.4</span><span class=\"number\">.0</span></span><br><span class=\"line\">\tgithub.com/ugorji/go/codec v1<span class=\"number\">.1</span><span class=\"number\">.7</span></span><br><span class=\"line\">\tgopkg.<span class=\"keyword\">in</span>/yaml.v2 v2<span class=\"number\">.2</span><span class=\"number\">.8</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p><code>go.sum</code> , :</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">github.<span class=\"keyword\">com</span>/davecgh/<span class=\"keyword\">go</span>-spew v1.<span class=\"number\">1.0</span>/<span class=\"keyword\">go</span>.<span class=\"keyword\">mod</span> h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=</span><br><span class=\"line\">github.<span class=\"keyword\">com</span>/davecgh/<span class=\"keyword\">go</span>-spew v1.<span class=\"number\">1.1</span> h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=</span><br><span class=\"line\">github.<span class=\"keyword\">com</span>/davecgh/<span class=\"keyword\">go</span>-spew v1.<span class=\"number\">1.1</span>/<span class=\"keyword\">go</span>.<span class=\"keyword\">mod</span> h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=</span><br><span class=\"line\">github.<span class=\"keyword\">com</span>/gin-contrib/sse v0.<span class=\"number\">1.0</span> h1:Y/yl/+YNO8GZSjAhjMsSuLt29uWRFHdHYUb5lYOV9qE=</span><br><span class=\"line\">// ...</span><br></pre></td></tr></table></figure>\n\n<p> Go Modules ?</p>\n<h3 id=\"-go-module-\"><a href=\"#-go-module-\" class=\"headerlink\" title=\" go module \"></a> go module </h3><ul>\n<li>go  &gt;= v1.11</li>\n<li> <code>GO111MODULE</code>  on. </li>\n</ul>\n<p><code>GO111MODULE</code> ,  <code>auto</code></p>\n<ul>\n<li><code>on</code>:  go module,  GOPATH  vendor  go.mod </li>\n<li><code>off</code>:  go module,  GOPATH  vendor </li>\n<li><code>auto</code>:  GOPATH/src ,  go.mod  go module</li>\n</ul>\n<p> <code>GOPROXY</code> .</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go env -w <span class=\"attribute\">GOPROXY</span>=https://goproxy.cn,direct</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"builtin-name\">export</span> <span class=\"attribute\">GOPROXY</span>=https://goproxy.cn</span><br></pre></td></tr></table></figure>\n<p>: </p>\n<figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">https:</span><span class=\"comment\">//goproxy.io/</span></span><br><span class=\"line\"><span class=\"symbol\">https:</span><span class=\"comment\">//goproxy.cn/</span></span><br><span class=\"line\"><span class=\"symbol\">https:</span><span class=\"comment\">//mirrors.aliyun.com/goproxy/</span></span><br><span class=\"line\">`</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-go-module-\"><a href=\"#-go-module-\" class=\"headerlink\" title=\" go module \"></a> go module </h3><figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#  <span class=\"built_in\">go</span> module,  <span class=\"built_in\">go</span>.<span class=\"built_in\">mod</span> , module  <span class=\"built_in\">go</span> </span><br><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">mod</span> init  [module_name]</span><br><span class=\"line\">#  module,  <span class=\"built_in\">go</span>.<span class=\"built_in\">mod</span> , ,</span><br><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">mod</span> tidy</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> <code>GOPATH</code> ( <code>go env</code> ),  src, bin, pkg . <code>src</code> , <code>bin,pkg</code>  <code>go install/get</code> , (), .</p>\n<p> GOPATH . , GOPATH , Unix  <code>:</code>, Windows  <code>;</code>. <code>go get</code> .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Go (package), (package) Go .</p>\n<p>,  <code>package pacakgeName</code> .</p>\n<p>, :</p>\n<ul>\n<li>, </li>\n<li>, ,  <code>-</code> </li>\n<li>,,  GitHub  <code>GOPATH/src/github.com/userName/projectName</code> </li>\n<li> <code>main</code> ,  main </li>\n<li>, </li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,  <code>import</code> . <code>import</code> . :</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"path/to/package\"</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"path/to/package1\"</span></span><br><span class=\"line\">    <span class=\"comment\">//\"path/to/package2\"</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>,  <code>&quot;&quot;</code> ,  <code>GOPATG/src/</code> ,  <code>/</code> . , <code>import &quot;custom/lib&quot;</code>  <code>GOPATH/src/custom/lib</code> .</p>\n<p> 4 :</p>\n<ol>\n<li>: <code>import &quot;fmt&quot;</code></li>\n<li>: <code>import f &quot;fmt&quot;</code>,  <code>f.</code>  <code>fmt.</code>  fmt . </li>\n<li>: <code>import . &quot;fmt&quot;</code>,  <code>fmt.</code>  <code>fmt</code> ,  <code>fmt.Println()</code> -&gt; <code>Println()</code></li>\n<li>: <code>import _ &quot;fmt&quot;</code>,  <code>init()</code> , </li>\n</ol>\n<p>, :</p>\n<ul>\n<li></li>\n<li> <code>init()</code> ,  <code>init()</code> , ,  <code>init()</code>  <code>init()</code> .</li>\n<li>,  a  b, b  c, c  a, </li>\n<li>,  Go  <code>init()</code> </li>\n<li><strong> <code>internal</code> ()()</strong></li>\n</ul>\n<figure class=\"highlight gherkin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">src/</span><br><span class=\"line\">|</span><br><span class=\"line\"><span class=\"string\">+-- main.go</span></span><br><span class=\"line\">|</span><br><span class=\"line\">+-- lib/            <span class=\"comment\">#  internal/&#123;a, b&#125;  lib, lib/x, lib/x/y </span></span><br><span class=\"line\">|<span class=\"string\">    </span>|</span><br><span class=\"line\">|<span class=\"string\">\t +-- internal/  # </span></span><br><span class=\"line\">|<span class=\"string\">\t </span>|<span class=\"string\">      </span>|</span><br><span class=\"line\">|<span class=\"string\">    </span>|<span class=\"string\">      +-- a/  # ,  lib/x/y</span></span><br><span class=\"line\">|<span class=\"string\">\t </span>|<span class=\"string\">      </span>|</span><br><span class=\"line\">|<span class=\"string\">    </span>|<span class=\"string\">      +-- b/</span></span><br><span class=\"line\">|<span class=\"string\">\t </span>|</span><br><span class=\"line\">|<span class=\"string\">    +-- x/</span></span><br><span class=\"line\">|<span class=\"string\">        </span>|</span><br><span class=\"line\">|<span class=\"string\">        +-- y</span></span><br><span class=\"line\">|</span><br><span class=\"line\">+-- z/              <span class=\"comment\"># z  lib/internal ,  lib/x </span></span><br></pre></td></tr></table></figure>\n\n<p> main  main , Go . , ,  <code>init()</code> ,,  <code>main.main</code> .</p>\n<ol>\n<li> main , , </li>\n<li>, , ,  init </li>\n</ol>\n<p><img src=\"/2020/04/30/go-study-notes-package/package_initialization_process_in_go.jpg\" alt=\"Go \"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>, . , ,  java  <code>public</code>. , ,  <code>private</code>.</p>\n<p>, ,  Get/Set .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/model/person.go</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> model</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> person <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Name <span class=\"keyword\">string</span></span><br><span class=\"line\">    age <span class=\"keyword\">int</span> <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewPerson</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> *<span class=\"title\">person</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &amp;person&#123;name&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p *person)</span> <span class=\"title\">SetAge</span><span class=\"params\">(age <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    p.age = age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(p *person)</span> <span class=\"title\">GetAge</span><span class=\"params\">()</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p.age</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/main.go</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"model\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    p := model.NewPerson(<span class=\"string\">\"smith\"</span>)</span><br><span class=\"line\">    p.SetAge(<span class=\"number\">18</span>)</span><br><span class=\"line\">    fmt.Println(p)</span><br><span class=\"line\">    fmt.Println(p.Name, <span class=\"string\">\" age =\"</span>, p.GetAge())</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Go Modules  Go ,  Go 1.11 ,  Go 1.12 , Go 1.13 , .</p>\n<p>Go Modules  <code>go.mod</code>  <code>go.sum</code> . </p>\n<p><code>go.mod</code> (), Go , <code>module</code>, <code>require</code>, <code>replace</code>  <code>exclude</code>  go module .</p>\n<ul>\n<li><code>module</code> ()</li>\n<li><code>require</code> </li>\n<li><code>replace</code> </li>\n<li><code>exclude</code> </li>\n</ul>\n<p><a href=\"https://github.com/gin-gonic\" target=\"_blank\" rel=\"noopener\">github.com/gin-gonic/gin</a> :  </p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">module github.com/gin-gonic/gin</span><br><span class=\"line\"></span><br><span class=\"line\">go <span class=\"number\">1.13</span></span><br><span class=\"line\"></span><br><span class=\"line\">require (</span><br><span class=\"line\">\tgithub.com/gin-contrib/sse v0<span class=\"number\">.1</span><span class=\"number\">.0</span></span><br><span class=\"line\">\tgithub.com/go-playground/validator/v10 v10<span class=\"number\">.2</span><span class=\"number\">.0</span></span><br><span class=\"line\">\tgithub.com/golang/protobuf v1<span class=\"number\">.3</span><span class=\"number\">.3</span></span><br><span class=\"line\">\tgithub.com/json-iterator/go v1<span class=\"number\">.1</span><span class=\"number\">.9</span></span><br><span class=\"line\">\tgithub.com/mattn/go-isatty v0<span class=\"number\">.0</span><span class=\"number\">.12</span></span><br><span class=\"line\">\tgithub.com/stretchr/testify v1<span class=\"number\">.4</span><span class=\"number\">.0</span></span><br><span class=\"line\">\tgithub.com/ugorji/go/codec v1<span class=\"number\">.1</span><span class=\"number\">.7</span></span><br><span class=\"line\">\tgopkg.<span class=\"keyword\">in</span>/yaml.v2 v2<span class=\"number\">.2</span><span class=\"number\">.8</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p><code>go.sum</code> , :</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">github.<span class=\"keyword\">com</span>/davecgh/<span class=\"keyword\">go</span>-spew v1.<span class=\"number\">1.0</span>/<span class=\"keyword\">go</span>.<span class=\"keyword\">mod</span> h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=</span><br><span class=\"line\">github.<span class=\"keyword\">com</span>/davecgh/<span class=\"keyword\">go</span>-spew v1.<span class=\"number\">1.1</span> h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=</span><br><span class=\"line\">github.<span class=\"keyword\">com</span>/davecgh/<span class=\"keyword\">go</span>-spew v1.<span class=\"number\">1.1</span>/<span class=\"keyword\">go</span>.<span class=\"keyword\">mod</span> h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=</span><br><span class=\"line\">github.<span class=\"keyword\">com</span>/gin-contrib/sse v0.<span class=\"number\">1.0</span> h1:Y/yl/+YNO8GZSjAhjMsSuLt29uWRFHdHYUb5lYOV9qE=</span><br><span class=\"line\">// ...</span><br></pre></td></tr></table></figure>\n\n<p> Go Modules ?</p>\n<h3 id=\"-go-module-\"><a href=\"#-go-module-\" class=\"headerlink\" title=\" go module \"></a> go module </h3><ul>\n<li>go  &gt;= v1.11</li>\n<li> <code>GO111MODULE</code>  on. </li>\n</ul>\n<p><code>GO111MODULE</code> ,  <code>auto</code></p>\n<ul>\n<li><code>on</code>:  go module,  GOPATH  vendor  go.mod </li>\n<li><code>off</code>:  go module,  GOPATH  vendor </li>\n<li><code>auto</code>:  GOPATH/src ,  go.mod  go module</li>\n</ul>\n<p> <code>GOPROXY</code> .</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go env -w <span class=\"attribute\">GOPROXY</span>=https://goproxy.cn,direct</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"builtin-name\">export</span> <span class=\"attribute\">GOPROXY</span>=https://goproxy.cn</span><br></pre></td></tr></table></figure>\n<p>: </p>\n<figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">https:</span><span class=\"comment\">//goproxy.io/</span></span><br><span class=\"line\"><span class=\"symbol\">https:</span><span class=\"comment\">//goproxy.cn/</span></span><br><span class=\"line\"><span class=\"symbol\">https:</span><span class=\"comment\">//mirrors.aliyun.com/goproxy/</span></span><br><span class=\"line\">`</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-go-module-\"><a href=\"#-go-module-\" class=\"headerlink\" title=\" go module \"></a> go module </h3><figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#  <span class=\"built_in\">go</span> module,  <span class=\"built_in\">go</span>.<span class=\"built_in\">mod</span> , module  <span class=\"built_in\">go</span> </span><br><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">mod</span> init  [module_name]</span><br><span class=\"line\">#  module,  <span class=\"built_in\">go</span>.<span class=\"built_in\">mod</span> , ,</span><br><span class=\"line\"><span class=\"built_in\">go</span> <span class=\"built_in\">mod</span> tidy</span><br></pre></td></tr></table></figure>"},{"title":"istio","abbrlink":63298,"description":"Istio 4 .","_content":"\n> \n\n,,,,, APM(Application Performance Management,) ,,.\n\n> \n\nIstio  Envoy , Mixer , Envoy , Envoy .Envoy  Mixer \n\n Mixer Adapter ,, Envoy , Adapter,,\n\n# \n\n## \n,:\n1. Envoy  Mixer\n2. Mixer \n\n Envoy  Mixer,Mixer\n,\n\n## \n\n> \n\nEnvoy  Istio (Attribute)., Mixer ,EnvoyMixerMixer,\n\n\n> \n\n```\ndestination_service: destination.service\nresponse_code: response.code\ndestination_version: destination.labels[\"version\"] | \"unknown\"\n```\n < istio>  4-1\n\n> Mixer\n\nIstio  `Handler`(),`Instance`() `Rule`() Adapter \n\n- `Handler`\n\nHandler  Adapters , Adapter .Handler  Adapter ,\n\n\n```yaml\napiVersion: \"config.istio.io/v1alpha2\"\nkind: stdio\nmetadata:\n  name: handler\n  namespace: istio-system\nspec:\n  outputAsJson: true\n---\napiVersion: \"config.istio.io/v1alpha2\"\nkind: prometheus\nmetadata:\n  name: handler\n  namespace: istio-system\nspec:\n  metrics:\n  - name: requests_total\n    instance_name: requestcount.metric.istio-system\n    kind: COUNTER\n    label_names:\n    - reporter\n    - source_app\n    - source_principal\n    - source_workload\n    - source_workload_namespace\n    - source_version\n    - destination_app\n    - destination_principal\n    - destination_workload\n    - destination_workload_namespace\n    - destination_version\n    - destination_service\n    - destination_service_name\n    - destination_service_namespace\n    - request_protocol\n    - response_code\n    - connection_security_policy\n  - name: request_duration_seconds\n    instance_name: requestduration.metric.istio-system\n    kind: DISTRIBUTION\n    label_names:\n    - reporter\n    - source_app\n    - source_principal\n    - source_workload\n    - source_workload_namespace\n    - source_version\n    - destination_app\n    - destination_principal\n    - destination_workload\n    - destination_workload_namespace\n    - destination_version\n    - destination_service\n    - destination_service_name\n    - destination_service_namespace\n    - request_protocol\n    - response_code\n    - connection_security_policy\n    buckets:\n      explicit_buckets:\n        bounds: [0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1, 2.5, 5, 10]\n```\n\n- `Instance`\n\nInstance  Adapter , Adapter .Mixer  Instance \n\n:\n```yaml\napiVersion: \"config.istio.io/v1alpha2\"\nkind: logentry\nmetadata:\n  name: accesslog\n  namespace: istio-system\nspec:\n  severity: '\"Info\"'\n  timestamp: request.time\n  variables:\n    sourceIp: source.ip | ip(\"0.0.0.0\")\n    sourceApp: source.labels[\"app\"] | \"\"\n    sourcePrincipal: source.principal | \"\"\n    sourceName: source.name | \"\"\n    sourceWorkload: source.workload.name | \"\"\n    sourceNamespace: source.namespace | \"\"\n    sourceOwner: source.owner | \"\"\n    destinationApp: destination.labels[\"app\"] | \"\"\n    destinationIp: destination.ip | ip(\"0.0.0.0\")\n    destinationServiceHost: destination.service.host | \"\"\n    destinationWorkload: destination.workload.name | \"\"\n    destinationName: destination.name | \"\"\n    destinationNamespace: destination.namespace | \"\"\n    destinationOwner: destination.owner | \"\"\n    destinationPrincipal: destination.principal | \"\"\n    apiClaims: request.auth.raw_claims | \"\"\n    apiKey: request.api_key | request.headers[\"x-api-key\"] | \"\"\n    protocol: request.scheme | context.protocol | \"http\"\n    method: request.method | \"\"\n    url: request.path | \"\"\n    responseCode: response.code | 0\n    responseSize: response.size | 0\n    requestSize: request.size | 0\n    requestId: request.headers[\"x-request-id\"] | \"\"\n    clientTraceId: request.headers[\"x-client-trace-id\"] | \"\"\n    latency: response.duration | \"0ms\"\n    connection_security_policy: conditional((context.reporter.kind | \"inbound\") == \"outbound\", \"unknown\", conditional(connection.mtls | false, \"mutual_tls\", \"none\"))\n    requestedServerName: connection.requested_server_name | \"\"\n    userAgent: request.useragent | \"\"\n    responseTimestamp: response.time\n    receivedBytes: request.total_size | 0\n    sentBytes: response.total_size | 0\n    referer: request.referer | \"\"\n    httpAuthority: request.headers[\":authority\"] | request.host | \"\"\n    xForwardedFor: request.headers[\"x-forwarded-for\"] | \"0.0.0.0\"\n    reporter: conditional((context.reporter.kind | \"inbound\") == \"outbound\", \"source\", \"destination\")\n  monitored_resource_type: '\"global\"'\n---\napiVersion: \"config.istio.io/v1alpha2\"\nkind: metric\nmetadata:\n  name: requestcount\n  namespace: istio-system\nspec:\n  value: \"1\"\n  dimensions:\n    reporter: conditional((context.reporter.kind | \"inbound\") == \"outbound\", \"source\", \"destination\")\n    source_workload: source.workload.name | \"unknown\"\n    source_workload_namespace: source.workload.namespace | \"unknown\"\n    source_principal: source.principal | \"unknown\"\n    source_app: source.labels[\"app\"] | \"unknown\"\n    source_version: source.labels[\"version\"] | \"unknown\"\n    destination_workload: destination.workload.name | \"unknown\"\n    destination_workload_namespace: destination.workload.namespace | \"unknown\"\n    destination_principal: destination.principal | \"unknown\"\n    destination_app: destination.labels[\"app\"] | \"unknown\"\n    destination_version: destination.labels[\"version\"] | \"unknown\"\n    destination_service: destination.service.host | \"unknown\"\n    destination_service_name: destination.service.name | \"unknown\"\n    destination_service_namespace: destination.service.namespace | \"unknown\"\n    request_protocol: api.protocol | context.protocol | \"unknown\"\n    response_code: response.code | 200\n    connection_security_policy: conditional((context.reporter.kind | \"inbound\") == \"outbound\", \"unknown\", conditional(connection.mtls | false, \"mutual_tls\", \"none\"))\n  monitored_resource_type: '\"UNSPECIFIED\"'\n```\n\n- `Rule`\n\nRule , Mixer  Instance  Handler ,(action) Adapter, Action  Adapter  Instance \n\n\n\n |  | \n:---: | :---: | :---:\nmatch |  | ,,\nactions |  | ,. handler  instance , handler  instance (, `<name.kind>`)\n\n\n```yaml\napiVersion: \"config.istio.io/v1alpha2\"\nkind: rule\nmetadata:\n  name: stdio\n  namespace: istio-system\nspec:\n  match: context.protocol == \"http\" || context.protocol == \"grpc\"\n  actions:\n  - handler: handler.stdio\n    instances:\n    - accesslog.logentry\n---\napiVersion: \"config.istio.io/v1alpha2\"\nkind: rule\nmetadata:\n  name: promhttp\n  namespace: istio-system\nspec:\n  match: context.protocol == \"http\" || context.protocol == \"grpc\"\n  actions:\n  - handler: handler.prometheus\n    instances:\n    - requestcount.metric\n    - requestduration.metric\n    - requestsize.metric\n    - responsesize.metric\n```\n\n# \n\n## Prometheus \n\n> \n\n1. Envoy  Report  Mixer\n2. Mixer  Prometheus Adapter\n3. Prometheus Adapter  HTTP  Metric \n4. Prometheus  Addon , Metric , Query \n5.  Dashboard(Grafana) Prometheus  API  Metric \n\n> handler \n\nhandler  `metrics`, Prometheus  metrics.,\n\n- `name`: metric \n- `instance_name`: instance , `<instance_name.kind.namespace>`\n- `kind`: , `COUNTER`, `DISTRIBUTION`.DISTRIBUTION  buckets\n- `label_names`: , instance \n\n> instance \n\ninstance  `dimensions`  `value`,.. key  prometheus-metrics \n\n> rule \n\nRule  Handler  Instance, `match`  `actions`,","source":"_posts/istio-adapter-configuration.md","raw":"---\ntitle: istio\ntags:\n  - istio\n  - \ncategories:\n  - \n  - istio\nabbrlink: 63298\ndescription: Istio 4 .\n---\n\n> \n\n,,,,, APM(Application Performance Management,) ,,.\n\n> \n\nIstio  Envoy , Mixer , Envoy , Envoy .Envoy  Mixer \n\n Mixer Adapter ,, Envoy , Adapter,,\n\n# \n\n## \n,:\n1. Envoy  Mixer\n2. Mixer \n\n Envoy  Mixer,Mixer\n,\n\n## \n\n> \n\nEnvoy  Istio (Attribute)., Mixer ,EnvoyMixerMixer,\n\n\n> \n\n```\ndestination_service: destination.service\nresponse_code: response.code\ndestination_version: destination.labels[\"version\"] | \"unknown\"\n```\n < istio>  4-1\n\n> Mixer\n\nIstio  `Handler`(),`Instance`() `Rule`() Adapter \n\n- `Handler`\n\nHandler  Adapters , Adapter .Handler  Adapter ,\n\n\n```yaml\napiVersion: \"config.istio.io/v1alpha2\"\nkind: stdio\nmetadata:\n  name: handler\n  namespace: istio-system\nspec:\n  outputAsJson: true\n---\napiVersion: \"config.istio.io/v1alpha2\"\nkind: prometheus\nmetadata:\n  name: handler\n  namespace: istio-system\nspec:\n  metrics:\n  - name: requests_total\n    instance_name: requestcount.metric.istio-system\n    kind: COUNTER\n    label_names:\n    - reporter\n    - source_app\n    - source_principal\n    - source_workload\n    - source_workload_namespace\n    - source_version\n    - destination_app\n    - destination_principal\n    - destination_workload\n    - destination_workload_namespace\n    - destination_version\n    - destination_service\n    - destination_service_name\n    - destination_service_namespace\n    - request_protocol\n    - response_code\n    - connection_security_policy\n  - name: request_duration_seconds\n    instance_name: requestduration.metric.istio-system\n    kind: DISTRIBUTION\n    label_names:\n    - reporter\n    - source_app\n    - source_principal\n    - source_workload\n    - source_workload_namespace\n    - source_version\n    - destination_app\n    - destination_principal\n    - destination_workload\n    - destination_workload_namespace\n    - destination_version\n    - destination_service\n    - destination_service_name\n    - destination_service_namespace\n    - request_protocol\n    - response_code\n    - connection_security_policy\n    buckets:\n      explicit_buckets:\n        bounds: [0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1, 2.5, 5, 10]\n```\n\n- `Instance`\n\nInstance  Adapter , Adapter .Mixer  Instance \n\n:\n```yaml\napiVersion: \"config.istio.io/v1alpha2\"\nkind: logentry\nmetadata:\n  name: accesslog\n  namespace: istio-system\nspec:\n  severity: '\"Info\"'\n  timestamp: request.time\n  variables:\n    sourceIp: source.ip | ip(\"0.0.0.0\")\n    sourceApp: source.labels[\"app\"] | \"\"\n    sourcePrincipal: source.principal | \"\"\n    sourceName: source.name | \"\"\n    sourceWorkload: source.workload.name | \"\"\n    sourceNamespace: source.namespace | \"\"\n    sourceOwner: source.owner | \"\"\n    destinationApp: destination.labels[\"app\"] | \"\"\n    destinationIp: destination.ip | ip(\"0.0.0.0\")\n    destinationServiceHost: destination.service.host | \"\"\n    destinationWorkload: destination.workload.name | \"\"\n    destinationName: destination.name | \"\"\n    destinationNamespace: destination.namespace | \"\"\n    destinationOwner: destination.owner | \"\"\n    destinationPrincipal: destination.principal | \"\"\n    apiClaims: request.auth.raw_claims | \"\"\n    apiKey: request.api_key | request.headers[\"x-api-key\"] | \"\"\n    protocol: request.scheme | context.protocol | \"http\"\n    method: request.method | \"\"\n    url: request.path | \"\"\n    responseCode: response.code | 0\n    responseSize: response.size | 0\n    requestSize: request.size | 0\n    requestId: request.headers[\"x-request-id\"] | \"\"\n    clientTraceId: request.headers[\"x-client-trace-id\"] | \"\"\n    latency: response.duration | \"0ms\"\n    connection_security_policy: conditional((context.reporter.kind | \"inbound\") == \"outbound\", \"unknown\", conditional(connection.mtls | false, \"mutual_tls\", \"none\"))\n    requestedServerName: connection.requested_server_name | \"\"\n    userAgent: request.useragent | \"\"\n    responseTimestamp: response.time\n    receivedBytes: request.total_size | 0\n    sentBytes: response.total_size | 0\n    referer: request.referer | \"\"\n    httpAuthority: request.headers[\":authority\"] | request.host | \"\"\n    xForwardedFor: request.headers[\"x-forwarded-for\"] | \"0.0.0.0\"\n    reporter: conditional((context.reporter.kind | \"inbound\") == \"outbound\", \"source\", \"destination\")\n  monitored_resource_type: '\"global\"'\n---\napiVersion: \"config.istio.io/v1alpha2\"\nkind: metric\nmetadata:\n  name: requestcount\n  namespace: istio-system\nspec:\n  value: \"1\"\n  dimensions:\n    reporter: conditional((context.reporter.kind | \"inbound\") == \"outbound\", \"source\", \"destination\")\n    source_workload: source.workload.name | \"unknown\"\n    source_workload_namespace: source.workload.namespace | \"unknown\"\n    source_principal: source.principal | \"unknown\"\n    source_app: source.labels[\"app\"] | \"unknown\"\n    source_version: source.labels[\"version\"] | \"unknown\"\n    destination_workload: destination.workload.name | \"unknown\"\n    destination_workload_namespace: destination.workload.namespace | \"unknown\"\n    destination_principal: destination.principal | \"unknown\"\n    destination_app: destination.labels[\"app\"] | \"unknown\"\n    destination_version: destination.labels[\"version\"] | \"unknown\"\n    destination_service: destination.service.host | \"unknown\"\n    destination_service_name: destination.service.name | \"unknown\"\n    destination_service_namespace: destination.service.namespace | \"unknown\"\n    request_protocol: api.protocol | context.protocol | \"unknown\"\n    response_code: response.code | 200\n    connection_security_policy: conditional((context.reporter.kind | \"inbound\") == \"outbound\", \"unknown\", conditional(connection.mtls | false, \"mutual_tls\", \"none\"))\n  monitored_resource_type: '\"UNSPECIFIED\"'\n```\n\n- `Rule`\n\nRule , Mixer  Instance  Handler ,(action) Adapter, Action  Adapter  Instance \n\n\n\n |  | \n:---: | :---: | :---:\nmatch |  | ,,\nactions |  | ,. handler  instance , handler  instance (, `<name.kind>`)\n\n\n```yaml\napiVersion: \"config.istio.io/v1alpha2\"\nkind: rule\nmetadata:\n  name: stdio\n  namespace: istio-system\nspec:\n  match: context.protocol == \"http\" || context.protocol == \"grpc\"\n  actions:\n  - handler: handler.stdio\n    instances:\n    - accesslog.logentry\n---\napiVersion: \"config.istio.io/v1alpha2\"\nkind: rule\nmetadata:\n  name: promhttp\n  namespace: istio-system\nspec:\n  match: context.protocol == \"http\" || context.protocol == \"grpc\"\n  actions:\n  - handler: handler.prometheus\n    instances:\n    - requestcount.metric\n    - requestduration.metric\n    - requestsize.metric\n    - responsesize.metric\n```\n\n# \n\n## Prometheus \n\n> \n\n1. Envoy  Report  Mixer\n2. Mixer  Prometheus Adapter\n3. Prometheus Adapter  HTTP  Metric \n4. Prometheus  Addon , Metric , Query \n5.  Dashboard(Grafana) Prometheus  API  Metric \n\n> handler \n\nhandler  `metrics`, Prometheus  metrics.,\n\n- `name`: metric \n- `instance_name`: instance , `<instance_name.kind.namespace>`\n- `kind`: , `COUNTER`, `DISTRIBUTION`.DISTRIBUTION  buckets\n- `label_names`: , instance \n\n> instance \n\ninstance  `dimensions`  `value`,.. key  prometheus-metrics \n\n> rule \n\nRule  Handler  Instance, `match`  `actions`,","slug":"istio-adapter-configuration","published":1,"date":"2020-04-03T08:44:40.175Z","updated":"2020-04-30T11:01:49.966Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvu002ak8u779kibbly","content":"<blockquote>\n<p></p>\n</blockquote>\n<p>,,,,, APM(Application Performance Management,) ,,.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>Istio  Envoy , Mixer , Envoy , Envoy .Envoy  Mixer </p>\n<p> Mixer Adapter ,, Envoy , Adapter,,</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,:</p>\n<ol>\n<li>Envoy  Mixer</li>\n<li>Mixer </li>\n</ol>\n<p> Envoy  Mixer,Mixer<br>,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p></p>\n</blockquote>\n<p>Envoy  Istio (Attribute)., Mixer ,EnvoyMixerMixer,<br></p>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight avrasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">destination_service:</span> destination.service</span><br><span class=\"line\"><span class=\"symbol\">response_code:</span> response.code</span><br><span class=\"line\"><span class=\"symbol\">destination_version:</span> destination.labels[<span class=\"string\">\"version\"</span>] | <span class=\"string\">\"unknown\"</span></span><br></pre></td></tr></table></figure>\n<p> &lt; istio&gt;  4-1</p>\n<blockquote>\n<p>Mixer</p>\n</blockquote>\n<p>Istio  <code>Handler</code>(),<code>Instance</code>() <code>Rule</code>() Adapter </p>\n<ul>\n<li><code>Handler</code></li>\n</ul>\n<p>Handler  Adapters , Adapter .Handler  Adapter ,</p>\n<p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">stdio</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">handler</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">outputAsJson:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">prometheus</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">handler</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">metrics:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">requests_total</span></span><br><span class=\"line\">    <span class=\"attr\">instance_name:</span> <span class=\"string\">requestcount.metric.istio-system</span></span><br><span class=\"line\">    <span class=\"attr\">kind:</span> <span class=\"string\">COUNTER</span></span><br><span class=\"line\">    <span class=\"attr\">label_names:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">reporter</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_app</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_principal</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_workload</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_workload_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_app</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_principal</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_workload</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_workload_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service_name</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">request_protocol</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">response_code</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">connection_security_policy</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">request_duration_seconds</span></span><br><span class=\"line\">    <span class=\"attr\">instance_name:</span> <span class=\"string\">requestduration.metric.istio-system</span></span><br><span class=\"line\">    <span class=\"attr\">kind:</span> <span class=\"string\">DISTRIBUTION</span></span><br><span class=\"line\">    <span class=\"attr\">label_names:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">reporter</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_app</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_principal</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_workload</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_workload_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_app</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_principal</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_workload</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_workload_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service_name</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">request_protocol</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">response_code</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">connection_security_policy</span></span><br><span class=\"line\">    <span class=\"attr\">buckets:</span></span><br><span class=\"line\">      <span class=\"attr\">explicit_buckets:</span></span><br><span class=\"line\">        <span class=\"attr\">bounds:</span> <span class=\"string\">[0.005,</span> <span class=\"number\">0.01</span><span class=\"string\">,</span> <span class=\"number\">0.025</span><span class=\"string\">,</span> <span class=\"number\">0.05</span><span class=\"string\">,</span> <span class=\"number\">0.1</span><span class=\"string\">,</span> <span class=\"number\">0.25</span><span class=\"string\">,</span> <span class=\"number\">0.5</span><span class=\"string\">,</span> <span class=\"number\">1</span><span class=\"string\">,</span> <span class=\"number\">2.5</span><span class=\"string\">,</span> <span class=\"number\">5</span><span class=\"string\">,</span> <span class=\"number\">10</span><span class=\"string\">]</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>Instance</code></li>\n</ul>\n<p>Instance  Adapter , Adapter .Mixer  Instance </p>\n<p>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">logentry</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">accesslog</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">severity:</span> <span class=\"string\">'\"Info\"'</span></span><br><span class=\"line\">  <span class=\"attr\">timestamp:</span> <span class=\"string\">request.time</span></span><br><span class=\"line\">  <span class=\"attr\">variables:</span></span><br><span class=\"line\">    <span class=\"attr\">sourceIp:</span> <span class=\"string\">source.ip</span> <span class=\"string\">|</span> <span class=\"string\">ip(\"0.0.0.0\")</span></span><br><span class=\"line\">    <span class=\"attr\">sourceApp:</span> <span class=\"string\">source.labels[\"app\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourcePrincipal:</span> <span class=\"string\">source.principal</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourceName:</span> <span class=\"string\">source.name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourceWorkload:</span> <span class=\"string\">source.workload.name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourceNamespace:</span> <span class=\"string\">source.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourceOwner:</span> <span class=\"string\">source.owner</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationApp:</span> <span class=\"string\">destination.labels[\"app\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationIp:</span> <span class=\"string\">destination.ip</span> <span class=\"string\">|</span> <span class=\"string\">ip(\"0.0.0.0\")</span></span><br><span class=\"line\">    <span class=\"attr\">destinationServiceHost:</span> <span class=\"string\">destination.service.host</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationWorkload:</span> <span class=\"string\">destination.workload.name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationName:</span> <span class=\"string\">destination.name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationNamespace:</span> <span class=\"string\">destination.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationOwner:</span> <span class=\"string\">destination.owner</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationPrincipal:</span> <span class=\"string\">destination.principal</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">apiClaims:</span> <span class=\"string\">request.auth.raw_claims</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">apiKey:</span> <span class=\"string\">request.api_key</span> <span class=\"string\">|</span> <span class=\"string\">request.headers[\"x-api-key\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">protocol:</span> <span class=\"string\">request.scheme</span> <span class=\"string\">|</span> <span class=\"string\">context.protocol</span> <span class=\"string\">|</span> <span class=\"string\">\"http\"</span></span><br><span class=\"line\">    <span class=\"attr\">method:</span> <span class=\"string\">request.method</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">request.path</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">responseCode:</span> <span class=\"string\">response.code</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">responseSize:</span> <span class=\"string\">response.size</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">requestSize:</span> <span class=\"string\">request.size</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">requestId:</span> <span class=\"string\">request.headers[\"x-request-id\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">clientTraceId:</span> <span class=\"string\">request.headers[\"x-client-trace-id\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">latency:</span> <span class=\"string\">response.duration</span> <span class=\"string\">|</span> <span class=\"string\">\"0ms\"</span></span><br><span class=\"line\">    <span class=\"attr\">connection_security_policy:</span> <span class=\"string\">conditional((context.reporter.kind</span> <span class=\"string\">|</span> <span class=\"string\">\"inbound\"</span><span class=\"string\">)</span> <span class=\"string\">==</span> <span class=\"string\">\"outbound\"</span><span class=\"string\">,</span> <span class=\"string\">\"unknown\"</span><span class=\"string\">,</span> <span class=\"string\">conditional(connection.mtls</span> <span class=\"string\">|</span> <span class=\"literal\">false</span><span class=\"string\">,</span> <span class=\"string\">\"mutual_tls\"</span><span class=\"string\">,</span> <span class=\"string\">\"none\"</span><span class=\"string\">))</span></span><br><span class=\"line\">    <span class=\"attr\">requestedServerName:</span> <span class=\"string\">connection.requested_server_name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">userAgent:</span> <span class=\"string\">request.useragent</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">responseTimestamp:</span> <span class=\"string\">response.time</span></span><br><span class=\"line\">    <span class=\"attr\">receivedBytes:</span> <span class=\"string\">request.total_size</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">sentBytes:</span> <span class=\"string\">response.total_size</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">referer:</span> <span class=\"string\">request.referer</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">httpAuthority:</span> <span class=\"string\">request.headers[\":authority\"]</span> <span class=\"string\">|</span> <span class=\"string\">request.host</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">xForwardedFor:</span> <span class=\"string\">request.headers[\"x-forwarded-for\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"0.0.0.0\"</span></span><br><span class=\"line\">    <span class=\"attr\">reporter:</span> <span class=\"string\">conditional((context.reporter.kind</span> <span class=\"string\">|</span> <span class=\"string\">\"inbound\"</span><span class=\"string\">)</span> <span class=\"string\">==</span> <span class=\"string\">\"outbound\"</span><span class=\"string\">,</span> <span class=\"string\">\"source\"</span><span class=\"string\">,</span> <span class=\"string\">\"destination\"</span><span class=\"string\">)</span></span><br><span class=\"line\">  <span class=\"attr\">monitored_resource_type:</span> <span class=\"string\">'\"global\"'</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">metric</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">requestcount</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">value:</span> <span class=\"string\">\"1\"</span></span><br><span class=\"line\">  <span class=\"attr\">dimensions:</span></span><br><span class=\"line\">    <span class=\"attr\">reporter:</span> <span class=\"string\">conditional((context.reporter.kind</span> <span class=\"string\">|</span> <span class=\"string\">\"inbound\"</span><span class=\"string\">)</span> <span class=\"string\">==</span> <span class=\"string\">\"outbound\"</span><span class=\"string\">,</span> <span class=\"string\">\"source\"</span><span class=\"string\">,</span> <span class=\"string\">\"destination\"</span><span class=\"string\">)</span></span><br><span class=\"line\">    <span class=\"attr\">source_workload:</span> <span class=\"string\">source.workload.name</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">source_workload_namespace:</span> <span class=\"string\">source.workload.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">source_principal:</span> <span class=\"string\">source.principal</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">source_app:</span> <span class=\"string\">source.labels[\"app\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">source_version:</span> <span class=\"string\">source.labels[\"version\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_workload:</span> <span class=\"string\">destination.workload.name</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_workload_namespace:</span> <span class=\"string\">destination.workload.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_principal:</span> <span class=\"string\">destination.principal</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_app:</span> <span class=\"string\">destination.labels[\"app\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_version:</span> <span class=\"string\">destination.labels[\"version\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_service:</span> <span class=\"string\">destination.service.host</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_service_name:</span> <span class=\"string\">destination.service.name</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_service_namespace:</span> <span class=\"string\">destination.service.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">request_protocol:</span> <span class=\"string\">api.protocol</span> <span class=\"string\">|</span> <span class=\"string\">context.protocol</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">response_code:</span> <span class=\"string\">response.code</span> <span class=\"string\">|</span> <span class=\"number\">200</span></span><br><span class=\"line\">    <span class=\"attr\">connection_security_policy:</span> <span class=\"string\">conditional((context.reporter.kind</span> <span class=\"string\">|</span> <span class=\"string\">\"inbound\"</span><span class=\"string\">)</span> <span class=\"string\">==</span> <span class=\"string\">\"outbound\"</span><span class=\"string\">,</span> <span class=\"string\">\"unknown\"</span><span class=\"string\">,</span> <span class=\"string\">conditional(connection.mtls</span> <span class=\"string\">|</span> <span class=\"literal\">false</span><span class=\"string\">,</span> <span class=\"string\">\"mutual_tls\"</span><span class=\"string\">,</span> <span class=\"string\">\"none\"</span><span class=\"string\">))</span></span><br><span class=\"line\">  <span class=\"attr\">monitored_resource_type:</span> <span class=\"string\">'\"UNSPECIFIED\"'</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>Rule</code></li>\n</ul>\n<p>Rule , Mixer  Instance  Handler ,(action) Adapter, Action  Adapter  Instance </p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">match</td>\n<td align=\"center\"></td>\n<td align=\"center\">,,</td>\n</tr>\n<tr>\n<td align=\"center\">actions</td>\n<td align=\"center\"></td>\n<td align=\"center\">,. handler  instance , handler  instance (, <code>&lt;name.kind&gt;</code>)</td>\n</tr>\n</tbody></table>\n<p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">rule</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">stdio</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">match:</span> <span class=\"string\">context.protocol</span> <span class=\"string\">==</span> <span class=\"string\">\"http\"</span> <span class=\"string\">||</span> <span class=\"string\">context.protocol</span> <span class=\"string\">==</span> <span class=\"string\">\"grpc\"</span></span><br><span class=\"line\">  <span class=\"attr\">actions:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">handler:</span> <span class=\"string\">handler.stdio</span></span><br><span class=\"line\">    <span class=\"attr\">instances:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">accesslog.logentry</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">rule</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">promhttp</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">match:</span> <span class=\"string\">context.protocol</span> <span class=\"string\">==</span> <span class=\"string\">\"http\"</span> <span class=\"string\">||</span> <span class=\"string\">context.protocol</span> <span class=\"string\">==</span> <span class=\"string\">\"grpc\"</span></span><br><span class=\"line\">  <span class=\"attr\">actions:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">handler:</span> <span class=\"string\">handler.prometheus</span></span><br><span class=\"line\">    <span class=\"attr\">instances:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">requestcount.metric</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">requestduration.metric</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">requestsize.metric</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">responsesize.metric</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Prometheus-\"><a href=\"#Prometheus-\" class=\"headerlink\" title=\"Prometheus \"></a>Prometheus </h2><blockquote>\n<p></p>\n</blockquote>\n<ol>\n<li>Envoy  Report  Mixer</li>\n<li>Mixer  Prometheus Adapter</li>\n<li>Prometheus Adapter  HTTP  Metric </li>\n<li>Prometheus  Addon , Metric , Query </li>\n<li> Dashboard(Grafana) Prometheus  API  Metric </li>\n</ol>\n<blockquote>\n<p>handler </p>\n</blockquote>\n<p>handler  <code>metrics</code>, Prometheus  metrics.,</p>\n<ul>\n<li><code>name</code>: metric </li>\n<li><code>instance_name</code>: instance , <code>&lt;instance_name.kind.namespace&gt;</code></li>\n<li><code>kind</code>: , <code>COUNTER</code>, <code>DISTRIBUTION</code>.DISTRIBUTION  buckets</li>\n<li><code>label_names</code>: , instance </li>\n</ul>\n<blockquote>\n<p>instance </p>\n</blockquote>\n<p>instance  <code>dimensions</code>  <code>value</code>,.. key  prometheus-metrics </p>\n<blockquote>\n<p>rule </p>\n</blockquote>\n<p>Rule  Handler  Instance, <code>match</code>  <code>actions</code>,</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p></p>\n</blockquote>\n<p>,,,,, APM(Application Performance Management,) ,,.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>Istio  Envoy , Mixer , Envoy , Envoy .Envoy  Mixer </p>\n<p> Mixer Adapter ,, Envoy , Adapter,,</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,:</p>\n<ol>\n<li>Envoy  Mixer</li>\n<li>Mixer </li>\n</ol>\n<p> Envoy  Mixer,Mixer<br>,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p></p>\n</blockquote>\n<p>Envoy  Istio (Attribute)., Mixer ,EnvoyMixerMixer,<br></p>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight avrasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">destination_service:</span> destination.service</span><br><span class=\"line\"><span class=\"symbol\">response_code:</span> response.code</span><br><span class=\"line\"><span class=\"symbol\">destination_version:</span> destination.labels[<span class=\"string\">\"version\"</span>] | <span class=\"string\">\"unknown\"</span></span><br></pre></td></tr></table></figure>\n<p> &lt; istio&gt;  4-1</p>\n<blockquote>\n<p>Mixer</p>\n</blockquote>\n<p>Istio  <code>Handler</code>(),<code>Instance</code>() <code>Rule</code>() Adapter </p>\n<ul>\n<li><code>Handler</code></li>\n</ul>\n<p>Handler  Adapters , Adapter .Handler  Adapter ,</p>\n<p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">stdio</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">handler</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">outputAsJson:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">prometheus</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">handler</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">metrics:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">requests_total</span></span><br><span class=\"line\">    <span class=\"attr\">instance_name:</span> <span class=\"string\">requestcount.metric.istio-system</span></span><br><span class=\"line\">    <span class=\"attr\">kind:</span> <span class=\"string\">COUNTER</span></span><br><span class=\"line\">    <span class=\"attr\">label_names:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">reporter</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_app</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_principal</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_workload</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_workload_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_app</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_principal</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_workload</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_workload_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service_name</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">request_protocol</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">response_code</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">connection_security_policy</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">request_duration_seconds</span></span><br><span class=\"line\">    <span class=\"attr\">instance_name:</span> <span class=\"string\">requestduration.metric.istio-system</span></span><br><span class=\"line\">    <span class=\"attr\">kind:</span> <span class=\"string\">DISTRIBUTION</span></span><br><span class=\"line\">    <span class=\"attr\">label_names:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">reporter</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_app</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_principal</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_workload</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_workload_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">source_version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_app</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_principal</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_workload</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_workload_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service_name</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">destination_service_namespace</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">request_protocol</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">response_code</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">connection_security_policy</span></span><br><span class=\"line\">    <span class=\"attr\">buckets:</span></span><br><span class=\"line\">      <span class=\"attr\">explicit_buckets:</span></span><br><span class=\"line\">        <span class=\"attr\">bounds:</span> <span class=\"string\">[0.005,</span> <span class=\"number\">0.01</span><span class=\"string\">,</span> <span class=\"number\">0.025</span><span class=\"string\">,</span> <span class=\"number\">0.05</span><span class=\"string\">,</span> <span class=\"number\">0.1</span><span class=\"string\">,</span> <span class=\"number\">0.25</span><span class=\"string\">,</span> <span class=\"number\">0.5</span><span class=\"string\">,</span> <span class=\"number\">1</span><span class=\"string\">,</span> <span class=\"number\">2.5</span><span class=\"string\">,</span> <span class=\"number\">5</span><span class=\"string\">,</span> <span class=\"number\">10</span><span class=\"string\">]</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>Instance</code></li>\n</ul>\n<p>Instance  Adapter , Adapter .Mixer  Instance </p>\n<p>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">logentry</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">accesslog</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">severity:</span> <span class=\"string\">'\"Info\"'</span></span><br><span class=\"line\">  <span class=\"attr\">timestamp:</span> <span class=\"string\">request.time</span></span><br><span class=\"line\">  <span class=\"attr\">variables:</span></span><br><span class=\"line\">    <span class=\"attr\">sourceIp:</span> <span class=\"string\">source.ip</span> <span class=\"string\">|</span> <span class=\"string\">ip(\"0.0.0.0\")</span></span><br><span class=\"line\">    <span class=\"attr\">sourceApp:</span> <span class=\"string\">source.labels[\"app\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourcePrincipal:</span> <span class=\"string\">source.principal</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourceName:</span> <span class=\"string\">source.name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourceWorkload:</span> <span class=\"string\">source.workload.name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourceNamespace:</span> <span class=\"string\">source.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">sourceOwner:</span> <span class=\"string\">source.owner</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationApp:</span> <span class=\"string\">destination.labels[\"app\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationIp:</span> <span class=\"string\">destination.ip</span> <span class=\"string\">|</span> <span class=\"string\">ip(\"0.0.0.0\")</span></span><br><span class=\"line\">    <span class=\"attr\">destinationServiceHost:</span> <span class=\"string\">destination.service.host</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationWorkload:</span> <span class=\"string\">destination.workload.name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationName:</span> <span class=\"string\">destination.name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationNamespace:</span> <span class=\"string\">destination.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationOwner:</span> <span class=\"string\">destination.owner</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">destinationPrincipal:</span> <span class=\"string\">destination.principal</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">apiClaims:</span> <span class=\"string\">request.auth.raw_claims</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">apiKey:</span> <span class=\"string\">request.api_key</span> <span class=\"string\">|</span> <span class=\"string\">request.headers[\"x-api-key\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">protocol:</span> <span class=\"string\">request.scheme</span> <span class=\"string\">|</span> <span class=\"string\">context.protocol</span> <span class=\"string\">|</span> <span class=\"string\">\"http\"</span></span><br><span class=\"line\">    <span class=\"attr\">method:</span> <span class=\"string\">request.method</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">request.path</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">responseCode:</span> <span class=\"string\">response.code</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">responseSize:</span> <span class=\"string\">response.size</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">requestSize:</span> <span class=\"string\">request.size</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">requestId:</span> <span class=\"string\">request.headers[\"x-request-id\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">clientTraceId:</span> <span class=\"string\">request.headers[\"x-client-trace-id\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">latency:</span> <span class=\"string\">response.duration</span> <span class=\"string\">|</span> <span class=\"string\">\"0ms\"</span></span><br><span class=\"line\">    <span class=\"attr\">connection_security_policy:</span> <span class=\"string\">conditional((context.reporter.kind</span> <span class=\"string\">|</span> <span class=\"string\">\"inbound\"</span><span class=\"string\">)</span> <span class=\"string\">==</span> <span class=\"string\">\"outbound\"</span><span class=\"string\">,</span> <span class=\"string\">\"unknown\"</span><span class=\"string\">,</span> <span class=\"string\">conditional(connection.mtls</span> <span class=\"string\">|</span> <span class=\"literal\">false</span><span class=\"string\">,</span> <span class=\"string\">\"mutual_tls\"</span><span class=\"string\">,</span> <span class=\"string\">\"none\"</span><span class=\"string\">))</span></span><br><span class=\"line\">    <span class=\"attr\">requestedServerName:</span> <span class=\"string\">connection.requested_server_name</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">userAgent:</span> <span class=\"string\">request.useragent</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">responseTimestamp:</span> <span class=\"string\">response.time</span></span><br><span class=\"line\">    <span class=\"attr\">receivedBytes:</span> <span class=\"string\">request.total_size</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">sentBytes:</span> <span class=\"string\">response.total_size</span> <span class=\"string\">|</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"attr\">referer:</span> <span class=\"string\">request.referer</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">httpAuthority:</span> <span class=\"string\">request.headers[\":authority\"]</span> <span class=\"string\">|</span> <span class=\"string\">request.host</span> <span class=\"string\">|</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">xForwardedFor:</span> <span class=\"string\">request.headers[\"x-forwarded-for\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"0.0.0.0\"</span></span><br><span class=\"line\">    <span class=\"attr\">reporter:</span> <span class=\"string\">conditional((context.reporter.kind</span> <span class=\"string\">|</span> <span class=\"string\">\"inbound\"</span><span class=\"string\">)</span> <span class=\"string\">==</span> <span class=\"string\">\"outbound\"</span><span class=\"string\">,</span> <span class=\"string\">\"source\"</span><span class=\"string\">,</span> <span class=\"string\">\"destination\"</span><span class=\"string\">)</span></span><br><span class=\"line\">  <span class=\"attr\">monitored_resource_type:</span> <span class=\"string\">'\"global\"'</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">metric</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">requestcount</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">value:</span> <span class=\"string\">\"1\"</span></span><br><span class=\"line\">  <span class=\"attr\">dimensions:</span></span><br><span class=\"line\">    <span class=\"attr\">reporter:</span> <span class=\"string\">conditional((context.reporter.kind</span> <span class=\"string\">|</span> <span class=\"string\">\"inbound\"</span><span class=\"string\">)</span> <span class=\"string\">==</span> <span class=\"string\">\"outbound\"</span><span class=\"string\">,</span> <span class=\"string\">\"source\"</span><span class=\"string\">,</span> <span class=\"string\">\"destination\"</span><span class=\"string\">)</span></span><br><span class=\"line\">    <span class=\"attr\">source_workload:</span> <span class=\"string\">source.workload.name</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">source_workload_namespace:</span> <span class=\"string\">source.workload.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">source_principal:</span> <span class=\"string\">source.principal</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">source_app:</span> <span class=\"string\">source.labels[\"app\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">source_version:</span> <span class=\"string\">source.labels[\"version\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_workload:</span> <span class=\"string\">destination.workload.name</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_workload_namespace:</span> <span class=\"string\">destination.workload.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_principal:</span> <span class=\"string\">destination.principal</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_app:</span> <span class=\"string\">destination.labels[\"app\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_version:</span> <span class=\"string\">destination.labels[\"version\"]</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_service:</span> <span class=\"string\">destination.service.host</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_service_name:</span> <span class=\"string\">destination.service.name</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">destination_service_namespace:</span> <span class=\"string\">destination.service.namespace</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">request_protocol:</span> <span class=\"string\">api.protocol</span> <span class=\"string\">|</span> <span class=\"string\">context.protocol</span> <span class=\"string\">|</span> <span class=\"string\">\"unknown\"</span></span><br><span class=\"line\">    <span class=\"attr\">response_code:</span> <span class=\"string\">response.code</span> <span class=\"string\">|</span> <span class=\"number\">200</span></span><br><span class=\"line\">    <span class=\"attr\">connection_security_policy:</span> <span class=\"string\">conditional((context.reporter.kind</span> <span class=\"string\">|</span> <span class=\"string\">\"inbound\"</span><span class=\"string\">)</span> <span class=\"string\">==</span> <span class=\"string\">\"outbound\"</span><span class=\"string\">,</span> <span class=\"string\">\"unknown\"</span><span class=\"string\">,</span> <span class=\"string\">conditional(connection.mtls</span> <span class=\"string\">|</span> <span class=\"literal\">false</span><span class=\"string\">,</span> <span class=\"string\">\"mutual_tls\"</span><span class=\"string\">,</span> <span class=\"string\">\"none\"</span><span class=\"string\">))</span></span><br><span class=\"line\">  <span class=\"attr\">monitored_resource_type:</span> <span class=\"string\">'\"UNSPECIFIED\"'</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>Rule</code></li>\n</ul>\n<p>Rule , Mixer  Instance  Handler ,(action) Adapter, Action  Adapter  Instance </p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">match</td>\n<td align=\"center\"></td>\n<td align=\"center\">,,</td>\n</tr>\n<tr>\n<td align=\"center\">actions</td>\n<td align=\"center\"></td>\n<td align=\"center\">,. handler  instance , handler  instance (, <code>&lt;name.kind&gt;</code>)</td>\n</tr>\n</tbody></table>\n<p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">rule</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">stdio</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">match:</span> <span class=\"string\">context.protocol</span> <span class=\"string\">==</span> <span class=\"string\">\"http\"</span> <span class=\"string\">||</span> <span class=\"string\">context.protocol</span> <span class=\"string\">==</span> <span class=\"string\">\"grpc\"</span></span><br><span class=\"line\">  <span class=\"attr\">actions:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">handler:</span> <span class=\"string\">handler.stdio</span></span><br><span class=\"line\">    <span class=\"attr\">instances:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">accesslog.logentry</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">\"config.istio.io/v1alpha2\"</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">rule</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">promhttp</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">match:</span> <span class=\"string\">context.protocol</span> <span class=\"string\">==</span> <span class=\"string\">\"http\"</span> <span class=\"string\">||</span> <span class=\"string\">context.protocol</span> <span class=\"string\">==</span> <span class=\"string\">\"grpc\"</span></span><br><span class=\"line\">  <span class=\"attr\">actions:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">handler:</span> <span class=\"string\">handler.prometheus</span></span><br><span class=\"line\">    <span class=\"attr\">instances:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">requestcount.metric</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">requestduration.metric</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">requestsize.metric</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">responsesize.metric</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Prometheus-\"><a href=\"#Prometheus-\" class=\"headerlink\" title=\"Prometheus \"></a>Prometheus </h2><blockquote>\n<p></p>\n</blockquote>\n<ol>\n<li>Envoy  Report  Mixer</li>\n<li>Mixer  Prometheus Adapter</li>\n<li>Prometheus Adapter  HTTP  Metric </li>\n<li>Prometheus  Addon , Metric , Query </li>\n<li> Dashboard(Grafana) Prometheus  API  Metric </li>\n</ol>\n<blockquote>\n<p>handler </p>\n</blockquote>\n<p>handler  <code>metrics</code>, Prometheus  metrics.,</p>\n<ul>\n<li><code>name</code>: metric </li>\n<li><code>instance_name</code>: instance , <code>&lt;instance_name.kind.namespace&gt;</code></li>\n<li><code>kind</code>: , <code>COUNTER</code>, <code>DISTRIBUTION</code>.DISTRIBUTION  buckets</li>\n<li><code>label_names</code>: , instance </li>\n</ul>\n<blockquote>\n<p>instance </p>\n</blockquote>\n<p>instance  <code>dimensions</code>  <code>value</code>,.. key  prometheus-metrics </p>\n<blockquote>\n<p>rule </p>\n</blockquote>\n<p>Rule  Handler  Instance, <code>match</code>  <code>actions</code>,</p>\n"},{"title":"istio","abbrlink":43254,"description":"Istio 1-2 .","_content":"\n[Istio](https://item.jd.com/12538407.html) 1-2 .,.\n\n# istio \n\n[Istio](https://istio.io/)  [Kubernetes](https://kubernetes.io/)  Service Mesh \n\n## istio \n\n- ,\n- \n- ,,\n- \n- ,\n- ,.\n\n# istio \n\n## istio \n\n![istio ](istio-first-step/istio_working_mechanism_and_architecture.jpg)\n\n- ``:  Sidecar . Kubernetes  Pod ,Kube-apiserver  Sidecar-Injector , Sidecar.Pod,Pod Sidecar \n- ``:  Pod  iptables ,, iptables  Inbound  Outbound  Sidecar . Sidecar,\n- ``:  Envoy  Pilot \n- ``:  Envoy ,\n- ``: Envoy  Pilot , Inbound  Outbound \n- ``:  Envoy ,. Citadel \n- ``: , Envoy  Mixer , Mixer \n- ``: ,Mixer,\n- ``:  Envoy \n\n## istio \n\nistio  kubernetes \n\nistio | kubernetes\n:---: | :---:\nservice | service\n | Deployment, app  version \n | Endpoint\n\n## istio \n\n> istio-pilot \n\n- \n\npilot  adapter , istio . kubernetes `service(service),endpoint(instance),deployment(version)`\n\n![pilot ](istio-first-step/service_discovery_on_pilot.png)\n\n- \n\n,pilot  Envoy , xDS  Envoy,Envoy.\n\n `VirtualService,DestinationRule,Gateway,ServiceEntry` ,.\n\n> istio-mixer ,\n\n-  telemetry \n\n, Envoy  istio-telemetry ,istio-telemetry  Metric \n\n-  policy \n \n istio-policy  Check , adapter ,\n\n> istio-citadel \n\nistio-citadel  istio ,,,.\n\ncitadel   kube-apiserver, secret , pod  pod ,, TLS ,,\n\n> istio-galley \n\nistio-galley ,, Pilot  Mixer.\n\n> istio-sidecar-injector \n\nistio-sidecar-injector , Pod  istio-sidecar-injector  pod  sideCar \n\n> istio-proxy,Envoy,Sidecar Istio\n\n/ pilot , proxy,4  7 .,Envoy ,,TLS,HTTP/2  gRPC,,,,,\n\n> istio-ingressgateway \n\nistio-ingressgateway ,. Loadbalancer  Service,,.\n\n# \n\n## \n\n> \n\n,\n,\n\n> \n\n1.  API \n2. Pilot  Envoy , Envoy()\n3. Envoy  Pod  Inbound  Outbound \n4.  Envoy ,\n\n> \n\n- \n\n: \n: ,\n: .,\n\n- \n\n,.,,\n\n- \n\n,,Istio ,.\n\n HTTP Code 503(),()\n\n- \n\n,,,\n\n,,AB  3 \n\n- \n\nIstio  Ingress Gateway ,,TLS,VirtualService\n\n- \n\nIstio  ServiceEntry ,.\n Egress Gateway ","source":"_posts/istio-first-step.md","raw":"---\ntitle: istio\ntags:\n  - istio\n  - \ncategories:\n  - \n  - istio\nabbrlink: 43254\ndescription: Istio 1-2 .\n---\n\n[Istio](https://item.jd.com/12538407.html) 1-2 .,.\n\n# istio \n\n[Istio](https://istio.io/)  [Kubernetes](https://kubernetes.io/)  Service Mesh \n\n## istio \n\n- ,\n- \n- ,,\n- \n- ,\n- ,.\n\n# istio \n\n## istio \n\n![istio ](istio-first-step/istio_working_mechanism_and_architecture.jpg)\n\n- ``:  Sidecar . Kubernetes  Pod ,Kube-apiserver  Sidecar-Injector , Sidecar.Pod,Pod Sidecar \n- ``:  Pod  iptables ,, iptables  Inbound  Outbound  Sidecar . Sidecar,\n- ``:  Envoy  Pilot \n- ``:  Envoy ,\n- ``: Envoy  Pilot , Inbound  Outbound \n- ``:  Envoy ,. Citadel \n- ``: , Envoy  Mixer , Mixer \n- ``: ,Mixer,\n- ``:  Envoy \n\n## istio \n\nistio  kubernetes \n\nistio | kubernetes\n:---: | :---:\nservice | service\n | Deployment, app  version \n | Endpoint\n\n## istio \n\n> istio-pilot \n\n- \n\npilot  adapter , istio . kubernetes `service(service),endpoint(instance),deployment(version)`\n\n![pilot ](istio-first-step/service_discovery_on_pilot.png)\n\n- \n\n,pilot  Envoy , xDS  Envoy,Envoy.\n\n `VirtualService,DestinationRule,Gateway,ServiceEntry` ,.\n\n> istio-mixer ,\n\n-  telemetry \n\n, Envoy  istio-telemetry ,istio-telemetry  Metric \n\n-  policy \n \n istio-policy  Check , adapter ,\n\n> istio-citadel \n\nistio-citadel  istio ,,,.\n\ncitadel   kube-apiserver, secret , pod  pod ,, TLS ,,\n\n> istio-galley \n\nistio-galley ,, Pilot  Mixer.\n\n> istio-sidecar-injector \n\nistio-sidecar-injector , Pod  istio-sidecar-injector  pod  sideCar \n\n> istio-proxy,Envoy,Sidecar Istio\n\n/ pilot , proxy,4  7 .,Envoy ,,TLS,HTTP/2  gRPC,,,,,\n\n> istio-ingressgateway \n\nistio-ingressgateway ,. Loadbalancer  Service,,.\n\n# \n\n## \n\n> \n\n,\n,\n\n> \n\n1.  API \n2. Pilot  Envoy , Envoy()\n3. Envoy  Pod  Inbound  Outbound \n4.  Envoy ,\n\n> \n\n- \n\n: \n: ,\n: .,\n\n- \n\n,.,,\n\n- \n\n,,Istio ,.\n\n HTTP Code 503(),()\n\n- \n\n,,,\n\n,,AB  3 \n\n- \n\nIstio  Ingress Gateway ,,TLS,VirtualService\n\n- \n\nIstio  ServiceEntry ,.\n Egress Gateway ","slug":"istio-first-step","published":1,"date":"2020-04-03T07:39:22.816Z","updated":"2020-04-30T02:29:55.696Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvv002dk8u7dd7j2v6p","content":"<p><a href=\"https://item.jd.com/12538407.html\" target=\"_blank\" rel=\"noopener\">Istio</a> 1-2 .,.</p>\n<h1 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h1><p><a href=\"https://istio.io/\" target=\"_blank\" rel=\"noopener\">Istio</a>  <a href=\"https://kubernetes.io/\" target=\"_blank\" rel=\"noopener\">Kubernetes</a>  Service Mesh </p>\n<h2 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h2><ul>\n<li>,</li>\n<li></li>\n<li>,,</li>\n<li></li>\n<li>,</li>\n<li>,.</li>\n</ul>\n<h1 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h1><h2 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h2><p><img src=\"/2020/04/03/istio-first-step/istio_working_mechanism_and_architecture.jpg\" alt=\"istio \"></p>\n<ul>\n<li><code></code>:  Sidecar . Kubernetes  Pod ,Kube-apiserver  Sidecar-Injector , Sidecar.Pod,Pod Sidecar </li>\n<li><code></code>:  Pod  iptables ,, iptables  Inbound  Outbound  Sidecar . Sidecar,</li>\n<li><code></code>:  Envoy  Pilot </li>\n<li><code></code>:  Envoy ,</li>\n<li><code></code>: Envoy  Pilot , Inbound  Outbound </li>\n<li><code></code>:  Envoy ,. Citadel </li>\n<li><code></code>: , Envoy  Mixer , Mixer </li>\n<li><code></code>: ,Mixer,</li>\n<li><code></code>:  Envoy </li>\n</ul>\n<h2 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h2><p>istio  kubernetes </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">istio</th>\n<th align=\"center\">kubernetes</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">service</td>\n<td align=\"center\">service</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Deployment, app  version </td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Endpoint</td>\n</tr>\n</tbody></table>\n<h2 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h2><blockquote>\n<p>istio-pilot </p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<p>pilot  adapter , istio . kubernetes <code>service(service),endpoint(instance),deployment(version)</code></p>\n<p><img src=\"/2020/04/03/istio-first-step/service_discovery_on_pilot.png\" alt=\"pilot \"></p>\n<ul>\n<li></li>\n</ul>\n<p>,pilot  Envoy , xDS  Envoy,Envoy.</p>\n<p> <code>VirtualService,DestinationRule,Gateway,ServiceEntry</code> ,.</p>\n<blockquote>\n<p>istio-mixer ,</p>\n</blockquote>\n<ul>\n<li> telemetry </li>\n</ul>\n<p>, Envoy  istio-telemetry ,istio-telemetry  Metric </p>\n<ul>\n<li> policy </li>\n</ul>\n<p> istio-policy  Check , adapter ,</p>\n<blockquote>\n<p>istio-citadel </p>\n</blockquote>\n<p>istio-citadel  istio ,,,.</p>\n<p>citadel   kube-apiserver, secret , pod  pod ,, TLS ,,</p>\n<blockquote>\n<p>istio-galley </p>\n</blockquote>\n<p>istio-galley ,, Pilot  Mixer.</p>\n<blockquote>\n<p>istio-sidecar-injector </p>\n</blockquote>\n<p>istio-sidecar-injector , Pod  istio-sidecar-injector  pod  sideCar </p>\n<blockquote>\n<p>istio-proxy,Envoy,Sidecar Istio</p>\n</blockquote>\n<p>/ pilot , proxy,4  7 .,Envoy ,,TLS,HTTP/2  gRPC,,,,,</p>\n<blockquote>\n<p>istio-ingressgateway </p>\n</blockquote>\n<p>istio-ingressgateway ,. Loadbalancer  Service,,.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p></p>\n</blockquote>\n<p>,<br>,</p>\n<blockquote>\n<p></p>\n</blockquote>\n<ol>\n<li> API </li>\n<li>Pilot  Envoy , Envoy()</li>\n<li>Envoy  Pod  Inbound  Outbound </li>\n<li> Envoy ,</li>\n</ol>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<p>: <br>: ,<br>: .,</p>\n<ul>\n<li></li>\n</ul>\n<p>,.,,</p>\n<ul>\n<li></li>\n</ul>\n<p>,,Istio ,.</p>\n<p> HTTP Code 503(),()</p>\n<ul>\n<li></li>\n</ul>\n<p>,,,</p>\n<p>,,AB  3 </p>\n<ul>\n<li></li>\n</ul>\n<p>Istio  Ingress Gateway ,,TLS,VirtualService</p>\n<ul>\n<li></li>\n</ul>\n<p>Istio  ServiceEntry ,.<br> Egress Gateway </p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://item.jd.com/12538407.html\" target=\"_blank\" rel=\"noopener\">Istio</a> 1-2 .,.</p>\n<h1 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h1><p><a href=\"https://istio.io/\" target=\"_blank\" rel=\"noopener\">Istio</a>  <a href=\"https://kubernetes.io/\" target=\"_blank\" rel=\"noopener\">Kubernetes</a>  Service Mesh </p>\n<h2 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h2><ul>\n<li>,</li>\n<li></li>\n<li>,,</li>\n<li></li>\n<li>,</li>\n<li>,.</li>\n</ul>\n<h1 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h1><h2 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h2><p><img src=\"/2020/04/03/istio-first-step/istio_working_mechanism_and_architecture.jpg\" alt=\"istio \"></p>\n<ul>\n<li><code></code>:  Sidecar . Kubernetes  Pod ,Kube-apiserver  Sidecar-Injector , Sidecar.Pod,Pod Sidecar </li>\n<li><code></code>:  Pod  iptables ,, iptables  Inbound  Outbound  Sidecar . Sidecar,</li>\n<li><code></code>:  Envoy  Pilot </li>\n<li><code></code>:  Envoy ,</li>\n<li><code></code>: Envoy  Pilot , Inbound  Outbound </li>\n<li><code></code>:  Envoy ,. Citadel </li>\n<li><code></code>: , Envoy  Mixer , Mixer </li>\n<li><code></code>: ,Mixer,</li>\n<li><code></code>:  Envoy </li>\n</ul>\n<h2 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h2><p>istio  kubernetes </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">istio</th>\n<th align=\"center\">kubernetes</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">service</td>\n<td align=\"center\">service</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Deployment, app  version </td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Endpoint</td>\n</tr>\n</tbody></table>\n<h2 id=\"istio-\"><a href=\"#istio-\" class=\"headerlink\" title=\"istio \"></a>istio </h2><blockquote>\n<p>istio-pilot </p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<p>pilot  adapter , istio . kubernetes <code>service(service),endpoint(instance),deployment(version)</code></p>\n<p><img src=\"/2020/04/03/istio-first-step/service_discovery_on_pilot.png\" alt=\"pilot \"></p>\n<ul>\n<li></li>\n</ul>\n<p>,pilot  Envoy , xDS  Envoy,Envoy.</p>\n<p> <code>VirtualService,DestinationRule,Gateway,ServiceEntry</code> ,.</p>\n<blockquote>\n<p>istio-mixer ,</p>\n</blockquote>\n<ul>\n<li> telemetry </li>\n</ul>\n<p>, Envoy  istio-telemetry ,istio-telemetry  Metric </p>\n<ul>\n<li> policy </li>\n</ul>\n<p> istio-policy  Check , adapter ,</p>\n<blockquote>\n<p>istio-citadel </p>\n</blockquote>\n<p>istio-citadel  istio ,,,.</p>\n<p>citadel   kube-apiserver, secret , pod  pod ,, TLS ,,</p>\n<blockquote>\n<p>istio-galley </p>\n</blockquote>\n<p>istio-galley ,, Pilot  Mixer.</p>\n<blockquote>\n<p>istio-sidecar-injector </p>\n</blockquote>\n<p>istio-sidecar-injector , Pod  istio-sidecar-injector  pod  sideCar </p>\n<blockquote>\n<p>istio-proxy,Envoy,Sidecar Istio</p>\n</blockquote>\n<p>/ pilot , proxy,4  7 .,Envoy ,,TLS,HTTP/2  gRPC,,,,,</p>\n<blockquote>\n<p>istio-ingressgateway </p>\n</blockquote>\n<p>istio-ingressgateway ,. Loadbalancer  Service,,.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p></p>\n</blockquote>\n<p>,<br>,</p>\n<blockquote>\n<p></p>\n</blockquote>\n<ol>\n<li> API </li>\n<li>Pilot  Envoy , Envoy()</li>\n<li>Envoy  Pod  Inbound  Outbound </li>\n<li> Envoy ,</li>\n</ol>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<p>: <br>: ,<br>: .,</p>\n<ul>\n<li></li>\n</ul>\n<p>,.,,</p>\n<ul>\n<li></li>\n</ul>\n<p>,,Istio ,.</p>\n<p> HTTP Code 503(),()</p>\n<ul>\n<li></li>\n</ul>\n<p>,,,</p>\n<p>,,AB  3 </p>\n<ul>\n<li></li>\n</ul>\n<p>Istio  Ingress Gateway ,,TLS,VirtualService</p>\n<ul>\n<li></li>\n</ul>\n<p>Istio  ServiceEntry ,.<br> Egress Gateway </p>\n"},{"title":"go ","abbrlink":15536,"description":" Go , ,  Go ,  reflect.Type  reflect.Value","_content":"\n. , , , .\n\n, , , , , , .\n\n\n Type  Value . Go  `reflect` ,  `reflect.Type`  `reflect.Value`,  `reflect.TypeOf`  `reflect.ValueOf`  Value  Type.\n\n##  `reflect.Type`\n\n Go ,  `reflect.TypeOf()`  `reflect.Type` , .\n\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    var n int = 20\n    typeOfn := reflect.TypeOf(n)  //  n   `reflect.Type`\n    fmt.Println(\"type:\", typeOfn.Name(), \"kind:\", typeOfn.Kind())  //  type: int kind: int\n}\n```\n\n### (Name)(Kind)\n\n- Name() ,  Go  type .  `reflect.Type`  `Name()` \n- Kind() ,  Go .  `reflect.Type`  `Kind()` ,  `reflect.Kind` \n\n, `stu`  `Student`,  `struct`.\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Student struct {\n\tName  string\n\tAge   int\n}\n\nfunc main() {\n    stu := Student{\n    \tName:  \"tom\",\n    \tAge:   20,\n    }\n    typeOfstu := reflect.TypeOf(stu)\n    fmt.Println(\"type:\", typeOfstu.Name(), \"kind:\", typeOfstu.Kind())\n}\n// \n// type: Student kind: struct\n```\n\n### \n\n(Kind) `Array`, `Chan`, `Map`, `Ptr`  `Slice` ,  `Name()` (\"\")\n\n,  `Elem()` ,  `Name()` \n\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Student struct {\n\tName  string\n\tAge   int\n}\n\nfunc main() {\n    stu := Student{\n    \tName:  \"tom\",\n    \tAge:   20,\n    }\n    ptrOfstu := &stu\n    a:=[3]int{1,3,4}\n    typeOfptr := reflect.TypeOf(a)  //  &stu  `reflect.Type`\n    fmt.Println(\"type:\", typeOfptr.Name(), \"kind:\", typeOfptr.Kind())  //  type:  kind: ptr\n    elemType := typeOfptr.Elem()\n    fmt.Println(\"elem's type:\", elem.Name(), \"elem's kind:\", elem.Kind())  //  elem's type: Student elem's kind: struct\n}\n// \n// type:  kind: ptr\n// type: Student kind: struct\n```\n\n`reflect.Type`  `Elem()`  `Array`, `Chan`, `Map`, `Ptr`  `Slice` ,  `Elem()`  panics.\n\n\n### \n\n `reflect.TypeOf()` ,  `reflect.Type`  `NumField()`  `Field()` , `NumMethod()`  `Method()` \n\n`reflect.Type` \n\n |  |  |\n:---: | :---: | :---: | :---:\n`NumField()` | - | int | \n`Field(i int)` | , 0  | reflect.StructField | \n`NumMethod()` | - | int | \n`Method(i int)` | , 0  | reflect.Method | ,  ascii \n\n,  `reflect.TypeOf(&object).Method()` ,  receiver  `&object` . `reflect.TypeOf(object).Method()`  receiver  `object` .  `Elem()` \n\n```go\nimport (\n\t\"fmt\"\n\t\"reflect\"\n)\n\ntype Student struct {\n\tName  string  `json: \"name\"`\n\tAge   int     `json: \"age\"`\n}\n\nfunc (stu Student) GetSum(n1, n2 int) int {\n    return n1 + n2\n}\n\nfunc (stu *Student) Print() {\n\tfmt.Println(*stu)\n}\n\nfunc (stu *Student) Set(name string, age int) {\n\tstu.Name = name\n\tstu.Age = age\n}\n\nfunc main() {\n\tstu := Student{\n\t\tName: \"tom\",\n\t\tAge:  20,\n\t}\n\ttypeOfstu := reflect.TypeOf(stu)\n\tkindOfstu := typeOfstu.Kind()\n\ttypeOfptr := reflect.TypeOf(&stu)\n\n\tif kindOfstu != reflect.Struct {\n\t\tfmt.Println(\"except struct...\")\n\t\treturn\n\t}\n\n\tfieldNum := typeOfstu.NumField()\n\tfmt.Println(\": \", fieldNum)  // 2\n\tfor i := 0; i < fieldNum; i++ {\n\t\tfield := typeOfstu.Field(i)\n\t\tfmt.Println(field)\n\t\tfmt.Printf(\": %v, : %v,  json : %v\\n\", field.Name, field.Type, field.Tag.Get(\"json\"))  // Tag.Get(key) \n\t}\n\n\tmethodNumOfstu := typeOfstu.NumMethod()\n\tfmt.Println(\"stu: \", methodNumOfstu)  // 1\n\tfor i := 0; i < methodNumOfstu; i++ {\n\t\tmethod := typeOfstu.Method(i)\n\t\tfmt.Println(method)\n\t\tfmt.Printf(\": %v, : %v\\n\", method.Name, method.Type)\n\t}\n\n\tmethodNumOfptr := typeOfptr.NumMethod()\n\tfmt.Println(\"&stu: \", methodNumOfptr)   // 3\n\tfor i := 0; i < methodNumOfptr; i++ {\n\t\tmethod := typeOfptr.Method(i)\n\t\tfmt.Println(method)\n\t\tfmt.Printf(\": %v, : %v, \\n\", method.Name, method.Type, method.Func)\n\t}\n}\n```\n\n##  `reflect.Value`\n\n `reflect.ValueOf()`  `reflect.Value`. `reflect.Value`  `Type()`  `reflect.Type` , .\n\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    var n int = 20\n    valueOfN := reflect.ValueOf(n)  //  n   `reflect.Value`\n    typeOfN := valueOfN.Type() // ,  reflect.TypeOf(n)\n    fmt.Printf(\": %v,  %T\", valueOfN, valueOfN)  //  : 20,  reflect.Value\n    n2, ok := valueOfN.Interface().(int) //  reflect.Value  interface,  int \n    if ok {\n    \tfmt.Printf(\": %v,  %T\", n2, n2)  //  : 20,  int\n    }\n}\n```\n\n![](go-study-notes-reflect/conversion_between_actual_type_and_reflection.jpg)\n\n,  `reflect.ValueOf(i interface{})` ,  `reflect.Value` . `reflect.Value`  `Interface()` , , .\n\n### \n\n `reflect.ValueOf()` ,  `reflect.Value`  `NumField()`  `Field()` , `NumMethod()`  `Method()` \n\n`reflect.Value` :\n\n |  |  |\n:---: | :---: | :---: | :---:\n`NumField()` | - | int | \n`Field(i int)` | , 0  | reflect.Value | \n`NumMethod()` | - | int | \n`Method(i int)` | , 0  | reflect.Value | , (),  ascii \n\n,  `reflect.ValueOf(&object).Method()` ,  receiver  `&object` . `reflect.ValueOf(object).Method()`  receiver  `object` .  `Elem()` \n\n```go\nimport (\n\t\"fmt\"\n\t\"reflect\"\n)\n\ntype Student struct {\n\tName  string  `json: \"name\"`\n\tAge   int     `json: \"age\"`\n}\n\nfunc (stu Student) GetSum(n1, n2 int) int {\n    return n1 + n2\n}\n\nfunc (stu *Student) Print() {\n\tfmt.Println(*stu)\n}\n\nfunc (stu *Student) Set(name string, age int) {\n\tstu.Name = name\n\tstu.Age = age\n}\n\nfunc main() {\n\tstu := Student{\n\t\tName: \"tom\",\n\t\tAge:  20,\n\t}\n\tvalueOfstu := reflect.ValueOf(stu)\n\tkindOfstu := valueOfstu.Kind()\n\tvalueOfptr := reflect.ValueOf(&stu)\n    typeOfStu := valueOfstu.Type()  // \n\n\tif kindOfstu != reflect.Struct {\n\t\tfmt.Println(\"except struct...\")\n\t\treturn\n\t}\n\n\tfieldNum := typeOfstu.NumField()\n\tfmt.Println(\": \", fieldNum)  // 2\n\tfor i := 0; i < fieldNum; i++ {\n\t\tfield := typeOfstu.Field(i)\n\t\tfmt.Println(field)  // \n        \n\t}\n\n\tmethodNumOfstu := typeOfstu.NumMethod()\n\tfmt.Println(\"stu: \", methodNumOfstu)  // 1\n\tfor i := 0; i < methodNumOfstu; i++ {\n\t\tmethod := typeOfstu.Method(i)\n\t\tfmt.Println(method)  //  0x4878c0 , , \n\t}\n\n\tmethodNumOfptr := typeOfptr.NumMethod()\n\tfmt.Println(\"&stu: \", methodNumOfptr)   // 3\n\tfor i := 0; i < methodNumOfptr; i++ {\n\t\tmethod := typeOfptr.Method(i)\n\t\tfmt.Println(method) //  0x4878c0 , , \n\t}\n}\n```\n\n### \n\n,  `Student` ?\n\n```go\nimport (\n\t\"fmt\"\n\t\"reflect\"\n)\n\ntype Student struct {\n\tName  string  `json: \"name\"`\n\tAge   int     `json: \"age\"`\n}\n\nfunc (stu Student) GetSum(n1, n2 int) int {\n    return n1 + n2\n}\n\nfunc (stu *Student) Print() {\n\tfmt.Println(*stu)\n}\n\nfunc (stu *Student) Set(name string, age int) {\n\tstu.Name = name\n\tstu.Age = age\n}\n\nfunc main() {\n\tstu := Student{\n\t\tName: \"tom\",\n\t\tAge:  20,\n\t}\n\tvalueOfStu := reflect.ValueOf(&stu)  //  &stu, , \n\n    //  reflect.Value  Call()  GetSum(n1, n2 int) int , Call() []reflect.Value \n\tvar paramsGetSum []reflect.Value\n\tparamsGetSum = append(paramsGetSum, reflect.ValueOf(10))\n\tparamsGetSum = append(paramsGetSum, reflect.ValueOf(20))\n\tresGetSum := valueOfStu.Method(0).Call(paramsGetSum)  //  []reflect.Value, \n    fmt.Printf(\" %v,  %T\", resGetSum, resGetSum)  //  : 30,  []reflect.Value\n    resGetSum0 := resGetSum[0]\n    fmt.Printf(\" %v,  %T\\n\", resGetSum0, resGetSum0)  //  : 30,  reflect.Value\n\trealRes0 := resGetSum[0].Interface().(int)\n\tfmt.Printf(\" %v,  %T\\n\", realRes, realRes)  //  : 30,  int\n    \n    //  reflect.Value  Call()  Print() , Call() []reflect.Value \n    var paramsPrint []reflect.Value\n\tresPrint := valueOfStu.Method(1).Call(paramsPrint)\n\tfmt.Printf(\" %v,  %T\", resPrint, resPrint)  //  : [],  []reflect.Value\n    \n    //  reflect.Value  Call()  Set(name string, age int) , Call() []reflect.Value \n    var paramsSet []reflect.Value\n\tparamsSet = append(paramsSet, reflect.ValueOf(\"jack\"))\n\tparamsSet = append(paramsSet, reflect.ValueOf(30))\n\tresSet := valueOfStu.Method(2).Call(paramsSet)\n\tfmt.Printf(\" %v,  %T\\n\", resSet, resSet) //  : [],  []reflect.Value\n\tfmt.Println(stu)  //  stu  {jack 30}\n}\n```\n\n## \n\n### StructField \n\n```go\ntype StructField struct {\n    Name string          // \n    PkgPath string       // \n    Type      Type       // \n    Tag       StructTag  // \n    Offset    uintptr    // \n    Index     []int      // Type.FieldByIndex\n    Anonymous bool       // \n}\ntype StructTag string\n```\n\n### Method \n\n```go\ntype Method struct {\n\tName    string // \n\tPkgPath string // \n\tType    Type   // \n\tFunc    Value  //  func\n\tIndex   int    // Type.Method \n}\n```","source":"_posts/go-study-notes-reflect.md","raw":"---\ntitle: go \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 15536\ndescription: ' Go , ,  Go ,  reflect.Type  reflect.Value'\n---\n\n. , , , .\n\n, , , , , , .\n\n\n Type  Value . Go  `reflect` ,  `reflect.Type`  `reflect.Value`,  `reflect.TypeOf`  `reflect.ValueOf`  Value  Type.\n\n##  `reflect.Type`\n\n Go ,  `reflect.TypeOf()`  `reflect.Type` , .\n\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    var n int = 20\n    typeOfn := reflect.TypeOf(n)  //  n   `reflect.Type`\n    fmt.Println(\"type:\", typeOfn.Name(), \"kind:\", typeOfn.Kind())  //  type: int kind: int\n}\n```\n\n### (Name)(Kind)\n\n- Name() ,  Go  type .  `reflect.Type`  `Name()` \n- Kind() ,  Go .  `reflect.Type`  `Kind()` ,  `reflect.Kind` \n\n, `stu`  `Student`,  `struct`.\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Student struct {\n\tName  string\n\tAge   int\n}\n\nfunc main() {\n    stu := Student{\n    \tName:  \"tom\",\n    \tAge:   20,\n    }\n    typeOfstu := reflect.TypeOf(stu)\n    fmt.Println(\"type:\", typeOfstu.Name(), \"kind:\", typeOfstu.Kind())\n}\n// \n// type: Student kind: struct\n```\n\n### \n\n(Kind) `Array`, `Chan`, `Map`, `Ptr`  `Slice` ,  `Name()` (\"\")\n\n,  `Elem()` ,  `Name()` \n\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Student struct {\n\tName  string\n\tAge   int\n}\n\nfunc main() {\n    stu := Student{\n    \tName:  \"tom\",\n    \tAge:   20,\n    }\n    ptrOfstu := &stu\n    a:=[3]int{1,3,4}\n    typeOfptr := reflect.TypeOf(a)  //  &stu  `reflect.Type`\n    fmt.Println(\"type:\", typeOfptr.Name(), \"kind:\", typeOfptr.Kind())  //  type:  kind: ptr\n    elemType := typeOfptr.Elem()\n    fmt.Println(\"elem's type:\", elem.Name(), \"elem's kind:\", elem.Kind())  //  elem's type: Student elem's kind: struct\n}\n// \n// type:  kind: ptr\n// type: Student kind: struct\n```\n\n`reflect.Type`  `Elem()`  `Array`, `Chan`, `Map`, `Ptr`  `Slice` ,  `Elem()`  panics.\n\n\n### \n\n `reflect.TypeOf()` ,  `reflect.Type`  `NumField()`  `Field()` , `NumMethod()`  `Method()` \n\n`reflect.Type` \n\n |  |  |\n:---: | :---: | :---: | :---:\n`NumField()` | - | int | \n`Field(i int)` | , 0  | reflect.StructField | \n`NumMethod()` | - | int | \n`Method(i int)` | , 0  | reflect.Method | ,  ascii \n\n,  `reflect.TypeOf(&object).Method()` ,  receiver  `&object` . `reflect.TypeOf(object).Method()`  receiver  `object` .  `Elem()` \n\n```go\nimport (\n\t\"fmt\"\n\t\"reflect\"\n)\n\ntype Student struct {\n\tName  string  `json: \"name\"`\n\tAge   int     `json: \"age\"`\n}\n\nfunc (stu Student) GetSum(n1, n2 int) int {\n    return n1 + n2\n}\n\nfunc (stu *Student) Print() {\n\tfmt.Println(*stu)\n}\n\nfunc (stu *Student) Set(name string, age int) {\n\tstu.Name = name\n\tstu.Age = age\n}\n\nfunc main() {\n\tstu := Student{\n\t\tName: \"tom\",\n\t\tAge:  20,\n\t}\n\ttypeOfstu := reflect.TypeOf(stu)\n\tkindOfstu := typeOfstu.Kind()\n\ttypeOfptr := reflect.TypeOf(&stu)\n\n\tif kindOfstu != reflect.Struct {\n\t\tfmt.Println(\"except struct...\")\n\t\treturn\n\t}\n\n\tfieldNum := typeOfstu.NumField()\n\tfmt.Println(\": \", fieldNum)  // 2\n\tfor i := 0; i < fieldNum; i++ {\n\t\tfield := typeOfstu.Field(i)\n\t\tfmt.Println(field)\n\t\tfmt.Printf(\": %v, : %v,  json : %v\\n\", field.Name, field.Type, field.Tag.Get(\"json\"))  // Tag.Get(key) \n\t}\n\n\tmethodNumOfstu := typeOfstu.NumMethod()\n\tfmt.Println(\"stu: \", methodNumOfstu)  // 1\n\tfor i := 0; i < methodNumOfstu; i++ {\n\t\tmethod := typeOfstu.Method(i)\n\t\tfmt.Println(method)\n\t\tfmt.Printf(\": %v, : %v\\n\", method.Name, method.Type)\n\t}\n\n\tmethodNumOfptr := typeOfptr.NumMethod()\n\tfmt.Println(\"&stu: \", methodNumOfptr)   // 3\n\tfor i := 0; i < methodNumOfptr; i++ {\n\t\tmethod := typeOfptr.Method(i)\n\t\tfmt.Println(method)\n\t\tfmt.Printf(\": %v, : %v, \\n\", method.Name, method.Type, method.Func)\n\t}\n}\n```\n\n##  `reflect.Value`\n\n `reflect.ValueOf()`  `reflect.Value`. `reflect.Value`  `Type()`  `reflect.Type` , .\n\n```go\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    var n int = 20\n    valueOfN := reflect.ValueOf(n)  //  n   `reflect.Value`\n    typeOfN := valueOfN.Type() // ,  reflect.TypeOf(n)\n    fmt.Printf(\": %v,  %T\", valueOfN, valueOfN)  //  : 20,  reflect.Value\n    n2, ok := valueOfN.Interface().(int) //  reflect.Value  interface,  int \n    if ok {\n    \tfmt.Printf(\": %v,  %T\", n2, n2)  //  : 20,  int\n    }\n}\n```\n\n![](go-study-notes-reflect/conversion_between_actual_type_and_reflection.jpg)\n\n,  `reflect.ValueOf(i interface{})` ,  `reflect.Value` . `reflect.Value`  `Interface()` , , .\n\n### \n\n `reflect.ValueOf()` ,  `reflect.Value`  `NumField()`  `Field()` , `NumMethod()`  `Method()` \n\n`reflect.Value` :\n\n |  |  |\n:---: | :---: | :---: | :---:\n`NumField()` | - | int | \n`Field(i int)` | , 0  | reflect.Value | \n`NumMethod()` | - | int | \n`Method(i int)` | , 0  | reflect.Value | , (),  ascii \n\n,  `reflect.ValueOf(&object).Method()` ,  receiver  `&object` . `reflect.ValueOf(object).Method()`  receiver  `object` .  `Elem()` \n\n```go\nimport (\n\t\"fmt\"\n\t\"reflect\"\n)\n\ntype Student struct {\n\tName  string  `json: \"name\"`\n\tAge   int     `json: \"age\"`\n}\n\nfunc (stu Student) GetSum(n1, n2 int) int {\n    return n1 + n2\n}\n\nfunc (stu *Student) Print() {\n\tfmt.Println(*stu)\n}\n\nfunc (stu *Student) Set(name string, age int) {\n\tstu.Name = name\n\tstu.Age = age\n}\n\nfunc main() {\n\tstu := Student{\n\t\tName: \"tom\",\n\t\tAge:  20,\n\t}\n\tvalueOfstu := reflect.ValueOf(stu)\n\tkindOfstu := valueOfstu.Kind()\n\tvalueOfptr := reflect.ValueOf(&stu)\n    typeOfStu := valueOfstu.Type()  // \n\n\tif kindOfstu != reflect.Struct {\n\t\tfmt.Println(\"except struct...\")\n\t\treturn\n\t}\n\n\tfieldNum := typeOfstu.NumField()\n\tfmt.Println(\": \", fieldNum)  // 2\n\tfor i := 0; i < fieldNum; i++ {\n\t\tfield := typeOfstu.Field(i)\n\t\tfmt.Println(field)  // \n        \n\t}\n\n\tmethodNumOfstu := typeOfstu.NumMethod()\n\tfmt.Println(\"stu: \", methodNumOfstu)  // 1\n\tfor i := 0; i < methodNumOfstu; i++ {\n\t\tmethod := typeOfstu.Method(i)\n\t\tfmt.Println(method)  //  0x4878c0 , , \n\t}\n\n\tmethodNumOfptr := typeOfptr.NumMethod()\n\tfmt.Println(\"&stu: \", methodNumOfptr)   // 3\n\tfor i := 0; i < methodNumOfptr; i++ {\n\t\tmethod := typeOfptr.Method(i)\n\t\tfmt.Println(method) //  0x4878c0 , , \n\t}\n}\n```\n\n### \n\n,  `Student` ?\n\n```go\nimport (\n\t\"fmt\"\n\t\"reflect\"\n)\n\ntype Student struct {\n\tName  string  `json: \"name\"`\n\tAge   int     `json: \"age\"`\n}\n\nfunc (stu Student) GetSum(n1, n2 int) int {\n    return n1 + n2\n}\n\nfunc (stu *Student) Print() {\n\tfmt.Println(*stu)\n}\n\nfunc (stu *Student) Set(name string, age int) {\n\tstu.Name = name\n\tstu.Age = age\n}\n\nfunc main() {\n\tstu := Student{\n\t\tName: \"tom\",\n\t\tAge:  20,\n\t}\n\tvalueOfStu := reflect.ValueOf(&stu)  //  &stu, , \n\n    //  reflect.Value  Call()  GetSum(n1, n2 int) int , Call() []reflect.Value \n\tvar paramsGetSum []reflect.Value\n\tparamsGetSum = append(paramsGetSum, reflect.ValueOf(10))\n\tparamsGetSum = append(paramsGetSum, reflect.ValueOf(20))\n\tresGetSum := valueOfStu.Method(0).Call(paramsGetSum)  //  []reflect.Value, \n    fmt.Printf(\" %v,  %T\", resGetSum, resGetSum)  //  : 30,  []reflect.Value\n    resGetSum0 := resGetSum[0]\n    fmt.Printf(\" %v,  %T\\n\", resGetSum0, resGetSum0)  //  : 30,  reflect.Value\n\trealRes0 := resGetSum[0].Interface().(int)\n\tfmt.Printf(\" %v,  %T\\n\", realRes, realRes)  //  : 30,  int\n    \n    //  reflect.Value  Call()  Print() , Call() []reflect.Value \n    var paramsPrint []reflect.Value\n\tresPrint := valueOfStu.Method(1).Call(paramsPrint)\n\tfmt.Printf(\" %v,  %T\", resPrint, resPrint)  //  : [],  []reflect.Value\n    \n    //  reflect.Value  Call()  Set(name string, age int) , Call() []reflect.Value \n    var paramsSet []reflect.Value\n\tparamsSet = append(paramsSet, reflect.ValueOf(\"jack\"))\n\tparamsSet = append(paramsSet, reflect.ValueOf(30))\n\tresSet := valueOfStu.Method(2).Call(paramsSet)\n\tfmt.Printf(\" %v,  %T\\n\", resSet, resSet) //  : [],  []reflect.Value\n\tfmt.Println(stu)  //  stu  {jack 30}\n}\n```\n\n## \n\n### StructField \n\n```go\ntype StructField struct {\n    Name string          // \n    PkgPath string       // \n    Type      Type       // \n    Tag       StructTag  // \n    Offset    uintptr    // \n    Index     []int      // Type.FieldByIndex\n    Anonymous bool       // \n}\ntype StructTag string\n```\n\n### Method \n\n```go\ntype Method struct {\n\tName    string // \n\tPkgPath string // \n\tType    Type   // \n\tFunc    Value  //  func\n\tIndex   int    // Type.Method \n}\n```","slug":"go-study-notes-reflect","published":1,"date":"2020-04-30T10:57:44.937Z","updated":"2020-05-16T02:03:23.632Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvw002ik8u74l2hg06r","content":"<p>. , , , .</p>\n<p>, , , , , , .</p>\n<p> Type  Value . Go  <code>reflect</code> ,  <code>reflect.Type</code>  <code>reflect.Value</code>,  <code>reflect.TypeOf</code>  <code>reflect.ValueOf</code>  Value  Type.</p>\n<h2 id=\"-reflect-Type\"><a href=\"#-reflect-Type\" class=\"headerlink\" title=\" reflect.Type\"></a> <code>reflect.Type</code></h2><p> Go ,  <code>reflect.TypeOf()</code>  <code>reflect.Type</code> , .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> n <span class=\"keyword\">int</span> = <span class=\"number\">20</span></span><br><span class=\"line\">    typeOfn := reflect.TypeOf(n)  <span class=\"comment\">//  n   `reflect.Type`</span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"type:\"</span>, typeOfn.Name(), <span class=\"string\">\"kind:\"</span>, typeOfn.Kind())  <span class=\"comment\">//  type: int kind: int</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-Name--Kind\"><a href=\"#-Name--Kind\" class=\"headerlink\" title=\"(Name)(Kind)\"></a>(Name)(Kind)</h3><ul>\n<li>Name() ,  Go  type .  <code>reflect.Type</code>  <code>Name()</code> </li>\n<li>Kind() ,  Go .  <code>reflect.Type</code>  <code>Kind()</code> ,  <code>reflect.Kind</code> </li>\n</ul>\n<p>, <code>stu</code>  <code>Student</code>,  <code>struct</code>.</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    stu := Student&#123;</span><br><span class=\"line\">    \tName:  <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">    \tAge:   <span class=\"number\">20</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    typeOfstu := reflect.TypeOf(stu)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"type:\"</span>, typeOfstu.Name(), <span class=\"string\">\"kind:\"</span>, typeOfstu.Kind())</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// type: Student kind: struct</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>(Kind) <code>Array</code>, <code>Chan</code>, <code>Map</code>, <code>Ptr</code>  <code>Slice</code> ,  <code>Name()</code> ()</p>\n<p>,  <code>Elem()</code> ,  <code>Name()</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    stu := Student&#123;</span><br><span class=\"line\">    \tName:  <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">    \tAge:   <span class=\"number\">20</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ptrOfstu := &amp;stu</span><br><span class=\"line\">    a:=[<span class=\"number\">3</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>&#125;</span><br><span class=\"line\">    typeOfptr := reflect.TypeOf(a)  <span class=\"comment\">//  &amp;stu  `reflect.Type`</span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"type:\"</span>, typeOfptr.Name(), <span class=\"string\">\"kind:\"</span>, typeOfptr.Kind())  <span class=\"comment\">//  type:  kind: ptr</span></span><br><span class=\"line\">    elemType := typeOfptr.Elem()</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"elem's type:\"</span>, elem.Name(), <span class=\"string\">\"elem's kind:\"</span>, elem.Kind())  <span class=\"comment\">//  elem's type: Student elem's kind: struct</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// type:  kind: ptr</span></span><br><span class=\"line\"><span class=\"comment\">// type: Student kind: struct</span></span><br></pre></td></tr></table></figure>\n\n<p><code>reflect.Type</code>  <code>Elem()</code>  <code>Array</code>, <code>Chan</code>, <code>Map</code>, <code>Ptr</code>  <code>Slice</code> ,  <code>Elem()</code>  panics.</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> <code>reflect.TypeOf()</code> ,  <code>reflect.Type</code>  <code>NumField()</code>  <code>Field()</code> , <code>NumMethod()</code>  <code>Method()</code> </p>\n<p><code>reflect.Type</code> </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>NumField()</code></td>\n<td align=\"center\">-</td>\n<td align=\"center\">int</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>Field(i int)</code></td>\n<td align=\"center\">, 0 </td>\n<td align=\"center\">reflect.StructField</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>NumMethod()</code></td>\n<td align=\"center\">-</td>\n<td align=\"center\">int</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>Method(i int)</code></td>\n<td align=\"center\">, 0 </td>\n<td align=\"center\">reflect.Method</td>\n<td align=\"center\">,  ascii </td>\n</tr>\n</tbody></table>\n<p>,  <code>reflect.TypeOf(&amp;object).Method()</code> ,  receiver  <code>&amp;object</code> . <code>reflect.TypeOf(object).Method()</code>  receiver  <code>object</code> .  <code>Elem()</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span>  <span class=\"string\">`json: \"name\"`</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span>     <span class=\"string\">`json: \"age\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu Student)</span> <span class=\"title\">GetSum</span><span class=\"params\">(n1, n2 <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> n1 + n2</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Print</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tfmt.Println(*stu)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Set</span><span class=\"params\">(name <span class=\"keyword\">string</span>, age <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\tstu.Name = name</span><br><span class=\"line\">\tstu.Age = age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tstu := Student&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">20</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\ttypeOfstu := reflect.TypeOf(stu)</span><br><span class=\"line\">\tkindOfstu := typeOfstu.Kind()</span><br><span class=\"line\">\ttypeOfptr := reflect.TypeOf(&amp;stu)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> kindOfstu != reflect.Struct &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"except struct...\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tfieldNum := typeOfstu.NumField()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\": \"</span>, fieldNum)  <span class=\"comment\">// 2</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; fieldNum; i++ &#123;</span><br><span class=\"line\">\t\tfield := typeOfstu.Field(i)</span><br><span class=\"line\">\t\tfmt.Println(field)</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\": %v, : %v,  json : %v\\n\"</span>, field.Name, field.Type, field.Tag.Get(<span class=\"string\">\"json\"</span>))  <span class=\"comment\">// Tag.Get(key) </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tmethodNumOfstu := typeOfstu.NumMethod()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"stu: \"</span>, methodNumOfstu)  <span class=\"comment\">// 1</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; methodNumOfstu; i++ &#123;</span><br><span class=\"line\">\t\tmethod := typeOfstu.Method(i)</span><br><span class=\"line\">\t\tfmt.Println(method)</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\": %v, : %v\\n\"</span>, method.Name, method.Type)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tmethodNumOfptr := typeOfptr.NumMethod()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"&amp;stu: \"</span>, methodNumOfptr)   <span class=\"comment\">// 3</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; methodNumOfptr; i++ &#123;</span><br><span class=\"line\">\t\tmethod := typeOfptr.Method(i)</span><br><span class=\"line\">\t\tfmt.Println(method)</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\": %v, : %v, \\n\"</span>, method.Name, method.Type, method.Func)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-reflect-Value\"><a href=\"#-reflect-Value\" class=\"headerlink\" title=\" reflect.Value\"></a> <code>reflect.Value</code></h2><p> <code>reflect.ValueOf()</code>  <code>reflect.Value</code>. <code>reflect.Value</code>  <code>Type()</code>  <code>reflect.Type</code> , .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> n <span class=\"keyword\">int</span> = <span class=\"number\">20</span></span><br><span class=\"line\">    valueOfN := reflect.ValueOf(n)  <span class=\"comment\">//  n   `reflect.Value`</span></span><br><span class=\"line\">    typeOfN := valueOfN.Type() <span class=\"comment\">// ,  reflect.TypeOf(n)</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\": %v,  %T\"</span>, valueOfN, valueOfN)  <span class=\"comment\">//  : 20,  reflect.Value</span></span><br><span class=\"line\">    n2, ok := valueOfN.Interface().(<span class=\"keyword\">int</span>) <span class=\"comment\">//  reflect.Value  interface,  int </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ok &#123;</span><br><span class=\"line\">    \tfmt.Printf(<span class=\"string\">\": %v,  %T\"</span>, n2, n2)  <span class=\"comment\">//  : 20,  int</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2020/04/30/go-study-notes-reflect/conversion_between_actual_type_and_reflection.jpg\" alt=\"\"></p>\n<p>,  <code>reflect.ValueOf(i interface{})</code> ,  <code>reflect.Value</code> . <code>reflect.Value</code>  <code>Interface()</code> , , .</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> <code>reflect.ValueOf()</code> ,  <code>reflect.Value</code>  <code>NumField()</code>  <code>Field()</code> , <code>NumMethod()</code>  <code>Method()</code> </p>\n<p><code>reflect.Value</code> :</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>NumField()</code></td>\n<td align=\"center\">-</td>\n<td align=\"center\">int</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>Field(i int)</code></td>\n<td align=\"center\">, 0 </td>\n<td align=\"center\">reflect.Value</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>NumMethod()</code></td>\n<td align=\"center\">-</td>\n<td align=\"center\">int</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>Method(i int)</code></td>\n<td align=\"center\">, 0 </td>\n<td align=\"center\">reflect.Value</td>\n<td align=\"center\">, (),  ascii </td>\n</tr>\n</tbody></table>\n<p>,  <code>reflect.ValueOf(&amp;object).Method()</code> ,  receiver  <code>&amp;object</code> . <code>reflect.ValueOf(object).Method()</code>  receiver  <code>object</code> .  <code>Elem()</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span>  <span class=\"string\">`json: \"name\"`</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span>     <span class=\"string\">`json: \"age\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu Student)</span> <span class=\"title\">GetSum</span><span class=\"params\">(n1, n2 <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> n1 + n2</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Print</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tfmt.Println(*stu)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Set</span><span class=\"params\">(name <span class=\"keyword\">string</span>, age <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\tstu.Name = name</span><br><span class=\"line\">\tstu.Age = age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tstu := Student&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">20</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tvalueOfstu := reflect.ValueOf(stu)</span><br><span class=\"line\">\tkindOfstu := valueOfstu.Kind()</span><br><span class=\"line\">\tvalueOfptr := reflect.ValueOf(&amp;stu)</span><br><span class=\"line\">    typeOfStu := valueOfstu.Type()  <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> kindOfstu != reflect.Struct &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"except struct...\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tfieldNum := typeOfstu.NumField()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\": \"</span>, fieldNum)  <span class=\"comment\">// 2</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; fieldNum; i++ &#123;</span><br><span class=\"line\">\t\tfield := typeOfstu.Field(i)</span><br><span class=\"line\">\t\tfmt.Println(field)  <span class=\"comment\">// </span></span><br><span class=\"line\">        </span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tmethodNumOfstu := typeOfstu.NumMethod()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"stu: \"</span>, methodNumOfstu)  <span class=\"comment\">// 1</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; methodNumOfstu; i++ &#123;</span><br><span class=\"line\">\t\tmethod := typeOfstu.Method(i)</span><br><span class=\"line\">\t\tfmt.Println(method)  <span class=\"comment\">//  0x4878c0 , , </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tmethodNumOfptr := typeOfptr.NumMethod()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"&amp;stu: \"</span>, methodNumOfptr)   <span class=\"comment\">// 3</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; methodNumOfptr; i++ &#123;</span><br><span class=\"line\">\t\tmethod := typeOfptr.Method(i)</span><br><span class=\"line\">\t\tfmt.Println(method) <span class=\"comment\">//  0x4878c0 , , </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,  <code>Student</code> ?</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span>  <span class=\"string\">`json: \"name\"`</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span>     <span class=\"string\">`json: \"age\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu Student)</span> <span class=\"title\">GetSum</span><span class=\"params\">(n1, n2 <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> n1 + n2</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Print</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tfmt.Println(*stu)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Set</span><span class=\"params\">(name <span class=\"keyword\">string</span>, age <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\tstu.Name = name</span><br><span class=\"line\">\tstu.Age = age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tstu := Student&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">20</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tvalueOfStu := reflect.ValueOf(&amp;stu)  <span class=\"comment\">//  &amp;stu, , </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  reflect.Value  Call()  GetSum(n1, n2 int) int , Call() []reflect.Value </span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> paramsGetSum []reflect.Value</span><br><span class=\"line\">\tparamsGetSum = <span class=\"built_in\">append</span>(paramsGetSum, reflect.ValueOf(<span class=\"number\">10</span>))</span><br><span class=\"line\">\tparamsGetSum = <span class=\"built_in\">append</span>(paramsGetSum, reflect.ValueOf(<span class=\"number\">20</span>))</span><br><span class=\"line\">\tresGetSum := valueOfStu.Method(<span class=\"number\">0</span>).Call(paramsGetSum)  <span class=\"comment\">//  []reflect.Value, </span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\" %v,  %T\"</span>, resGetSum, resGetSum)  <span class=\"comment\">//  : 30,  []reflect.Value</span></span><br><span class=\"line\">    resGetSum0 := resGetSum[<span class=\"number\">0</span>]</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\" %v,  %T\\n\"</span>, resGetSum0, resGetSum0)  <span class=\"comment\">//  : 30,  reflect.Value</span></span><br><span class=\"line\">\trealRes0 := resGetSum[<span class=\"number\">0</span>].Interface().(<span class=\"keyword\">int</span>)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\" %v,  %T\\n\"</span>, realRes, realRes)  <span class=\"comment\">//  : 30,  int</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//  reflect.Value  Call()  Print() , Call() []reflect.Value </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> paramsPrint []reflect.Value</span><br><span class=\"line\">\tresPrint := valueOfStu.Method(<span class=\"number\">1</span>).Call(paramsPrint)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\" %v,  %T\"</span>, resPrint, resPrint)  <span class=\"comment\">//  : [],  []reflect.Value</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//  reflect.Value  Call()  Set(name string, age int) , Call() []reflect.Value </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> paramsSet []reflect.Value</span><br><span class=\"line\">\tparamsSet = <span class=\"built_in\">append</span>(paramsSet, reflect.ValueOf(<span class=\"string\">\"jack\"</span>))</span><br><span class=\"line\">\tparamsSet = <span class=\"built_in\">append</span>(paramsSet, reflect.ValueOf(<span class=\"number\">30</span>))</span><br><span class=\"line\">\tresSet := valueOfStu.Method(<span class=\"number\">2</span>).Call(paramsSet)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\" %v,  %T\\n\"</span>, resSet, resSet) <span class=\"comment\">//  : [],  []reflect.Value</span></span><br><span class=\"line\">\tfmt.Println(stu)  <span class=\"comment\">//  stu  &#123;jack 30&#125;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"StructField-\"><a href=\"#StructField-\" class=\"headerlink\" title=\"StructField \"></a>StructField </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> StructField <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Name <span class=\"keyword\">string</span>          <span class=\"comment\">// </span></span><br><span class=\"line\">    PkgPath <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    Type      Type       <span class=\"comment\">// </span></span><br><span class=\"line\">    Tag       StructTag  <span class=\"comment\">// </span></span><br><span class=\"line\">    Offset    <span class=\"keyword\">uintptr</span>    <span class=\"comment\">// </span></span><br><span class=\"line\">    Index     []<span class=\"keyword\">int</span>      <span class=\"comment\">// Type.FieldByIndex</span></span><br><span class=\"line\">    Anonymous <span class=\"keyword\">bool</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> StructTag <span class=\"keyword\">string</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Method-\"><a href=\"#Method-\" class=\"headerlink\" title=\"Method \"></a>Method </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Method <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName    <span class=\"keyword\">string</span> <span class=\"comment\">// </span></span><br><span class=\"line\">\tPkgPath <span class=\"keyword\">string</span> <span class=\"comment\">// </span></span><br><span class=\"line\">\tType    Type   <span class=\"comment\">// </span></span><br><span class=\"line\">\tFunc    Value  <span class=\"comment\">//  func</span></span><br><span class=\"line\">\tIndex   <span class=\"keyword\">int</span>    <span class=\"comment\">// Type.Method </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p>. , , , .</p>\n<p>, , , , , , .</p>\n<p> Type  Value . Go  <code>reflect</code> ,  <code>reflect.Type</code>  <code>reflect.Value</code>,  <code>reflect.TypeOf</code>  <code>reflect.ValueOf</code>  Value  Type.</p>\n<h2 id=\"-reflect-Type\"><a href=\"#-reflect-Type\" class=\"headerlink\" title=\" reflect.Type\"></a> <code>reflect.Type</code></h2><p> Go ,  <code>reflect.TypeOf()</code>  <code>reflect.Type</code> , .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> n <span class=\"keyword\">int</span> = <span class=\"number\">20</span></span><br><span class=\"line\">    typeOfn := reflect.TypeOf(n)  <span class=\"comment\">//  n   `reflect.Type`</span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"type:\"</span>, typeOfn.Name(), <span class=\"string\">\"kind:\"</span>, typeOfn.Kind())  <span class=\"comment\">//  type: int kind: int</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-Name--Kind\"><a href=\"#-Name--Kind\" class=\"headerlink\" title=\"(Name)(Kind)\"></a>(Name)(Kind)</h3><ul>\n<li>Name() ,  Go  type .  <code>reflect.Type</code>  <code>Name()</code> </li>\n<li>Kind() ,  Go .  <code>reflect.Type</code>  <code>Kind()</code> ,  <code>reflect.Kind</code> </li>\n</ul>\n<p>, <code>stu</code>  <code>Student</code>,  <code>struct</code>.</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    stu := Student&#123;</span><br><span class=\"line\">    \tName:  <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">    \tAge:   <span class=\"number\">20</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    typeOfstu := reflect.TypeOf(stu)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"type:\"</span>, typeOfstu.Name(), <span class=\"string\">\"kind:\"</span>, typeOfstu.Kind())</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// type: Student kind: struct</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>(Kind) <code>Array</code>, <code>Chan</code>, <code>Map</code>, <code>Ptr</code>  <code>Slice</code> ,  <code>Name()</code> ()</p>\n<p>,  <code>Elem()</code> ,  <code>Name()</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    stu := Student&#123;</span><br><span class=\"line\">    \tName:  <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">    \tAge:   <span class=\"number\">20</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ptrOfstu := &amp;stu</span><br><span class=\"line\">    a:=[<span class=\"number\">3</span>]<span class=\"keyword\">int</span>&#123;<span class=\"number\">1</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>&#125;</span><br><span class=\"line\">    typeOfptr := reflect.TypeOf(a)  <span class=\"comment\">//  &amp;stu  `reflect.Type`</span></span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"type:\"</span>, typeOfptr.Name(), <span class=\"string\">\"kind:\"</span>, typeOfptr.Kind())  <span class=\"comment\">//  type:  kind: ptr</span></span><br><span class=\"line\">    elemType := typeOfptr.Elem()</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"elem's type:\"</span>, elem.Name(), <span class=\"string\">\"elem's kind:\"</span>, elem.Kind())  <span class=\"comment\">//  elem's type: Student elem's kind: struct</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// type:  kind: ptr</span></span><br><span class=\"line\"><span class=\"comment\">// type: Student kind: struct</span></span><br></pre></td></tr></table></figure>\n\n<p><code>reflect.Type</code>  <code>Elem()</code>  <code>Array</code>, <code>Chan</code>, <code>Map</code>, <code>Ptr</code>  <code>Slice</code> ,  <code>Elem()</code>  panics.</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> <code>reflect.TypeOf()</code> ,  <code>reflect.Type</code>  <code>NumField()</code>  <code>Field()</code> , <code>NumMethod()</code>  <code>Method()</code> </p>\n<p><code>reflect.Type</code> </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>NumField()</code></td>\n<td align=\"center\">-</td>\n<td align=\"center\">int</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>Field(i int)</code></td>\n<td align=\"center\">, 0 </td>\n<td align=\"center\">reflect.StructField</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>NumMethod()</code></td>\n<td align=\"center\">-</td>\n<td align=\"center\">int</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>Method(i int)</code></td>\n<td align=\"center\">, 0 </td>\n<td align=\"center\">reflect.Method</td>\n<td align=\"center\">,  ascii </td>\n</tr>\n</tbody></table>\n<p>,  <code>reflect.TypeOf(&amp;object).Method()</code> ,  receiver  <code>&amp;object</code> . <code>reflect.TypeOf(object).Method()</code>  receiver  <code>object</code> .  <code>Elem()</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span>  <span class=\"string\">`json: \"name\"`</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span>     <span class=\"string\">`json: \"age\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu Student)</span> <span class=\"title\">GetSum</span><span class=\"params\">(n1, n2 <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> n1 + n2</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Print</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tfmt.Println(*stu)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Set</span><span class=\"params\">(name <span class=\"keyword\">string</span>, age <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\tstu.Name = name</span><br><span class=\"line\">\tstu.Age = age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tstu := Student&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">20</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\ttypeOfstu := reflect.TypeOf(stu)</span><br><span class=\"line\">\tkindOfstu := typeOfstu.Kind()</span><br><span class=\"line\">\ttypeOfptr := reflect.TypeOf(&amp;stu)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> kindOfstu != reflect.Struct &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"except struct...\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tfieldNum := typeOfstu.NumField()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\": \"</span>, fieldNum)  <span class=\"comment\">// 2</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; fieldNum; i++ &#123;</span><br><span class=\"line\">\t\tfield := typeOfstu.Field(i)</span><br><span class=\"line\">\t\tfmt.Println(field)</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\": %v, : %v,  json : %v\\n\"</span>, field.Name, field.Type, field.Tag.Get(<span class=\"string\">\"json\"</span>))  <span class=\"comment\">// Tag.Get(key) </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tmethodNumOfstu := typeOfstu.NumMethod()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"stu: \"</span>, methodNumOfstu)  <span class=\"comment\">// 1</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; methodNumOfstu; i++ &#123;</span><br><span class=\"line\">\t\tmethod := typeOfstu.Method(i)</span><br><span class=\"line\">\t\tfmt.Println(method)</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\": %v, : %v\\n\"</span>, method.Name, method.Type)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tmethodNumOfptr := typeOfptr.NumMethod()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"&amp;stu: \"</span>, methodNumOfptr)   <span class=\"comment\">// 3</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; methodNumOfptr; i++ &#123;</span><br><span class=\"line\">\t\tmethod := typeOfptr.Method(i)</span><br><span class=\"line\">\t\tfmt.Println(method)</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\": %v, : %v, \\n\"</span>, method.Name, method.Type, method.Func)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-reflect-Value\"><a href=\"#-reflect-Value\" class=\"headerlink\" title=\" reflect.Value\"></a> <code>reflect.Value</code></h2><p> <code>reflect.ValueOf()</code>  <code>reflect.Value</code>. <code>reflect.Value</code>  <code>Type()</code>  <code>reflect.Type</code> , .</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> n <span class=\"keyword\">int</span> = <span class=\"number\">20</span></span><br><span class=\"line\">    valueOfN := reflect.ValueOf(n)  <span class=\"comment\">//  n   `reflect.Value`</span></span><br><span class=\"line\">    typeOfN := valueOfN.Type() <span class=\"comment\">// ,  reflect.TypeOf(n)</span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\": %v,  %T\"</span>, valueOfN, valueOfN)  <span class=\"comment\">//  : 20,  reflect.Value</span></span><br><span class=\"line\">    n2, ok := valueOfN.Interface().(<span class=\"keyword\">int</span>) <span class=\"comment\">//  reflect.Value  interface,  int </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ok &#123;</span><br><span class=\"line\">    \tfmt.Printf(<span class=\"string\">\": %v,  %T\"</span>, n2, n2)  <span class=\"comment\">//  : 20,  int</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2020/04/30/go-study-notes-reflect/conversion_between_actual_type_and_reflection.jpg\" alt=\"\"></p>\n<p>,  <code>reflect.ValueOf(i interface{})</code> ,  <code>reflect.Value</code> . <code>reflect.Value</code>  <code>Interface()</code> , , .</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> <code>reflect.ValueOf()</code> ,  <code>reflect.Value</code>  <code>NumField()</code>  <code>Field()</code> , <code>NumMethod()</code>  <code>Method()</code> </p>\n<p><code>reflect.Value</code> :</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>NumField()</code></td>\n<td align=\"center\">-</td>\n<td align=\"center\">int</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>Field(i int)</code></td>\n<td align=\"center\">, 0 </td>\n<td align=\"center\">reflect.Value</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>NumMethod()</code></td>\n<td align=\"center\">-</td>\n<td align=\"center\">int</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>Method(i int)</code></td>\n<td align=\"center\">, 0 </td>\n<td align=\"center\">reflect.Value</td>\n<td align=\"center\">, (),  ascii </td>\n</tr>\n</tbody></table>\n<p>,  <code>reflect.ValueOf(&amp;object).Method()</code> ,  receiver  <code>&amp;object</code> . <code>reflect.ValueOf(object).Method()</code>  receiver  <code>object</code> .  <code>Elem()</code> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span>  <span class=\"string\">`json: \"name\"`</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span>     <span class=\"string\">`json: \"age\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu Student)</span> <span class=\"title\">GetSum</span><span class=\"params\">(n1, n2 <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> n1 + n2</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Print</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tfmt.Println(*stu)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Set</span><span class=\"params\">(name <span class=\"keyword\">string</span>, age <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\tstu.Name = name</span><br><span class=\"line\">\tstu.Age = age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tstu := Student&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">20</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tvalueOfstu := reflect.ValueOf(stu)</span><br><span class=\"line\">\tkindOfstu := valueOfstu.Kind()</span><br><span class=\"line\">\tvalueOfptr := reflect.ValueOf(&amp;stu)</span><br><span class=\"line\">    typeOfStu := valueOfstu.Type()  <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> kindOfstu != reflect.Struct &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"except struct...\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tfieldNum := typeOfstu.NumField()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\": \"</span>, fieldNum)  <span class=\"comment\">// 2</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; fieldNum; i++ &#123;</span><br><span class=\"line\">\t\tfield := typeOfstu.Field(i)</span><br><span class=\"line\">\t\tfmt.Println(field)  <span class=\"comment\">// </span></span><br><span class=\"line\">        </span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tmethodNumOfstu := typeOfstu.NumMethod()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"stu: \"</span>, methodNumOfstu)  <span class=\"comment\">// 1</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; methodNumOfstu; i++ &#123;</span><br><span class=\"line\">\t\tmethod := typeOfstu.Method(i)</span><br><span class=\"line\">\t\tfmt.Println(method)  <span class=\"comment\">//  0x4878c0 , , </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tmethodNumOfptr := typeOfptr.NumMethod()</span><br><span class=\"line\">\tfmt.Println(<span class=\"string\">\"&amp;stu: \"</span>, methodNumOfptr)   <span class=\"comment\">// 3</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i := <span class=\"number\">0</span>; i &lt; methodNumOfptr; i++ &#123;</span><br><span class=\"line\">\t\tmethod := typeOfptr.Method(i)</span><br><span class=\"line\">\t\tfmt.Println(method) <span class=\"comment\">//  0x4878c0 , , </span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,  <code>Student</code> ?</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Student <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName  <span class=\"keyword\">string</span>  <span class=\"string\">`json: \"name\"`</span></span><br><span class=\"line\">\tAge   <span class=\"keyword\">int</span>     <span class=\"string\">`json: \"age\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu Student)</span> <span class=\"title\">GetSum</span><span class=\"params\">(n1, n2 <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> n1 + n2</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Print</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tfmt.Println(*stu)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(stu *Student)</span> <span class=\"title\">Set</span><span class=\"params\">(name <span class=\"keyword\">string</span>, age <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">\tstu.Name = name</span><br><span class=\"line\">\tstu.Age = age</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tstu := Student&#123;</span><br><span class=\"line\">\t\tName: <span class=\"string\">\"tom\"</span>,</span><br><span class=\"line\">\t\tAge:  <span class=\"number\">20</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tvalueOfStu := reflect.ValueOf(&amp;stu)  <span class=\"comment\">//  &amp;stu, , </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  reflect.Value  Call()  GetSum(n1, n2 int) int , Call() []reflect.Value </span></span><br><span class=\"line\">\t<span class=\"keyword\">var</span> paramsGetSum []reflect.Value</span><br><span class=\"line\">\tparamsGetSum = <span class=\"built_in\">append</span>(paramsGetSum, reflect.ValueOf(<span class=\"number\">10</span>))</span><br><span class=\"line\">\tparamsGetSum = <span class=\"built_in\">append</span>(paramsGetSum, reflect.ValueOf(<span class=\"number\">20</span>))</span><br><span class=\"line\">\tresGetSum := valueOfStu.Method(<span class=\"number\">0</span>).Call(paramsGetSum)  <span class=\"comment\">//  []reflect.Value, </span></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\" %v,  %T\"</span>, resGetSum, resGetSum)  <span class=\"comment\">//  : 30,  []reflect.Value</span></span><br><span class=\"line\">    resGetSum0 := resGetSum[<span class=\"number\">0</span>]</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\" %v,  %T\\n\"</span>, resGetSum0, resGetSum0)  <span class=\"comment\">//  : 30,  reflect.Value</span></span><br><span class=\"line\">\trealRes0 := resGetSum[<span class=\"number\">0</span>].Interface().(<span class=\"keyword\">int</span>)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\" %v,  %T\\n\"</span>, realRes, realRes)  <span class=\"comment\">//  : 30,  int</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//  reflect.Value  Call()  Print() , Call() []reflect.Value </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> paramsPrint []reflect.Value</span><br><span class=\"line\">\tresPrint := valueOfStu.Method(<span class=\"number\">1</span>).Call(paramsPrint)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\" %v,  %T\"</span>, resPrint, resPrint)  <span class=\"comment\">//  : [],  []reflect.Value</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//  reflect.Value  Call()  Set(name string, age int) , Call() []reflect.Value </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> paramsSet []reflect.Value</span><br><span class=\"line\">\tparamsSet = <span class=\"built_in\">append</span>(paramsSet, reflect.ValueOf(<span class=\"string\">\"jack\"</span>))</span><br><span class=\"line\">\tparamsSet = <span class=\"built_in\">append</span>(paramsSet, reflect.ValueOf(<span class=\"number\">30</span>))</span><br><span class=\"line\">\tresSet := valueOfStu.Method(<span class=\"number\">2</span>).Call(paramsSet)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\" %v,  %T\\n\"</span>, resSet, resSet) <span class=\"comment\">//  : [],  []reflect.Value</span></span><br><span class=\"line\">\tfmt.Println(stu)  <span class=\"comment\">//  stu  &#123;jack 30&#125;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"StructField-\"><a href=\"#StructField-\" class=\"headerlink\" title=\"StructField \"></a>StructField </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> StructField <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Name <span class=\"keyword\">string</span>          <span class=\"comment\">// </span></span><br><span class=\"line\">    PkgPath <span class=\"keyword\">string</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">    Type      Type       <span class=\"comment\">// </span></span><br><span class=\"line\">    Tag       StructTag  <span class=\"comment\">// </span></span><br><span class=\"line\">    Offset    <span class=\"keyword\">uintptr</span>    <span class=\"comment\">// </span></span><br><span class=\"line\">    Index     []<span class=\"keyword\">int</span>      <span class=\"comment\">// Type.FieldByIndex</span></span><br><span class=\"line\">    Anonymous <span class=\"keyword\">bool</span>       <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">type</span> StructTag <span class=\"keyword\">string</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Method-\"><a href=\"#Method-\" class=\"headerlink\" title=\"Method \"></a>Method </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Method <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tName    <span class=\"keyword\">string</span> <span class=\"comment\">// </span></span><br><span class=\"line\">\tPkgPath <span class=\"keyword\">string</span> <span class=\"comment\">// </span></span><br><span class=\"line\">\tType    Type   <span class=\"comment\">// </span></span><br><span class=\"line\">\tFunc    Value  <span class=\"comment\">//  func</span></span><br><span class=\"line\">\tIndex   <span class=\"keyword\">int</span>    <span class=\"comment\">// Type.Method </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"istio ","abbrlink":11402,"description":"Istio 5 .","_content":"\n# \n\n> \n\n-  Citadel \n- Envoy ,,\n- Pilot , Envoy\n- Mixer  Adapter \n\n:\n- Citadel Kube-apiserver, Service , Kubernetes Secrets.Pod,Kubernetes  Secret Pod\n- Citadel, Kubernetes Secrets \n- Pilot, ServiceAccount  Envoy\n\n:\n-  Envoy  Outbound \n-  Envoy  Envoy  TLS \n- TLS, Envoy, Envoy \n\nIstio \n\n> \n\nistio :\n- : .Istio  TLS ,,.TLS\n- : ,\n\n> \n\nistio (RBAC)\n\n> \n\nCitadel  4 \n-  Service Account  SPIFFE \n- Service Account  Pod \n- \n- \n\n# \n\n\n```yaml\n#  forecast \napiVersion: authentication.istio.io/v1alpha1\nkind: Policy\nmetadata:\n  name: forecast-weather-mtls\n  namespace: istio-system\nspec:\n  targets:\n  - name: forecast\n  peers:\n  - mtls: {}\n```\n\n## \n\n:\n- `targets`: ,,. `name`  `ports` \n- `peers`: . mtls,.,\n- `orgins`: .\n\n## \n\n>  TLS \n\n```yaml\n# : ,\napiVersion: authentication.istio.io/v1alpha1\nkind: MeshPolicy\nmetadata:\n  name: default\nspec:\n  peers:\n  - mtls: {}\n```\n\n>  TLS ()\n\n```yaml\n# : ,\napiVersion: authentication.istio.io/v1alpha1\nkind: Policy\nmetadata:\n  name: default\n  namespace: default\nspec:\n  peers:\n  - mtls: {}\n```\n\n>  TLS \n\n```yaml\n---\napiVersion: authentication.istio.io/v1alpha1\nkind: Policy\nmetadata:\n  name: enable_weather_tls\n  namespace: weather\nspec:\n  peers:\n  - mtls:\n---\napiVersion: authentication.istio.io/v1alpha1\nkind: Policy\nmetadata:\n  name: disable_adv_tls\n  namespace: weather\nspec:\n  targets:\n  - name: advertisement\n```\n\n# \n\n## \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ClusterRbacConfig\nmetadata: ClusterRbacConfig\n  name: default\nspec:\n  mode: \"ON_WITH_INCLUSION\"\n  #  4 ,OFF(),ON(),ON_WITH_INCLUSION( inclusion ),ON_WITH_EXCLUSION( exclusion )\n  inclusion:\n    namespaces:\n    - weather\n    # services:\n    # - weather_service\n```\n## \n\n```yaml\n---\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"advertisement.weather.svc.cluster.local\"]\n    methods: [\"GET\"]\n---\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRoleBinding\nmetadata:\n  name: binding-advertisement-reader\n  namespace: weather\nspec:\n  subjects:\n  - properties:\n      source.namespace: \"terminal\"\n  roleRef:\n    kind: ServiceRole\n    name: advertisement-reader\n```\n\n> serviceRole \n\n `rules`,, rule \n- `servces`: ,\n- `paths`: . path\n- `methods`: , GET,POST \n- `constraints`: ,.\n    - `destination.labels`: , destination.labels[version]  [v1] \n    - `request.headers`:  Header  \n    - `destination.ip`:  IP \n    - `destination.port`: \n    - `destination.namespace`: \n    - `destination.user`: \n\n> serviceRoleBinding \n\nserviceRoleBinding ,, `roleRef`, `subjects`\n\n- `roleRef`: ,. `kind(,ServiceRole)`  `name()` \n- `subjects`: ,,,.\n    - `user`:  ID. \"*\" \n    - `properties`: .\n        - `source.ip`:  IP \n        - `source.namespace`: \n        - `source.principal`: \n        - `request.headers`:  HTTP header\n        - `request.auth.principal`: \n        - `request.auth.audiences`: \n        - `request.auth.presenter`: \n        - `request.auth.claims`: JWT\n\n## \n\n> \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"*\"]\n    methods: [\"*\"]\n---\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRoleBinding\nmetadata:\n  name: binding-advertisement-reader\n  namespace: weather\nspec:\n  subjects:\n  - properties:\n      source.namespace: \"client\"\n  roleRef:\n    kind: ServiceRole\n    name: advertisement-reader\n```\n\n> \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"advertisement.weather.svc.cluster.local\"]\n    methods: [\"GET\"]\n```\n\n> \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"advertisement.weather.svc.cluster.local\"]\n    paths: [\"v2/weatherdata\"]\n    methods: [\"GET\"]\n```\n\n> \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"advertisement.weather.svc.cluster.local\"]\n    methods: [\"GET\"]\n    constraints:\n    - key: \"destination.labels[version]\"\n      value: [\"v2\"]\n```\n\n> \n\n```\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRoleBinding\nmetadata:\n  name: binding-advertisement-reader\n  namespace: weather\nspec:\n  subjects:\n  - properties:\n      source.ip: \"1.1.0.0/16\"\n  roleRef:\n    kind: ServiceRole\n    name: advertisement-reader\n```","source":"_posts/istio-security-service.md","raw":"---\ntitle: istio \ntags:\n  - istio\n  - \ncategories:\n  - \n  - istio\nabbrlink: 11402\ndescription: Istio 5 .\n---\n\n# \n\n> \n\n-  Citadel \n- Envoy ,,\n- Pilot , Envoy\n- Mixer  Adapter \n\n:\n- Citadel Kube-apiserver, Service , Kubernetes Secrets.Pod,Kubernetes  Secret Pod\n- Citadel, Kubernetes Secrets \n- Pilot, ServiceAccount  Envoy\n\n:\n-  Envoy  Outbound \n-  Envoy  Envoy  TLS \n- TLS, Envoy, Envoy \n\nIstio \n\n> \n\nistio :\n- : .Istio  TLS ,,.TLS\n- : ,\n\n> \n\nistio (RBAC)\n\n> \n\nCitadel  4 \n-  Service Account  SPIFFE \n- Service Account  Pod \n- \n- \n\n# \n\n\n```yaml\n#  forecast \napiVersion: authentication.istio.io/v1alpha1\nkind: Policy\nmetadata:\n  name: forecast-weather-mtls\n  namespace: istio-system\nspec:\n  targets:\n  - name: forecast\n  peers:\n  - mtls: {}\n```\n\n## \n\n:\n- `targets`: ,,. `name`  `ports` \n- `peers`: . mtls,.,\n- `orgins`: .\n\n## \n\n>  TLS \n\n```yaml\n# : ,\napiVersion: authentication.istio.io/v1alpha1\nkind: MeshPolicy\nmetadata:\n  name: default\nspec:\n  peers:\n  - mtls: {}\n```\n\n>  TLS ()\n\n```yaml\n# : ,\napiVersion: authentication.istio.io/v1alpha1\nkind: Policy\nmetadata:\n  name: default\n  namespace: default\nspec:\n  peers:\n  - mtls: {}\n```\n\n>  TLS \n\n```yaml\n---\napiVersion: authentication.istio.io/v1alpha1\nkind: Policy\nmetadata:\n  name: enable_weather_tls\n  namespace: weather\nspec:\n  peers:\n  - mtls:\n---\napiVersion: authentication.istio.io/v1alpha1\nkind: Policy\nmetadata:\n  name: disable_adv_tls\n  namespace: weather\nspec:\n  targets:\n  - name: advertisement\n```\n\n# \n\n## \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ClusterRbacConfig\nmetadata: ClusterRbacConfig\n  name: default\nspec:\n  mode: \"ON_WITH_INCLUSION\"\n  #  4 ,OFF(),ON(),ON_WITH_INCLUSION( inclusion ),ON_WITH_EXCLUSION( exclusion )\n  inclusion:\n    namespaces:\n    - weather\n    # services:\n    # - weather_service\n```\n## \n\n```yaml\n---\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"advertisement.weather.svc.cluster.local\"]\n    methods: [\"GET\"]\n---\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRoleBinding\nmetadata:\n  name: binding-advertisement-reader\n  namespace: weather\nspec:\n  subjects:\n  - properties:\n      source.namespace: \"terminal\"\n  roleRef:\n    kind: ServiceRole\n    name: advertisement-reader\n```\n\n> serviceRole \n\n `rules`,, rule \n- `servces`: ,\n- `paths`: . path\n- `methods`: , GET,POST \n- `constraints`: ,.\n    - `destination.labels`: , destination.labels[version]  [v1] \n    - `request.headers`:  Header  \n    - `destination.ip`:  IP \n    - `destination.port`: \n    - `destination.namespace`: \n    - `destination.user`: \n\n> serviceRoleBinding \n\nserviceRoleBinding ,, `roleRef`, `subjects`\n\n- `roleRef`: ,. `kind(,ServiceRole)`  `name()` \n- `subjects`: ,,,.\n    - `user`:  ID. \"*\" \n    - `properties`: .\n        - `source.ip`:  IP \n        - `source.namespace`: \n        - `source.principal`: \n        - `request.headers`:  HTTP header\n        - `request.auth.principal`: \n        - `request.auth.audiences`: \n        - `request.auth.presenter`: \n        - `request.auth.claims`: JWT\n\n## \n\n> \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"*\"]\n    methods: [\"*\"]\n---\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRoleBinding\nmetadata:\n  name: binding-advertisement-reader\n  namespace: weather\nspec:\n  subjects:\n  - properties:\n      source.namespace: \"client\"\n  roleRef:\n    kind: ServiceRole\n    name: advertisement-reader\n```\n\n> \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"advertisement.weather.svc.cluster.local\"]\n    methods: [\"GET\"]\n```\n\n> \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"advertisement.weather.svc.cluster.local\"]\n    paths: [\"v2/weatherdata\"]\n    methods: [\"GET\"]\n```\n\n> \n\n```yaml\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRole\nmetadata:\n  name: advertisement-reader\n  namespace: weather\nspec:\n  rules:\n  - services: [\"advertisement.weather.svc.cluster.local\"]\n    methods: [\"GET\"]\n    constraints:\n    - key: \"destination.labels[version]\"\n      value: [\"v2\"]\n```\n\n> \n\n```\napiVersion: rbac.istio.io/v1alpha1\nkind: ServiceRoleBinding\nmetadata:\n  name: binding-advertisement-reader\n  namespace: weather\nspec:\n  subjects:\n  - properties:\n      source.ip: \"1.1.0.0/16\"\n  roleRef:\n    kind: ServiceRole\n    name: advertisement-reader\n```","slug":"istio-security-service","published":1,"date":"2020-04-30T02:18:46.822Z","updated":"2020-04-30T11:48:51.140Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvy002lk8u739s7ff2y","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li> Citadel </li>\n<li>Envoy ,,</li>\n<li>Pilot , Envoy</li>\n<li>Mixer  Adapter </li>\n</ul>\n<p>:</p>\n<ul>\n<li>Citadel Kube-apiserver, Service , Kubernetes Secrets.Pod,Kubernetes  Secret Pod</li>\n<li>Citadel, Kubernetes Secrets </li>\n<li>Pilot, ServiceAccount  Envoy</li>\n</ul>\n<p>:</p>\n<ul>\n<li> Envoy  Outbound </li>\n<li> Envoy  Envoy  TLS </li>\n<li>TLS, Envoy, Envoy </li>\n</ul>\n<p>Istio </p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>istio :</p>\n<ul>\n<li>: .Istio  TLS ,,.TLS</li>\n<li>: ,</li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<p>istio (RBAC)</p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>Citadel  4 </p>\n<ul>\n<li> Service Account  SPIFFE </li>\n<li>Service Account  Pod </li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  forecast </span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Policy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">forecast-weather-mtls</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">targets:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">  <span class=\"attr\">peers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">mtls:</span> <span class=\"string\">&#123;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<ul>\n<li><code>targets</code>: ,,. <code>name</code>  <code>ports</code> </li>\n<li><code>peers</code>: . mtls,.,</li>\n<li><code>orgins</code>: .</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p> TLS </p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># : ,</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">MeshPolicy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">default</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">peers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">mtls:</span> <span class=\"string\">&#123;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p> TLS ()</p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># : ,</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Policy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">default</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">default</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">peers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">mtls:</span> <span class=\"string\">&#123;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p> TLS </p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Policy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">enable_weather_tls</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">peers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">mtls:</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Policy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">disable_adv_tls</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">targets:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">advertisement</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ClusterRbacConfig</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span> <span class=\"string\">ClusterRbacConfig</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">default</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">mode:</span> <span class=\"string\">\"ON_WITH_INCLUSION\"</span></span><br><span class=\"line\">  <span class=\"comment\">#  4 ,OFF(),ON(),ON_WITH_INCLUSION( inclusion ),ON_WITH_EXCLUSION( exclusion )</span></span><br><span class=\"line\">  <span class=\"attr\">inclusion:</span></span><br><span class=\"line\">    <span class=\"attr\">namespaces:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather</span></span><br><span class=\"line\">    <span class=\"comment\"># services:</span></span><br><span class=\"line\">    <span class=\"comment\"># - weather_service</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"advertisement.weather.svc.cluster.local\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"GET\"]</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">binding-advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">subjects:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">properties:</span></span><br><span class=\"line\">      <span class=\"attr\">source.namespace:</span> <span class=\"string\">\"terminal\"</span></span><br><span class=\"line\">  <span class=\"attr\">roleRef:</span></span><br><span class=\"line\">    <span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\">    <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>serviceRole </p>\n</blockquote>\n<p> <code>rules</code>,, rule </p>\n<ul>\n<li><code>servces</code>: ,</li>\n<li><code>paths</code>: . path</li>\n<li><code>methods</code>: , GET,POST </li>\n<li><code>constraints</code>: ,.<ul>\n<li><code>destination.labels</code>: , destination.labels[version]  [v1] </li>\n<li><code>request.headers</code>:  Header  </li>\n<li><code>destination.ip</code>:  IP </li>\n<li><code>destination.port</code>: </li>\n<li><code>destination.namespace</code>: </li>\n<li><code>destination.user</code>: </li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>serviceRoleBinding </p>\n</blockquote>\n<p>serviceRoleBinding ,, <code>roleRef</code>, <code>subjects</code></p>\n<ul>\n<li><code>roleRef</code>: ,. <code>kind(,ServiceRole)</code>  <code>name()</code> </li>\n<li><code>subjects</code>: ,,,.<ul>\n<li><code>user</code>:  ID. * </li>\n<li><code>properties</code>: .<ul>\n<li><code>source.ip</code>:  IP </li>\n<li><code>source.namespace</code>: </li>\n<li><code>source.principal</code>: </li>\n<li><code>request.headers</code>:  HTTP header</li>\n<li><code>request.auth.principal</code>: </li>\n<li><code>request.auth.audiences</code>: </li>\n<li><code>request.auth.presenter</code>: </li>\n<li><code>request.auth.claims</code>: JWT</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"*\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"*\"]</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">binding-advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">subjects:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">properties:</span></span><br><span class=\"line\">      <span class=\"attr\">source.namespace:</span> <span class=\"string\">\"client\"</span></span><br><span class=\"line\">  <span class=\"attr\">roleRef:</span></span><br><span class=\"line\">    <span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\">    <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"advertisement.weather.svc.cluster.local\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"GET\"]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"advertisement.weather.svc.cluster.local\"]</span></span><br><span class=\"line\">    <span class=\"attr\">paths:</span> <span class=\"string\">[\"v2/weatherdata\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"GET\"]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"advertisement.weather.svc.cluster.local\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"GET\"]</span></span><br><span class=\"line\">    <span class=\"attr\">constraints:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">\"destination.labels[version]\"</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"string\">[\"v2\"]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">apiVersion</span>: rbac.istio.io/v1alpha1</span><br><span class=\"line\"><span class=\"attribute\">kind</span>: ServiceRoleBinding</span><br><span class=\"line\"><span class=\"attribute\">metadata</span>:</span><br><span class=\"line\">  <span class=\"attribute\">name</span>: binding-advertisement-reader</span><br><span class=\"line\">  <span class=\"attribute\">namespace</span>: weather</span><br><span class=\"line\"><span class=\"attribute\">spec</span>:</span><br><span class=\"line\">  <span class=\"attribute\">subjects</span>:</span><br><span class=\"line\">  - <span class=\"attribute\">properties</span>:</span><br><span class=\"line\">      source.<span class=\"attribute\">ip</span>: <span class=\"string\">\"1.1.0.0/16\"</span></span><br><span class=\"line\">  <span class=\"attribute\">roleRef</span>:</span><br><span class=\"line\">    <span class=\"attribute\">kind</span>: ServiceRole</span><br><span class=\"line\">    <span class=\"attribute\">name</span>: advertisement-reader</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li> Citadel </li>\n<li>Envoy ,,</li>\n<li>Pilot , Envoy</li>\n<li>Mixer  Adapter </li>\n</ul>\n<p>:</p>\n<ul>\n<li>Citadel Kube-apiserver, Service , Kubernetes Secrets.Pod,Kubernetes  Secret Pod</li>\n<li>Citadel, Kubernetes Secrets </li>\n<li>Pilot, ServiceAccount  Envoy</li>\n</ul>\n<p>:</p>\n<ul>\n<li> Envoy  Outbound </li>\n<li> Envoy  Envoy  TLS </li>\n<li>TLS, Envoy, Envoy </li>\n</ul>\n<p>Istio </p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>istio :</p>\n<ul>\n<li>: .Istio  TLS ,,.TLS</li>\n<li>: ,</li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<p>istio (RBAC)</p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>Citadel  4 </p>\n<ul>\n<li> Service Account  SPIFFE </li>\n<li>Service Account  Pod </li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  forecast </span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Policy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">forecast-weather-mtls</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">targets:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">  <span class=\"attr\">peers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">mtls:</span> <span class=\"string\">&#123;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<ul>\n<li><code>targets</code>: ,,. <code>name</code>  <code>ports</code> </li>\n<li><code>peers</code>: . mtls,.,</li>\n<li><code>orgins</code>: .</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p> TLS </p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># : ,</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">MeshPolicy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">default</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">peers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">mtls:</span> <span class=\"string\">&#123;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p> TLS ()</p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># : ,</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Policy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">default</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">default</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">peers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">mtls:</span> <span class=\"string\">&#123;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p> TLS </p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Policy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">enable_weather_tls</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">peers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">mtls:</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">authentication.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Policy</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">disable_adv_tls</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">targets:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">advertisement</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ClusterRbacConfig</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span> <span class=\"string\">ClusterRbacConfig</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">default</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">mode:</span> <span class=\"string\">\"ON_WITH_INCLUSION\"</span></span><br><span class=\"line\">  <span class=\"comment\">#  4 ,OFF(),ON(),ON_WITH_INCLUSION( inclusion ),ON_WITH_EXCLUSION( exclusion )</span></span><br><span class=\"line\">  <span class=\"attr\">inclusion:</span></span><br><span class=\"line\">    <span class=\"attr\">namespaces:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather</span></span><br><span class=\"line\">    <span class=\"comment\"># services:</span></span><br><span class=\"line\">    <span class=\"comment\"># - weather_service</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"advertisement.weather.svc.cluster.local\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"GET\"]</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">binding-advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">subjects:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">properties:</span></span><br><span class=\"line\">      <span class=\"attr\">source.namespace:</span> <span class=\"string\">\"terminal\"</span></span><br><span class=\"line\">  <span class=\"attr\">roleRef:</span></span><br><span class=\"line\">    <span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\">    <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>serviceRole </p>\n</blockquote>\n<p> <code>rules</code>,, rule </p>\n<ul>\n<li><code>servces</code>: ,</li>\n<li><code>paths</code>: . path</li>\n<li><code>methods</code>: , GET,POST </li>\n<li><code>constraints</code>: ,.<ul>\n<li><code>destination.labels</code>: , destination.labels[version]  [v1] </li>\n<li><code>request.headers</code>:  Header  </li>\n<li><code>destination.ip</code>:  IP </li>\n<li><code>destination.port</code>: </li>\n<li><code>destination.namespace</code>: </li>\n<li><code>destination.user</code>: </li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>serviceRoleBinding </p>\n</blockquote>\n<p>serviceRoleBinding ,, <code>roleRef</code>, <code>subjects</code></p>\n<ul>\n<li><code>roleRef</code>: ,. <code>kind(,ServiceRole)</code>  <code>name()</code> </li>\n<li><code>subjects</code>: ,,,.<ul>\n<li><code>user</code>:  ID. * </li>\n<li><code>properties</code>: .<ul>\n<li><code>source.ip</code>:  IP </li>\n<li><code>source.namespace</code>: </li>\n<li><code>source.principal</code>: </li>\n<li><code>request.headers</code>:  HTTP header</li>\n<li><code>request.auth.principal</code>: </li>\n<li><code>request.auth.audiences</code>: </li>\n<li><code>request.auth.presenter</code>: </li>\n<li><code>request.auth.claims</code>: JWT</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"*\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"*\"]</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">binding-advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">subjects:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">properties:</span></span><br><span class=\"line\">      <span class=\"attr\">source.namespace:</span> <span class=\"string\">\"client\"</span></span><br><span class=\"line\">  <span class=\"attr\">roleRef:</span></span><br><span class=\"line\">    <span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\">    <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"advertisement.weather.svc.cluster.local\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"GET\"]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"advertisement.weather.svc.cluster.local\"]</span></span><br><span class=\"line\">    <span class=\"attr\">paths:</span> <span class=\"string\">[\"v2/weatherdata\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"GET\"]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.istio.io/v1alpha1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceRole</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">advertisement-reader</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">services:</span> <span class=\"string\">[\"advertisement.weather.svc.cluster.local\"]</span></span><br><span class=\"line\">    <span class=\"attr\">methods:</span> <span class=\"string\">[\"GET\"]</span></span><br><span class=\"line\">    <span class=\"attr\">constraints:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">key:</span> <span class=\"string\">\"destination.labels[version]\"</span></span><br><span class=\"line\">      <span class=\"attr\">value:</span> <span class=\"string\">[\"v2\"]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">apiVersion</span>: rbac.istio.io/v1alpha1</span><br><span class=\"line\"><span class=\"attribute\">kind</span>: ServiceRoleBinding</span><br><span class=\"line\"><span class=\"attribute\">metadata</span>:</span><br><span class=\"line\">  <span class=\"attribute\">name</span>: binding-advertisement-reader</span><br><span class=\"line\">  <span class=\"attribute\">namespace</span>: weather</span><br><span class=\"line\"><span class=\"attribute\">spec</span>:</span><br><span class=\"line\">  <span class=\"attribute\">subjects</span>:</span><br><span class=\"line\">  - <span class=\"attribute\">properties</span>:</span><br><span class=\"line\">      source.<span class=\"attribute\">ip</span>: <span class=\"string\">\"1.1.0.0/16\"</span></span><br><span class=\"line\">  <span class=\"attribute\">roleRef</span>:</span><br><span class=\"line\">    <span class=\"attribute\">kind</span>: ServiceRole</span><br><span class=\"line\">    <span class=\"attribute\">name</span>: advertisement-reader</span><br></pre></td></tr></table></figure>"},{"title":"istio Sidecar ","abbrlink":14870,"description":"Istio 6 .","_content":"\n# Sidecar \n\n Kubernetes ,Sidecar  Pod , Network Namespaces,Sidecar, Sidecar  iptables \n\n istio  sidecar , istioctl , Sidecar Injector . Pod  init  istio-proxy  Sidecar .\n\n## \n\nSidecar Injector  Istio  Sidecar , Kubernetes  Admission Controller .Admission Controller  Kube-apiserver ,,.Kubernetes  Webhook ,Sidecar Injector  MutatingAdmissionWebhook\n\nSidecar Injector  Pod  Sidecar , Pod  kube-apiserver ,,,kube-apiserver  REST  Sidecar Injector Webhook  init  istio-proxy , Pod  etcd \n\nIstio MutatingWebhook \n```yaml\napiVersion: admissionregistration.k8s.io/v1beta1\nkind: MutatingWebhookConfiguration\nmetadata:\n  name: istio-sidecar-injector\n\n  labels:\n    app: sidecar-injector\n    release: istio\nwebhooks:\n  - name: sidecar-injector.istio.io\n    clientConfig:\n      service:\n        name: istiod\n        namespace: istio-system\n        path: \"/inject\"\n      caBundle: \"\"\n    rules:\n      - operations: [ \"CREATE\" ]\n        apiGroups: [\"\"]\n        apiVersions: [\"v1\"]\n        resources: [\"pods\"]\n    failurePolicy: Fail\n    namespaceSelector:\n      matchLabels:\n        istio-injection: enabled\n\n```\n, Sidecar Injector  `istio-injectionenabled` Pod\n\n# Sidecar \n\nSidecar  iptables (init ), Inbound/Outbound \n\n\n![istio ](istio-sidecar/istio_traffic_flow.png)\n\n1. Inbound  Pod  iptables \n2. iptables  Envoy\n3. Envoy ,\n4. Outbound, iptables \n5. iptables Envoy\n6. Envoy \n\n## \n\nIstio, initContainer iptables , `REDIRECT`  `TPROXY` .\n\n`REDIRECT` ,.:\n-  Istio \n- Kubernetes  Pod  IP \n\nistio  initContainer ,initContainer \n\n```yaml\ninitContainers:\n- args:\n  - \"-p\"  #  Envoy  TCP \n  - 15001\n  - \"-z\"\n  - \"15006\"\n  - \"-u\"  #  id, iptables ,\n  - 1337\n  - \"-m\"  #  iptables ,REDIRECT\n  - \"REDIRECT\"\n  - \"-i\"  #  Envoy\n  - \"*\"\n  - \"-x\"  # \n  - \"\"\n  - \"-b\"  # , Envoy,\n  - \"9080\"\n  - \"-d\"  # ,Envoy, 15020, Sidecar \n  - \"15020\" \n```","source":"_posts/istio-sidecar.md","raw":"---\ntitle: istio Sidecar \ntags:\n  - istio\n  - \ncategories:\n  - \n  - istio\nabbrlink: 14870\ndescription: Istio 6 .\n---\n\n# Sidecar \n\n Kubernetes ,Sidecar  Pod , Network Namespaces,Sidecar, Sidecar  iptables \n\n istio  sidecar , istioctl , Sidecar Injector . Pod  init  istio-proxy  Sidecar .\n\n## \n\nSidecar Injector  Istio  Sidecar , Kubernetes  Admission Controller .Admission Controller  Kube-apiserver ,,.Kubernetes  Webhook ,Sidecar Injector  MutatingAdmissionWebhook\n\nSidecar Injector  Pod  Sidecar , Pod  kube-apiserver ,,,kube-apiserver  REST  Sidecar Injector Webhook  init  istio-proxy , Pod  etcd \n\nIstio MutatingWebhook \n```yaml\napiVersion: admissionregistration.k8s.io/v1beta1\nkind: MutatingWebhookConfiguration\nmetadata:\n  name: istio-sidecar-injector\n\n  labels:\n    app: sidecar-injector\n    release: istio\nwebhooks:\n  - name: sidecar-injector.istio.io\n    clientConfig:\n      service:\n        name: istiod\n        namespace: istio-system\n        path: \"/inject\"\n      caBundle: \"\"\n    rules:\n      - operations: [ \"CREATE\" ]\n        apiGroups: [\"\"]\n        apiVersions: [\"v1\"]\n        resources: [\"pods\"]\n    failurePolicy: Fail\n    namespaceSelector:\n      matchLabels:\n        istio-injection: enabled\n\n```\n, Sidecar Injector  `istio-injectionenabled` Pod\n\n# Sidecar \n\nSidecar  iptables (init ), Inbound/Outbound \n\n\n![istio ](istio-sidecar/istio_traffic_flow.png)\n\n1. Inbound  Pod  iptables \n2. iptables  Envoy\n3. Envoy ,\n4. Outbound, iptables \n5. iptables Envoy\n6. Envoy \n\n## \n\nIstio, initContainer iptables , `REDIRECT`  `TPROXY` .\n\n`REDIRECT` ,.:\n-  Istio \n- Kubernetes  Pod  IP \n\nistio  initContainer ,initContainer \n\n```yaml\ninitContainers:\n- args:\n  - \"-p\"  #  Envoy  TCP \n  - 15001\n  - \"-z\"\n  - \"15006\"\n  - \"-u\"  #  id, iptables ,\n  - 1337\n  - \"-m\"  #  iptables ,REDIRECT\n  - \"REDIRECT\"\n  - \"-i\"  #  Envoy\n  - \"*\"\n  - \"-x\"  # \n  - \"\"\n  - \"-b\"  # , Envoy,\n  - \"9080\"\n  - \"-d\"  # ,Envoy, 15020, Sidecar \n  - \"15020\" \n```","slug":"istio-sidecar","published":1,"date":"2020-04-30T11:51:42.308Z","updated":"2020-04-30T11:55:14.446Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihvz002ok8u72ryz432i","content":"<h1 id=\"Sidecar-\"><a href=\"#Sidecar-\" class=\"headerlink\" title=\"Sidecar \"></a>Sidecar </h1><p> Kubernetes ,Sidecar  Pod , Network Namespaces,Sidecar, Sidecar  iptables </p>\n<p> istio  sidecar , istioctl , Sidecar Injector . Pod  init  istio-proxy  Sidecar .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Sidecar Injector  Istio  Sidecar , Kubernetes  Admission Controller .Admission Controller  Kube-apiserver ,,.Kubernetes  Webhook ,Sidecar Injector  MutatingAdmissionWebhook</p>\n<p>Sidecar Injector  Pod  Sidecar , Pod  kube-apiserver ,,,kube-apiserver  REST  Sidecar Injector Webhook  init  istio-proxy , Pod  etcd </p>\n<p>Istio MutatingWebhook </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">admissionregistration.k8s.io/v1beta1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">MutatingWebhookConfiguration</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-sidecar-injector</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attr\">labels:</span></span><br><span class=\"line\">    <span class=\"attr\">app:</span> <span class=\"string\">sidecar-injector</span></span><br><span class=\"line\">    <span class=\"attr\">release:</span> <span class=\"string\">istio</span></span><br><span class=\"line\"><span class=\"attr\">webhooks:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">sidecar-injector.istio.io</span></span><br><span class=\"line\">    <span class=\"attr\">clientConfig:</span></span><br><span class=\"line\">      <span class=\"attr\">service:</span></span><br><span class=\"line\">        <span class=\"attr\">name:</span> <span class=\"string\">istiod</span></span><br><span class=\"line\">        <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\">        <span class=\"attr\">path:</span> <span class=\"string\">\"/inject\"</span></span><br><span class=\"line\">      <span class=\"attr\">caBundle:</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">rules:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">operations:</span> <span class=\"string\">[</span> <span class=\"string\">\"CREATE\"</span> <span class=\"string\">]</span></span><br><span class=\"line\">        <span class=\"attr\">apiGroups:</span> <span class=\"string\">[\"\"]</span></span><br><span class=\"line\">        <span class=\"attr\">apiVersions:</span> <span class=\"string\">[\"v1\"]</span></span><br><span class=\"line\">        <span class=\"attr\">resources:</span> <span class=\"string\">[\"pods\"]</span></span><br><span class=\"line\">    <span class=\"attr\">failurePolicy:</span> <span class=\"string\">Fail</span></span><br><span class=\"line\">    <span class=\"attr\">namespaceSelector:</span></span><br><span class=\"line\">      <span class=\"attr\">matchLabels:</span></span><br><span class=\"line\">        <span class=\"attr\">istio-injection:</span> <span class=\"string\">enabled</span></span><br></pre></td></tr></table></figure>\n<p>, Sidecar Injector  <code>istio-injectionenabled</code> Pod</p>\n<h1 id=\"Sidecar-\"><a href=\"#Sidecar-\" class=\"headerlink\" title=\"Sidecar \"></a>Sidecar </h1><p>Sidecar  iptables (init ), Inbound/Outbound </p>\n<p><img src=\"/2020/04/30/istio-sidecar/istio_traffic_flow.png\" alt=\"istio \"></p>\n<ol>\n<li>Inbound  Pod  iptables </li>\n<li>iptables  Envoy</li>\n<li>Envoy ,</li>\n<li>Outbound, iptables </li>\n<li>iptables Envoy</li>\n<li>Envoy </li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Istio, initContainer iptables , <code>REDIRECT</code>  <code>TPROXY</code> .</p>\n<p><code>REDIRECT</code> ,.:</p>\n<ul>\n<li> Istio </li>\n<li>Kubernetes  Pod  IP </li>\n</ul>\n<p>istio  initContainer ,initContainer </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">initContainers:</span></span><br><span class=\"line\"><span class=\"bullet\">-</span> <span class=\"attr\">args:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-p\"</span>  <span class=\"comment\">#  Envoy  TCP </span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"number\">15001</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-z\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"15006\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-u\"</span>  <span class=\"comment\">#  id, iptables ,</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"number\">1337</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-m\"</span>  <span class=\"comment\">#  iptables ,REDIRECT</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"REDIRECT\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-i\"</span>  <span class=\"comment\">#  Envoy</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"*\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-x\"</span>  <span class=\"comment\"># </span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-b\"</span>  <span class=\"comment\"># , Envoy,</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"9080\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-d\"</span>  <span class=\"comment\"># ,Envoy, 15020, Sidecar </span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"15020\"</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Sidecar-\"><a href=\"#Sidecar-\" class=\"headerlink\" title=\"Sidecar \"></a>Sidecar </h1><p> Kubernetes ,Sidecar  Pod , Network Namespaces,Sidecar, Sidecar  iptables </p>\n<p> istio  sidecar , istioctl , Sidecar Injector . Pod  init  istio-proxy  Sidecar .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Sidecar Injector  Istio  Sidecar , Kubernetes  Admission Controller .Admission Controller  Kube-apiserver ,,.Kubernetes  Webhook ,Sidecar Injector  MutatingAdmissionWebhook</p>\n<p>Sidecar Injector  Pod  Sidecar , Pod  kube-apiserver ,,,kube-apiserver  REST  Sidecar Injector Webhook  init  istio-proxy , Pod  etcd </p>\n<p>Istio MutatingWebhook </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">admissionregistration.k8s.io/v1beta1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">MutatingWebhookConfiguration</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-sidecar-injector</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attr\">labels:</span></span><br><span class=\"line\">    <span class=\"attr\">app:</span> <span class=\"string\">sidecar-injector</span></span><br><span class=\"line\">    <span class=\"attr\">release:</span> <span class=\"string\">istio</span></span><br><span class=\"line\"><span class=\"attr\">webhooks:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">sidecar-injector.istio.io</span></span><br><span class=\"line\">    <span class=\"attr\">clientConfig:</span></span><br><span class=\"line\">      <span class=\"attr\">service:</span></span><br><span class=\"line\">        <span class=\"attr\">name:</span> <span class=\"string\">istiod</span></span><br><span class=\"line\">        <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\">        <span class=\"attr\">path:</span> <span class=\"string\">\"/inject\"</span></span><br><span class=\"line\">      <span class=\"attr\">caBundle:</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"attr\">rules:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">operations:</span> <span class=\"string\">[</span> <span class=\"string\">\"CREATE\"</span> <span class=\"string\">]</span></span><br><span class=\"line\">        <span class=\"attr\">apiGroups:</span> <span class=\"string\">[\"\"]</span></span><br><span class=\"line\">        <span class=\"attr\">apiVersions:</span> <span class=\"string\">[\"v1\"]</span></span><br><span class=\"line\">        <span class=\"attr\">resources:</span> <span class=\"string\">[\"pods\"]</span></span><br><span class=\"line\">    <span class=\"attr\">failurePolicy:</span> <span class=\"string\">Fail</span></span><br><span class=\"line\">    <span class=\"attr\">namespaceSelector:</span></span><br><span class=\"line\">      <span class=\"attr\">matchLabels:</span></span><br><span class=\"line\">        <span class=\"attr\">istio-injection:</span> <span class=\"string\">enabled</span></span><br></pre></td></tr></table></figure>\n<p>, Sidecar Injector  <code>istio-injectionenabled</code> Pod</p>\n<h1 id=\"Sidecar-\"><a href=\"#Sidecar-\" class=\"headerlink\" title=\"Sidecar \"></a>Sidecar </h1><p>Sidecar  iptables (init ), Inbound/Outbound </p>\n<p><img src=\"/2020/04/30/istio-sidecar/istio_traffic_flow.png\" alt=\"istio \"></p>\n<ol>\n<li>Inbound  Pod  iptables </li>\n<li>iptables  Envoy</li>\n<li>Envoy ,</li>\n<li>Outbound, iptables </li>\n<li>iptables Envoy</li>\n<li>Envoy </li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Istio, initContainer iptables , <code>REDIRECT</code>  <code>TPROXY</code> .</p>\n<p><code>REDIRECT</code> ,.:</p>\n<ul>\n<li> Istio </li>\n<li>Kubernetes  Pod  IP </li>\n</ul>\n<p>istio  initContainer ,initContainer </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">initContainers:</span></span><br><span class=\"line\"><span class=\"bullet\">-</span> <span class=\"attr\">args:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-p\"</span>  <span class=\"comment\">#  Envoy  TCP </span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"number\">15001</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-z\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"15006\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-u\"</span>  <span class=\"comment\">#  id, iptables ,</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"number\">1337</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-m\"</span>  <span class=\"comment\">#  iptables ,REDIRECT</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"REDIRECT\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-i\"</span>  <span class=\"comment\">#  Envoy</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"*\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-x\"</span>  <span class=\"comment\"># </span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-b\"</span>  <span class=\"comment\"># , Envoy,</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"9080\"</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"-d\"</span>  <span class=\"comment\"># ,Envoy, 15020, Sidecar </span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"15020\"</span></span><br></pre></td></tr></table></figure>"},{"title":"istio","abbrlink":6366,"description":"Istio 3 .","_content":"\n# \n\n## \n\n,,\n\n## \n\n1.  API \n2. Pilot  Envoy , Envoy()\n3. Envoy  Pod  Inbound  Outbound \n4.  Envoy ,\n\n## \n\n- \n\n: \n: ,\n: .,\n\n- \n\n,.,,\n\n- \n\n,,Istio ,.\n\n HTTP Code 503(),()\n\n- \n\n,,,\n\n,,AB  3 \n\n- \n\nIstio  Ingress Gateway ,,TLS,VirtualService\n\n- \n\nIstio  ServiceEntry ,.\n Egress Gateway \n\n# VirtualService \n\nVirtualService ,,, DestinationRule \n\n## HTTP(HTTPRoute)\n\n `HTTPMatchRequest`  `HTTPRouteDestination`, `HTTPRedirect`, `HTTPRewrite`, `HTTPRetry`, `HTTPFaultInjection`, `CorsPolicy` \n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: forecast\nspec:\n  hosts:\n  - forecast\n  http:\n  - match:\n    - headers:\n        location:\n          exact: north\n    route:\n    - destination:\n        host: forecast\n        subset: v2\n  - route:\n    - destination:\n        host: reviews\n        subset: v1\n```\n\n> HTTPMatchRequest \n\n: `match`,\n\n- `uri,scheme,method,authority,headers`:  `exact(),prefix(),regex()` \n- `port`: \n- `sourceLabels`: , Pod \n\n> HTTPRouteDestination \n\n: `route`,\n- `destination`: ,. `host,subnet,port` \n    - `host`: , istio . `<hostname>.<namspace>.svc.cluster.local`\n    - `subset`:  host ,\n- `weight`: , destination ,weight  100\n- `headers`: \n\n> HTTPRedirect \n\n: `redirect`, `uri`. `uri`  uri \n\n> HTTPRewrite  url \n\n: `rewrite`, `uri`.,, `uri`  uri\n\n> HTTPRetry \n\n `retries`,(attempts),(perTryTimeout),(retryOn).\n\n- `attempts`: ,\n- `perTryTimeout`: , ms,s,m,h\n- `retryOn`: ,.:\n    - 5xx: 5xx,\n    - gateway-error: 502,503504\n    - connect-failure\n    - retriable-4xx4xx\n    - refused-streamREFUSED_STREAM\n    - cancelledgRPCHeadercancelled\n    - deadline-exceededgRPCHeaderdeadline-exceeded\n    - internalgRPCHeaderinternal\n    - resource-exhaustedgRPCHeaderresource-exhausted\n    - unavailablegRPCHeaderunavailable\n\n> Mirror \n\n `mirror`,,\n\n> HTTPFaultInjection \n\n `fault`, `delay`  `abort` \n\n- `delay`: ,\n    - `fixedDelay`: ,, ms,s,m,h\n    - `percentage`: \n- `abort`: ,\n    - `httpStatus`: , HTTP \n    - `percentage`: \n\n> CorsPolicy \n\n `corsPolicy`,(Cross\nOrigin Resource Sharing) Web ,\n\n- `allowMethods`:  HTTP , Access-Control-Allow-Methods \nHeader\n- `allowHeaders`:  HTTP Header , Access-Control-Allow-Headers  Header \n- `exposeHeaders`:  HTTP Header , Access-Control-Expose-Headers  Header \n- `maxAge`: , Access-Control-Max-Age  Header\n- `allowCredentials`: , Access-Control-Allow-Credentials  Header\n\n## TLS(TLSRoute)\n\n `TLSMatchAttributes`  TLS  HTTPS  `RouteDestination`\n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: total-weather-tls\nspec:\n  hosts:\n  - \"*.weather.com\"\n  gateways:\n  - \"ingress-gateway\"\n  tls:\n  - match:\n    - port: 443\n      sniHosts:\n      - frontend.weather.com\n    route:\n    - destination:\n        host: frontend\n        subset: v2\n  - match:\n    - port: 443\n      sniHosts:\n      - recommendation.weather.com\n    route:\n    - destination:\n        host: recommendation\n```\n\n> TLSMatchAttributes TLS\n\n `match`, TLS,:\n\n- `sniHosts`:  TLS  SNI ,SNI  VirtualService  hosts \n- `port`: \n- `destinationSubnets`: IPIP\n- `sourceLabels`: \n\n `sniHosts`  `port`\n\n> RouteDestination \n\n: `route`,, `HTTPRouteDestination` \n- `destination`: ,. `host,subnet,port` \n    - `host`: , istio . `<hostname>.<namspace>.svc.cluster.local`\n    - `subset`:  host ,\n- `weight`: , destination ,weight  100\n\n## TCP(TCPRoute)\n\nHTTPTLSTCP\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: forecast\nspec:\n  hosts:\n  - forecast\n  tcp:\n  - match:\n    port: 23003\n    route: \n    - destination:\n        host: inner-forecast\n        port:\n          number: 3003\n```\n== TCP  4  `L4MatchAttribute` ==\n\n> L4MatchAttribute \n\n `match`,\n- `destinationSubnets`: IP IP \n- `port`: \n`sourceLabels`\n\n> RouteDestination   TLS \n\n\n## \n\n |  |  |  |  |  | \n:---: | :---: | :---: | :---: | :---: | :---: | :---: \nHTTP | HTTPRoute | HTTPMatchRequest |  uri,scheme,method,port,sourceLabels | route,redirect,rewrite,retry,timeout,faultInjection,corsPolicy | HTTPRouteDestination | destination,weight,headers\nTLS | TLSRoute | TLSMatchAttribute | sniHost,port,destinationSubnets,sourceLabels | route | RouteDestination | destination,weight\nTCP | TCPRoute | L4MatchAttribute | destinationSubnets,port,sourceLabels | route | RouteDestination | destination,weight\n\n\n# DestinationRule \n\nDestinationRule . Istio ,,\n```yaml\napiVersion: networking.istio.io/v1alph3\nkind: DestinationRule\nmetadata:\n  name: forecast\nspec:\n  host: forecast\n  subnet:\n  - name: v2\n    labels: \n      version: v2\n    trafficPolicy:\n      loadBalancer:\n        simple: ROUND_ROBIN\n  - name: v1\n    labels: \n      version: v1\n    trafficPolicy:\n      loadBalancer:\n        simple: RANDON\n```\nDestinationRule :\n- `host`: ,,.host,.\n- `trafficPolicy`: ,,,\n- `PortTrafficPolicy`:  port , TrafficPolicy \n- `subsets`: ,.\n    - `name`: ,subnet \n    - `labels`: Subset , Subset \n- `exportTo`:  DestinationRule . \".\"  \"*\",\n\n## TrafficPolicy \n\n 4 \n\n |  |  \n:---: | :---: | :---:\nloadBalancer | LoadBalancerSettings | \nconnectionPool | ConnectionPoolSettings | \noutlierDetection | OutlierDetection | \ntls | TLSSettings | TLS\n\n> loadBalancer \n\n `simple()`  `consistentHash( hash)` .,, HTTP \n\n- `simple`  `ROUND_ROBIN(,)`,`LEAST_CONN()`,`RANDOM()`,`PASSTHROUGH()` \n- `consistentHash`  `httpHeaderName()`,`httpCookie(cookie)`,`useSourceIp( IP)` . `minimumRingSize()` , hash ()\n\n> connectionPool \n\nIstio  `tcp(TCP)`  `http(HTTP)` .\n\n`tcp` \n- `maxConnections`: ,1024\n- `connectTimeout`: TCP,\n- `tcpKeepalive`: TCP keepalives(TCP keepalive).,\n    - `probes` ,9\n    - `time` ,2h\n    - `interval` , 75s\n\n`http` \n- `http1MaxPendingRequests`:  HTTP ,1024\n- `http2MaxRequests`: ,1024\n- `maxRequestsPerConnection`: \n- `maxRetries`: ,3\n- `idleTimeout`: ,\n\n> outlierDetection \n\n,,,,.\n\n\n- `consecutiveErrors`: ,5\n- `interval`: , 10s\n- `baseEjectionTime`: ,30s.\n- `maxEjectionPercent`: ,10%.\n- `minHealthPercent`: ,,. 50%\n\n> tls TLS\n\nistio TLS :\n- `mode`: tls .4\n    - `Disable`:  TLS \n    - `SIMPLE`: \n    - `MUTUAL`: .,\n    - `ISTIO_MUTUAL`: .Istio,\n- `privateKey`: \n- `clientCertificate`: \n- `caCertificates`:  CA \n\n# Gateway \n\nGateway ,.Istio  Gateway , Gateway ,\n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: istio-gateway\nspec:\n  selector: \n    istio: ingressgateway\n  servers:\n  - port:\n      name: http\n      number: 80\n      protocol: HTTP\n    hosts:\n    - weather.com\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: frontend\nspec:\n  hosts:\n  - frontend\n  - weather.com\n  gateways:\n  - istio.gateway.istio-system.svc.cluster.local\n  - mesh\n  http:\n  - match:\n    - headers:\n      location:\n        exact: north\n    route:\n    - destionation:\n        host: frontend\n        subset: v2\n  - route:  \n    - destionation:\n        host: frontend\n        subset: v1\n```\nGateway  `selector()`  `servers()` .\n\n> server \n\nserver , server\n- `port`: ,,\n- `hosts`:  gateway , FQDN \n- `defaultEndpoint`: \n- `tls`: .\n    - `httpsRedirect`:  HTTPS \n    - `mode`: TLS ,`PASSTHROUGH(,,TLS),SIMPLE(),MUTUAL(),AUTO_PASSTHROUGH`\n    - `serverCertificate`: , SIMPLE,MUTUAL \n    - `privateKey`: , SIMPLE,MUTUAL \n    - `caCertificates`: CA, MUTUAL \n    - `credentialName`: Gateway  `credentialName` (Kubernetes-Secrets),\n    - `subjectAltNames`: SAN \n    - `minProtocolVersion`,`maxProtocolVersion`: TLS ,\n    - `cipherSuites`: , Envoy \n\n## Gateway \n\n> 1.  HTTPS  HTTPS \n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: istio-gateway\nspec:\n  selector: \n    istio: ingressgateway\n  servers:\n  - port:\n      name: https\n      number: 443\n      protocol: HTTPS\n    hosts:\n    - weather.com\n    tls:\n      mode: PASSTHROUGH\n```\n,, HTTPS.istio , Gateway  HTTPS .\n\n> 2.  HTTP  HTTPS \n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: istio-gateway\nspec:\n  selector: \n    istio: ingressgateway\n  servers:\n  - port:\n      name: https\n      number: 443\n      protocol: HTTPS\n    hosts:\n    - weather.com\n    tls:\n      mode: SIMPLE\n      # , ingressgateway pod . k8s-secrets \n      serverCertificate: /etc/istio/gateway-weather-certs/tls.crt\n      privateKey: /etc/istio/gateway-weather-certs/tls.key\n      #  k8s-secrets ,istio ()\n      # credentialName: weather-com-secrets\n```\n,, HTTP.istio  Gateway , Gateway  HTTP  HTTPS .\n\n> 3.  HTTP  HTTPS \n\n,,, TLS . APP\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: istio-gateway\nspec:\n  selector: \n    istio: ingressgateway\n  servers:\n  - port:\n      name: https\n      number: 443\n      protocol: HTTPS\n    hosts:\n    - weather.com\n    tls:\n      mode: MUTUAL\n      serverCertificate: /etc/istio/gateway-weather-certs/tls.crt\n      privateKey: /etc/istio/gateway-weather-certs/tls.key\n      # \n      caCertificates: /etc/istio/gateway-weather-certs/ca.crt\n```\n\n> 4.  HTTP  HTTPS  HTTPS \n\n2  Gateway  Manifest , istio  TLS,.\n\n Gateway  frontend \n\n- frontend HTTP,\n- ,Gateway  frontend , HTTPS . Gateway  HTTPS , Gateway \n- ,Gateway  frontend (Envoy,Sidecar), frontend  HTTPS , Citadel , frontend (Envoy,Sidecar) TLS .( mTLS )\n\n\n# ServiceEntry \n\nServiceEntry ,, istio \n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: ServiceEntry\nmetadata:\n  name: weather-external\nspec:\n  hosts:\n  - www.weatherdb.com\n  ports:\n  - name: http\n    number: 80\n    protocol: HTTP\n  resolution: DNS\n  location: MESH_EXTERNAL\n```\nServiceEntry \n\n- `hosts`: , ServiceEntry . resolution  DN S endpoints ,\n- `ports`: ,\n- `resolution`: ,,3\n    - `NONE`:  IP \n    - `STATIC`:  endpoints ,\n    - `DNS`:  DNS . endpoints,`hosts` DNS \n- `addresses`: IP\n- `location`: `MESH_EXTERNAL`()  `MESH_INTERNAL`().,mTLS ,,., Sidecar \n- `endpoints`:,IP,.\n    - `address`: ,. resolution  DNS ,\n    - `ports`: \n    - `labels`: \n    - `weight`: \n\n## ServiceEntry \n\n>  ServiceEntry + Egressgateway + VirtualService \n\n```yaml\n#  www.weatherdb.com \n---\napiVersion: networking.istio.io/v1alpha3\nkind: ServiceEntry\nmetadata:\n  name: weather-external\nspec:\n  hosts:\n  - www.weatherdb.com\n  ports:\n  - name: http\n    number: 80\n    protocol: HTTP\n  resolution: DNS\n  location: MESH_EXTERNAL\n#  www.weatherdb.com  egress-gateway \n---\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: egress-gateway\n  namespace: istio-system\nspec:\n  selector: \n    istio: egressgateway\n  servers:\n  - port:\n      name: http\n      number: 80\n      protocol: HTTP\n    hosts:\n    - www.weatherdb.com\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: egress-wearthdb\nspec:\n  hosts:\n  - www.weatherdb.com\n  gateways:\n  - egress-gateway.istio-system.svc.cluster.local\n  - mesh\n  http:\n  - match:\n    - gateways:\n      - mesh\n      port: 80\n    route:\n    - destination:\n        host: egress-gateway.istio-system.svc.cluster.local\n  - match:\n    - gateways:\n      - egress-gateway.istio-system.svc.cluster.local\n      port: 80\n    route:\n    - destination:\n        host: www.weatherdb.com\n```\n, route\n- :  route  gateways  mesh, www.weatherdb.com , egressgateway \n- :  route  gateways  egress, egress  www.weatherdb.com , www.weatherdb.com \n\n# Sidecar \n\n istio\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: SideCar\nmetadata:\n  name: default\n  namespace: weather\nspec:\n  egress:\n  - hosts:\n    - \"istio-system/*\"\n    - \"news/*\"\n```\nSidecar\n\n- `workloadSelector`: (pod ),,\n- `egress`:  sidecar .,,\n    - `hosts`: , `namespace/dnsName` ,\n    - `port`: \n    - `bind`: \n    - `captureMode`: . `DEFAULT(),IPTABLES( iptables ),NONE()`.\n- `ingress`:  Sidecar  Inbound.\n    - `port`: ,\n    - `defaultEndpoint`: ,\n    - `bind`: \n    - `captureMode`: ","source":"_posts/istio-traffic-control.md","raw":"---\ntitle: istio\ntags:\n  - istio\n  - \ncategories:\n  - \n  - istio\nabbrlink: 6366\ndescription: Istio 3 .\n---\n\n# \n\n## \n\n,,\n\n## \n\n1.  API \n2. Pilot  Envoy , Envoy()\n3. Envoy  Pod  Inbound  Outbound \n4.  Envoy ,\n\n## \n\n- \n\n: \n: ,\n: .,\n\n- \n\n,.,,\n\n- \n\n,,Istio ,.\n\n HTTP Code 503(),()\n\n- \n\n,,,\n\n,,AB  3 \n\n- \n\nIstio  Ingress Gateway ,,TLS,VirtualService\n\n- \n\nIstio  ServiceEntry ,.\n Egress Gateway \n\n# VirtualService \n\nVirtualService ,,, DestinationRule \n\n## HTTP(HTTPRoute)\n\n `HTTPMatchRequest`  `HTTPRouteDestination`, `HTTPRedirect`, `HTTPRewrite`, `HTTPRetry`, `HTTPFaultInjection`, `CorsPolicy` \n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: forecast\nspec:\n  hosts:\n  - forecast\n  http:\n  - match:\n    - headers:\n        location:\n          exact: north\n    route:\n    - destination:\n        host: forecast\n        subset: v2\n  - route:\n    - destination:\n        host: reviews\n        subset: v1\n```\n\n> HTTPMatchRequest \n\n: `match`,\n\n- `uri,scheme,method,authority,headers`:  `exact(),prefix(),regex()` \n- `port`: \n- `sourceLabels`: , Pod \n\n> HTTPRouteDestination \n\n: `route`,\n- `destination`: ,. `host,subnet,port` \n    - `host`: , istio . `<hostname>.<namspace>.svc.cluster.local`\n    - `subset`:  host ,\n- `weight`: , destination ,weight  100\n- `headers`: \n\n> HTTPRedirect \n\n: `redirect`, `uri`. `uri`  uri \n\n> HTTPRewrite  url \n\n: `rewrite`, `uri`.,, `uri`  uri\n\n> HTTPRetry \n\n `retries`,(attempts),(perTryTimeout),(retryOn).\n\n- `attempts`: ,\n- `perTryTimeout`: , ms,s,m,h\n- `retryOn`: ,.:\n    - 5xx: 5xx,\n    - gateway-error: 502,503504\n    - connect-failure\n    - retriable-4xx4xx\n    - refused-streamREFUSED_STREAM\n    - cancelledgRPCHeadercancelled\n    - deadline-exceededgRPCHeaderdeadline-exceeded\n    - internalgRPCHeaderinternal\n    - resource-exhaustedgRPCHeaderresource-exhausted\n    - unavailablegRPCHeaderunavailable\n\n> Mirror \n\n `mirror`,,\n\n> HTTPFaultInjection \n\n `fault`, `delay`  `abort` \n\n- `delay`: ,\n    - `fixedDelay`: ,, ms,s,m,h\n    - `percentage`: \n- `abort`: ,\n    - `httpStatus`: , HTTP \n    - `percentage`: \n\n> CorsPolicy \n\n `corsPolicy`,(Cross\nOrigin Resource Sharing) Web ,\n\n- `allowMethods`:  HTTP , Access-Control-Allow-Methods \nHeader\n- `allowHeaders`:  HTTP Header , Access-Control-Allow-Headers  Header \n- `exposeHeaders`:  HTTP Header , Access-Control-Expose-Headers  Header \n- `maxAge`: , Access-Control-Max-Age  Header\n- `allowCredentials`: , Access-Control-Allow-Credentials  Header\n\n## TLS(TLSRoute)\n\n `TLSMatchAttributes`  TLS  HTTPS  `RouteDestination`\n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: total-weather-tls\nspec:\n  hosts:\n  - \"*.weather.com\"\n  gateways:\n  - \"ingress-gateway\"\n  tls:\n  - match:\n    - port: 443\n      sniHosts:\n      - frontend.weather.com\n    route:\n    - destination:\n        host: frontend\n        subset: v2\n  - match:\n    - port: 443\n      sniHosts:\n      - recommendation.weather.com\n    route:\n    - destination:\n        host: recommendation\n```\n\n> TLSMatchAttributes TLS\n\n `match`, TLS,:\n\n- `sniHosts`:  TLS  SNI ,SNI  VirtualService  hosts \n- `port`: \n- `destinationSubnets`: IPIP\n- `sourceLabels`: \n\n `sniHosts`  `port`\n\n> RouteDestination \n\n: `route`,, `HTTPRouteDestination` \n- `destination`: ,. `host,subnet,port` \n    - `host`: , istio . `<hostname>.<namspace>.svc.cluster.local`\n    - `subset`:  host ,\n- `weight`: , destination ,weight  100\n\n## TCP(TCPRoute)\n\nHTTPTLSTCP\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: forecast\nspec:\n  hosts:\n  - forecast\n  tcp:\n  - match:\n    port: 23003\n    route: \n    - destination:\n        host: inner-forecast\n        port:\n          number: 3003\n```\n== TCP  4  `L4MatchAttribute` ==\n\n> L4MatchAttribute \n\n `match`,\n- `destinationSubnets`: IP IP \n- `port`: \n`sourceLabels`\n\n> RouteDestination   TLS \n\n\n## \n\n |  |  |  |  |  | \n:---: | :---: | :---: | :---: | :---: | :---: | :---: \nHTTP | HTTPRoute | HTTPMatchRequest |  uri,scheme,method,port,sourceLabels | route,redirect,rewrite,retry,timeout,faultInjection,corsPolicy | HTTPRouteDestination | destination,weight,headers\nTLS | TLSRoute | TLSMatchAttribute | sniHost,port,destinationSubnets,sourceLabels | route | RouteDestination | destination,weight\nTCP | TCPRoute | L4MatchAttribute | destinationSubnets,port,sourceLabels | route | RouteDestination | destination,weight\n\n\n# DestinationRule \n\nDestinationRule . Istio ,,\n```yaml\napiVersion: networking.istio.io/v1alph3\nkind: DestinationRule\nmetadata:\n  name: forecast\nspec:\n  host: forecast\n  subnet:\n  - name: v2\n    labels: \n      version: v2\n    trafficPolicy:\n      loadBalancer:\n        simple: ROUND_ROBIN\n  - name: v1\n    labels: \n      version: v1\n    trafficPolicy:\n      loadBalancer:\n        simple: RANDON\n```\nDestinationRule :\n- `host`: ,,.host,.\n- `trafficPolicy`: ,,,\n- `PortTrafficPolicy`:  port , TrafficPolicy \n- `subsets`: ,.\n    - `name`: ,subnet \n    - `labels`: Subset , Subset \n- `exportTo`:  DestinationRule . \".\"  \"*\",\n\n## TrafficPolicy \n\n 4 \n\n |  |  \n:---: | :---: | :---:\nloadBalancer | LoadBalancerSettings | \nconnectionPool | ConnectionPoolSettings | \noutlierDetection | OutlierDetection | \ntls | TLSSettings | TLS\n\n> loadBalancer \n\n `simple()`  `consistentHash( hash)` .,, HTTP \n\n- `simple`  `ROUND_ROBIN(,)`,`LEAST_CONN()`,`RANDOM()`,`PASSTHROUGH()` \n- `consistentHash`  `httpHeaderName()`,`httpCookie(cookie)`,`useSourceIp( IP)` . `minimumRingSize()` , hash ()\n\n> connectionPool \n\nIstio  `tcp(TCP)`  `http(HTTP)` .\n\n`tcp` \n- `maxConnections`: ,1024\n- `connectTimeout`: TCP,\n- `tcpKeepalive`: TCP keepalives(TCP keepalive).,\n    - `probes` ,9\n    - `time` ,2h\n    - `interval` , 75s\n\n`http` \n- `http1MaxPendingRequests`:  HTTP ,1024\n- `http2MaxRequests`: ,1024\n- `maxRequestsPerConnection`: \n- `maxRetries`: ,3\n- `idleTimeout`: ,\n\n> outlierDetection \n\n,,,,.\n\n\n- `consecutiveErrors`: ,5\n- `interval`: , 10s\n- `baseEjectionTime`: ,30s.\n- `maxEjectionPercent`: ,10%.\n- `minHealthPercent`: ,,. 50%\n\n> tls TLS\n\nistio TLS :\n- `mode`: tls .4\n    - `Disable`:  TLS \n    - `SIMPLE`: \n    - `MUTUAL`: .,\n    - `ISTIO_MUTUAL`: .Istio,\n- `privateKey`: \n- `clientCertificate`: \n- `caCertificates`:  CA \n\n# Gateway \n\nGateway ,.Istio  Gateway , Gateway ,\n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: istio-gateway\nspec:\n  selector: \n    istio: ingressgateway\n  servers:\n  - port:\n      name: http\n      number: 80\n      protocol: HTTP\n    hosts:\n    - weather.com\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: frontend\nspec:\n  hosts:\n  - frontend\n  - weather.com\n  gateways:\n  - istio.gateway.istio-system.svc.cluster.local\n  - mesh\n  http:\n  - match:\n    - headers:\n      location:\n        exact: north\n    route:\n    - destionation:\n        host: frontend\n        subset: v2\n  - route:  \n    - destionation:\n        host: frontend\n        subset: v1\n```\nGateway  `selector()`  `servers()` .\n\n> server \n\nserver , server\n- `port`: ,,\n- `hosts`:  gateway , FQDN \n- `defaultEndpoint`: \n- `tls`: .\n    - `httpsRedirect`:  HTTPS \n    - `mode`: TLS ,`PASSTHROUGH(,,TLS),SIMPLE(),MUTUAL(),AUTO_PASSTHROUGH`\n    - `serverCertificate`: , SIMPLE,MUTUAL \n    - `privateKey`: , SIMPLE,MUTUAL \n    - `caCertificates`: CA, MUTUAL \n    - `credentialName`: Gateway  `credentialName` (Kubernetes-Secrets),\n    - `subjectAltNames`: SAN \n    - `minProtocolVersion`,`maxProtocolVersion`: TLS ,\n    - `cipherSuites`: , Envoy \n\n## Gateway \n\n> 1.  HTTPS  HTTPS \n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: istio-gateway\nspec:\n  selector: \n    istio: ingressgateway\n  servers:\n  - port:\n      name: https\n      number: 443\n      protocol: HTTPS\n    hosts:\n    - weather.com\n    tls:\n      mode: PASSTHROUGH\n```\n,, HTTPS.istio , Gateway  HTTPS .\n\n> 2.  HTTP  HTTPS \n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: istio-gateway\nspec:\n  selector: \n    istio: ingressgateway\n  servers:\n  - port:\n      name: https\n      number: 443\n      protocol: HTTPS\n    hosts:\n    - weather.com\n    tls:\n      mode: SIMPLE\n      # , ingressgateway pod . k8s-secrets \n      serverCertificate: /etc/istio/gateway-weather-certs/tls.crt\n      privateKey: /etc/istio/gateway-weather-certs/tls.key\n      #  k8s-secrets ,istio ()\n      # credentialName: weather-com-secrets\n```\n,, HTTP.istio  Gateway , Gateway  HTTP  HTTPS .\n\n> 3.  HTTP  HTTPS \n\n,,, TLS . APP\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: istio-gateway\nspec:\n  selector: \n    istio: ingressgateway\n  servers:\n  - port:\n      name: https\n      number: 443\n      protocol: HTTPS\n    hosts:\n    - weather.com\n    tls:\n      mode: MUTUAL\n      serverCertificate: /etc/istio/gateway-weather-certs/tls.crt\n      privateKey: /etc/istio/gateway-weather-certs/tls.key\n      # \n      caCertificates: /etc/istio/gateway-weather-certs/ca.crt\n```\n\n> 4.  HTTP  HTTPS  HTTPS \n\n2  Gateway  Manifest , istio  TLS,.\n\n Gateway  frontend \n\n- frontend HTTP,\n- ,Gateway  frontend , HTTPS . Gateway  HTTPS , Gateway \n- ,Gateway  frontend (Envoy,Sidecar), frontend  HTTPS , Citadel , frontend (Envoy,Sidecar) TLS .( mTLS )\n\n\n# ServiceEntry \n\nServiceEntry ,, istio \n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: ServiceEntry\nmetadata:\n  name: weather-external\nspec:\n  hosts:\n  - www.weatherdb.com\n  ports:\n  - name: http\n    number: 80\n    protocol: HTTP\n  resolution: DNS\n  location: MESH_EXTERNAL\n```\nServiceEntry \n\n- `hosts`: , ServiceEntry . resolution  DN S endpoints ,\n- `ports`: ,\n- `resolution`: ,,3\n    - `NONE`:  IP \n    - `STATIC`:  endpoints ,\n    - `DNS`:  DNS . endpoints,`hosts` DNS \n- `addresses`: IP\n- `location`: `MESH_EXTERNAL`()  `MESH_INTERNAL`().,mTLS ,,., Sidecar \n- `endpoints`:,IP,.\n    - `address`: ,. resolution  DNS ,\n    - `ports`: \n    - `labels`: \n    - `weight`: \n\n## ServiceEntry \n\n>  ServiceEntry + Egressgateway + VirtualService \n\n```yaml\n#  www.weatherdb.com \n---\napiVersion: networking.istio.io/v1alpha3\nkind: ServiceEntry\nmetadata:\n  name: weather-external\nspec:\n  hosts:\n  - www.weatherdb.com\n  ports:\n  - name: http\n    number: 80\n    protocol: HTTP\n  resolution: DNS\n  location: MESH_EXTERNAL\n#  www.weatherdb.com  egress-gateway \n---\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: egress-gateway\n  namespace: istio-system\nspec:\n  selector: \n    istio: egressgateway\n  servers:\n  - port:\n      name: http\n      number: 80\n      protocol: HTTP\n    hosts:\n    - www.weatherdb.com\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: egress-wearthdb\nspec:\n  hosts:\n  - www.weatherdb.com\n  gateways:\n  - egress-gateway.istio-system.svc.cluster.local\n  - mesh\n  http:\n  - match:\n    - gateways:\n      - mesh\n      port: 80\n    route:\n    - destination:\n        host: egress-gateway.istio-system.svc.cluster.local\n  - match:\n    - gateways:\n      - egress-gateway.istio-system.svc.cluster.local\n      port: 80\n    route:\n    - destination:\n        host: www.weatherdb.com\n```\n, route\n- :  route  gateways  mesh, www.weatherdb.com , egressgateway \n- :  route  gateways  egress, egress  www.weatherdb.com , www.weatherdb.com \n\n# Sidecar \n\n istio\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: SideCar\nmetadata:\n  name: default\n  namespace: weather\nspec:\n  egress:\n  - hosts:\n    - \"istio-system/*\"\n    - \"news/*\"\n```\nSidecar\n\n- `workloadSelector`: (pod ),,\n- `egress`:  sidecar .,,\n    - `hosts`: , `namespace/dnsName` ,\n    - `port`: \n    - `bind`: \n    - `captureMode`: . `DEFAULT(),IPTABLES( iptables ),NONE()`.\n- `ingress`:  Sidecar  Inbound.\n    - `port`: ,\n    - `defaultEndpoint`: ,\n    - `bind`: \n    - `captureMode`: ","slug":"istio-traffic-control","published":1,"date":"2020-04-03T08:14:57.955Z","updated":"2020-04-26T08:46:56.021Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihw0002tk8u77oohce9l","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li> API </li>\n<li>Pilot  Envoy , Envoy()</li>\n<li>Envoy  Pod  Inbound  Outbound </li>\n<li> Envoy ,</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n</ul>\n<p>: <br>: ,<br>: .,</p>\n<ul>\n<li></li>\n</ul>\n<p>,.,,</p>\n<ul>\n<li></li>\n</ul>\n<p>,,Istio ,.</p>\n<p> HTTP Code 503(),()</p>\n<ul>\n<li></li>\n</ul>\n<p>,,,</p>\n<p>,,AB  3 </p>\n<ul>\n<li></li>\n</ul>\n<p>Istio  Ingress Gateway ,,TLS,VirtualService</p>\n<ul>\n<li></li>\n</ul>\n<p>Istio  ServiceEntry ,.<br> Egress Gateway </p>\n<h1 id=\"VirtualService-\"><a href=\"#VirtualService-\" class=\"headerlink\" title=\"VirtualService \"></a>VirtualService </h1><p>VirtualService ,,, DestinationRule </p>\n<h2 id=\"HTTP-HTTPRoute\"><a href=\"#HTTP-HTTPRoute\" class=\"headerlink\" title=\"HTTP(HTTPRoute)\"></a>HTTP(HTTPRoute)</h2><p> <code>HTTPMatchRequest</code>  <code>HTTPRouteDestination</code>, <code>HTTPRedirect</code>, <code>HTTPRewrite</code>, <code>HTTPRetry</code>, <code>HTTPFaultInjection</code>, <code>CorsPolicy</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">  <span class=\"attr\">http:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">headers:</span></span><br><span class=\"line\">        <span class=\"attr\">location:</span></span><br><span class=\"line\">          <span class=\"attr\">exact:</span> <span class=\"string\">north</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">reviews</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v1</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>HTTPMatchRequest </p>\n</blockquote>\n<p>: <code>match</code>,</p>\n<ul>\n<li><code>uri,scheme,method,authority,headers</code>:  <code>exact(),prefix(),regex()</code> </li>\n<li><code>port</code>: </li>\n<li><code>sourceLabels</code>: , Pod </li>\n</ul>\n<blockquote>\n<p>HTTPRouteDestination </p>\n</blockquote>\n<p>: <code>route</code>,</p>\n<ul>\n<li><code>destination</code>: ,. <code>host,subnet,port</code> <ul>\n<li><code>host</code>: , istio . <code>&lt;hostname&gt;.&lt;namspace&gt;.svc.cluster.local</code></li>\n<li><code>subset</code>:  host ,</li>\n</ul>\n</li>\n<li><code>weight</code>: , destination ,weight  100</li>\n<li><code>headers</code>: </li>\n</ul>\n<blockquote>\n<p>HTTPRedirect </p>\n</blockquote>\n<p>: <code>redirect</code>, <code>uri</code>. <code>uri</code>  uri </p>\n<blockquote>\n<p>HTTPRewrite  url </p>\n</blockquote>\n<p>: <code>rewrite</code>, <code>uri</code>.,, <code>uri</code>  uri</p>\n<blockquote>\n<p>HTTPRetry </p>\n</blockquote>\n<p> <code>retries</code>,(attempts),(perTryTimeout),(retryOn).</p>\n<ul>\n<li><code>attempts</code>: ,</li>\n<li><code>perTryTimeout</code>: , ms,s,m,h</li>\n<li><code>retryOn</code>: ,.:<ul>\n<li>5xx: 5xx,</li>\n<li>gateway-error: 502,503504</li>\n<li>connect-failure</li>\n<li>retriable-4xx4xx</li>\n<li>refused-streamREFUSED_STREAM</li>\n<li>cancelledgRPCHeadercancelled</li>\n<li>deadline-exceededgRPCHeaderdeadline-exceeded</li>\n<li>internalgRPCHeaderinternal</li>\n<li>resource-exhaustedgRPCHeaderresource-exhausted</li>\n<li>unavailablegRPCHeaderunavailable</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>Mirror </p>\n</blockquote>\n<p> <code>mirror</code>,,</p>\n<blockquote>\n<p>HTTPFaultInjection </p>\n</blockquote>\n<p> <code>fault</code>, <code>delay</code>  <code>abort</code> </p>\n<ul>\n<li><code>delay</code>: ,<ul>\n<li><code>fixedDelay</code>: ,, ms,s,m,h</li>\n<li><code>percentage</code>: </li>\n</ul>\n</li>\n<li><code>abort</code>: ,<ul>\n<li><code>httpStatus</code>: , HTTP </li>\n<li><code>percentage</code>: </li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>CorsPolicy </p>\n</blockquote>\n<p> <code>corsPolicy</code>,(Cross<br>Origin Resource Sharing) Web ,</p>\n<ul>\n<li><code>allowMethods</code>:  HTTP , Access-Control-Allow-Methods <br>Header</li>\n<li><code>allowHeaders</code>:  HTTP Header , Access-Control-Allow-Headers  Header </li>\n<li><code>exposeHeaders</code>:  HTTP Header , Access-Control-Expose-Headers  Header </li>\n<li><code>maxAge</code>: , Access-Control-Max-Age  Header</li>\n<li><code>allowCredentials</code>: , Access-Control-Allow-Credentials  Header</li>\n</ul>\n<h2 id=\"TLS-TLSRoute\"><a href=\"#TLS-TLSRoute\" class=\"headerlink\" title=\"TLS(TLSRoute)\"></a>TLS(TLSRoute)</h2><p> <code>TLSMatchAttributes</code>  TLS  HTTPS  <code>RouteDestination</code></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">total-weather-tls</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"*.weather.com\"</span></span><br><span class=\"line\">  <span class=\"attr\">gateways:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"ingress-gateway\"</span></span><br><span class=\"line\">  <span class=\"attr\">tls:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">port:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">sniHosts:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">frontend.weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">frontend</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">port:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">sniHosts:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">recommendation.weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">recommendation</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>TLSMatchAttributes TLS</p>\n</blockquote>\n<p> <code>match</code>, TLS,:</p>\n<ul>\n<li><code>sniHosts</code>:  TLS  SNI ,SNI  VirtualService  hosts </li>\n<li><code>port</code>: </li>\n<li><code>destinationSubnets</code>: IPIP</li>\n<li><code>sourceLabels</code>: </li>\n</ul>\n<p> <code>sniHosts</code>  <code>port</code></p>\n<blockquote>\n<p>RouteDestination </p>\n</blockquote>\n<p>: <code>route</code>,, <code>HTTPRouteDestination</code> </p>\n<ul>\n<li><code>destination</code>: ,. <code>host,subnet,port</code> <ul>\n<li><code>host</code>: , istio . <code>&lt;hostname&gt;.&lt;namspace&gt;.svc.cluster.local</code></li>\n<li><code>subset</code>:  host ,</li>\n</ul>\n</li>\n<li><code>weight</code>: , destination ,weight  100</li>\n</ul>\n<h2 id=\"TCP-TCPRoute\"><a href=\"#TCP-TCPRoute\" class=\"headerlink\" title=\"TCP(TCPRoute)\"></a>TCP(TCPRoute)</h2><p>HTTPTLSTCP</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">  <span class=\"attr\">tcp:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"attr\">port:</span> <span class=\"number\">23003</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span> </span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">inner-forecast</span></span><br><span class=\"line\">        <span class=\"attr\">port:</span></span><br><span class=\"line\">          <span class=\"attr\">number:</span> <span class=\"number\">3003</span></span><br></pre></td></tr></table></figure>\n<p>== TCP  4  <code>L4MatchAttribute</code> ==</p>\n<blockquote>\n<p>L4MatchAttribute </p>\n</blockquote>\n<p> <code>match</code>,</p>\n<ul>\n<li><code>destinationSubnets</code>: IP IP </li>\n<li><code>port</code>: <br><code>sourceLabels</code></li>\n</ul>\n<blockquote>\n<p>RouteDestination   TLS </p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">HTTP</td>\n<td align=\"center\">HTTPRoute</td>\n<td align=\"center\">HTTPMatchRequest</td>\n<td align=\"center\">uri,scheme,method,port,sourceLabels</td>\n<td align=\"center\">route,redirect,rewrite,retry,timeout,faultInjection,corsPolicy</td>\n<td align=\"center\">HTTPRouteDestination</td>\n<td align=\"center\">destination,weight,headers</td>\n</tr>\n<tr>\n<td align=\"center\">TLS</td>\n<td align=\"center\">TLSRoute</td>\n<td align=\"center\">TLSMatchAttribute</td>\n<td align=\"center\">sniHost,port,destinationSubnets,sourceLabels</td>\n<td align=\"center\">route</td>\n<td align=\"center\">RouteDestination</td>\n<td align=\"center\">destination,weight</td>\n</tr>\n<tr>\n<td align=\"center\">TCP</td>\n<td align=\"center\">TCPRoute</td>\n<td align=\"center\">L4MatchAttribute</td>\n<td align=\"center\">destinationSubnets,port,sourceLabels</td>\n<td align=\"center\">route</td>\n<td align=\"center\">RouteDestination</td>\n<td align=\"center\">destination,weight</td>\n</tr>\n</tbody></table>\n<h1 id=\"DestinationRule-\"><a href=\"#DestinationRule-\" class=\"headerlink\" title=\"DestinationRule \"></a>DestinationRule </h1><p>DestinationRule . Istio ,,</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alph3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">DestinationRule</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">host:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">  <span class=\"attr\">subnet:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">    <span class=\"attr\">labels:</span> </span><br><span class=\"line\">      <span class=\"attr\">version:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">    <span class=\"attr\">trafficPolicy:</span></span><br><span class=\"line\">      <span class=\"attr\">loadBalancer:</span></span><br><span class=\"line\">        <span class=\"attr\">simple:</span> <span class=\"string\">ROUND_ROBIN</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">v1</span></span><br><span class=\"line\">    <span class=\"attr\">labels:</span> </span><br><span class=\"line\">      <span class=\"attr\">version:</span> <span class=\"string\">v1</span></span><br><span class=\"line\">    <span class=\"attr\">trafficPolicy:</span></span><br><span class=\"line\">      <span class=\"attr\">loadBalancer:</span></span><br><span class=\"line\">        <span class=\"attr\">simple:</span> <span class=\"string\">RANDON</span></span><br></pre></td></tr></table></figure>\n<p>DestinationRule :</p>\n<ul>\n<li><code>host</code>: ,,.host,.</li>\n<li><code>trafficPolicy</code>: ,,,</li>\n<li><code>PortTrafficPolicy</code>:  port , TrafficPolicy </li>\n<li><code>subsets</code>: ,.<ul>\n<li><code>name</code>: ,subnet </li>\n<li><code>labels</code>: Subset , Subset </li>\n</ul>\n</li>\n<li><code>exportTo</code>:  DestinationRule . .  *,</li>\n</ul>\n<h2 id=\"TrafficPolicy-\"><a href=\"#TrafficPolicy-\" class=\"headerlink\" title=\"TrafficPolicy \"></a>TrafficPolicy </h2><p> 4 </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">loadBalancer</td>\n<td align=\"center\">LoadBalancerSettings</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">connectionPool</td>\n<td align=\"center\">ConnectionPoolSettings</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">outlierDetection</td>\n<td align=\"center\">OutlierDetection</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">tls</td>\n<td align=\"center\">TLSSettings</td>\n<td align=\"center\">TLS</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>loadBalancer </p>\n</blockquote>\n<p> <code>simple()</code>  <code>consistentHash( hash)</code> .,, HTTP </p>\n<ul>\n<li><code>simple</code>  <code>ROUND_ROBIN(,)</code>,<code>LEAST_CONN()</code>,<code>RANDOM()</code>,<code>PASSTHROUGH()</code> </li>\n<li><code>consistentHash</code>  <code>httpHeaderName()</code>,<code>httpCookie(cookie)</code>,<code>useSourceIp( IP)</code> . <code>minimumRingSize()</code> , hash ()</li>\n</ul>\n<blockquote>\n<p>connectionPool </p>\n</blockquote>\n<p>Istio  <code>tcp(TCP)</code>  <code>http(HTTP)</code> .</p>\n<p><code>tcp</code> </p>\n<ul>\n<li><code>maxConnections</code>: ,1024</li>\n<li><code>connectTimeout</code>: TCP,</li>\n<li><code>tcpKeepalive</code>: TCP keepalives(TCP keepalive).,<ul>\n<li><code>probes</code> ,9</li>\n<li><code>time</code> ,2h</li>\n<li><code>interval</code> , 75s</li>\n</ul>\n</li>\n</ul>\n<p><code>http</code> </p>\n<ul>\n<li><code>http1MaxPendingRequests</code>:  HTTP ,1024</li>\n<li><code>http2MaxRequests</code>: ,1024</li>\n<li><code>maxRequestsPerConnection</code>: </li>\n<li><code>maxRetries</code>: ,3</li>\n<li><code>idleTimeout</code>: ,</li>\n</ul>\n<blockquote>\n<p>outlierDetection </p>\n</blockquote>\n<p>,,,,.</p>\n<p></p>\n<ul>\n<li><code>consecutiveErrors</code>: ,5</li>\n<li><code>interval</code>: , 10s</li>\n<li><code>baseEjectionTime</code>: ,30s.</li>\n<li><code>maxEjectionPercent</code>: ,10%.</li>\n<li><code>minHealthPercent</code>: ,,. 50%</li>\n</ul>\n<blockquote>\n<p>tls TLS</p>\n</blockquote>\n<p>istio TLS :</p>\n<ul>\n<li><code>mode</code>: tls .4<ul>\n<li><code>Disable</code>:  TLS </li>\n<li><code>SIMPLE</code>: </li>\n<li><code>MUTUAL</code>: .,</li>\n<li><code>ISTIO_MUTUAL</code>: .Istio,</li>\n</ul>\n</li>\n<li><code>privateKey</code>: </li>\n<li><code>clientCertificate</code>: </li>\n<li><code>caCertificates</code>:  CA </li>\n</ul>\n<h1 id=\"Gateway-\"><a href=\"#Gateway-\" class=\"headerlink\" title=\"Gateway \"></a>Gateway </h1><p>Gateway ,.Istio  Gateway , Gateway ,</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-gateway</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">ingressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">http</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">80</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTP</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">frontend</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">frontend</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\">  <span class=\"attr\">gateways:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">istio.gateway.istio-system.svc.cluster.local</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">mesh</span></span><br><span class=\"line\">  <span class=\"attr\">http:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">headers:</span></span><br><span class=\"line\">      <span class=\"attr\">location:</span></span><br><span class=\"line\">        <span class=\"attr\">exact:</span> <span class=\"string\">north</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destionation:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">frontend</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">route:</span>  </span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destionation:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">frontend</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v1</span></span><br></pre></td></tr></table></figure>\n<p>Gateway  <code>selector()</code>  <code>servers()</code> .</p>\n<blockquote>\n<p>server </p>\n</blockquote>\n<p>server , server</p>\n<ul>\n<li><code>port</code>: ,,</li>\n<li><code>hosts</code>:  gateway , FQDN </li>\n<li><code>defaultEndpoint</code>: </li>\n<li><code>tls</code>: .<ul>\n<li><code>httpsRedirect</code>:  HTTPS </li>\n<li><code>mode</code>: TLS ,<code>PASSTHROUGH(,,TLS),SIMPLE(),MUTUAL(),AUTO_PASSTHROUGH</code></li>\n<li><code>serverCertificate</code>: , SIMPLE,MUTUAL </li>\n<li><code>privateKey</code>: , SIMPLE,MUTUAL </li>\n<li><code>caCertificates</code>: CA, MUTUAL </li>\n<li><code>credentialName</code>: Gateway  <code>credentialName</code> (Kubernetes-Secrets),</li>\n<li><code>subjectAltNames</code>: SAN </li>\n<li><code>minProtocolVersion</code>,<code>maxProtocolVersion</code>: TLS ,</li>\n<li><code>cipherSuites</code>: , Envoy </li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Gateway-\"><a href=\"#Gateway-\" class=\"headerlink\" title=\"Gateway \"></a>Gateway </h2><blockquote>\n<ol>\n<li> HTTPS  HTTPS </li>\n</ol>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-gateway</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">ingressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">https</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTPS</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">tls:</span></span><br><span class=\"line\">      <span class=\"attr\">mode:</span> <span class=\"string\">PASSTHROUGH</span></span><br></pre></td></tr></table></figure>\n<p>,, HTTPS.istio , Gateway  HTTPS .</p>\n<blockquote>\n<ol start=\"2\">\n<li> HTTP  HTTPS </li>\n</ol>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-gateway</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">ingressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">https</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTPS</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">tls:</span></span><br><span class=\"line\">      <span class=\"attr\">mode:</span> <span class=\"string\">SIMPLE</span></span><br><span class=\"line\">      <span class=\"comment\"># , ingressgateway pod . k8s-secrets </span></span><br><span class=\"line\">      <span class=\"attr\">serverCertificate:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/tls.crt</span></span><br><span class=\"line\">      <span class=\"attr\">privateKey:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/tls.key</span></span><br><span class=\"line\">      <span class=\"comment\">#  k8s-secrets ,istio ()</span></span><br><span class=\"line\">      <span class=\"comment\"># credentialName: weather-com-secrets</span></span><br></pre></td></tr></table></figure>\n<p>,, HTTP.istio  Gateway , Gateway  HTTP  HTTPS .</p>\n<blockquote>\n<ol start=\"3\">\n<li> HTTP  HTTPS </li>\n</ol>\n</blockquote>\n<p>,,, TLS . APP</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-gateway</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">ingressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">https</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTPS</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">tls:</span></span><br><span class=\"line\">      <span class=\"attr\">mode:</span> <span class=\"string\">MUTUAL</span></span><br><span class=\"line\">      <span class=\"attr\">serverCertificate:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/tls.crt</span></span><br><span class=\"line\">      <span class=\"attr\">privateKey:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/tls.key</span></span><br><span class=\"line\">      <span class=\"comment\"># </span></span><br><span class=\"line\">      <span class=\"attr\">caCertificates:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/ca.crt</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<ol start=\"4\">\n<li> HTTP  HTTPS  HTTPS </li>\n</ol>\n</blockquote>\n<p>2  Gateway  Manifest , istio  TLS,.</p>\n<p> Gateway  frontend </p>\n<ul>\n<li>frontend HTTP,</li>\n<li>,Gateway  frontend , HTTPS . Gateway  HTTPS , Gateway </li>\n<li>,Gateway  frontend (Envoy,Sidecar), frontend  HTTPS , Citadel , frontend (Envoy,Sidecar) TLS .( mTLS )</li>\n</ul>\n<h1 id=\"ServiceEntry-\"><a href=\"#ServiceEntry-\" class=\"headerlink\" title=\"ServiceEntry \"></a>ServiceEntry </h1><p>ServiceEntry ,, istio </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceEntry</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">weather-external</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">www.weatherdb.com</span></span><br><span class=\"line\">  <span class=\"attr\">ports:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">http</span></span><br><span class=\"line\">    <span class=\"attr\">number:</span> <span class=\"number\">80</span></span><br><span class=\"line\">    <span class=\"attr\">protocol:</span> <span class=\"string\">HTTP</span></span><br><span class=\"line\">  <span class=\"attr\">resolution:</span> <span class=\"string\">DNS</span></span><br><span class=\"line\">  <span class=\"attr\">location:</span> <span class=\"string\">MESH_EXTERNAL</span></span><br></pre></td></tr></table></figure>\n<p>ServiceEntry </p>\n<ul>\n<li><code>hosts</code>: , ServiceEntry . resolution  DN S endpoints ,</li>\n<li><code>ports</code>: ,</li>\n<li><code>resolution</code>: ,,3<ul>\n<li><code>NONE</code>:  IP </li>\n<li><code>STATIC</code>:  endpoints ,</li>\n<li><code>DNS</code>:  DNS . endpoints,<code>hosts</code> DNS </li>\n</ul>\n</li>\n<li><code>addresses</code>: IP</li>\n<li><code>location</code>: <code>MESH_EXTERNAL</code>()  <code>MESH_INTERNAL</code>().,mTLS ,,., Sidecar </li>\n<li><code>endpoints</code>:,IP,.<ul>\n<li><code>address</code>: ,. resolution  DNS ,</li>\n<li><code>ports</code>: </li>\n<li><code>labels</code>: </li>\n<li><code>weight</code>: </li>\n</ul>\n</li>\n</ul>\n<h2 id=\"ServiceEntry-\"><a href=\"#ServiceEntry-\" class=\"headerlink\" title=\"ServiceEntry \"></a>ServiceEntry </h2><blockquote>\n<p> ServiceEntry + Egressgateway + VirtualService </p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  www.weatherdb.com </span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceEntry</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">weather-external</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">www.weatherdb.com</span></span><br><span class=\"line\">  <span class=\"attr\">ports:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">http</span></span><br><span class=\"line\">    <span class=\"attr\">number:</span> <span class=\"number\">80</span></span><br><span class=\"line\">    <span class=\"attr\">protocol:</span> <span class=\"string\">HTTP</span></span><br><span class=\"line\">  <span class=\"attr\">resolution:</span> <span class=\"string\">DNS</span></span><br><span class=\"line\">  <span class=\"attr\">location:</span> <span class=\"string\">MESH_EXTERNAL</span></span><br><span class=\"line\"><span class=\"comment\">#  www.weatherdb.com  egress-gateway </span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">egress-gateway</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">egressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">http</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">80</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTP</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">www.weatherdb.com</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">egress-wearthdb</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">www.weatherdb.com</span></span><br><span class=\"line\">  <span class=\"attr\">gateways:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">egress-gateway.istio-system.svc.cluster.local</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">mesh</span></span><br><span class=\"line\">  <span class=\"attr\">http:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">gateways:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">mesh</span></span><br><span class=\"line\">      <span class=\"attr\">port:</span> <span class=\"number\">80</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">egress-gateway.istio-system.svc.cluster.local</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">gateways:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">egress-gateway.istio-system.svc.cluster.local</span></span><br><span class=\"line\">      <span class=\"attr\">port:</span> <span class=\"number\">80</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">www.weatherdb.com</span></span><br></pre></td></tr></table></figure>\n<p>, route</p>\n<ul>\n<li>:  route  gateways  mesh, <a href=\"http://www.weatherdb.com\" target=\"_blank\" rel=\"noopener\">www.weatherdb.com</a> , egressgateway </li>\n<li>:  route  gateways  egress, egress  <a href=\"http://www.weatherdb.com\" target=\"_blank\" rel=\"noopener\">www.weatherdb.com</a> , <a href=\"http://www.weatherdb.com\" target=\"_blank\" rel=\"noopener\">www.weatherdb.com</a> </li>\n</ul>\n<h1 id=\"Sidecar-\"><a href=\"#Sidecar-\" class=\"headerlink\" title=\"Sidecar \"></a>Sidecar </h1><p> istio</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">SideCar</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">default</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">egress:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"istio-system/*\"</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"news/*\"</span></span><br></pre></td></tr></table></figure>\n<p>Sidecar</p>\n<ul>\n<li><code>workloadSelector</code>: (pod ),,</li>\n<li><code>egress</code>:  sidecar .,,<ul>\n<li><code>hosts</code>: , <code>namespace/dnsName</code> ,</li>\n<li><code>port</code>: </li>\n<li><code>bind</code>: </li>\n<li><code>captureMode</code>: . <code>DEFAULT(),IPTABLES( iptables ),NONE()</code>.</li>\n</ul>\n</li>\n<li><code>ingress</code>:  Sidecar  Inbound.<ul>\n<li><code>port</code>: ,</li>\n<li><code>defaultEndpoint</code>: ,</li>\n<li><code>bind</code>: </li>\n<li><code>captureMode</code>: </li>\n</ul>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li> API </li>\n<li>Pilot  Envoy , Envoy()</li>\n<li>Envoy  Pod  Inbound  Outbound </li>\n<li> Envoy ,</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n</ul>\n<p>: <br>: ,<br>: .,</p>\n<ul>\n<li></li>\n</ul>\n<p>,.,,</p>\n<ul>\n<li></li>\n</ul>\n<p>,,Istio ,.</p>\n<p> HTTP Code 503(),()</p>\n<ul>\n<li></li>\n</ul>\n<p>,,,</p>\n<p>,,AB  3 </p>\n<ul>\n<li></li>\n</ul>\n<p>Istio  Ingress Gateway ,,TLS,VirtualService</p>\n<ul>\n<li></li>\n</ul>\n<p>Istio  ServiceEntry ,.<br> Egress Gateway </p>\n<h1 id=\"VirtualService-\"><a href=\"#VirtualService-\" class=\"headerlink\" title=\"VirtualService \"></a>VirtualService </h1><p>VirtualService ,,, DestinationRule </p>\n<h2 id=\"HTTP-HTTPRoute\"><a href=\"#HTTP-HTTPRoute\" class=\"headerlink\" title=\"HTTP(HTTPRoute)\"></a>HTTP(HTTPRoute)</h2><p> <code>HTTPMatchRequest</code>  <code>HTTPRouteDestination</code>, <code>HTTPRedirect</code>, <code>HTTPRewrite</code>, <code>HTTPRetry</code>, <code>HTTPFaultInjection</code>, <code>CorsPolicy</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">  <span class=\"attr\">http:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">headers:</span></span><br><span class=\"line\">        <span class=\"attr\">location:</span></span><br><span class=\"line\">          <span class=\"attr\">exact:</span> <span class=\"string\">north</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">reviews</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v1</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>HTTPMatchRequest </p>\n</blockquote>\n<p>: <code>match</code>,</p>\n<ul>\n<li><code>uri,scheme,method,authority,headers</code>:  <code>exact(),prefix(),regex()</code> </li>\n<li><code>port</code>: </li>\n<li><code>sourceLabels</code>: , Pod </li>\n</ul>\n<blockquote>\n<p>HTTPRouteDestination </p>\n</blockquote>\n<p>: <code>route</code>,</p>\n<ul>\n<li><code>destination</code>: ,. <code>host,subnet,port</code> <ul>\n<li><code>host</code>: , istio . <code>&lt;hostname&gt;.&lt;namspace&gt;.svc.cluster.local</code></li>\n<li><code>subset</code>:  host ,</li>\n</ul>\n</li>\n<li><code>weight</code>: , destination ,weight  100</li>\n<li><code>headers</code>: </li>\n</ul>\n<blockquote>\n<p>HTTPRedirect </p>\n</blockquote>\n<p>: <code>redirect</code>, <code>uri</code>. <code>uri</code>  uri </p>\n<blockquote>\n<p>HTTPRewrite  url </p>\n</blockquote>\n<p>: <code>rewrite</code>, <code>uri</code>.,, <code>uri</code>  uri</p>\n<blockquote>\n<p>HTTPRetry </p>\n</blockquote>\n<p> <code>retries</code>,(attempts),(perTryTimeout),(retryOn).</p>\n<ul>\n<li><code>attempts</code>: ,</li>\n<li><code>perTryTimeout</code>: , ms,s,m,h</li>\n<li><code>retryOn</code>: ,.:<ul>\n<li>5xx: 5xx,</li>\n<li>gateway-error: 502,503504</li>\n<li>connect-failure</li>\n<li>retriable-4xx4xx</li>\n<li>refused-streamREFUSED_STREAM</li>\n<li>cancelledgRPCHeadercancelled</li>\n<li>deadline-exceededgRPCHeaderdeadline-exceeded</li>\n<li>internalgRPCHeaderinternal</li>\n<li>resource-exhaustedgRPCHeaderresource-exhausted</li>\n<li>unavailablegRPCHeaderunavailable</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>Mirror </p>\n</blockquote>\n<p> <code>mirror</code>,,</p>\n<blockquote>\n<p>HTTPFaultInjection </p>\n</blockquote>\n<p> <code>fault</code>, <code>delay</code>  <code>abort</code> </p>\n<ul>\n<li><code>delay</code>: ,<ul>\n<li><code>fixedDelay</code>: ,, ms,s,m,h</li>\n<li><code>percentage</code>: </li>\n</ul>\n</li>\n<li><code>abort</code>: ,<ul>\n<li><code>httpStatus</code>: , HTTP </li>\n<li><code>percentage</code>: </li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>CorsPolicy </p>\n</blockquote>\n<p> <code>corsPolicy</code>,(Cross<br>Origin Resource Sharing) Web ,</p>\n<ul>\n<li><code>allowMethods</code>:  HTTP , Access-Control-Allow-Methods <br>Header</li>\n<li><code>allowHeaders</code>:  HTTP Header , Access-Control-Allow-Headers  Header </li>\n<li><code>exposeHeaders</code>:  HTTP Header , Access-Control-Expose-Headers  Header </li>\n<li><code>maxAge</code>: , Access-Control-Max-Age  Header</li>\n<li><code>allowCredentials</code>: , Access-Control-Allow-Credentials  Header</li>\n</ul>\n<h2 id=\"TLS-TLSRoute\"><a href=\"#TLS-TLSRoute\" class=\"headerlink\" title=\"TLS(TLSRoute)\"></a>TLS(TLSRoute)</h2><p> <code>TLSMatchAttributes</code>  TLS  HTTPS  <code>RouteDestination</code></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">total-weather-tls</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"*.weather.com\"</span></span><br><span class=\"line\">  <span class=\"attr\">gateways:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">\"ingress-gateway\"</span></span><br><span class=\"line\">  <span class=\"attr\">tls:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">port:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">sniHosts:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">frontend.weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">frontend</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">port:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">sniHosts:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">recommendation.weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">recommendation</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>TLSMatchAttributes TLS</p>\n</blockquote>\n<p> <code>match</code>, TLS,:</p>\n<ul>\n<li><code>sniHosts</code>:  TLS  SNI ,SNI  VirtualService  hosts </li>\n<li><code>port</code>: </li>\n<li><code>destinationSubnets</code>: IPIP</li>\n<li><code>sourceLabels</code>: </li>\n</ul>\n<p> <code>sniHosts</code>  <code>port</code></p>\n<blockquote>\n<p>RouteDestination </p>\n</blockquote>\n<p>: <code>route</code>,, <code>HTTPRouteDestination</code> </p>\n<ul>\n<li><code>destination</code>: ,. <code>host,subnet,port</code> <ul>\n<li><code>host</code>: , istio . <code>&lt;hostname&gt;.&lt;namspace&gt;.svc.cluster.local</code></li>\n<li><code>subset</code>:  host ,</li>\n</ul>\n</li>\n<li><code>weight</code>: , destination ,weight  100</li>\n</ul>\n<h2 id=\"TCP-TCPRoute\"><a href=\"#TCP-TCPRoute\" class=\"headerlink\" title=\"TCP(TCPRoute)\"></a>TCP(TCPRoute)</h2><p>HTTPTLSTCP</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">  <span class=\"attr\">tcp:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"attr\">port:</span> <span class=\"number\">23003</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span> </span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">inner-forecast</span></span><br><span class=\"line\">        <span class=\"attr\">port:</span></span><br><span class=\"line\">          <span class=\"attr\">number:</span> <span class=\"number\">3003</span></span><br></pre></td></tr></table></figure>\n<p>== TCP  4  <code>L4MatchAttribute</code> ==</p>\n<blockquote>\n<p>L4MatchAttribute </p>\n</blockquote>\n<p> <code>match</code>,</p>\n<ul>\n<li><code>destinationSubnets</code>: IP IP </li>\n<li><code>port</code>: <br><code>sourceLabels</code></li>\n</ul>\n<blockquote>\n<p>RouteDestination   TLS </p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">HTTP</td>\n<td align=\"center\">HTTPRoute</td>\n<td align=\"center\">HTTPMatchRequest</td>\n<td align=\"center\">uri,scheme,method,port,sourceLabels</td>\n<td align=\"center\">route,redirect,rewrite,retry,timeout,faultInjection,corsPolicy</td>\n<td align=\"center\">HTTPRouteDestination</td>\n<td align=\"center\">destination,weight,headers</td>\n</tr>\n<tr>\n<td align=\"center\">TLS</td>\n<td align=\"center\">TLSRoute</td>\n<td align=\"center\">TLSMatchAttribute</td>\n<td align=\"center\">sniHost,port,destinationSubnets,sourceLabels</td>\n<td align=\"center\">route</td>\n<td align=\"center\">RouteDestination</td>\n<td align=\"center\">destination,weight</td>\n</tr>\n<tr>\n<td align=\"center\">TCP</td>\n<td align=\"center\">TCPRoute</td>\n<td align=\"center\">L4MatchAttribute</td>\n<td align=\"center\">destinationSubnets,port,sourceLabels</td>\n<td align=\"center\">route</td>\n<td align=\"center\">RouteDestination</td>\n<td align=\"center\">destination,weight</td>\n</tr>\n</tbody></table>\n<h1 id=\"DestinationRule-\"><a href=\"#DestinationRule-\" class=\"headerlink\" title=\"DestinationRule \"></a>DestinationRule </h1><p>DestinationRule . Istio ,,</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alph3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">DestinationRule</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">host:</span> <span class=\"string\">forecast</span></span><br><span class=\"line\">  <span class=\"attr\">subnet:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">    <span class=\"attr\">labels:</span> </span><br><span class=\"line\">      <span class=\"attr\">version:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">    <span class=\"attr\">trafficPolicy:</span></span><br><span class=\"line\">      <span class=\"attr\">loadBalancer:</span></span><br><span class=\"line\">        <span class=\"attr\">simple:</span> <span class=\"string\">ROUND_ROBIN</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">v1</span></span><br><span class=\"line\">    <span class=\"attr\">labels:</span> </span><br><span class=\"line\">      <span class=\"attr\">version:</span> <span class=\"string\">v1</span></span><br><span class=\"line\">    <span class=\"attr\">trafficPolicy:</span></span><br><span class=\"line\">      <span class=\"attr\">loadBalancer:</span></span><br><span class=\"line\">        <span class=\"attr\">simple:</span> <span class=\"string\">RANDON</span></span><br></pre></td></tr></table></figure>\n<p>DestinationRule :</p>\n<ul>\n<li><code>host</code>: ,,.host,.</li>\n<li><code>trafficPolicy</code>: ,,,</li>\n<li><code>PortTrafficPolicy</code>:  port , TrafficPolicy </li>\n<li><code>subsets</code>: ,.<ul>\n<li><code>name</code>: ,subnet </li>\n<li><code>labels</code>: Subset , Subset </li>\n</ul>\n</li>\n<li><code>exportTo</code>:  DestinationRule . .  *,</li>\n</ul>\n<h2 id=\"TrafficPolicy-\"><a href=\"#TrafficPolicy-\" class=\"headerlink\" title=\"TrafficPolicy \"></a>TrafficPolicy </h2><p> 4 </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">loadBalancer</td>\n<td align=\"center\">LoadBalancerSettings</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">connectionPool</td>\n<td align=\"center\">ConnectionPoolSettings</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">outlierDetection</td>\n<td align=\"center\">OutlierDetection</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">tls</td>\n<td align=\"center\">TLSSettings</td>\n<td align=\"center\">TLS</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>loadBalancer </p>\n</blockquote>\n<p> <code>simple()</code>  <code>consistentHash( hash)</code> .,, HTTP </p>\n<ul>\n<li><code>simple</code>  <code>ROUND_ROBIN(,)</code>,<code>LEAST_CONN()</code>,<code>RANDOM()</code>,<code>PASSTHROUGH()</code> </li>\n<li><code>consistentHash</code>  <code>httpHeaderName()</code>,<code>httpCookie(cookie)</code>,<code>useSourceIp( IP)</code> . <code>minimumRingSize()</code> , hash ()</li>\n</ul>\n<blockquote>\n<p>connectionPool </p>\n</blockquote>\n<p>Istio  <code>tcp(TCP)</code>  <code>http(HTTP)</code> .</p>\n<p><code>tcp</code> </p>\n<ul>\n<li><code>maxConnections</code>: ,1024</li>\n<li><code>connectTimeout</code>: TCP,</li>\n<li><code>tcpKeepalive</code>: TCP keepalives(TCP keepalive).,<ul>\n<li><code>probes</code> ,9</li>\n<li><code>time</code> ,2h</li>\n<li><code>interval</code> , 75s</li>\n</ul>\n</li>\n</ul>\n<p><code>http</code> </p>\n<ul>\n<li><code>http1MaxPendingRequests</code>:  HTTP ,1024</li>\n<li><code>http2MaxRequests</code>: ,1024</li>\n<li><code>maxRequestsPerConnection</code>: </li>\n<li><code>maxRetries</code>: ,3</li>\n<li><code>idleTimeout</code>: ,</li>\n</ul>\n<blockquote>\n<p>outlierDetection </p>\n</blockquote>\n<p>,,,,.</p>\n<p></p>\n<ul>\n<li><code>consecutiveErrors</code>: ,5</li>\n<li><code>interval</code>: , 10s</li>\n<li><code>baseEjectionTime</code>: ,30s.</li>\n<li><code>maxEjectionPercent</code>: ,10%.</li>\n<li><code>minHealthPercent</code>: ,,. 50%</li>\n</ul>\n<blockquote>\n<p>tls TLS</p>\n</blockquote>\n<p>istio TLS :</p>\n<ul>\n<li><code>mode</code>: tls .4<ul>\n<li><code>Disable</code>:  TLS </li>\n<li><code>SIMPLE</code>: </li>\n<li><code>MUTUAL</code>: .,</li>\n<li><code>ISTIO_MUTUAL</code>: .Istio,</li>\n</ul>\n</li>\n<li><code>privateKey</code>: </li>\n<li><code>clientCertificate</code>: </li>\n<li><code>caCertificates</code>:  CA </li>\n</ul>\n<h1 id=\"Gateway-\"><a href=\"#Gateway-\" class=\"headerlink\" title=\"Gateway \"></a>Gateway </h1><p>Gateway ,.Istio  Gateway , Gateway ,</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-gateway</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">ingressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">http</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">80</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTP</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">frontend</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">frontend</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\">  <span class=\"attr\">gateways:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">istio.gateway.istio-system.svc.cluster.local</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">mesh</span></span><br><span class=\"line\">  <span class=\"attr\">http:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">headers:</span></span><br><span class=\"line\">      <span class=\"attr\">location:</span></span><br><span class=\"line\">        <span class=\"attr\">exact:</span> <span class=\"string\">north</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destionation:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">frontend</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v2</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">route:</span>  </span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destionation:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">frontend</span></span><br><span class=\"line\">        <span class=\"attr\">subset:</span> <span class=\"string\">v1</span></span><br></pre></td></tr></table></figure>\n<p>Gateway  <code>selector()</code>  <code>servers()</code> .</p>\n<blockquote>\n<p>server </p>\n</blockquote>\n<p>server , server</p>\n<ul>\n<li><code>port</code>: ,,</li>\n<li><code>hosts</code>:  gateway , FQDN </li>\n<li><code>defaultEndpoint</code>: </li>\n<li><code>tls</code>: .<ul>\n<li><code>httpsRedirect</code>:  HTTPS </li>\n<li><code>mode</code>: TLS ,<code>PASSTHROUGH(,,TLS),SIMPLE(),MUTUAL(),AUTO_PASSTHROUGH</code></li>\n<li><code>serverCertificate</code>: , SIMPLE,MUTUAL </li>\n<li><code>privateKey</code>: , SIMPLE,MUTUAL </li>\n<li><code>caCertificates</code>: CA, MUTUAL </li>\n<li><code>credentialName</code>: Gateway  <code>credentialName</code> (Kubernetes-Secrets),</li>\n<li><code>subjectAltNames</code>: SAN </li>\n<li><code>minProtocolVersion</code>,<code>maxProtocolVersion</code>: TLS ,</li>\n<li><code>cipherSuites</code>: , Envoy </li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Gateway-\"><a href=\"#Gateway-\" class=\"headerlink\" title=\"Gateway \"></a>Gateway </h2><blockquote>\n<ol>\n<li> HTTPS  HTTPS </li>\n</ol>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-gateway</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">ingressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">https</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTPS</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">tls:</span></span><br><span class=\"line\">      <span class=\"attr\">mode:</span> <span class=\"string\">PASSTHROUGH</span></span><br></pre></td></tr></table></figure>\n<p>,, HTTPS.istio , Gateway  HTTPS .</p>\n<blockquote>\n<ol start=\"2\">\n<li> HTTP  HTTPS </li>\n</ol>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-gateway</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">ingressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">https</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTPS</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">tls:</span></span><br><span class=\"line\">      <span class=\"attr\">mode:</span> <span class=\"string\">SIMPLE</span></span><br><span class=\"line\">      <span class=\"comment\"># , ingressgateway pod . k8s-secrets </span></span><br><span class=\"line\">      <span class=\"attr\">serverCertificate:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/tls.crt</span></span><br><span class=\"line\">      <span class=\"attr\">privateKey:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/tls.key</span></span><br><span class=\"line\">      <span class=\"comment\">#  k8s-secrets ,istio ()</span></span><br><span class=\"line\">      <span class=\"comment\"># credentialName: weather-com-secrets</span></span><br></pre></td></tr></table></figure>\n<p>,, HTTP.istio  Gateway , Gateway  HTTP  HTTPS .</p>\n<blockquote>\n<ol start=\"3\">\n<li> HTTP  HTTPS </li>\n</ol>\n</blockquote>\n<p>,,, TLS . APP</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">istio-gateway</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">ingressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">https</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTPS</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">weather.com</span></span><br><span class=\"line\">    <span class=\"attr\">tls:</span></span><br><span class=\"line\">      <span class=\"attr\">mode:</span> <span class=\"string\">MUTUAL</span></span><br><span class=\"line\">      <span class=\"attr\">serverCertificate:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/tls.crt</span></span><br><span class=\"line\">      <span class=\"attr\">privateKey:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/tls.key</span></span><br><span class=\"line\">      <span class=\"comment\"># </span></span><br><span class=\"line\">      <span class=\"attr\">caCertificates:</span> <span class=\"string\">/etc/istio/gateway-weather-certs/ca.crt</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<ol start=\"4\">\n<li> HTTP  HTTPS  HTTPS </li>\n</ol>\n</blockquote>\n<p>2  Gateway  Manifest , istio  TLS,.</p>\n<p> Gateway  frontend </p>\n<ul>\n<li>frontend HTTP,</li>\n<li>,Gateway  frontend , HTTPS . Gateway  HTTPS , Gateway </li>\n<li>,Gateway  frontend (Envoy,Sidecar), frontend  HTTPS , Citadel , frontend (Envoy,Sidecar) TLS .( mTLS )</li>\n</ul>\n<h1 id=\"ServiceEntry-\"><a href=\"#ServiceEntry-\" class=\"headerlink\" title=\"ServiceEntry \"></a>ServiceEntry </h1><p>ServiceEntry ,, istio </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceEntry</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">weather-external</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">www.weatherdb.com</span></span><br><span class=\"line\">  <span class=\"attr\">ports:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">http</span></span><br><span class=\"line\">    <span class=\"attr\">number:</span> <span class=\"number\">80</span></span><br><span class=\"line\">    <span class=\"attr\">protocol:</span> <span class=\"string\">HTTP</span></span><br><span class=\"line\">  <span class=\"attr\">resolution:</span> <span class=\"string\">DNS</span></span><br><span class=\"line\">  <span class=\"attr\">location:</span> <span class=\"string\">MESH_EXTERNAL</span></span><br></pre></td></tr></table></figure>\n<p>ServiceEntry </p>\n<ul>\n<li><code>hosts</code>: , ServiceEntry . resolution  DN S endpoints ,</li>\n<li><code>ports</code>: ,</li>\n<li><code>resolution</code>: ,,3<ul>\n<li><code>NONE</code>:  IP </li>\n<li><code>STATIC</code>:  endpoints ,</li>\n<li><code>DNS</code>:  DNS . endpoints,<code>hosts</code> DNS </li>\n</ul>\n</li>\n<li><code>addresses</code>: IP</li>\n<li><code>location</code>: <code>MESH_EXTERNAL</code>()  <code>MESH_INTERNAL</code>().,mTLS ,,., Sidecar </li>\n<li><code>endpoints</code>:,IP,.<ul>\n<li><code>address</code>: ,. resolution  DNS ,</li>\n<li><code>ports</code>: </li>\n<li><code>labels</code>: </li>\n<li><code>weight</code>: </li>\n</ul>\n</li>\n</ul>\n<h2 id=\"ServiceEntry-\"><a href=\"#ServiceEntry-\" class=\"headerlink\" title=\"ServiceEntry \"></a>ServiceEntry </h2><blockquote>\n<p> ServiceEntry + Egressgateway + VirtualService </p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  www.weatherdb.com </span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceEntry</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">weather-external</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">www.weatherdb.com</span></span><br><span class=\"line\">  <span class=\"attr\">ports:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">http</span></span><br><span class=\"line\">    <span class=\"attr\">number:</span> <span class=\"number\">80</span></span><br><span class=\"line\">    <span class=\"attr\">protocol:</span> <span class=\"string\">HTTP</span></span><br><span class=\"line\">  <span class=\"attr\">resolution:</span> <span class=\"string\">DNS</span></span><br><span class=\"line\">  <span class=\"attr\">location:</span> <span class=\"string\">MESH_EXTERNAL</span></span><br><span class=\"line\"><span class=\"comment\">#  www.weatherdb.com  egress-gateway </span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Gateway</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">egress-gateway</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">istio-system</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span> </span><br><span class=\"line\">    <span class=\"attr\">istio:</span> <span class=\"string\">egressgateway</span></span><br><span class=\"line\">  <span class=\"attr\">servers:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">port:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">http</span></span><br><span class=\"line\">      <span class=\"attr\">number:</span> <span class=\"number\">80</span></span><br><span class=\"line\">      <span class=\"attr\">protocol:</span> <span class=\"string\">HTTP</span></span><br><span class=\"line\">    <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">www.weatherdb.com</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">VirtualService</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">egress-wearthdb</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">hosts:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">www.weatherdb.com</span></span><br><span class=\"line\">  <span class=\"attr\">gateways:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">egress-gateway.istio-system.svc.cluster.local</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">mesh</span></span><br><span class=\"line\">  <span class=\"attr\">http:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">gateways:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">mesh</span></span><br><span class=\"line\">      <span class=\"attr\">port:</span> <span class=\"number\">80</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">egress-gateway.istio-system.svc.cluster.local</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">match:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">gateways:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">egress-gateway.istio-system.svc.cluster.local</span></span><br><span class=\"line\">      <span class=\"attr\">port:</span> <span class=\"number\">80</span></span><br><span class=\"line\">    <span class=\"attr\">route:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">destination:</span></span><br><span class=\"line\">        <span class=\"attr\">host:</span> <span class=\"string\">www.weatherdb.com</span></span><br></pre></td></tr></table></figure>\n<p>, route</p>\n<ul>\n<li>:  route  gateways  mesh, <a href=\"http://www.weatherdb.com\" target=\"_blank\" rel=\"noopener\">www.weatherdb.com</a> , egressgateway </li>\n<li>:  route  gateways  egress, egress  <a href=\"http://www.weatherdb.com\" target=\"_blank\" rel=\"noopener\">www.weatherdb.com</a> , <a href=\"http://www.weatherdb.com\" target=\"_blank\" rel=\"noopener\">www.weatherdb.com</a> </li>\n</ul>\n<h1 id=\"Sidecar-\"><a href=\"#Sidecar-\" class=\"headerlink\" title=\"Sidecar \"></a>Sidecar </h1><p> istio</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">networking.istio.io/v1alpha3</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">SideCar</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">default</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">weather</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">egress:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">hosts:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"istio-system/*\"</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"news/*\"</span></span><br></pre></td></tr></table></figure>\n<p>Sidecar</p>\n<ul>\n<li><code>workloadSelector</code>: (pod ),,</li>\n<li><code>egress</code>:  sidecar .,,<ul>\n<li><code>hosts</code>: , <code>namespace/dnsName</code> ,</li>\n<li><code>port</code>: </li>\n<li><code>bind</code>: </li>\n<li><code>captureMode</code>: . <code>DEFAULT(),IPTABLES( iptables ),NONE()</code>.</li>\n</ul>\n</li>\n<li><code>ingress</code>:  Sidecar  Inbound.<ul>\n<li><code>port</code>: ,</li>\n<li><code>defaultEndpoint</code>: ,</li>\n<li><code>bind</code>: </li>\n<li><code>captureMode</code>: </li>\n</ul>\n</li>\n</ul>\n"},{"title":"kubernetes","abbrlink":57264,"description":" kubernetes ","_content":"\n# etcd\n\n> - [x] [](https://github.com/etcd-io/etcd/issues/10174)\n\n\n```log\n2019-07-22 03:33:16.621867 W | etcdserver: read-only range request \"key:\\\"/registry/namespaces/kube-system\\\" \" with result \"range_response_count:1 size:177\" took too long (265.312097ms) to execute\n2019-07-22 03:33:16.622103 W | etcdserver: read-only range request \"key:\\\"/registry/health\\\" \" with result \"range_response_count:0 size:4\" took too long (255.015614ms) to execute\n2019-07-22 03:33:16.622848 W | etcdserver: read-only range request \"key:\\\"/registry/clusterroles/\\\" range_end:\\\"/registry/clusterroles0\\\" \" with result \"range_response_count:0 size:4\" took too long (266.165829ms) to execute\n2019-07-22 03:33:16.625493 W | etcdserver: read-only range request \"key:\\\"/registry/health\\\" \" with result \"range_response_count:0 size:4\" took too long (231.260569ms) to execute\n```\n\n- [IO](https://github.com/etcd-io/etcd/blob/master/Documentation/faq.md#what-does-the-etcd-warning-apply-entries-took-too-long-mean)\n\n> - [x] [](https://github.com/etcd-io/etcd/issues/5154)\n\n\n```bash\n# etcd \netcd --name vm1 --initial-advertise-peer-urls http://192.168.2.3:12380 \\\n  --listen-peer-urls http://192.168.2.3:12380 \\\n  --listen-client-urls http://192.168.2.3:12379,http://127.0.0.1:12379 \\\n  --advertise-client-urls http://192.168.2.3:12379 \\\n  --initial-cluster-token etcd-cluster-bin \\\n  --initial-cluster vm1=http://192.168.2.3:12380,vm2=http://192.168.2.4:12380 \\\n  --initial-cluster-state new\n```\n\n```log\n2019-08-20 16:58:45.366953 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 154.491083ms, to 7ceb206ff2a779a3)\n2019-08-20 16:58:45.366979 W | etcdserver: server is likely overloaded\n2019-08-20 16:59:14.442020 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 44.374276ms, to 7ceb206ff2a779a3)\n2019-08-20 16:59:14.442049 W | etcdserver: server is likely overloaded\n2019-08-20 16:59:38.078540 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 380.617868ms, to 7ceb206ff2a779a3)\n```\n: `--heartbeat-interval 250 --election-timeout 1250`\n\n# kube-apiserver\n\n> - [ ] [unknow](https://github.com/kubernetes/kubernetes/issues/76956)\n```log\nE0722 03:32:55.266253       1 prometheus.go:55] failed to register depth metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266276       1 prometheus.go:68] failed to register adds metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266294       1 prometheus.go:82] failed to register latency metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266308       1 prometheus.go:96] failed to register workDuration metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266330       1 prometheus.go:112] failed to register unfinished metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266346       1 prometheus.go:126] failed to register unfinished metric admission_quota_controller: duplicate metrics collector registration attempted\n```\n\n# metrics-server\n\n> - [x] [metrics ](https://github.com/kubernetes-incubator/metrics-server/issues/247)\n\n```log\nE0821 01:20:44.192985       1 reststorage.go:128] unable to fetch node metrics for node \"vm1\": no metrics known for node\nE0821 01:20:44.193003       1 reststorage.go:128] unable to fetch node metrics for node \"vm2\": no metrics known for node\nE0821 01:25:06.254119       1 reststorage.go:147] unable to fetch pod metrics for pod default/bbox: no metrics known for pod\nE0821 01:25:06.254143       1 reststorage.go:147] unable to fetch pod metrics for pod default/nginx: no metrics known for pod\nE0821 01:25:43.654288       1 manager.go:111] unable to fully collect metrics: [unable to fully scrape metrics from source kubelet_summary:vm2: unable to fetch metrics from Kubelet vm2 (vm2): Get https://vm2:10250/stats/summary/: x509: certificate signed by unknown authority, unable to fully scrape metrics from source kubelet_summary:vm1: unable to fetch metrics from Kubelet vm1 (vm1): Get https://vm1:10250/stats/summary/: x509: certificate signed by unknown authority]\n```\n: `metrics-server-deployment.yaml``args: [ \"--kubelet-insecure-tls\" ]`\n\n\n> - [x] [](https://www.cnblogs.com/vincenshen/p/9638162.html)\n```\nE1218 10:26:36.104471       1 manager.go:111] unable to fully collect metrics: [unable to fully scrape metrics from source kubelet_summary:master: unable to fetch metrics from Kubelet master (10.168.67.6): request failed - \"403 Forbidden\", response: \"Forbidden (user=system:serviceaccount:kube-system:metrics-server, verb=get, resource=nodes, subresource=stats)\"]\n```\n\n- clusterrole`system:metrics-server``nodes/stats`\n\n: `nodes/stats` get \n```bash\nkubectl get clusterrole system:metrics-server -o yaml > metrics-server-clusterrole.yaml\nkubectl apply -f metrics-server-clusterrole.yaml\n```\n\n# Kubelet\n\n> - [x] [](https://github.com/kubernetes/kubernetes/issues/60987#issuecomment-529107444)\n```log\n# /var/log/kubernetes/kubelet.log\nE0214 17:00:33.187665    1547 kubelet_volumes.go:154] Orphaned pod \"8d73e524-fb7c-4b25-a907-3c18b78f587d\" found, but volume paths are still present on disk : There were a total of 1 errors similar to this. Turn up verbosity to see them.\nE0214 17:00:35.188258    1547 kubelet_volumes.go:154] Orphaned pod \"8d73e524-fb7c-4b25-a907-3c18b78f587d\" found, but volume paths are still present on disk : There were a total of 1 errors similar to this. Turn up verbosity to see them.\n```\n: Podid,\n```bash\njournalctl -fu kubelet | awk -F'\"' '{ print $2}'\ncd /var/lib/kubelet/pods\nrm -rf <pod id#>\n```\n\n# helm\n\n> - [x] [helm  tiller ](https://www.orchome.com/1977)\n\n\n```bash\nkubectl apply -f - << EOF\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: tiller\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: tiller\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- kind: ServiceAccount\n  name: tiller\n  namespace: kube-system\nEOF\nhelm init --service-account tiller\nhelm version\n```\n\n```\nClient: &version.Version{SemVer:\"v2.12.0\", GitCommit:\"d325d2a9c179b33af1a024cdb5a4472b6288016a\", GitTreeState:\"clean\"}\nE0311 14:30:57.739137    2268 portforward.go:331] an error occurred forwarding 37108 -> 44134: error forwarding port 44134 to pod 656c9a0a94968a3ef99a17bba846c4617d8afd1b6f9a375890a86b965cd9fa5f, uid : unable to do port forwarding: socat not found\nError: cannot connect to Tiller\n```\n: `socat`\n\n# \n\n> - [x] , Pod  ping\n\n:  node  flannel.1  down,[](https://www.oschina.net/question/2344660_2286913)\n:  cni0,flannel.1 \n```bash\nsystemctl stop kubelet \nsystemctl stop docker \nifconfig cni0 down\nifconfig flannel.1 down \nifconfig docker0 down \nip link delete cni0 \nip link delete flannel.1 \nsystemctl start docker \nsystemctl start kubelet\n```\n\n> - [x] kubernetesTerminatingnamespace\n\n: namespace json`spec`,\n```bash\nkubectl get namespace <namespace-name> -o json > tmp.json\n#  tmp.json, \"spec\" \ncurl -k -XPUT -H \"Content-Type: application/json\" --data-binary @tmp.json http://127.0.0.1:8001/api/v1/namespaces/istio-system/finalize\n```\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/k8s-errors-and-resolve.md","raw":"---\ntitle: kubernetes\ntags:\n  - kubernetes\n  - etcd\ncategories:\n  - \nabbrlink: 57264\ndescription:  kubernetes \n---\n\n# etcd\n\n> - [x] [](https://github.com/etcd-io/etcd/issues/10174)\n\n\n```log\n2019-07-22 03:33:16.621867 W | etcdserver: read-only range request \"key:\\\"/registry/namespaces/kube-system\\\" \" with result \"range_response_count:1 size:177\" took too long (265.312097ms) to execute\n2019-07-22 03:33:16.622103 W | etcdserver: read-only range request \"key:\\\"/registry/health\\\" \" with result \"range_response_count:0 size:4\" took too long (255.015614ms) to execute\n2019-07-22 03:33:16.622848 W | etcdserver: read-only range request \"key:\\\"/registry/clusterroles/\\\" range_end:\\\"/registry/clusterroles0\\\" \" with result \"range_response_count:0 size:4\" took too long (266.165829ms) to execute\n2019-07-22 03:33:16.625493 W | etcdserver: read-only range request \"key:\\\"/registry/health\\\" \" with result \"range_response_count:0 size:4\" took too long (231.260569ms) to execute\n```\n\n- [IO](https://github.com/etcd-io/etcd/blob/master/Documentation/faq.md#what-does-the-etcd-warning-apply-entries-took-too-long-mean)\n\n> - [x] [](https://github.com/etcd-io/etcd/issues/5154)\n\n\n```bash\n# etcd \netcd --name vm1 --initial-advertise-peer-urls http://192.168.2.3:12380 \\\n  --listen-peer-urls http://192.168.2.3:12380 \\\n  --listen-client-urls http://192.168.2.3:12379,http://127.0.0.1:12379 \\\n  --advertise-client-urls http://192.168.2.3:12379 \\\n  --initial-cluster-token etcd-cluster-bin \\\n  --initial-cluster vm1=http://192.168.2.3:12380,vm2=http://192.168.2.4:12380 \\\n  --initial-cluster-state new\n```\n\n```log\n2019-08-20 16:58:45.366953 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 154.491083ms, to 7ceb206ff2a779a3)\n2019-08-20 16:58:45.366979 W | etcdserver: server is likely overloaded\n2019-08-20 16:59:14.442020 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 44.374276ms, to 7ceb206ff2a779a3)\n2019-08-20 16:59:14.442049 W | etcdserver: server is likely overloaded\n2019-08-20 16:59:38.078540 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 380.617868ms, to 7ceb206ff2a779a3)\n```\n: `--heartbeat-interval 250 --election-timeout 1250`\n\n# kube-apiserver\n\n> - [ ] [unknow](https://github.com/kubernetes/kubernetes/issues/76956)\n```log\nE0722 03:32:55.266253       1 prometheus.go:55] failed to register depth metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266276       1 prometheus.go:68] failed to register adds metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266294       1 prometheus.go:82] failed to register latency metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266308       1 prometheus.go:96] failed to register workDuration metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266330       1 prometheus.go:112] failed to register unfinished metric admission_quota_controller: duplicate metrics collector registration attempted\nE0722 03:32:55.266346       1 prometheus.go:126] failed to register unfinished metric admission_quota_controller: duplicate metrics collector registration attempted\n```\n\n# metrics-server\n\n> - [x] [metrics ](https://github.com/kubernetes-incubator/metrics-server/issues/247)\n\n```log\nE0821 01:20:44.192985       1 reststorage.go:128] unable to fetch node metrics for node \"vm1\": no metrics known for node\nE0821 01:20:44.193003       1 reststorage.go:128] unable to fetch node metrics for node \"vm2\": no metrics known for node\nE0821 01:25:06.254119       1 reststorage.go:147] unable to fetch pod metrics for pod default/bbox: no metrics known for pod\nE0821 01:25:06.254143       1 reststorage.go:147] unable to fetch pod metrics for pod default/nginx: no metrics known for pod\nE0821 01:25:43.654288       1 manager.go:111] unable to fully collect metrics: [unable to fully scrape metrics from source kubelet_summary:vm2: unable to fetch metrics from Kubelet vm2 (vm2): Get https://vm2:10250/stats/summary/: x509: certificate signed by unknown authority, unable to fully scrape metrics from source kubelet_summary:vm1: unable to fetch metrics from Kubelet vm1 (vm1): Get https://vm1:10250/stats/summary/: x509: certificate signed by unknown authority]\n```\n: `metrics-server-deployment.yaml``args: [ \"--kubelet-insecure-tls\" ]`\n\n\n> - [x] [](https://www.cnblogs.com/vincenshen/p/9638162.html)\n```\nE1218 10:26:36.104471       1 manager.go:111] unable to fully collect metrics: [unable to fully scrape metrics from source kubelet_summary:master: unable to fetch metrics from Kubelet master (10.168.67.6): request failed - \"403 Forbidden\", response: \"Forbidden (user=system:serviceaccount:kube-system:metrics-server, verb=get, resource=nodes, subresource=stats)\"]\n```\n\n- clusterrole`system:metrics-server``nodes/stats`\n\n: `nodes/stats` get \n```bash\nkubectl get clusterrole system:metrics-server -o yaml > metrics-server-clusterrole.yaml\nkubectl apply -f metrics-server-clusterrole.yaml\n```\n\n# Kubelet\n\n> - [x] [](https://github.com/kubernetes/kubernetes/issues/60987#issuecomment-529107444)\n```log\n# /var/log/kubernetes/kubelet.log\nE0214 17:00:33.187665    1547 kubelet_volumes.go:154] Orphaned pod \"8d73e524-fb7c-4b25-a907-3c18b78f587d\" found, but volume paths are still present on disk : There were a total of 1 errors similar to this. Turn up verbosity to see them.\nE0214 17:00:35.188258    1547 kubelet_volumes.go:154] Orphaned pod \"8d73e524-fb7c-4b25-a907-3c18b78f587d\" found, but volume paths are still present on disk : There were a total of 1 errors similar to this. Turn up verbosity to see them.\n```\n: Podid,\n```bash\njournalctl -fu kubelet | awk -F'\"' '{ print $2}'\ncd /var/lib/kubelet/pods\nrm -rf <pod id#>\n```\n\n# helm\n\n> - [x] [helm  tiller ](https://www.orchome.com/1977)\n\n\n```bash\nkubectl apply -f - << EOF\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: tiller\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: tiller\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- kind: ServiceAccount\n  name: tiller\n  namespace: kube-system\nEOF\nhelm init --service-account tiller\nhelm version\n```\n\n```\nClient: &version.Version{SemVer:\"v2.12.0\", GitCommit:\"d325d2a9c179b33af1a024cdb5a4472b6288016a\", GitTreeState:\"clean\"}\nE0311 14:30:57.739137    2268 portforward.go:331] an error occurred forwarding 37108 -> 44134: error forwarding port 44134 to pod 656c9a0a94968a3ef99a17bba846c4617d8afd1b6f9a375890a86b965cd9fa5f, uid : unable to do port forwarding: socat not found\nError: cannot connect to Tiller\n```\n: `socat`\n\n# \n\n> - [x] , Pod  ping\n\n:  node  flannel.1  down,[](https://www.oschina.net/question/2344660_2286913)\n:  cni0,flannel.1 \n```bash\nsystemctl stop kubelet \nsystemctl stop docker \nifconfig cni0 down\nifconfig flannel.1 down \nifconfig docker0 down \nip link delete cni0 \nip link delete flannel.1 \nsystemctl start docker \nsystemctl start kubelet\n```\n\n> - [x] kubernetesTerminatingnamespace\n\n: namespace json`spec`,\n```bash\nkubectl get namespace <namespace-name> -o json > tmp.json\n#  tmp.json, \"spec\" \ncurl -k -XPUT -H \"Content-Type: application/json\" --data-binary @tmp.json http://127.0.0.1:8001/api/v1/namespaces/istio-system/finalize\n```\n\n\n\n\n\n\n\n\n\n\n\n","slug":"k8s-errors-and-resolve","published":1,"date":"2020-04-03T05:01:02.302Z","updated":"2020-05-02T00:17:28.658Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihw1002wk8u7534pghqp","content":"<h1 id=\"etcd\"><a href=\"#etcd\" class=\"headerlink\" title=\"etcd\"></a>etcd</h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://github.com/etcd-io/etcd/issues/10174\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n</blockquote>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2019-07-22 03:33:16.621867 W | etcdserver: read-only range request &quot;key:\\&quot;&#x2F;registry&#x2F;namespaces&#x2F;kube-system\\&quot; &quot; with result &quot;range_response_count:1 size:177&quot; took too long (265.312097ms) to execute</span><br><span class=\"line\">2019-07-22 03:33:16.622103 W | etcdserver: read-only range request &quot;key:\\&quot;&#x2F;registry&#x2F;health\\&quot; &quot; with result &quot;range_response_count:0 size:4&quot; took too long (255.015614ms) to execute</span><br><span class=\"line\">2019-07-22 03:33:16.622848 W | etcdserver: read-only range request &quot;key:\\&quot;&#x2F;registry&#x2F;clusterroles&#x2F;\\&quot; range_end:\\&quot;&#x2F;registry&#x2F;clusterroles0\\&quot; &quot; with result &quot;range_response_count:0 size:4&quot; took too long (266.165829ms) to execute</span><br><span class=\"line\">2019-07-22 03:33:16.625493 W | etcdserver: read-only range request &quot;key:\\&quot;&#x2F;registry&#x2F;health\\&quot; &quot; with result &quot;range_response_count:0 size:4&quot; took too long (231.260569ms) to execute</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><a href=\"https://github.com/etcd-io/etcd/blob/master/Documentation/faq.md#what-does-the-etcd-warning-apply-entries-took-too-long-mean\" target=\"_blank\" rel=\"noopener\">IO</a></li>\n</ul>\n<blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://github.com/etcd-io/etcd/issues/5154\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n</blockquote>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># etcd </span></span><br><span class=\"line\">etcd --name vm1 --initial-advertise-peer-urls http://192.168.2.3:12380 \\</span><br><span class=\"line\">  --listen-peer-urls http://192.168.2.3:12380 \\</span><br><span class=\"line\">  --listen-client-urls http://192.168.2.3:12379,http://127.0.0.1:12379 \\</span><br><span class=\"line\">  --advertise-client-urls http://192.168.2.3:12379 \\</span><br><span class=\"line\">  --initial-cluster-token etcd-cluster-bin \\</span><br><span class=\"line\">  --initial-cluster vm1=http://192.168.2.3:12380,vm2=http://192.168.2.4:12380 \\</span><br><span class=\"line\">  --initial-cluster-state new</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2019-08-20 16:58:45.366953 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 154.491083ms, to 7ceb206ff2a779a3)</span><br><span class=\"line\">2019-08-20 16:58:45.366979 W | etcdserver: server is likely overloaded</span><br><span class=\"line\">2019-08-20 16:59:14.442020 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 44.374276ms, to 7ceb206ff2a779a3)</span><br><span class=\"line\">2019-08-20 16:59:14.442049 W | etcdserver: server is likely overloaded</span><br><span class=\"line\">2019-08-20 16:59:38.078540 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 380.617868ms, to 7ceb206ff2a779a3)</span><br></pre></td></tr></table></figure>\n<p>: <code>--heartbeat-interval 250 --election-timeout 1250</code></p>\n<h1 id=\"kube-apiserver\"><a href=\"#kube-apiserver\" class=\"headerlink\" title=\"kube-apiserver\"></a>kube-apiserver</h1><blockquote>\n<ul>\n<li><input disabled type=\"checkbox\"> <a href=\"https://github.com/kubernetes/kubernetes/issues/76956\" target=\"_blank\" rel=\"noopener\">unknow</a></li>\n</ul>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">E0722 03:32:55.266253       1 prometheus.go:55] failed to register depth metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266276       1 prometheus.go:68] failed to register adds metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266294       1 prometheus.go:82] failed to register latency metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266308       1 prometheus.go:96] failed to register workDuration metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266330       1 prometheus.go:112] failed to register unfinished metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266346       1 prometheus.go:126] failed to register unfinished metric admission_quota_controller: duplicate metrics collector registration attempted</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"metrics-server\"><a href=\"#metrics-server\" class=\"headerlink\" title=\"metrics-server\"></a>metrics-server</h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://github.com/kubernetes-incubator/metrics-server/issues/247\" target=\"_blank\" rel=\"noopener\">metrics </a></li>\n</ul>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">E0821 01:20:44.192985       1 reststorage.go:128] unable to fetch node metrics for node &quot;vm1&quot;: no metrics known for node</span><br><span class=\"line\">E0821 01:20:44.193003       1 reststorage.go:128] unable to fetch node metrics for node &quot;vm2&quot;: no metrics known for node</span><br><span class=\"line\">E0821 01:25:06.254119       1 reststorage.go:147] unable to fetch pod metrics for pod default&#x2F;bbox: no metrics known for pod</span><br><span class=\"line\">E0821 01:25:06.254143       1 reststorage.go:147] unable to fetch pod metrics for pod default&#x2F;nginx: no metrics known for pod</span><br><span class=\"line\">E0821 01:25:43.654288       1 manager.go:111] unable to fully collect metrics: [unable to fully scrape metrics from source kubelet_summary:vm2: unable to fetch metrics from Kubelet vm2 (vm2): Get https:&#x2F;&#x2F;vm2:10250&#x2F;stats&#x2F;summary&#x2F;: x509: certificate signed by unknown authority, unable to fully scrape metrics from source kubelet_summary:vm1: unable to fetch metrics from Kubelet vm1 (vm1): Get https:&#x2F;&#x2F;vm1:10250&#x2F;stats&#x2F;summary&#x2F;: x509: certificate signed by unknown authority]</span><br></pre></td></tr></table></figure>\n<p>: <code>metrics-server-deployment.yaml</code><code>args: [ &quot;--kubelet-insecure-tls&quot; ]</code></p>\n<blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://www.cnblogs.com/vincenshen/p/9638162.html\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n</blockquote>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">E1218 <span class=\"number\">10</span>:<span class=\"number\">26</span>:<span class=\"number\">36.104471</span>       <span class=\"number\">1</span> manager.go:<span class=\"number\">111</span>] unable to fully collect metrics: [unable to fully scrape metrics <span class=\"keyword\">from</span> source kubelet_summary:master: unable to fetch metrics <span class=\"keyword\">from</span> Kubelet master (<span class=\"number\">10.168</span><span class=\"number\">.67</span><span class=\"number\">.6</span>): request failed - <span class=\"string\">\"403 Forbidden\"</span>, response: <span class=\"string\">\"Forbidden (user=system:serviceaccount:kube-system:metrics-server, verb=get, resource=nodes, subresource=stats)\"</span>]</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li>clusterrole<code>system:metrics-server</code><code>nodes/stats</code></li>\n</ul>\n<p>: <code>nodes/stats</code> get </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl get clusterrole system:metrics-server -o yaml &gt; metrics-server-clusterrole.yaml</span><br><span class=\"line\">kubectl apply -f metrics-server-clusterrole.yaml</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Kubelet\"><a href=\"#Kubelet\" class=\"headerlink\" title=\"Kubelet\"></a>Kubelet</h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://github.com/kubernetes/kubernetes/issues/60987#issuecomment-529107444\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># &#x2F;var&#x2F;log&#x2F;kubernetes&#x2F;kubelet.log</span><br><span class=\"line\">E0214 17:00:33.187665    1547 kubelet_volumes.go:154] Orphaned pod &quot;8d73e524-fb7c-4b25-a907-3c18b78f587d&quot; found, but volume paths are still present on disk : There were a total of 1 errors similar to this. Turn up verbosity to see them.</span><br><span class=\"line\">E0214 17:00:35.188258    1547 kubelet_volumes.go:154] Orphaned pod &quot;8d73e524-fb7c-4b25-a907-3c18b78f587d&quot; found, but volume paths are still present on disk : There were a total of 1 errors similar to this. Turn up verbosity to see them.</span><br></pre></td></tr></table></figure>\n<p>: Podid,</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">journalctl -fu kubelet | awk -F<span class=\"string\">'\"'</span> <span class=\"string\">'&#123; print $2&#125;'</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /var/lib/kubelet/pods</span><br><span class=\"line\">rm -rf &lt;pod id<span class=\"comment\">#&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"helm\"><a href=\"#helm\" class=\"headerlink\" title=\"helm\"></a>helm</h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://www.orchome.com/1977\" target=\"_blank\" rel=\"noopener\">helm  tiller </a></li>\n</ul>\n</blockquote>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl apply -f - &lt;&lt; EOF</span><br><span class=\"line\">apiVersion: v1</span><br><span class=\"line\">kind: ServiceAccount</span><br><span class=\"line\">metadata:</span><br><span class=\"line\">  name: tiller</span><br><span class=\"line\">  namespace: kube-system</span><br><span class=\"line\">---</span><br><span class=\"line\">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class=\"line\">kind: ClusterRoleBinding</span><br><span class=\"line\">metadata:</span><br><span class=\"line\">  name: tiller</span><br><span class=\"line\">roleRef:</span><br><span class=\"line\">  apiGroup: rbac.authorization.k8s.io</span><br><span class=\"line\">  kind: ClusterRole</span><br><span class=\"line\">  name: cluster-admin</span><br><span class=\"line\">subjects:</span><br><span class=\"line\">- kind: ServiceAccount</span><br><span class=\"line\">  name: tiller</span><br><span class=\"line\">  namespace: kube-system</span><br><span class=\"line\">EOF</span><br><span class=\"line\">helm init --service-account tiller</span><br><span class=\"line\">helm version</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Client: &amp;version.Version&#123;SemVer:<span class=\"string\">\"v2.12.0\"</span>, GitCommit:<span class=\"string\">\"d325d2a9c179b33af1a024cdb5a4472b6288016a\"</span>, GitTreeState:<span class=\"string\">\"clean\"</span>&#125;</span><br><span class=\"line\">E0311 14:30:57.739137    2268 portforward.go:331] an <span class=\"builtin-name\">error</span> occurred forwarding 37108 -&gt; 44134: <span class=\"builtin-name\">error</span> forwarding<span class=\"built_in\"> port </span>44134 <span class=\"keyword\">to</span> pod 656c9a0a94968a3ef99a17bba846c4617d8afd1b6f9a375890a86b965cd9fa5f, uid : unable <span class=\"keyword\">to</span> <span class=\"keyword\">do</span><span class=\"built_in\"> port </span>forwarding: socat <span class=\"keyword\">not</span> found</span><br><span class=\"line\">Error: cannot connect <span class=\"keyword\">to</span> Tiller</span><br></pre></td></tr></table></figure>\n<p>: <code>socat</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> , Pod  ping</li>\n</ul>\n</blockquote>\n<p>:  node  flannel.1  down,<a href=\"https://www.oschina.net/question/2344660_2286913\" target=\"_blank\" rel=\"noopener\"></a><br>:  cni0,flannel.1 </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop kubelet </span><br><span class=\"line\">systemctl stop docker </span><br><span class=\"line\">ifconfig cni0 down</span><br><span class=\"line\">ifconfig flannel.1 down </span><br><span class=\"line\">ifconfig docker0 down </span><br><span class=\"line\">ip link delete cni0 </span><br><span class=\"line\">ip link delete flannel.1 </span><br><span class=\"line\">systemctl start docker </span><br><span class=\"line\">systemctl start kubelet</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> kubernetesTerminatingnamespace</li>\n</ul>\n</blockquote>\n<p>: namespace json<code>spec</code>,</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl get namespace &lt;namespace-name&gt; -o json &gt; tmp.json</span><br><span class=\"line\"><span class=\"comment\">#  tmp.json, \"spec\" </span></span><br><span class=\"line\">curl -k -XPUT -H <span class=\"string\">\"Content-Type: application/json\"</span> --data-binary @tmp.json http://127.0.0.1:8001/api/v1/namespaces/istio-system/finalize</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n\n\n\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"etcd\"><a href=\"#etcd\" class=\"headerlink\" title=\"etcd\"></a>etcd</h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://github.com/etcd-io/etcd/issues/10174\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n</blockquote>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2019-07-22 03:33:16.621867 W | etcdserver: read-only range request &quot;key:\\&quot;&#x2F;registry&#x2F;namespaces&#x2F;kube-system\\&quot; &quot; with result &quot;range_response_count:1 size:177&quot; took too long (265.312097ms) to execute</span><br><span class=\"line\">2019-07-22 03:33:16.622103 W | etcdserver: read-only range request &quot;key:\\&quot;&#x2F;registry&#x2F;health\\&quot; &quot; with result &quot;range_response_count:0 size:4&quot; took too long (255.015614ms) to execute</span><br><span class=\"line\">2019-07-22 03:33:16.622848 W | etcdserver: read-only range request &quot;key:\\&quot;&#x2F;registry&#x2F;clusterroles&#x2F;\\&quot; range_end:\\&quot;&#x2F;registry&#x2F;clusterroles0\\&quot; &quot; with result &quot;range_response_count:0 size:4&quot; took too long (266.165829ms) to execute</span><br><span class=\"line\">2019-07-22 03:33:16.625493 W | etcdserver: read-only range request &quot;key:\\&quot;&#x2F;registry&#x2F;health\\&quot; &quot; with result &quot;range_response_count:0 size:4&quot; took too long (231.260569ms) to execute</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><a href=\"https://github.com/etcd-io/etcd/blob/master/Documentation/faq.md#what-does-the-etcd-warning-apply-entries-took-too-long-mean\" target=\"_blank\" rel=\"noopener\">IO</a></li>\n</ul>\n<blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://github.com/etcd-io/etcd/issues/5154\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n</blockquote>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># etcd </span></span><br><span class=\"line\">etcd --name vm1 --initial-advertise-peer-urls http://192.168.2.3:12380 \\</span><br><span class=\"line\">  --listen-peer-urls http://192.168.2.3:12380 \\</span><br><span class=\"line\">  --listen-client-urls http://192.168.2.3:12379,http://127.0.0.1:12379 \\</span><br><span class=\"line\">  --advertise-client-urls http://192.168.2.3:12379 \\</span><br><span class=\"line\">  --initial-cluster-token etcd-cluster-bin \\</span><br><span class=\"line\">  --initial-cluster vm1=http://192.168.2.3:12380,vm2=http://192.168.2.4:12380 \\</span><br><span class=\"line\">  --initial-cluster-state new</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2019-08-20 16:58:45.366953 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 154.491083ms, to 7ceb206ff2a779a3)</span><br><span class=\"line\">2019-08-20 16:58:45.366979 W | etcdserver: server is likely overloaded</span><br><span class=\"line\">2019-08-20 16:59:14.442020 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 44.374276ms, to 7ceb206ff2a779a3)</span><br><span class=\"line\">2019-08-20 16:59:14.442049 W | etcdserver: server is likely overloaded</span><br><span class=\"line\">2019-08-20 16:59:38.078540 W | etcdserver: failed to send out heartbeat on time (exceeded the 100ms timeout for 380.617868ms, to 7ceb206ff2a779a3)</span><br></pre></td></tr></table></figure>\n<p>: <code>--heartbeat-interval 250 --election-timeout 1250</code></p>\n<h1 id=\"kube-apiserver\"><a href=\"#kube-apiserver\" class=\"headerlink\" title=\"kube-apiserver\"></a>kube-apiserver</h1><blockquote>\n<ul>\n<li><input disabled type=\"checkbox\"> <a href=\"https://github.com/kubernetes/kubernetes/issues/76956\" target=\"_blank\" rel=\"noopener\">unknow</a></li>\n</ul>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">E0722 03:32:55.266253       1 prometheus.go:55] failed to register depth metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266276       1 prometheus.go:68] failed to register adds metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266294       1 prometheus.go:82] failed to register latency metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266308       1 prometheus.go:96] failed to register workDuration metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266330       1 prometheus.go:112] failed to register unfinished metric admission_quota_controller: duplicate metrics collector registration attempted</span><br><span class=\"line\">E0722 03:32:55.266346       1 prometheus.go:126] failed to register unfinished metric admission_quota_controller: duplicate metrics collector registration attempted</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"metrics-server\"><a href=\"#metrics-server\" class=\"headerlink\" title=\"metrics-server\"></a>metrics-server</h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://github.com/kubernetes-incubator/metrics-server/issues/247\" target=\"_blank\" rel=\"noopener\">metrics </a></li>\n</ul>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">E0821 01:20:44.192985       1 reststorage.go:128] unable to fetch node metrics for node &quot;vm1&quot;: no metrics known for node</span><br><span class=\"line\">E0821 01:20:44.193003       1 reststorage.go:128] unable to fetch node metrics for node &quot;vm2&quot;: no metrics known for node</span><br><span class=\"line\">E0821 01:25:06.254119       1 reststorage.go:147] unable to fetch pod metrics for pod default&#x2F;bbox: no metrics known for pod</span><br><span class=\"line\">E0821 01:25:06.254143       1 reststorage.go:147] unable to fetch pod metrics for pod default&#x2F;nginx: no metrics known for pod</span><br><span class=\"line\">E0821 01:25:43.654288       1 manager.go:111] unable to fully collect metrics: [unable to fully scrape metrics from source kubelet_summary:vm2: unable to fetch metrics from Kubelet vm2 (vm2): Get https:&#x2F;&#x2F;vm2:10250&#x2F;stats&#x2F;summary&#x2F;: x509: certificate signed by unknown authority, unable to fully scrape metrics from source kubelet_summary:vm1: unable to fetch metrics from Kubelet vm1 (vm1): Get https:&#x2F;&#x2F;vm1:10250&#x2F;stats&#x2F;summary&#x2F;: x509: certificate signed by unknown authority]</span><br></pre></td></tr></table></figure>\n<p>: <code>metrics-server-deployment.yaml</code><code>args: [ &quot;--kubelet-insecure-tls&quot; ]</code></p>\n<blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://www.cnblogs.com/vincenshen/p/9638162.html\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n</blockquote>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">E1218 <span class=\"number\">10</span>:<span class=\"number\">26</span>:<span class=\"number\">36.104471</span>       <span class=\"number\">1</span> manager.go:<span class=\"number\">111</span>] unable to fully collect metrics: [unable to fully scrape metrics <span class=\"keyword\">from</span> source kubelet_summary:master: unable to fetch metrics <span class=\"keyword\">from</span> Kubelet master (<span class=\"number\">10.168</span><span class=\"number\">.67</span><span class=\"number\">.6</span>): request failed - <span class=\"string\">\"403 Forbidden\"</span>, response: <span class=\"string\">\"Forbidden (user=system:serviceaccount:kube-system:metrics-server, verb=get, resource=nodes, subresource=stats)\"</span>]</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li>clusterrole<code>system:metrics-server</code><code>nodes/stats</code></li>\n</ul>\n<p>: <code>nodes/stats</code> get </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl get clusterrole system:metrics-server -o yaml &gt; metrics-server-clusterrole.yaml</span><br><span class=\"line\">kubectl apply -f metrics-server-clusterrole.yaml</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Kubelet\"><a href=\"#Kubelet\" class=\"headerlink\" title=\"Kubelet\"></a>Kubelet</h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://github.com/kubernetes/kubernetes/issues/60987#issuecomment-529107444\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># &#x2F;var&#x2F;log&#x2F;kubernetes&#x2F;kubelet.log</span><br><span class=\"line\">E0214 17:00:33.187665    1547 kubelet_volumes.go:154] Orphaned pod &quot;8d73e524-fb7c-4b25-a907-3c18b78f587d&quot; found, but volume paths are still present on disk : There were a total of 1 errors similar to this. Turn up verbosity to see them.</span><br><span class=\"line\">E0214 17:00:35.188258    1547 kubelet_volumes.go:154] Orphaned pod &quot;8d73e524-fb7c-4b25-a907-3c18b78f587d&quot; found, but volume paths are still present on disk : There were a total of 1 errors similar to this. Turn up verbosity to see them.</span><br></pre></td></tr></table></figure>\n<p>: Podid,</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">journalctl -fu kubelet | awk -F<span class=\"string\">'\"'</span> <span class=\"string\">'&#123; print $2&#125;'</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /var/lib/kubelet/pods</span><br><span class=\"line\">rm -rf &lt;pod id<span class=\"comment\">#&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"helm\"><a href=\"#helm\" class=\"headerlink\" title=\"helm\"></a>helm</h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> <a href=\"https://www.orchome.com/1977\" target=\"_blank\" rel=\"noopener\">helm  tiller </a></li>\n</ul>\n</blockquote>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl apply -f - &lt;&lt; EOF</span><br><span class=\"line\">apiVersion: v1</span><br><span class=\"line\">kind: ServiceAccount</span><br><span class=\"line\">metadata:</span><br><span class=\"line\">  name: tiller</span><br><span class=\"line\">  namespace: kube-system</span><br><span class=\"line\">---</span><br><span class=\"line\">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class=\"line\">kind: ClusterRoleBinding</span><br><span class=\"line\">metadata:</span><br><span class=\"line\">  name: tiller</span><br><span class=\"line\">roleRef:</span><br><span class=\"line\">  apiGroup: rbac.authorization.k8s.io</span><br><span class=\"line\">  kind: ClusterRole</span><br><span class=\"line\">  name: cluster-admin</span><br><span class=\"line\">subjects:</span><br><span class=\"line\">- kind: ServiceAccount</span><br><span class=\"line\">  name: tiller</span><br><span class=\"line\">  namespace: kube-system</span><br><span class=\"line\">EOF</span><br><span class=\"line\">helm init --service-account tiller</span><br><span class=\"line\">helm version</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Client: &amp;version.Version&#123;SemVer:<span class=\"string\">\"v2.12.0\"</span>, GitCommit:<span class=\"string\">\"d325d2a9c179b33af1a024cdb5a4472b6288016a\"</span>, GitTreeState:<span class=\"string\">\"clean\"</span>&#125;</span><br><span class=\"line\">E0311 14:30:57.739137    2268 portforward.go:331] an <span class=\"builtin-name\">error</span> occurred forwarding 37108 -&gt; 44134: <span class=\"builtin-name\">error</span> forwarding<span class=\"built_in\"> port </span>44134 <span class=\"keyword\">to</span> pod 656c9a0a94968a3ef99a17bba846c4617d8afd1b6f9a375890a86b965cd9fa5f, uid : unable <span class=\"keyword\">to</span> <span class=\"keyword\">do</span><span class=\"built_in\"> port </span>forwarding: socat <span class=\"keyword\">not</span> found</span><br><span class=\"line\">Error: cannot connect <span class=\"keyword\">to</span> Tiller</span><br></pre></td></tr></table></figure>\n<p>: <code>socat</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> , Pod  ping</li>\n</ul>\n</blockquote>\n<p>:  node  flannel.1  down,<a href=\"https://www.oschina.net/question/2344660_2286913\" target=\"_blank\" rel=\"noopener\"></a><br>:  cni0,flannel.1 </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop kubelet </span><br><span class=\"line\">systemctl stop docker </span><br><span class=\"line\">ifconfig cni0 down</span><br><span class=\"line\">ifconfig flannel.1 down </span><br><span class=\"line\">ifconfig docker0 down </span><br><span class=\"line\">ip link delete cni0 </span><br><span class=\"line\">ip link delete flannel.1 </span><br><span class=\"line\">systemctl start docker </span><br><span class=\"line\">systemctl start kubelet</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<ul>\n<li><input checked disabled type=\"checkbox\"> kubernetesTerminatingnamespace</li>\n</ul>\n</blockquote>\n<p>: namespace json<code>spec</code>,</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl get namespace &lt;namespace-name&gt; -o json &gt; tmp.json</span><br><span class=\"line\"><span class=\"comment\">#  tmp.json, \"spec\" </span></span><br><span class=\"line\">curl -k -XPUT -H <span class=\"string\">\"Content-Type: application/json\"</span> --data-binary @tmp.json http://127.0.0.1:8001/api/v1/namespaces/istio-system/finalize</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n\n\n\n\n"},{"title":"kube-prometheusetcd","abbrlink":43867,"description":"kube-prometheus  etcd ,  kube-prometheus  etcd ","_content":"\n# \n```bash\nyum install -y go\ngo get github.com/jsonnet-bundler/jsonnet-bundler/cmd/jb # jsonnet \ngo get github.com/brancz/gojsontoyaml # go  json  yaml \n#  ~/go/bin/ \ncd ~/go/bin/\ncp jb gojsontoyaml /usr/local/bin/\n```\n\n#  jsonnet\n```bash\ncd my-kube-prometheus #   kube-prometheus\njb init  #  jsonnetfile.json\n#  kube-prometheus .\n# , github.com/coreos/kube-prometheus/jsonnet/kube-prometheus@master\njb install github.com/coreos/kube-prometheus/jsonnet/kube-prometheus@release-0.1 \njb update\n```\n# \n `build.sh` , `etcd.jsonnet` \n```bash\n#!/bin/bash\n\nset -e\nset -x\nset -o pipefail\n\nrm -rf manifests\nmkdir -p manifests/setup\n\njsonnet -J vendor -m manifests \"${1-etcd.jsonnet}\" | xargs -I{} sh -c 'cat {} | gojsontoyaml > {}.yaml; rm -f {}' -- {}\n```\n\n```jsonnet\n// https://github.com/coreos/kube-prometheus/blob/master/examples/etcd.jsonnet\nlocal kp = (import 'kube-prometheus/kube-prometheus.libsonnet') +\n           (import 'kube-prometheus/kube-prometheus-static-etcd.libsonnet') + {\n  _config+:: {\n    namespace: 'monitoring',\n    etcd+:: {\n      //  etcd  IP ,  \n      ips: ['10.168.67.6', '10.168.67.7', '10.168.67.8'],\n      clientCA: importstr '/etc/kubernetes/pki/etcd/ca.crt',\n      clientCert: importstr '/etc/kubernetes/pki/etcd/healthcheck-client.crt',\n      clientKey: importstr '/etc/kubernetes/pki/etcd/healthcheck-client.key',\n      //  serverName  insecureSkipVerify .\n      //  serverName, openssl.cnf  etcd  DNS, x509 . serverName  nslookup \n      //  insecureSkipVerify,\n      serverName: 'etcd.kube-system.svc.cluster.local',\n      //insecureSkipVerify: true,\n    },\n  },\n};\n\n{ ['00namespace-' + name]: kp.kubePrometheus[name] for name in std.objectFields(kp.kubePrometheus) } +\n{ ['0prometheus-operator-' + name]: kp.prometheusOperator[name] for name in std.objectFields(kp.prometheusOperator) } +\n{ ['node-exporter-' + name]: kp.nodeExporter[name] for name in std.objectFields(kp.nodeExporter) } +\n{ ['kube-state-metrics-' + name]: kp.kubeStateMetrics[name] for name in std.objectFields(kp.kubeStateMetrics) } +\n{ ['alertmanager-' + name]: kp.alertmanager[name] for name in std.objectFields(kp.alertmanager) } +\n{ ['prometheus-' + name]: kp.prometheus[name] for name in std.objectFields(kp.prometheus) } +\n{ ['grafana-' + name]: kp.grafana[name] for name in std.objectFields(kp.grafana) }\n```\n\n#  \n `manifests`\n```bash\nkubectl apply -f manifests/setup\nkubectl apply -f manifests/\n```\n\n `kube-prometheus` ,\n```bash\njb init\njb update\nbuild.sh\nkubectl apply -f manifests/setup\nkubectl apply -f manifests/\n```","source":"_posts/monitor-etcd-with-kube-prometheus.md","raw":"---\ntitle: kube-prometheusetcd\ntags:\n  - kubernetes\n  - prometheus\n  - etcd\ncategories:\n  - \n  - prometheus\nabbrlink: 43867\ndescription: kube-prometheus  etcd ,  kube-prometheus  etcd \n---\n\n# \n```bash\nyum install -y go\ngo get github.com/jsonnet-bundler/jsonnet-bundler/cmd/jb # jsonnet \ngo get github.com/brancz/gojsontoyaml # go  json  yaml \n#  ~/go/bin/ \ncd ~/go/bin/\ncp jb gojsontoyaml /usr/local/bin/\n```\n\n#  jsonnet\n```bash\ncd my-kube-prometheus #   kube-prometheus\njb init  #  jsonnetfile.json\n#  kube-prometheus .\n# , github.com/coreos/kube-prometheus/jsonnet/kube-prometheus@master\njb install github.com/coreos/kube-prometheus/jsonnet/kube-prometheus@release-0.1 \njb update\n```\n# \n `build.sh` , `etcd.jsonnet` \n```bash\n#!/bin/bash\n\nset -e\nset -x\nset -o pipefail\n\nrm -rf manifests\nmkdir -p manifests/setup\n\njsonnet -J vendor -m manifests \"${1-etcd.jsonnet}\" | xargs -I{} sh -c 'cat {} | gojsontoyaml > {}.yaml; rm -f {}' -- {}\n```\n\n```jsonnet\n// https://github.com/coreos/kube-prometheus/blob/master/examples/etcd.jsonnet\nlocal kp = (import 'kube-prometheus/kube-prometheus.libsonnet') +\n           (import 'kube-prometheus/kube-prometheus-static-etcd.libsonnet') + {\n  _config+:: {\n    namespace: 'monitoring',\n    etcd+:: {\n      //  etcd  IP ,  \n      ips: ['10.168.67.6', '10.168.67.7', '10.168.67.8'],\n      clientCA: importstr '/etc/kubernetes/pki/etcd/ca.crt',\n      clientCert: importstr '/etc/kubernetes/pki/etcd/healthcheck-client.crt',\n      clientKey: importstr '/etc/kubernetes/pki/etcd/healthcheck-client.key',\n      //  serverName  insecureSkipVerify .\n      //  serverName, openssl.cnf  etcd  DNS, x509 . serverName  nslookup \n      //  insecureSkipVerify,\n      serverName: 'etcd.kube-system.svc.cluster.local',\n      //insecureSkipVerify: true,\n    },\n  },\n};\n\n{ ['00namespace-' + name]: kp.kubePrometheus[name] for name in std.objectFields(kp.kubePrometheus) } +\n{ ['0prometheus-operator-' + name]: kp.prometheusOperator[name] for name in std.objectFields(kp.prometheusOperator) } +\n{ ['node-exporter-' + name]: kp.nodeExporter[name] for name in std.objectFields(kp.nodeExporter) } +\n{ ['kube-state-metrics-' + name]: kp.kubeStateMetrics[name] for name in std.objectFields(kp.kubeStateMetrics) } +\n{ ['alertmanager-' + name]: kp.alertmanager[name] for name in std.objectFields(kp.alertmanager) } +\n{ ['prometheus-' + name]: kp.prometheus[name] for name in std.objectFields(kp.prometheus) } +\n{ ['grafana-' + name]: kp.grafana[name] for name in std.objectFields(kp.grafana) }\n```\n\n#  \n `manifests`\n```bash\nkubectl apply -f manifests/setup\nkubectl apply -f manifests/\n```\n\n `kube-prometheus` ,\n```bash\njb init\njb update\nbuild.sh\nkubectl apply -f manifests/setup\nkubectl apply -f manifests/\n```","slug":"monitor-etcd-with-kube-prometheus","published":1,"date":"2020-04-03T05:03:58.151Z","updated":"2020-04-26T08:47:19.246Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckab8ihx4004pk8u7gda1d2tg","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y go</span><br><span class=\"line\">go get github.com/jsonnet-bundler/jsonnet-bundler/cmd/jb <span class=\"comment\"># jsonnet </span></span><br><span class=\"line\">go get github.com/brancz/gojsontoyaml <span class=\"comment\"># go  json  yaml </span></span><br><span class=\"line\"><span class=\"comment\">#  ~/go/bin/ </span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/go/bin/</span><br><span class=\"line\">cp jb gojsontoyaml /usr/<span class=\"built_in\">local</span>/bin/</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-jsonnet\"><a href=\"#-jsonnet\" class=\"headerlink\" title=\" jsonnet\"></a> jsonnet</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> my-kube-prometheus <span class=\"comment\">#   kube-prometheus</span></span><br><span class=\"line\">jb init  <span class=\"comment\">#  jsonnetfile.json</span></span><br><span class=\"line\"><span class=\"comment\">#  kube-prometheus .</span></span><br><span class=\"line\"><span class=\"comment\"># , github.com/coreos/kube-prometheus/jsonnet/kube-prometheus@master</span></span><br><span class=\"line\">jb install github.com/coreos/kube-prometheus/jsonnet/kube-prometheus@release-0.1 </span><br><span class=\"line\">jb update</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>build.sh</code> , <code>etcd.jsonnet</code> </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">set</span> -e</span><br><span class=\"line\"><span class=\"built_in\">set</span> -x</span><br><span class=\"line\"><span class=\"built_in\">set</span> -o pipefail</span><br><span class=\"line\"></span><br><span class=\"line\">rm -rf manifests</span><br><span class=\"line\">mkdir -p manifests/setup</span><br><span class=\"line\"></span><br><span class=\"line\">jsonnet -J vendor -m manifests <span class=\"string\">\"<span class=\"variable\">$&#123;1-etcd.jsonnet&#125;</span>\"</span> | xargs -I&#123;&#125; sh -c <span class=\"string\">'cat &#123;&#125; | gojsontoyaml &gt; &#123;&#125;.yaml; rm -f &#123;&#125;'</span> -- &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;coreos&#x2F;kube-prometheus&#x2F;blob&#x2F;master&#x2F;examples&#x2F;etcd.jsonnet</span><br><span class=\"line\">local kp &#x3D; (import &#39;kube-prometheus&#x2F;kube-prometheus.libsonnet&#39;) +</span><br><span class=\"line\">           (import &#39;kube-prometheus&#x2F;kube-prometheus-static-etcd.libsonnet&#39;) + &#123;</span><br><span class=\"line\">  _config+:: &#123;</span><br><span class=\"line\">    namespace: &#39;monitoring&#39;,</span><br><span class=\"line\">    etcd+:: &#123;</span><br><span class=\"line\">      &#x2F;&#x2F;  etcd  IP ,  </span><br><span class=\"line\">      ips: [&#39;10.168.67.6&#39;, &#39;10.168.67.7&#39;, &#39;10.168.67.8&#39;],</span><br><span class=\"line\">      clientCA: importstr &#39;&#x2F;etc&#x2F;kubernetes&#x2F;pki&#x2F;etcd&#x2F;ca.crt&#39;,</span><br><span class=\"line\">      clientCert: importstr &#39;&#x2F;etc&#x2F;kubernetes&#x2F;pki&#x2F;etcd&#x2F;healthcheck-client.crt&#39;,</span><br><span class=\"line\">      clientKey: importstr &#39;&#x2F;etc&#x2F;kubernetes&#x2F;pki&#x2F;etcd&#x2F;healthcheck-client.key&#39;,</span><br><span class=\"line\">      &#x2F;&#x2F;  serverName  insecureSkipVerify .</span><br><span class=\"line\">      &#x2F;&#x2F;  serverName, openssl.cnf  etcd  DNS, x509 . serverName  nslookup </span><br><span class=\"line\">      &#x2F;&#x2F;  insecureSkipVerify,</span><br><span class=\"line\">      serverName: &#39;etcd.kube-system.svc.cluster.local&#39;,</span><br><span class=\"line\">      &#x2F;&#x2F;insecureSkipVerify: true,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123; [&#39;00namespace-&#39; + name]: kp.kubePrometheus[name] for name in std.objectFields(kp.kubePrometheus) &#125; +</span><br><span class=\"line\">&#123; [&#39;0prometheus-operator-&#39; + name]: kp.prometheusOperator[name] for name in std.objectFields(kp.prometheusOperator) &#125; +</span><br><span class=\"line\">&#123; [&#39;node-exporter-&#39; + name]: kp.nodeExporter[name] for name in std.objectFields(kp.nodeExporter) &#125; +</span><br><span class=\"line\">&#123; [&#39;kube-state-metrics-&#39; + name]: kp.kubeStateMetrics[name] for name in std.objectFields(kp.kubeStateMetrics) &#125; +</span><br><span class=\"line\">&#123; [&#39;alertmanager-&#39; + name]: kp.alertmanager[name] for name in std.objectFields(kp.alertmanager) &#125; +</span><br><span class=\"line\">&#123; [&#39;prometheus-&#39; + name]: kp.prometheus[name] for name in std.objectFields(kp.prometheus) &#125; +</span><br><span class=\"line\">&#123; [&#39;grafana-&#39; + name]: kp.grafana[name] for name in std.objectFields(kp.grafana) &#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>manifests</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl apply -f manifests/setup</span><br><span class=\"line\">kubectl apply -f manifests/</span><br></pre></td></tr></table></figure>\n\n<p> <code>kube-prometheus</code> ,</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jb init</span><br><span class=\"line\">jb update</span><br><span class=\"line\">build.sh</span><br><span class=\"line\">kubectl apply -f manifests/setup</span><br><span class=\"line\">kubectl apply -f manifests/</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y go</span><br><span class=\"line\">go get github.com/jsonnet-bundler/jsonnet-bundler/cmd/jb <span class=\"comment\"># jsonnet </span></span><br><span class=\"line\">go get github.com/brancz/gojsontoyaml <span class=\"comment\"># go  json  yaml </span></span><br><span class=\"line\"><span class=\"comment\">#  ~/go/bin/ </span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/go/bin/</span><br><span class=\"line\">cp jb gojsontoyaml /usr/<span class=\"built_in\">local</span>/bin/</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-jsonnet\"><a href=\"#-jsonnet\" class=\"headerlink\" title=\" jsonnet\"></a> jsonnet</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> my-kube-prometheus <span class=\"comment\">#   kube-prometheus</span></span><br><span class=\"line\">jb init  <span class=\"comment\">#  jsonnetfile.json</span></span><br><span class=\"line\"><span class=\"comment\">#  kube-prometheus .</span></span><br><span class=\"line\"><span class=\"comment\"># , github.com/coreos/kube-prometheus/jsonnet/kube-prometheus@master</span></span><br><span class=\"line\">jb install github.com/coreos/kube-prometheus/jsonnet/kube-prometheus@release-0.1 </span><br><span class=\"line\">jb update</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>build.sh</code> , <code>etcd.jsonnet</code> </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">set</span> -e</span><br><span class=\"line\"><span class=\"built_in\">set</span> -x</span><br><span class=\"line\"><span class=\"built_in\">set</span> -o pipefail</span><br><span class=\"line\"></span><br><span class=\"line\">rm -rf manifests</span><br><span class=\"line\">mkdir -p manifests/setup</span><br><span class=\"line\"></span><br><span class=\"line\">jsonnet -J vendor -m manifests <span class=\"string\">\"<span class=\"variable\">$&#123;1-etcd.jsonnet&#125;</span>\"</span> | xargs -I&#123;&#125; sh -c <span class=\"string\">'cat &#123;&#125; | gojsontoyaml &gt; &#123;&#125;.yaml; rm -f &#123;&#125;'</span> -- &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;coreos&#x2F;kube-prometheus&#x2F;blob&#x2F;master&#x2F;examples&#x2F;etcd.jsonnet</span><br><span class=\"line\">local kp &#x3D; (import &#39;kube-prometheus&#x2F;kube-prometheus.libsonnet&#39;) +</span><br><span class=\"line\">           (import &#39;kube-prometheus&#x2F;kube-prometheus-static-etcd.libsonnet&#39;) + &#123;</span><br><span class=\"line\">  _config+:: &#123;</span><br><span class=\"line\">    namespace: &#39;monitoring&#39;,</span><br><span class=\"line\">    etcd+:: &#123;</span><br><span class=\"line\">      &#x2F;&#x2F;  etcd  IP ,  </span><br><span class=\"line\">      ips: [&#39;10.168.67.6&#39;, &#39;10.168.67.7&#39;, &#39;10.168.67.8&#39;],</span><br><span class=\"line\">      clientCA: importstr &#39;&#x2F;etc&#x2F;kubernetes&#x2F;pki&#x2F;etcd&#x2F;ca.crt&#39;,</span><br><span class=\"line\">      clientCert: importstr &#39;&#x2F;etc&#x2F;kubernetes&#x2F;pki&#x2F;etcd&#x2F;healthcheck-client.crt&#39;,</span><br><span class=\"line\">      clientKey: importstr &#39;&#x2F;etc&#x2F;kubernetes&#x2F;pki&#x2F;etcd&#x2F;healthcheck-client.key&#39;,</span><br><span class=\"line\">      &#x2F;&#x2F;  serverName  insecureSkipVerify .</span><br><span class=\"line\">      &#x2F;&#x2F;  serverName, openssl.cnf  etcd  DNS, x509 . serverName  nslookup </span><br><span class=\"line\">      &#x2F;&#x2F;  insecureSkipVerify,</span><br><span class=\"line\">      serverName: &#39;etcd.kube-system.svc.cluster.local&#39;,</span><br><span class=\"line\">      &#x2F;&#x2F;insecureSkipVerify: true,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123; [&#39;00namespace-&#39; + name]: kp.kubePrometheus[name] for name in std.objectFields(kp.kubePrometheus) &#125; +</span><br><span class=\"line\">&#123; [&#39;0prometheus-operator-&#39; + name]: kp.prometheusOperator[name] for name in std.objectFields(kp.prometheusOperator) &#125; +</span><br><span class=\"line\">&#123; [&#39;node-exporter-&#39; + name]: kp.nodeExporter[name] for name in std.objectFields(kp.nodeExporter) &#125; +</span><br><span class=\"line\">&#123; [&#39;kube-state-metrics-&#39; + name]: kp.kubeStateMetrics[name] for name in std.objectFields(kp.kubeStateMetrics) &#125; +</span><br><span class=\"line\">&#123; [&#39;alertmanager-&#39; + name]: kp.alertmanager[name] for name in std.objectFields(kp.alertmanager) &#125; +</span><br><span class=\"line\">&#123; [&#39;prometheus-&#39; + name]: kp.prometheus[name] for name in std.objectFields(kp.prometheus) &#125; +</span><br><span class=\"line\">&#123; [&#39;grafana-&#39; + name]: kp.grafana[name] for name in std.objectFields(kp.grafana) &#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <code>manifests</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl apply -f manifests/setup</span><br><span class=\"line\">kubectl apply -f manifests/</span><br></pre></td></tr></table></figure>\n\n<p> <code>kube-prometheus</code> ,</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jb init</span><br><span class=\"line\">jb update</span><br><span class=\"line\">build.sh</span><br><span class=\"line\">kubectl apply -f manifests/setup</span><br><span class=\"line\">kubectl apply -f manifests/</span><br></pre></td></tr></table></figure>"},{"title":"","abbrlink":51507,"description":".","_content":"\n> \n\n..\n\n- .,,,\n- .,.,,,\n\n> \n\n, 5 :\n\n- : ,\n- : ,,\n- : ,\n- : \n\n> \n\n O , O :\n\n1.  1 \n2. ,\n3.  1,, O \n\n:\n\n```text\nO(1) < O(log n) < O(n) < O(nlog n) < O(n^2) < O(2^n)  < O(n!) < O(n^n)\n```\n\n# \n\n,.,,,.\n\n## \n\n.\n\n- ,\n- ,(), O(1)\n- ,, O(n)\n\n## \n\n- \n- ,,)\n- /,/ next \n\n## \n\n- \"(LIFO, Last In First Out)\"\n- /,\n\n:push(), peek(), pop()\n\n\n## \n\n- \"(FIFO, First-In-First-Out)\"\n- \"\",\"\"\n\n:\n\n# \n\n## \n\n,\"(left subtree)\"\"(right subtree)\".\n\n> : .k, 2^k - 1 \n> : ,,,,\n\n = ->->\n\n = ->->\n\n = ->->\n\n## \n\n- ,\n- ,\n- \n\n> :,()\n\n##  AVL\n\n,1.\n\n,,.AVL,.\n\n,\n\n## \n\n,,\n\n- \n- \n- (NULLNULL)\n- ,\n- ,NULL\n- \n\n> \n\n1. C++STL,MapSet\n2. LinuxCompletely Fair Scheduler,,,,,\n3. IOepollsockfd,\n4. Nginxtimer,,\n5. JavaTreeMap\n\n## B\n\nB,,MBM\n\n- \n- M-1key\n- M-1M keyM-1 M keyValue\n- M/2\n\n,\n\nB.\n,,.\n,B,B,\n\n## B+\n\n[_B+](https://blog.csdn.net/qq_26222859/article/details/80631121)\n\nB+B,.\n\n\n, Select ,,.\n,B ,.\n B+ ,,,,\n\n## \n\n### \n\n,:\n\n- :\n- :\n\n# \n\n## \n\n,,.,.,.\n\n```python\n\n```","source":"_posts/data-structure.md","raw":"---\ntitle: \ntags:\n  - \n  - \ncategories:\n  - \nabbrlink: 51507\ndescription: .\n---\n\n> \n\n..\n\n- .,,,\n- .,.,,,\n\n> \n\n, 5 :\n\n- : ,\n- : ,,\n- : ,\n- : \n\n> \n\n O , O :\n\n1.  1 \n2. ,\n3.  1,, O \n\n:\n\n```text\nO(1) < O(log n) < O(n) < O(nlog n) < O(n^2) < O(2^n)  < O(n!) < O(n^n)\n```\n\n# \n\n,.,,,.\n\n## \n\n.\n\n- ,\n- ,(), O(1)\n- ,, O(n)\n\n## \n\n- \n- ,,)\n- /,/ next \n\n## \n\n- \"(LIFO, Last In First Out)\"\n- /,\n\n:push(), peek(), pop()\n\n\n## \n\n- \"(FIFO, First-In-First-Out)\"\n- \"\",\"\"\n\n:\n\n# \n\n## \n\n,\"(left subtree)\"\"(right subtree)\".\n\n> : .k, 2^k - 1 \n> : ,,,,\n\n = ->->\n\n = ->->\n\n = ->->\n\n## \n\n- ,\n- ,\n- \n\n> :,()\n\n##  AVL\n\n,1.\n\n,,.AVL,.\n\n,\n\n## \n\n,,\n\n- \n- \n- (NULLNULL)\n- ,\n- ,NULL\n- \n\n> \n\n1. C++STL,MapSet\n2. LinuxCompletely Fair Scheduler,,,,,\n3. IOepollsockfd,\n4. Nginxtimer,,\n5. JavaTreeMap\n\n## B\n\nB,,MBM\n\n- \n- M-1key\n- M-1M keyM-1 M keyValue\n- M/2\n\n,\n\nB.\n,,.\n,B,B,\n\n## B+\n\n[_B+](https://blog.csdn.net/qq_26222859/article/details/80631121)\n\nB+B,.\n\n\n, Select ,,.\n,B ,.\n B+ ,,,,\n\n## \n\n### \n\n,:\n\n- :\n- :\n\n# \n\n## \n\n,,.,.,.\n\n```python\n\n```","slug":"data-structure","published":1,"date":"2020-05-17T09:30:02.190Z","updated":"2020-05-22T13:26:32.387Z","_id":"ckai8moxe0000gcu70k2xaxav","comments":1,"layout":"post","photos":[],"link":"","content":"<blockquote>\n<p></p>\n</blockquote>\n<p>..</p>\n<ul>\n<li>.,,,</li>\n<li>.,.,,,</li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<p>, 5 :</p>\n<ul>\n<li>: ,</li>\n<li>: ,,</li>\n<li>: ,</li>\n<li>: </li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<p> O , O :</p>\n<ol>\n<li> 1 </li>\n<li>,</li>\n<li> 1,, O </li>\n</ol>\n<p>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O(1) &lt; O(log n) &lt; O(n) &lt; O(nlog n) &lt; O(n^2) &lt; O(2^n)  &lt; O(n!) &lt; O(n^n)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>,.,,,.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>.</p>\n<ul>\n<li>,</li>\n<li>,(), O(1)</li>\n<li>,, O(n)</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li>,,)</li>\n<li>/,/ next </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>(LIFO, Last In First Out)</li>\n<li>/,</li>\n</ul>\n<p>:push(), peek(), pop()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>(FIFO, First-In-First-Out)</li>\n<li>,</li>\n</ul>\n<p>:</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,(left subtree)(right subtree).</p>\n<blockquote>\n<p>: .k, 2^k - 1 <br>: ,,,,</p>\n</blockquote>\n<p> = -&gt;-&gt;</p>\n<p> = -&gt;-&gt;</p>\n<p> = -&gt;-&gt;</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>,</li>\n<li>,</li>\n<li></li>\n</ul>\n<blockquote>\n<p>:,()</p>\n</blockquote>\n<h2 id=\"-AVL\"><a href=\"#-AVL\" class=\"headerlink\" title=\" AVL\"></a> AVL</h2><p>,1.</p>\n<p>,,.AVL,.</p>\n<p>,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,,</p>\n<ul>\n<li></li>\n<li></li>\n<li>(NULLNULL)</li>\n<li>,</li>\n<li>,NULL</li>\n<li></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<ol>\n<li>C++STL,MapSet</li>\n<li>LinuxCompletely Fair Scheduler,,,,,</li>\n<li>IOepollsockfd,</li>\n<li>Nginxtimer,,</li>\n<li>JavaTreeMap</li>\n</ol>\n<h2 id=\"B\"><a href=\"#B\" class=\"headerlink\" title=\"B\"></a>B</h2><p>B,,MBM</p>\n<ul>\n<li></li>\n<li>M-1key</li>\n<li>M-1M keyM-1 M keyValue</li>\n<li>M/2</li>\n</ul>\n<p>,</p>\n<p>B.<br>,,.<br>,B,B,</p>\n<h2 id=\"B-\"><a href=\"#B-\" class=\"headerlink\" title=\"B+\"></a>B+</h2><p><a href=\"https://blog.csdn.net/qq_26222859/article/details/80631121\" target=\"_blank\" rel=\"noopener\">_B+</a></p>\n<p>B+B,.<br></p>\n<p>, Select ,,.<br>,B ,.<br> B+ ,,,,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,:</p>\n<ul>\n<li>:</li>\n<li>:</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,,.,.,.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p></p>\n</blockquote>\n<p>..</p>\n<ul>\n<li>.,,,</li>\n<li>.,.,,,</li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<p>, 5 :</p>\n<ul>\n<li>: ,</li>\n<li>: ,,</li>\n<li>: ,</li>\n<li>: </li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<p> O , O :</p>\n<ol>\n<li> 1 </li>\n<li>,</li>\n<li> 1,, O </li>\n</ol>\n<p>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O(1) &lt; O(log n) &lt; O(n) &lt; O(nlog n) &lt; O(n^2) &lt; O(2^n)  &lt; O(n!) &lt; O(n^n)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>,.,,,.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>.</p>\n<ul>\n<li>,</li>\n<li>,(), O(1)</li>\n<li>,, O(n)</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li>,,)</li>\n<li>/,/ next </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>(LIFO, Last In First Out)</li>\n<li>/,</li>\n</ul>\n<p>:push(), peek(), pop()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>(FIFO, First-In-First-Out)</li>\n<li>,</li>\n</ul>\n<p>:</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,(left subtree)(right subtree).</p>\n<blockquote>\n<p>: .k, 2^k - 1 <br>: ,,,,</p>\n</blockquote>\n<p> = -&gt;-&gt;</p>\n<p> = -&gt;-&gt;</p>\n<p> = -&gt;-&gt;</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>,</li>\n<li>,</li>\n<li></li>\n</ul>\n<blockquote>\n<p>:,()</p>\n</blockquote>\n<h2 id=\"-AVL\"><a href=\"#-AVL\" class=\"headerlink\" title=\" AVL\"></a> AVL</h2><p>,1.</p>\n<p>,,.AVL,.</p>\n<p>,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,,</p>\n<ul>\n<li></li>\n<li></li>\n<li>(NULLNULL)</li>\n<li>,</li>\n<li>,NULL</li>\n<li></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<ol>\n<li>C++STL,MapSet</li>\n<li>LinuxCompletely Fair Scheduler,,,,,</li>\n<li>IOepollsockfd,</li>\n<li>Nginxtimer,,</li>\n<li>JavaTreeMap</li>\n</ol>\n<h2 id=\"B\"><a href=\"#B\" class=\"headerlink\" title=\"B\"></a>B</h2><p>B,,MBM</p>\n<ul>\n<li></li>\n<li>M-1key</li>\n<li>M-1M keyM-1 M keyValue</li>\n<li>M/2</li>\n</ul>\n<p>,</p>\n<p>B.<br>,,.<br>,B,B,</p>\n<h2 id=\"B-\"><a href=\"#B-\" class=\"headerlink\" title=\"B+\"></a>B+</h2><p><a href=\"https://blog.csdn.net/qq_26222859/article/details/80631121\" target=\"_blank\" rel=\"noopener\">_B+</a></p>\n<p>B+B,.<br></p>\n<p>, Select ,,.<br>,B ,.<br> B+ ,,,,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,:</p>\n<ul>\n<li>:</li>\n<li>:</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,,.,.,.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>"},{"title":"ELK ","abbrlink":53137,"description":" ELK  EFK ,","_content":"\n## \n\n[ELK Stack](https://www.elastic.co/guide/index.html)  [Elasticsearch](https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html), [Logstash](https://www.elastic.co/guide/en/logstash/current/index.html), [Kibana](https://www.elastic.co/guide/en/kibana/current/index.html) ,.,Logstash  [Beats](https://www.elastic.co/guide/en/beats/libbeat/current/beats-reference.html)  [Fluentd](https://www.fluentd.org/). ELK Stack  EFK Stack.\n\n ELK/EFK ,\n\n- Elasticsearch ,, API \n- Logstash ,. `input`, `filter`  `output` ,..\n- Beats ,,,,,,., Logstash .\n- Fluentd  Logstash ,,.,,..\n- Kibana  Elasticsearch , UI , Elasticsearch API , UI .\n\n## \n\n### \n\nLogstash ,,, Elasticsearch , Kibana .\n\n![](ELK-Stack/the-simplest-architecture.png)\n\n,. ELK \n\n###  LogStash \n\n![ LogStash ](ELK-Stack/multi-logstash.png)\n\n Logstash, Logstash ,,\n\n### Beats \n\nBeats  Logstash, Logstash , Elasticsearch , Kibana .\n\n![Beats ](ELK-Stack/beat-for-data-collection.png)\n\n Logstash , Logstash,Beats ,. SSL ,\n\n### \n\n Beat  Logstash , Kafka,Redis,RabbitMQ . Beats ,, Logstash  Elasticsearch , Kibana .\n\n![](ELK-Stack/introduce-message-queue.png)\n\n,, Logstash .,,.,Elasticsearch ,.\n\n##  Elasticsearch\n\n### \n\n```bash\nwget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.7.0-linux-x86_64.tar.gz\ntar -xzf elasticsearch-7.7.0-linux-x86_64.tar.gz\ncd elasticsearch-7.7.0/\n```\n\n### \n\n-  `swap`. `/etc/fstab` \n-  65535. `/etc/security/limits.conf` `nofile` \n-  4096. `/etc/security/limits.conf`  `nproc` \n-  262144. `/etc/sysctl.conf` \n\n```bash\nswapoff -a\nulimit -n 65535\nulimit -u 4096\nsysctl -w vm.max_map_count=262144\n```\n\n###  Elasticsearch \n\nElasticsearch  `config` ,\n\n- `elasticsearch.yml`  Elasticsearch \n- `jvm.options`  Elasticsearch JVM \n- `log4j2.properties`  Elasticsearch \n\n `elasticsearch.yml`  Elasticsearch \n\n```yml\ncluster.name: elasticsearch # , elasticsearch\nnode.name: ${HOSTNAME} # elasticsearch ,\npath.data: [\"/es-data1\", \"es-data2\"] # , data ,,\npath.logs: /var/log/elasticsearch # ,, logs \nnetwork.host: \"0.0.0.0\"  # elasticsearch , 127.0.0.1\nhttp.port: 9200 # \ndiscovery.send_hosts: [\"vm1:9300\", \"vm2:9300\", \"vm3:9300\"] # , 9300 \ncluster.initial_master_nodes: [\"vm1:9200\", \"vm2:9200\", \"vm3:9200\"] # ,\nxpack.security.enabled: false #  xpack-security \n```\n\n `jvm.options`  Elasticsearch JVM \n\n```text\n-Xms1g\n-Xmx1g\n```\n\n,Elasticsearch JVM  1G .,:\n\n- \n-  `Xmx`  `Xms`  `50%`\n- ,,, 32G\n\n###  Elasticsearch\n\n```bash\n# \nbin/elasticsearch -d\n\n# \n-E <KeyValuePair>\n# -Epath.data=data -Epath.logs=log\n```\n\n `curl http://localhost:9200`  Elasticsearch \n\n##  Kibana\n\n```bash\ncurl -O https://artifacts.elastic.co/downloads/kibana/kibana-7.7.0-linux-x86_64.tar.gz\ntar -xzf kibana-7.7.0-linux-x86_64.tar.gz\ncd kibana-7.7.0-linux-x86_64/\nbin/kibana\n```\n\n```yaml\nserver.port: 5601\nserver.host: \"192.168.2.3\"\n# server.name: \"your-hostname\"\nelasticsearch.url: \"http://localhost:9200\"\nkibana.index: \".kibana\"\n# xpack.security.enabled: false\n# elasticsearch.username: \"user\"\n# elasticsearch.password: \"pass\"\n# server.ssl.enabled: false\n# server.ssl.certificate: /path/to/your/server.crt\n# server.ssl.key: /path/to/your/server.key\n# elasticsearch.ssl.certificate: /path/to/your/client.crt\n# elasticsearch.ssl.key: /path/to/your/client.key\n# elasticsearch.ssl.certificateAuthorities: [ \"/path/to/your/CA.pem\" ]\n```\n\n---\n\n\n\n- [ELK  Filebeat ](https://www.ibm.com/developerworks/cn/opensource/os-cn-elk-filebeat/index.html)\n","source":"_posts/ELK-Stack.md","raw":"---\ntitle: ELK \ntags:\n  - ELK\n  - \ncategories:\n  - ELK\nabbrlink: 53137\ndescription: ' ELK  EFK ,'\n---\n\n## \n\n[ELK Stack](https://www.elastic.co/guide/index.html)  [Elasticsearch](https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html), [Logstash](https://www.elastic.co/guide/en/logstash/current/index.html), [Kibana](https://www.elastic.co/guide/en/kibana/current/index.html) ,.,Logstash  [Beats](https://www.elastic.co/guide/en/beats/libbeat/current/beats-reference.html)  [Fluentd](https://www.fluentd.org/). ELK Stack  EFK Stack.\n\n ELK/EFK ,\n\n- Elasticsearch ,, API \n- Logstash ,. `input`, `filter`  `output` ,..\n- Beats ,,,,,,., Logstash .\n- Fluentd  Logstash ,,.,,..\n- Kibana  Elasticsearch , UI , Elasticsearch API , UI .\n\n## \n\n### \n\nLogstash ,,, Elasticsearch , Kibana .\n\n![](ELK-Stack/the-simplest-architecture.png)\n\n,. ELK \n\n###  LogStash \n\n![ LogStash ](ELK-Stack/multi-logstash.png)\n\n Logstash, Logstash ,,\n\n### Beats \n\nBeats  Logstash, Logstash , Elasticsearch , Kibana .\n\n![Beats ](ELK-Stack/beat-for-data-collection.png)\n\n Logstash , Logstash,Beats ,. SSL ,\n\n### \n\n Beat  Logstash , Kafka,Redis,RabbitMQ . Beats ,, Logstash  Elasticsearch , Kibana .\n\n![](ELK-Stack/introduce-message-queue.png)\n\n,, Logstash .,,.,Elasticsearch ,.\n\n##  Elasticsearch\n\n### \n\n```bash\nwget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.7.0-linux-x86_64.tar.gz\ntar -xzf elasticsearch-7.7.0-linux-x86_64.tar.gz\ncd elasticsearch-7.7.0/\n```\n\n### \n\n-  `swap`. `/etc/fstab` \n-  65535. `/etc/security/limits.conf` `nofile` \n-  4096. `/etc/security/limits.conf`  `nproc` \n-  262144. `/etc/sysctl.conf` \n\n```bash\nswapoff -a\nulimit -n 65535\nulimit -u 4096\nsysctl -w vm.max_map_count=262144\n```\n\n###  Elasticsearch \n\nElasticsearch  `config` ,\n\n- `elasticsearch.yml`  Elasticsearch \n- `jvm.options`  Elasticsearch JVM \n- `log4j2.properties`  Elasticsearch \n\n `elasticsearch.yml`  Elasticsearch \n\n```yml\ncluster.name: elasticsearch # , elasticsearch\nnode.name: ${HOSTNAME} # elasticsearch ,\npath.data: [\"/es-data1\", \"es-data2\"] # , data ,,\npath.logs: /var/log/elasticsearch # ,, logs \nnetwork.host: \"0.0.0.0\"  # elasticsearch , 127.0.0.1\nhttp.port: 9200 # \ndiscovery.send_hosts: [\"vm1:9300\", \"vm2:9300\", \"vm3:9300\"] # , 9300 \ncluster.initial_master_nodes: [\"vm1:9200\", \"vm2:9200\", \"vm3:9200\"] # ,\nxpack.security.enabled: false #  xpack-security \n```\n\n `jvm.options`  Elasticsearch JVM \n\n```text\n-Xms1g\n-Xmx1g\n```\n\n,Elasticsearch JVM  1G .,:\n\n- \n-  `Xmx`  `Xms`  `50%`\n- ,,, 32G\n\n###  Elasticsearch\n\n```bash\n# \nbin/elasticsearch -d\n\n# \n-E <KeyValuePair>\n# -Epath.data=data -Epath.logs=log\n```\n\n `curl http://localhost:9200`  Elasticsearch \n\n##  Kibana\n\n```bash\ncurl -O https://artifacts.elastic.co/downloads/kibana/kibana-7.7.0-linux-x86_64.tar.gz\ntar -xzf kibana-7.7.0-linux-x86_64.tar.gz\ncd kibana-7.7.0-linux-x86_64/\nbin/kibana\n```\n\n```yaml\nserver.port: 5601\nserver.host: \"192.168.2.3\"\n# server.name: \"your-hostname\"\nelasticsearch.url: \"http://localhost:9200\"\nkibana.index: \".kibana\"\n# xpack.security.enabled: false\n# elasticsearch.username: \"user\"\n# elasticsearch.password: \"pass\"\n# server.ssl.enabled: false\n# server.ssl.certificate: /path/to/your/server.crt\n# server.ssl.key: /path/to/your/server.key\n# elasticsearch.ssl.certificate: /path/to/your/client.crt\n# elasticsearch.ssl.key: /path/to/your/client.key\n# elasticsearch.ssl.certificateAuthorities: [ \"/path/to/your/CA.pem\" ]\n```\n\n---\n\n\n\n- [ELK  Filebeat ](https://www.ibm.com/developerworks/cn/opensource/os-cn-elk-filebeat/index.html)\n","slug":"ELK-Stack","published":1,"date":"2020-05-22T13:25:30.944Z","updated":"2020-05-23T00:48:20.280Z","_id":"ckai8moy40007gcu72f0x8fen","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"https://www.elastic.co/guide/index.html\" target=\"_blank\" rel=\"noopener\">ELK Stack</a>  <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html\" target=\"_blank\" rel=\"noopener\">Elasticsearch</a>, <a href=\"https://www.elastic.co/guide/en/logstash/current/index.html\" target=\"_blank\" rel=\"noopener\">Logstash</a>, <a href=\"https://www.elastic.co/guide/en/kibana/current/index.html\" target=\"_blank\" rel=\"noopener\">Kibana</a> ,.,Logstash  <a href=\"https://www.elastic.co/guide/en/beats/libbeat/current/beats-reference.html\" target=\"_blank\" rel=\"noopener\">Beats</a>  <a href=\"https://www.fluentd.org/\" target=\"_blank\" rel=\"noopener\">Fluentd</a>. ELK Stack  EFK Stack.</p>\n<p> ELK/EFK ,</p>\n<ul>\n<li>Elasticsearch ,, API </li>\n<li>Logstash ,. <code>input</code>, <code>filter</code>  <code>output</code> ,..</li>\n<li>Beats ,,,,,,., Logstash .</li>\n<li>Fluentd  Logstash ,,.,,..</li>\n<li>Kibana  Elasticsearch , UI , Elasticsearch API , UI .</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Logstash ,,, Elasticsearch , Kibana .</p>\n<p><img src=\"/2020/05/22/ELK-Stack/the-simplest-architecture.png\" alt=\"\"></p>\n<p>,. ELK </p>\n<h3 id=\"-LogStash-\"><a href=\"#-LogStash-\" class=\"headerlink\" title=\" LogStash \"></a> LogStash </h3><p><img src=\"/2020/05/22/ELK-Stack/multi-logstash.png\" alt=\" LogStash \"></p>\n<p> Logstash, Logstash ,,</p>\n<h3 id=\"Beats-\"><a href=\"#Beats-\" class=\"headerlink\" title=\"Beats \"></a>Beats </h3><p>Beats  Logstash, Logstash , Elasticsearch , Kibana .</p>\n<p><img src=\"/2020/05/22/ELK-Stack/beat-for-data-collection.png\" alt=\"Beats \"></p>\n<p> Logstash , Logstash,Beats ,. SSL ,</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> Beat  Logstash , Kafka,Redis,RabbitMQ . Beats ,, Logstash  Elasticsearch , Kibana .</p>\n<p><img src=\"/2020/05/22/ELK-Stack/introduce-message-queue.png\" alt=\"\"></p>\n<p>,, Logstash .,,.,Elasticsearch ,.</p>\n<h2 id=\"-Elasticsearch\"><a href=\"#-Elasticsearch\" class=\"headerlink\" title=\" Elasticsearch\"></a> Elasticsearch</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.7.0-linux-x86_64.tar.gz</span><br><span class=\"line\">tar -xzf elasticsearch-7.7.0-linux-x86_64.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> elasticsearch-7.7.0/</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li> <code>swap</code>. <code>/etc/fstab</code> </li>\n<li> 65535. <code>/etc/security/limits.conf</code> <code>nofile</code> </li>\n<li> 4096. <code>/etc/security/limits.conf</code>  <code>nproc</code> </li>\n<li> 262144. <code>/etc/sysctl.conf</code> </li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">swapoff -a</span><br><span class=\"line\"><span class=\"built_in\">ulimit</span> -n 65535</span><br><span class=\"line\"><span class=\"built_in\">ulimit</span> -u 4096</span><br><span class=\"line\">sysctl -w vm.max_map_count=262144</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-Elasticsearch-\"><a href=\"#-Elasticsearch-\" class=\"headerlink\" title=\" Elasticsearch \"></a> Elasticsearch </h3><p>Elasticsearch  <code>config</code> ,</p>\n<ul>\n<li><code>elasticsearch.yml</code>  Elasticsearch </li>\n<li><code>jvm.options</code>  Elasticsearch JVM </li>\n<li><code>log4j2.properties</code>  Elasticsearch </li>\n</ul>\n<p> <code>elasticsearch.yml</code>  Elasticsearch </p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">cluster.name:</span> <span class=\"string\">elasticsearch</span> <span class=\"comment\"># , elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">node.name:</span> <span class=\"string\">$&#123;HOSTNAME&#125;</span> <span class=\"comment\"># elasticsearch ,</span></span><br><span class=\"line\"><span class=\"attr\">path.data:</span> <span class=\"string\">[\"/es-data1\",</span> <span class=\"string\">\"es-data2\"</span><span class=\"string\">]</span> <span class=\"comment\"># , data ,,</span></span><br><span class=\"line\"><span class=\"attr\">path.logs:</span> <span class=\"string\">/var/log/elasticsearch</span> <span class=\"comment\"># ,, logs </span></span><br><span class=\"line\"><span class=\"attr\">network.host:</span> <span class=\"string\">\"0.0.0.0\"</span>  <span class=\"comment\"># elasticsearch , 127.0.0.1</span></span><br><span class=\"line\"><span class=\"attr\">http.port:</span> <span class=\"number\">9200</span> <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">discovery.send_hosts:</span> <span class=\"string\">[\"vm1:9300\",</span> <span class=\"string\">\"vm2:9300\"</span><span class=\"string\">,</span> <span class=\"string\">\"vm3:9300\"</span><span class=\"string\">]</span> <span class=\"comment\"># , 9300 </span></span><br><span class=\"line\"><span class=\"attr\">cluster.initial_master_nodes:</span> <span class=\"string\">[\"vm1:9200\",</span> <span class=\"string\">\"vm2:9200\"</span><span class=\"string\">,</span> <span class=\"string\">\"vm3:9200\"</span><span class=\"string\">]</span> <span class=\"comment\"># ,</span></span><br><span class=\"line\"><span class=\"attr\">xpack.security.enabled:</span> <span class=\"literal\">false</span> <span class=\"comment\">#  xpack-security </span></span><br></pre></td></tr></table></figure>\n\n<p> <code>jvm.options</code>  Elasticsearch JVM </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-Xms1g</span><br><span class=\"line\">-Xmx1g</span><br></pre></td></tr></table></figure>\n\n<p>,Elasticsearch JVM  1G .,:</p>\n<ul>\n<li></li>\n<li> <code>Xmx</code>  <code>Xms</code>  <code>50%</code></li>\n<li>,,, 32G</li>\n</ul>\n<h3 id=\"-Elasticsearch\"><a href=\"#-Elasticsearch\" class=\"headerlink\" title=\" Elasticsearch\"></a> Elasticsearch</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">bin/elasticsearch -d</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">-E &lt;KeyValuePair&gt;</span><br><span class=\"line\"><span class=\"comment\"># -Epath.data=data -Epath.logs=log</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>curl http://localhost:9200</code>  Elasticsearch </p>\n<h2 id=\"-Kibana\"><a href=\"#-Kibana\" class=\"headerlink\" title=\" Kibana\"></a> Kibana</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -O https://artifacts.elastic.co/downloads/kibana/kibana-7.7.0-linux-x86_64.tar.gz</span><br><span class=\"line\">tar -xzf kibana-7.7.0-linux-x86_64.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> kibana-7.7.0-linux-x86_64/</span><br><span class=\"line\">bin/kibana</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server.port:</span> <span class=\"number\">5601</span></span><br><span class=\"line\"><span class=\"attr\">server.host:</span> <span class=\"string\">\"192.168.2.3\"</span></span><br><span class=\"line\"><span class=\"comment\"># server.name: \"your-hostname\"</span></span><br><span class=\"line\"><span class=\"attr\">elasticsearch.url:</span> <span class=\"string\">\"http://localhost:9200\"</span></span><br><span class=\"line\"><span class=\"attr\">kibana.index:</span> <span class=\"string\">\".kibana\"</span></span><br><span class=\"line\"><span class=\"comment\"># xpack.security.enabled: false</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.username: \"user\"</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.password: \"pass\"</span></span><br><span class=\"line\"><span class=\"comment\"># server.ssl.enabled: false</span></span><br><span class=\"line\"><span class=\"comment\"># server.ssl.certificate: /path/to/your/server.crt</span></span><br><span class=\"line\"><span class=\"comment\"># server.ssl.key: /path/to/your/server.key</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.ssl.certificate: /path/to/your/client.crt</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.ssl.key: /path/to/your/client.key</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.ssl.certificateAuthorities: [ \"/path/to/your/CA.pem\" ]</span></span><br></pre></td></tr></table></figure>\n\n<hr>\n<p></p>\n<ul>\n<li><a href=\"https://www.ibm.com/developerworks/cn/opensource/os-cn-elk-filebeat/index.html\" target=\"_blank\" rel=\"noopener\">ELK  Filebeat </a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"https://www.elastic.co/guide/index.html\" target=\"_blank\" rel=\"noopener\">ELK Stack</a>  <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html\" target=\"_blank\" rel=\"noopener\">Elasticsearch</a>, <a href=\"https://www.elastic.co/guide/en/logstash/current/index.html\" target=\"_blank\" rel=\"noopener\">Logstash</a>, <a href=\"https://www.elastic.co/guide/en/kibana/current/index.html\" target=\"_blank\" rel=\"noopener\">Kibana</a> ,.,Logstash  <a href=\"https://www.elastic.co/guide/en/beats/libbeat/current/beats-reference.html\" target=\"_blank\" rel=\"noopener\">Beats</a>  <a href=\"https://www.fluentd.org/\" target=\"_blank\" rel=\"noopener\">Fluentd</a>. ELK Stack  EFK Stack.</p>\n<p> ELK/EFK ,</p>\n<ul>\n<li>Elasticsearch ,, API </li>\n<li>Logstash ,. <code>input</code>, <code>filter</code>  <code>output</code> ,..</li>\n<li>Beats ,,,,,,., Logstash .</li>\n<li>Fluentd  Logstash ,,.,,..</li>\n<li>Kibana  Elasticsearch , UI , Elasticsearch API , UI .</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Logstash ,,, Elasticsearch , Kibana .</p>\n<p><img src=\"/2020/05/22/ELK-Stack/the-simplest-architecture.png\" alt=\"\"></p>\n<p>,. ELK </p>\n<h3 id=\"-LogStash-\"><a href=\"#-LogStash-\" class=\"headerlink\" title=\" LogStash \"></a> LogStash </h3><p><img src=\"/2020/05/22/ELK-Stack/multi-logstash.png\" alt=\" LogStash \"></p>\n<p> Logstash, Logstash ,,</p>\n<h3 id=\"Beats-\"><a href=\"#Beats-\" class=\"headerlink\" title=\"Beats \"></a>Beats </h3><p>Beats  Logstash, Logstash , Elasticsearch , Kibana .</p>\n<p><img src=\"/2020/05/22/ELK-Stack/beat-for-data-collection.png\" alt=\"Beats \"></p>\n<p> Logstash , Logstash,Beats ,. SSL ,</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> Beat  Logstash , Kafka,Redis,RabbitMQ . Beats ,, Logstash  Elasticsearch , Kibana .</p>\n<p><img src=\"/2020/05/22/ELK-Stack/introduce-message-queue.png\" alt=\"\"></p>\n<p>,, Logstash .,,.,Elasticsearch ,.</p>\n<h2 id=\"-Elasticsearch\"><a href=\"#-Elasticsearch\" class=\"headerlink\" title=\" Elasticsearch\"></a> Elasticsearch</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.7.0-linux-x86_64.tar.gz</span><br><span class=\"line\">tar -xzf elasticsearch-7.7.0-linux-x86_64.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> elasticsearch-7.7.0/</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li> <code>swap</code>. <code>/etc/fstab</code> </li>\n<li> 65535. <code>/etc/security/limits.conf</code> <code>nofile</code> </li>\n<li> 4096. <code>/etc/security/limits.conf</code>  <code>nproc</code> </li>\n<li> 262144. <code>/etc/sysctl.conf</code> </li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">swapoff -a</span><br><span class=\"line\"><span class=\"built_in\">ulimit</span> -n 65535</span><br><span class=\"line\"><span class=\"built_in\">ulimit</span> -u 4096</span><br><span class=\"line\">sysctl -w vm.max_map_count=262144</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-Elasticsearch-\"><a href=\"#-Elasticsearch-\" class=\"headerlink\" title=\" Elasticsearch \"></a> Elasticsearch </h3><p>Elasticsearch  <code>config</code> ,</p>\n<ul>\n<li><code>elasticsearch.yml</code>  Elasticsearch </li>\n<li><code>jvm.options</code>  Elasticsearch JVM </li>\n<li><code>log4j2.properties</code>  Elasticsearch </li>\n</ul>\n<p> <code>elasticsearch.yml</code>  Elasticsearch </p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">cluster.name:</span> <span class=\"string\">elasticsearch</span> <span class=\"comment\"># , elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">node.name:</span> <span class=\"string\">$&#123;HOSTNAME&#125;</span> <span class=\"comment\"># elasticsearch ,</span></span><br><span class=\"line\"><span class=\"attr\">path.data:</span> <span class=\"string\">[\"/es-data1\",</span> <span class=\"string\">\"es-data2\"</span><span class=\"string\">]</span> <span class=\"comment\"># , data ,,</span></span><br><span class=\"line\"><span class=\"attr\">path.logs:</span> <span class=\"string\">/var/log/elasticsearch</span> <span class=\"comment\"># ,, logs </span></span><br><span class=\"line\"><span class=\"attr\">network.host:</span> <span class=\"string\">\"0.0.0.0\"</span>  <span class=\"comment\"># elasticsearch , 127.0.0.1</span></span><br><span class=\"line\"><span class=\"attr\">http.port:</span> <span class=\"number\">9200</span> <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">discovery.send_hosts:</span> <span class=\"string\">[\"vm1:9300\",</span> <span class=\"string\">\"vm2:9300\"</span><span class=\"string\">,</span> <span class=\"string\">\"vm3:9300\"</span><span class=\"string\">]</span> <span class=\"comment\"># , 9300 </span></span><br><span class=\"line\"><span class=\"attr\">cluster.initial_master_nodes:</span> <span class=\"string\">[\"vm1:9200\",</span> <span class=\"string\">\"vm2:9200\"</span><span class=\"string\">,</span> <span class=\"string\">\"vm3:9200\"</span><span class=\"string\">]</span> <span class=\"comment\"># ,</span></span><br><span class=\"line\"><span class=\"attr\">xpack.security.enabled:</span> <span class=\"literal\">false</span> <span class=\"comment\">#  xpack-security </span></span><br></pre></td></tr></table></figure>\n\n<p> <code>jvm.options</code>  Elasticsearch JVM </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-Xms1g</span><br><span class=\"line\">-Xmx1g</span><br></pre></td></tr></table></figure>\n\n<p>,Elasticsearch JVM  1G .,:</p>\n<ul>\n<li></li>\n<li> <code>Xmx</code>  <code>Xms</code>  <code>50%</code></li>\n<li>,,, 32G</li>\n</ul>\n<h3 id=\"-Elasticsearch\"><a href=\"#-Elasticsearch\" class=\"headerlink\" title=\" Elasticsearch\"></a> Elasticsearch</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">bin/elasticsearch -d</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">-E &lt;KeyValuePair&gt;</span><br><span class=\"line\"><span class=\"comment\"># -Epath.data=data -Epath.logs=log</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>curl http://localhost:9200</code>  Elasticsearch </p>\n<h2 id=\"-Kibana\"><a href=\"#-Kibana\" class=\"headerlink\" title=\" Kibana\"></a> Kibana</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -O https://artifacts.elastic.co/downloads/kibana/kibana-7.7.0-linux-x86_64.tar.gz</span><br><span class=\"line\">tar -xzf kibana-7.7.0-linux-x86_64.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> kibana-7.7.0-linux-x86_64/</span><br><span class=\"line\">bin/kibana</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server.port:</span> <span class=\"number\">5601</span></span><br><span class=\"line\"><span class=\"attr\">server.host:</span> <span class=\"string\">\"192.168.2.3\"</span></span><br><span class=\"line\"><span class=\"comment\"># server.name: \"your-hostname\"</span></span><br><span class=\"line\"><span class=\"attr\">elasticsearch.url:</span> <span class=\"string\">\"http://localhost:9200\"</span></span><br><span class=\"line\"><span class=\"attr\">kibana.index:</span> <span class=\"string\">\".kibana\"</span></span><br><span class=\"line\"><span class=\"comment\"># xpack.security.enabled: false</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.username: \"user\"</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.password: \"pass\"</span></span><br><span class=\"line\"><span class=\"comment\"># server.ssl.enabled: false</span></span><br><span class=\"line\"><span class=\"comment\"># server.ssl.certificate: /path/to/your/server.crt</span></span><br><span class=\"line\"><span class=\"comment\"># server.ssl.key: /path/to/your/server.key</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.ssl.certificate: /path/to/your/client.crt</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.ssl.key: /path/to/your/client.key</span></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch.ssl.certificateAuthorities: [ \"/path/to/your/CA.pem\" ]</span></span><br></pre></td></tr></table></figure>\n\n<hr>\n<p></p>\n<ul>\n<li><a href=\"https://www.ibm.com/developerworks/cn/opensource/os-cn-elk-filebeat/index.html\" target=\"_blank\" rel=\"noopener\">ELK  Filebeat </a></li>\n</ul>\n"},{"title":"ELK  Logstash ","abbrlink":53890,"description":" ELK Logstash ,,.","_content":"\nLogstash , `input`, `filter`, `output`\n\nLogstash  `input > filter > output`., `filter` \n\n## `input` \n\n[`input`](https://www.elastic.co/guide/en/logstash/current/input-plugins.html)  Logstash .\n\n, Logstash ,.:\n\n | \n:---:| :---:\nadd_field | \nid |  input \ntags | \ntype | \n\n### `beats`\n\n[`beats`](https://www.elastic.co/guide/en/logstash/current/plugins-inputs-beats.html)  Beats \n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nport | Logstash |   | -\nhost | Logstash  |  | \"0.0.0.0\"\nssl |  ssl  |  | false\nssl_certificate | ssl  |  | \"\"\nssl_key | ssl  |  | \"\"\n\n> \n\n```ruby\ninput {\n  beats {\n    host => \"0.0.0.0\"\n    port => 5044\n    ssl => true\n    ssl_certificate => \"/path/to/ssl/cert\"\n    ssl_key => \"/path/to/ssl/key\"\n  }\n}\n```\n\n### `file`\n\n[`file`](https://www.elastic.co/guide/en/logstash/current/plugins-inputs-file.html) . sincedb , Logstash,, Logstash .\n\n- \n-  `tail` ( EOF) `read` (EOF)\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\npath |  |  | -\nclose_older | , |  | \"1 hour\"\ndelimiter |  |  | \"\\n\"\nexclude |  path , |  | []\nfile_chunk_count |  |  | 4611686018427387903\nfile_chunk_size |  |  | 32KB\nfile_completed_action |  EOF ,delete, log, log_and_delete |  | \"delete\"\nfile_completed_log_path |  EOF  |  | \"\"\nfile_sort_direction | ,asc,desc |  | \"asc\"\nignore_older |  |  | \"\"\nmode | , tail, read |  | \"tail\"\nsincedb_path |  sincedb , `<path.data>/plugins/inputs/file/` |  | \"\"\nstart_position | ,start, end |  | \"end\"\nstat_interval |  |  | \"1 second\"\n\n> \n\n-  `read` , \"*.gz\" \n\n```ruby\ninput {\n  file {\n    path => [\"/path/to/nginx-80-*.log\",\"/path/to/nginx-443-*.log\"]\n    exclude => \"*.gz\"\n    mode => \"read\"\n    file_sort_direction => \"desc\"\n    ignore_older => \"1d\"\n    start_position => \"beginning\"\n  }\n}\n```\n\n-  `tail` \n\n```ruby\ninput {\n  file {\n    path => [\"/path/to/nginx-80.log\",\"/path/to/nginx-443.log\"]\n    mode => \"tail\"\n    stat_interval => \"5 second\"\n    close_older => \"5\"\n    start_position => \"end\"\n  }\n}\n```\n\n### `redis`\n\n[`redis`](https://www.elastic.co/guide/en/logstash/current/plugins-inputs-redis.html)  Redis , Redis channels  lists.\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nhost | Redis  |  | \"127.0.0.1\"\nport | Redis  |  | 6379\npasswd | Redis  |  | \"\"\ndb | Redis  |  | 0\ndata_type |  Redis , list, channel, pattern_channel |  | -\nkey | Redis list  channel  |  | -\nbatch_count |  Redis  |  | 125\n\n> \n\n```ruby\ninput {\n  redis {\n    host => \"192.168.1.2\"\n    port => 6379\n    passwd => \"passwd\"\n    db => 0\n    data_type => \"list\"\n    key => \"logstash\"\n  }\n}\n```\n\n### `stdin`\n\n[`stdin`](https://www.elastic.co/guide/en/logstash/current/plugins-inputs-stdin.html) ,\n\n## `filter` \n\n[`filter`](https://www.elastic.co/guide/en/logstash/current/filter-plugins.html)  Logstash .\n\n, Logstash ,.\n\n | \n:---: | :---:\nadd_field | \nadd_tag | \nid |  filter \nremove_field | \nremove_tag | \n\n### `date`\n\n[`date`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-date.html) ,\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nmatch |  |  | []\ntag_on_failure |  |  | [\"_dateparsefailure\"]\ntarget |  |  | \"@timestamp\"\n\n> \n\n```ruby\nfilter {\n  date {\n    # log_time  dd/MMM/yyyy:HH:mm:ss Z \n    match => [\"log_time\",\"dd/MMM/yyyy:HH:mm:ss Z\"]\n    target => \"@log_time\"\n    tag_on_failure => [\"_dateparsefailure\"]\n  }\n}\n```\n\n### `drop`\n\n[`drop`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-drop.html) \n\n```ruby\nfilter {\n  if [loglevel] == \"debug\" {\n    drop { }\n  }\n}\n```\n\n### `geoip`\n\n[`geoip`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-geoip.html)  Maxmind GeoLite2  IP \n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\ndatabase |  Maxmind GeoLite2  |  | \"\"\nsource |  IP  |  | -\ntarget |  |  | \"geoip\"\nfields |  |  | []\ntag_on_failure |  |  | [\"_geoip_lookup_failure\"]\n\n> \n\n```ruby\nfilter {\n  geoip {\n    # remote_addr  IP ,\n    source => \"remote_addr\"\n    target => \"geoip\"\n    database => \"/home/elk/logstash-6.4.2/config/GeoLite2-City.mmdb\"\n    fields => [\"city_name\",\"country_name\",\"region_name\",\"location\"]\n    tag_on_failure => [\"_geoip_lookup_failure\"]\n  }\n}\n```\n\n### `grok`\n\n[`grok`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html) ,.\n\n`grok`  120 , [Github](https://github.com/logstash-plugins/logstash-patterns-core/tree/master/patterns)  `${LOGSTASH_HOME}/vendor/bundle/jruby/2.3.0/gems/logstash-patterns-core-4.1.2/patterns/` \n\n`grok`  `%{SYNTAX:SEMANTIC}`.`SYNTAX` ,.`SEMANTIC` ,,.\n\n, `PATTERN_NAME PATTERN` , `pattern_definitions` ., `pattern_dir`  `patterns_files_glob` .\n\n [http://grokdebug.herokuapp.com/](http://grokdebug.herokuapp.com/) .\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nmatch | , |  | {}\noverwrite |  |  | []\npattern_definitions |  |  | {}\npatterns_dir |  |  | []\npatterns_files_glob |  glob  patterns_dir  |  | \"*\"\ntag_on_failure |  |  | [\"_grokparsefailure\"]\ntag_on_timeout |  |  | \"_groktimeout\"\ntarget | , `geoip.target` |  | \"\"\nbreak_on_match | ,, false |  | true\n\n> \n\n```ruby\nfilter {\n  grok {\n    # \"message\"  nginx \n    match => {\n      \"message\" => \"\\[%{HTTPDATE:log_time}\\] - %{NUMBER:timestamp} - (%{IP_X:remote_addr}|-) - %{USER:remote_user} \\\"%{WORD:request_method} %{URIHOST:server_host}(%{URIPATH:request_uri}|-)(%{NOTSPACE:request_param})? HTTP\\/%{NUMBER:http_version}\\\" %{NUMBER:response_code} %{NUMBER:response_body_bytes} - %{DATA:ssl_protocol} %{NUMBER:request_time} - (%{HOSTPORT:upstream_addr}|-) (%{NUMBER:upstream_response_time}|-) %{GREEDYDATA:other}\"\n    }\n    remove_field => [ \"@version\", \"host\", \"path\", \"type\", \"message\", \"remote_user\", \"request_method\", \"http_version\", \"request_param\", \"ssl_protocol\", \"request_time\", \"upstream_addr\", \"upstream_response_time\", \"other\"]\n  }\n}\n```\n\n```text\n[19/May/2020:16:40:04 +0800] - 1589877604.781 - 42.236.82.156 - - \"GET reg.cntv.cn/ HTTP/1.1\" 302 0 - - 0.003 - 192.168.2.3:8082 0.003 - 100148273 - 1 - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36 \"-\"\n```\n\n### `json`\n\n[`json`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-json.html)  JSON  Logstash \n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nsource |  |  | -\ntarget |  |  | \"\"\ntag_on_failure |  |  | [\"_jsonparsefailure\"]\nskip_on_invalid_json |  JSON  |  | false\n\n> \n\n```ruby\nfilter {\n  json {\n    # \"message  json \n    source => \"message\"\n    skip_on_invalid_json => \"true\"\n    target => \"doc\"\n  }\n}\n```\n\n```text\n{\"method\":[\"user.getName\"],\"client\":[\"client\"],\"snap\":[\"120x120\"],\"userid\":[\"12345678\"]}\n\n\n{\n  \"doc\" => {\n    \"snap\" => [\n      [0] \"120x120\"\n    ],\n    \"client\" => [\n      [0] \"client\"\n    ],\n    \"userid\" => [\n      [0] \"12345678\"\n    ],\n    \"method\" => [\n      [0] \"user.getName\"\n    ]\n}\n```\n\n### `urldecode`\n\n[`urldecode`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-urldecode.html)  urlencoded \n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nfield |  |  | \"message\"\ncharset |  |  | \"UTF-8\"\ntag_on_failure |  |  | [\"_urldecodefailure\"]\nall_field |  |  | false\n\n> \n\n```ruby\nfilter {\n  urldecode {\n    # request_url \n    field => \"request_url\"\n    charset => \"UTF-8\"\n    tag_on_failure => [\"_urldecodefailure\"]\n  }\n}\n```\n\n```text\n\"client=6&data=%7B%22uid%22%3A73023332%2C%22vid%22%3A%2264d68733bd5343d2bc69334e804ce036%22%2C%22position%22%3A%220%22%7D&method=videoformobile.setVideoPosition\"\n\n\n\n\"client=6&data={\\\"uid\\\":73023332,\\\"vid\\\":\\\"64d68733bd5343d2bc69334e804ce036\\\",\\\"position\\\":\\\"0\\\"}&method=videoformobile.setVideoPosition\\\"\"\n```\n\n## `output` \n\n[`output`](https://www.elastic.co/guide/en/logstash/current/output-plugins.html),.\n\n, Logstash .:\n\n | \n:---: | :---:\ncodec | . \"rubydebug\", \"json\"\nid |  output \n\n### `elasticsearch`\n\n[`elasticsearch`](https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html)  Logstash  Elasticsearch.\n\n. `20MB`,.`20MB`,.\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nhosts |  Elasticsearch , |  | [\"127.0.0.1:9200\"]\nuser, password |  Elasticsearch  |  | \"\"\nindex |  |  | \"logstash-%{+yyyy.MM.dd}\"\naction | Elasticsearch ,index,delete,create,update |  | \"index\"\ndocument_id | , |  \"\"\nssl |  ssl |  | false\ncacert |  |  | \"\"\n\n### `mongodb`\n\n[`mongodb`](https://www.elastic.co/guide/en/logstash/current/plugins-outputs-mongodb.html)  MongoDB.\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nbulk |  |  | false\nbulk_interval |  |  | 2\nbulk_size |  |  | 900\ncollection |  MongoDB , |  | -\ndatabase |  MongoDB  |  | -\nuri |  MongoDB  |  | -\ngenerateId |  \"_id\"  MongoDB . true,, \"_id\"  |  | false\nretry_delay |  |  | 3\nisodate |  @timestamp  ISODate  MongoDB  |  | false\n\n### `redis`\n\n[`redis`](https://www.elastic.co/guide/en/logstash/current/plugins-outputs-redis.html)  Redis.\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nhost | Redis  |  | [\"127.0.0.1\"]\nport | Redis  |  | 6379\npasswd | Redis  |  | \"\"\ndb | Redis  |  | 0\ndata_type |  Redis , list, channel |  | \"\"\nkey | Redis list  channel , |  | \"\"\nbatch |  RPUSH  Redis list  |  | false\nbatch_events | RPUSH  Redis list  |  | 50\nbatch_timeout | RPUSH  |  | 5\nreconnect_interval |  |  | 1\ntimeout |  |  | 5\n\n> \n\n```ruby\n\n```\n\n### `stdout`\n\n[`stdout`](https://www.elastic.co/guide/en/logstash/current/plugins-outputs-stdout.html) ,.\n","source":"_posts/ELK-Stack-Logstash-plugins.md","raw":"---\ntitle: ELK  Logstash \ntags:\n  - ELK\n  - \ncategories:\n  - ELK\nabbrlink: 53890\ndescription: ' ELK Logstash ,,.'\n---\n\nLogstash , `input`, `filter`, `output`\n\nLogstash  `input > filter > output`., `filter` \n\n## `input` \n\n[`input`](https://www.elastic.co/guide/en/logstash/current/input-plugins.html)  Logstash .\n\n, Logstash ,.:\n\n | \n:---:| :---:\nadd_field | \nid |  input \ntags | \ntype | \n\n### `beats`\n\n[`beats`](https://www.elastic.co/guide/en/logstash/current/plugins-inputs-beats.html)  Beats \n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nport | Logstash |   | -\nhost | Logstash  |  | \"0.0.0.0\"\nssl |  ssl  |  | false\nssl_certificate | ssl  |  | \"\"\nssl_key | ssl  |  | \"\"\n\n> \n\n```ruby\ninput {\n  beats {\n    host => \"0.0.0.0\"\n    port => 5044\n    ssl => true\n    ssl_certificate => \"/path/to/ssl/cert\"\n    ssl_key => \"/path/to/ssl/key\"\n  }\n}\n```\n\n### `file`\n\n[`file`](https://www.elastic.co/guide/en/logstash/current/plugins-inputs-file.html) . sincedb , Logstash,, Logstash .\n\n- \n-  `tail` ( EOF) `read` (EOF)\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\npath |  |  | -\nclose_older | , |  | \"1 hour\"\ndelimiter |  |  | \"\\n\"\nexclude |  path , |  | []\nfile_chunk_count |  |  | 4611686018427387903\nfile_chunk_size |  |  | 32KB\nfile_completed_action |  EOF ,delete, log, log_and_delete |  | \"delete\"\nfile_completed_log_path |  EOF  |  | \"\"\nfile_sort_direction | ,asc,desc |  | \"asc\"\nignore_older |  |  | \"\"\nmode | , tail, read |  | \"tail\"\nsincedb_path |  sincedb , `<path.data>/plugins/inputs/file/` |  | \"\"\nstart_position | ,start, end |  | \"end\"\nstat_interval |  |  | \"1 second\"\n\n> \n\n-  `read` , \"*.gz\" \n\n```ruby\ninput {\n  file {\n    path => [\"/path/to/nginx-80-*.log\",\"/path/to/nginx-443-*.log\"]\n    exclude => \"*.gz\"\n    mode => \"read\"\n    file_sort_direction => \"desc\"\n    ignore_older => \"1d\"\n    start_position => \"beginning\"\n  }\n}\n```\n\n-  `tail` \n\n```ruby\ninput {\n  file {\n    path => [\"/path/to/nginx-80.log\",\"/path/to/nginx-443.log\"]\n    mode => \"tail\"\n    stat_interval => \"5 second\"\n    close_older => \"5\"\n    start_position => \"end\"\n  }\n}\n```\n\n### `redis`\n\n[`redis`](https://www.elastic.co/guide/en/logstash/current/plugins-inputs-redis.html)  Redis , Redis channels  lists.\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nhost | Redis  |  | \"127.0.0.1\"\nport | Redis  |  | 6379\npasswd | Redis  |  | \"\"\ndb | Redis  |  | 0\ndata_type |  Redis , list, channel, pattern_channel |  | -\nkey | Redis list  channel  |  | -\nbatch_count |  Redis  |  | 125\n\n> \n\n```ruby\ninput {\n  redis {\n    host => \"192.168.1.2\"\n    port => 6379\n    passwd => \"passwd\"\n    db => 0\n    data_type => \"list\"\n    key => \"logstash\"\n  }\n}\n```\n\n### `stdin`\n\n[`stdin`](https://www.elastic.co/guide/en/logstash/current/plugins-inputs-stdin.html) ,\n\n## `filter` \n\n[`filter`](https://www.elastic.co/guide/en/logstash/current/filter-plugins.html)  Logstash .\n\n, Logstash ,.\n\n | \n:---: | :---:\nadd_field | \nadd_tag | \nid |  filter \nremove_field | \nremove_tag | \n\n### `date`\n\n[`date`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-date.html) ,\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nmatch |  |  | []\ntag_on_failure |  |  | [\"_dateparsefailure\"]\ntarget |  |  | \"@timestamp\"\n\n> \n\n```ruby\nfilter {\n  date {\n    # log_time  dd/MMM/yyyy:HH:mm:ss Z \n    match => [\"log_time\",\"dd/MMM/yyyy:HH:mm:ss Z\"]\n    target => \"@log_time\"\n    tag_on_failure => [\"_dateparsefailure\"]\n  }\n}\n```\n\n### `drop`\n\n[`drop`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-drop.html) \n\n```ruby\nfilter {\n  if [loglevel] == \"debug\" {\n    drop { }\n  }\n}\n```\n\n### `geoip`\n\n[`geoip`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-geoip.html)  Maxmind GeoLite2  IP \n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\ndatabase |  Maxmind GeoLite2  |  | \"\"\nsource |  IP  |  | -\ntarget |  |  | \"geoip\"\nfields |  |  | []\ntag_on_failure |  |  | [\"_geoip_lookup_failure\"]\n\n> \n\n```ruby\nfilter {\n  geoip {\n    # remote_addr  IP ,\n    source => \"remote_addr\"\n    target => \"geoip\"\n    database => \"/home/elk/logstash-6.4.2/config/GeoLite2-City.mmdb\"\n    fields => [\"city_name\",\"country_name\",\"region_name\",\"location\"]\n    tag_on_failure => [\"_geoip_lookup_failure\"]\n  }\n}\n```\n\n### `grok`\n\n[`grok`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html) ,.\n\n`grok`  120 , [Github](https://github.com/logstash-plugins/logstash-patterns-core/tree/master/patterns)  `${LOGSTASH_HOME}/vendor/bundle/jruby/2.3.0/gems/logstash-patterns-core-4.1.2/patterns/` \n\n`grok`  `%{SYNTAX:SEMANTIC}`.`SYNTAX` ,.`SEMANTIC` ,,.\n\n, `PATTERN_NAME PATTERN` , `pattern_definitions` ., `pattern_dir`  `patterns_files_glob` .\n\n [http://grokdebug.herokuapp.com/](http://grokdebug.herokuapp.com/) .\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nmatch | , |  | {}\noverwrite |  |  | []\npattern_definitions |  |  | {}\npatterns_dir |  |  | []\npatterns_files_glob |  glob  patterns_dir  |  | \"*\"\ntag_on_failure |  |  | [\"_grokparsefailure\"]\ntag_on_timeout |  |  | \"_groktimeout\"\ntarget | , `geoip.target` |  | \"\"\nbreak_on_match | ,, false |  | true\n\n> \n\n```ruby\nfilter {\n  grok {\n    # \"message\"  nginx \n    match => {\n      \"message\" => \"\\[%{HTTPDATE:log_time}\\] - %{NUMBER:timestamp} - (%{IP_X:remote_addr}|-) - %{USER:remote_user} \\\"%{WORD:request_method} %{URIHOST:server_host}(%{URIPATH:request_uri}|-)(%{NOTSPACE:request_param})? HTTP\\/%{NUMBER:http_version}\\\" %{NUMBER:response_code} %{NUMBER:response_body_bytes} - %{DATA:ssl_protocol} %{NUMBER:request_time} - (%{HOSTPORT:upstream_addr}|-) (%{NUMBER:upstream_response_time}|-) %{GREEDYDATA:other}\"\n    }\n    remove_field => [ \"@version\", \"host\", \"path\", \"type\", \"message\", \"remote_user\", \"request_method\", \"http_version\", \"request_param\", \"ssl_protocol\", \"request_time\", \"upstream_addr\", \"upstream_response_time\", \"other\"]\n  }\n}\n```\n\n```text\n[19/May/2020:16:40:04 +0800] - 1589877604.781 - 42.236.82.156 - - \"GET reg.cntv.cn/ HTTP/1.1\" 302 0 - - 0.003 - 192.168.2.3:8082 0.003 - 100148273 - 1 - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36 \"-\"\n```\n\n### `json`\n\n[`json`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-json.html)  JSON  Logstash \n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nsource |  |  | -\ntarget |  |  | \"\"\ntag_on_failure |  |  | [\"_jsonparsefailure\"]\nskip_on_invalid_json |  JSON  |  | false\n\n> \n\n```ruby\nfilter {\n  json {\n    # \"message  json \n    source => \"message\"\n    skip_on_invalid_json => \"true\"\n    target => \"doc\"\n  }\n}\n```\n\n```text\n{\"method\":[\"user.getName\"],\"client\":[\"client\"],\"snap\":[\"120x120\"],\"userid\":[\"12345678\"]}\n\n\n{\n  \"doc\" => {\n    \"snap\" => [\n      [0] \"120x120\"\n    ],\n    \"client\" => [\n      [0] \"client\"\n    ],\n    \"userid\" => [\n      [0] \"12345678\"\n    ],\n    \"method\" => [\n      [0] \"user.getName\"\n    ]\n}\n```\n\n### `urldecode`\n\n[`urldecode`](https://www.elastic.co/guide/en/logstash/current/plugins-filters-urldecode.html)  urlencoded \n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nfield |  |  | \"message\"\ncharset |  |  | \"UTF-8\"\ntag_on_failure |  |  | [\"_urldecodefailure\"]\nall_field |  |  | false\n\n> \n\n```ruby\nfilter {\n  urldecode {\n    # request_url \n    field => \"request_url\"\n    charset => \"UTF-8\"\n    tag_on_failure => [\"_urldecodefailure\"]\n  }\n}\n```\n\n```text\n\"client=6&data=%7B%22uid%22%3A73023332%2C%22vid%22%3A%2264d68733bd5343d2bc69334e804ce036%22%2C%22position%22%3A%220%22%7D&method=videoformobile.setVideoPosition\"\n\n\n\n\"client=6&data={\\\"uid\\\":73023332,\\\"vid\\\":\\\"64d68733bd5343d2bc69334e804ce036\\\",\\\"position\\\":\\\"0\\\"}&method=videoformobile.setVideoPosition\\\"\"\n```\n\n## `output` \n\n[`output`](https://www.elastic.co/guide/en/logstash/current/output-plugins.html),.\n\n, Logstash .:\n\n | \n:---: | :---:\ncodec | . \"rubydebug\", \"json\"\nid |  output \n\n### `elasticsearch`\n\n[`elasticsearch`](https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html)  Logstash  Elasticsearch.\n\n. `20MB`,.`20MB`,.\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nhosts |  Elasticsearch , |  | [\"127.0.0.1:9200\"]\nuser, password |  Elasticsearch  |  | \"\"\nindex |  |  | \"logstash-%{+yyyy.MM.dd}\"\naction | Elasticsearch ,index,delete,create,update |  | \"index\"\ndocument_id | , |  \"\"\nssl |  ssl |  | false\ncacert |  |  | \"\"\n\n### `mongodb`\n\n[`mongodb`](https://www.elastic.co/guide/en/logstash/current/plugins-outputs-mongodb.html)  MongoDB.\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nbulk |  |  | false\nbulk_interval |  |  | 2\nbulk_size |  |  | 900\ncollection |  MongoDB , |  | -\ndatabase |  MongoDB  |  | -\nuri |  MongoDB  |  | -\ngenerateId |  \"_id\"  MongoDB . true,, \"_id\"  |  | false\nretry_delay |  |  | 3\nisodate |  @timestamp  ISODate  MongoDB  |  | false\n\n### `redis`\n\n[`redis`](https://www.elastic.co/guide/en/logstash/current/plugins-outputs-redis.html)  Redis.\n\n> \n\n |  |  | \n:---: | :---: | :---: | :---:\nhost | Redis  |  | [\"127.0.0.1\"]\nport | Redis  |  | 6379\npasswd | Redis  |  | \"\"\ndb | Redis  |  | 0\ndata_type |  Redis , list, channel |  | \"\"\nkey | Redis list  channel , |  | \"\"\nbatch |  RPUSH  Redis list  |  | false\nbatch_events | RPUSH  Redis list  |  | 50\nbatch_timeout | RPUSH  |  | 5\nreconnect_interval |  |  | 1\ntimeout |  |  | 5\n\n> \n\n```ruby\n\n```\n\n### `stdout`\n\n[`stdout`](https://www.elastic.co/guide/en/logstash/current/plugins-outputs-stdout.html) ,.\n","slug":"ELK-Stack-Logstash-plugins","published":1,"date":"2020-05-22T13:25:30.957Z","updated":"2020-05-23T00:53:55.374Z","_id":"ckai8moy50008gcu7fcg9h4yh","comments":1,"layout":"post","photos":[],"link":"","content":"<p>Logstash , <code>input</code>, <code>filter</code>, <code>output</code></p>\n<p>Logstash  <code>input &gt; filter &gt; output</code>., <code>filter</code> </p>\n<h2 id=\"input-\"><a href=\"#input-\" class=\"headerlink\" title=\"input \"></a><code>input</code> </h2><p><a href=\"https://www.elastic.co/guide/en/logstash/current/input-plugins.html\" target=\"_blank\" rel=\"noopener\"><code>input</code></a>  Logstash .</p>\n<p>, Logstash ,.:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">add_field</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">id</td>\n<td align=\"center\"> input </td>\n</tr>\n<tr>\n<td align=\"center\">tags</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">type</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"beats\"><a href=\"#beats\" class=\"headerlink\" title=\"beats\"></a><code>beats</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-inputs-beats.html\" target=\"_blank\" rel=\"noopener\"><code>beats</code></a>  Beats </p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">port</td>\n<td align=\"center\">Logstash </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">host</td>\n<td align=\"center\">Logstash </td>\n<td align=\"center\"></td>\n<td align=\"center\">0.0.0.0</td>\n</tr>\n<tr>\n<td align=\"center\">ssl</td>\n<td align=\"center\"> ssl </td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">ssl_certificate</td>\n<td align=\"center\">ssl </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">ssl_key</td>\n<td align=\"center\">ssl </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">  beats &#123;</span><br><span class=\"line\">    host =&gt; <span class=\"string\">\"0.0.0.0\"</span></span><br><span class=\"line\">    port =&gt; <span class=\"number\">5044</span></span><br><span class=\"line\">    ssl =&gt; <span class=\"literal\">true</span></span><br><span class=\"line\">    ssl_certificate =&gt; <span class=\"string\">\"/path/to/ssl/cert\"</span></span><br><span class=\"line\">    ssl_key =&gt; <span class=\"string\">\"/path/to/ssl/key\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"file\"><a href=\"#file\" class=\"headerlink\" title=\"file\"></a><code>file</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-inputs-file.html\" target=\"_blank\" rel=\"noopener\"><code>file</code></a> . sincedb , Logstash,, Logstash .</p>\n<ul>\n<li></li>\n<li> <code>tail</code> ( EOF) <code>read</code> (EOF)</li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">path</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">close_older</td>\n<td align=\"center\">,</td>\n<td align=\"center\"></td>\n<td align=\"center\">1 hour</td>\n</tr>\n<tr>\n<td align=\"center\">delimiter</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">\\n</td>\n</tr>\n<tr>\n<td align=\"center\">exclude</td>\n<td align=\"center\"> path ,</td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">file_chunk_count</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">4611686018427387903</td>\n</tr>\n<tr>\n<td align=\"center\">file_chunk_size</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">32KB</td>\n</tr>\n<tr>\n<td align=\"center\">file_completed_action</td>\n<td align=\"center\"> EOF ,delete, log, log_and_delete</td>\n<td align=\"center\"></td>\n<td align=\"center\">delete</td>\n</tr>\n<tr>\n<td align=\"center\">file_completed_log_path</td>\n<td align=\"center\"> EOF </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">file_sort_direction</td>\n<td align=\"center\">,asc,desc</td>\n<td align=\"center\"></td>\n<td align=\"center\">asc</td>\n</tr>\n<tr>\n<td align=\"center\">ignore_older</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">mode</td>\n<td align=\"center\">, tail, read</td>\n<td align=\"center\"></td>\n<td align=\"center\">tail</td>\n</tr>\n<tr>\n<td align=\"center\">sincedb_path</td>\n<td align=\"center\"> sincedb , <code>&lt;path.data&gt;/plugins/inputs/file/</code></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">start_position</td>\n<td align=\"center\">,start, end</td>\n<td align=\"center\"></td>\n<td align=\"center\">end</td>\n</tr>\n<tr>\n<td align=\"center\">stat_interval</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">1 second</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li> <code>read</code> , *.gz </li>\n</ul>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">  file &#123;</span><br><span class=\"line\">    path =&gt; [<span class=\"string\">\"/path/to/nginx-80-*.log\"</span>,<span class=\"string\">\"/path/to/nginx-443-*.log\"</span>]</span><br><span class=\"line\">    exclude =&gt; <span class=\"string\">\"*.gz\"</span></span><br><span class=\"line\">    mode =&gt; <span class=\"string\">\"read\"</span></span><br><span class=\"line\">    file_sort_direction =&gt; <span class=\"string\">\"desc\"</span></span><br><span class=\"line\">    ignore_older =&gt; <span class=\"string\">\"1d\"</span></span><br><span class=\"line\">    start_position =&gt; <span class=\"string\">\"beginning\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> <code>tail</code> </li>\n</ul>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">  file &#123;</span><br><span class=\"line\">    path =&gt; [<span class=\"string\">\"/path/to/nginx-80.log\"</span>,<span class=\"string\">\"/path/to/nginx-443.log\"</span>]</span><br><span class=\"line\">    mode =&gt; <span class=\"string\">\"tail\"</span></span><br><span class=\"line\">    stat_interval =&gt; <span class=\"string\">\"5 second\"</span></span><br><span class=\"line\">    close_older =&gt; <span class=\"string\">\"5\"</span></span><br><span class=\"line\">    start_position =&gt; <span class=\"string\">\"end\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a><code>redis</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-inputs-redis.html\" target=\"_blank\" rel=\"noopener\"><code>redis</code></a>  Redis , Redis channels  lists.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">host</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">127.0.0.1</td>\n</tr>\n<tr>\n<td align=\"center\">port</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">6379</td>\n</tr>\n<tr>\n<td align=\"center\">passwd</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">db</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">data_type</td>\n<td align=\"center\"> Redis , list, channel, pattern_channel</td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">key</td>\n<td align=\"center\">Redis list  channel </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">batch_count</td>\n<td align=\"center\"> Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">125</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">  redis &#123;</span><br><span class=\"line\">    host =&gt; <span class=\"string\">\"192.168.1.2\"</span></span><br><span class=\"line\">    port =&gt; <span class=\"number\">6379</span></span><br><span class=\"line\">    passwd =&gt; <span class=\"string\">\"passwd\"</span></span><br><span class=\"line\">    db =&gt; <span class=\"number\">0</span></span><br><span class=\"line\">    data_type =&gt; <span class=\"string\">\"list\"</span></span><br><span class=\"line\">    key =&gt; <span class=\"string\">\"logstash\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"stdin\"><a href=\"#stdin\" class=\"headerlink\" title=\"stdin\"></a><code>stdin</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-inputs-stdin.html\" target=\"_blank\" rel=\"noopener\"><code>stdin</code></a> ,</p>\n<h2 id=\"filter-\"><a href=\"#filter-\" class=\"headerlink\" title=\"filter \"></a><code>filter</code> </h2><p><a href=\"https://www.elastic.co/guide/en/logstash/current/filter-plugins.html\" target=\"_blank\" rel=\"noopener\"><code>filter</code></a>  Logstash .</p>\n<p>, Logstash ,.</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">add_field</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">add_tag</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">id</td>\n<td align=\"center\"> filter </td>\n</tr>\n<tr>\n<td align=\"center\">remove_field</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">remove_tag</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"date\"><a href=\"#date\" class=\"headerlink\" title=\"date\"></a><code>date</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-date.html\" target=\"_blank\" rel=\"noopener\"><code>date</code></a> ,</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">match</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_dateparsefailure]</td>\n</tr>\n<tr>\n<td align=\"center\">target</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">@timestamp</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  date &#123;</span><br><span class=\"line\">    <span class=\"comment\"># log_time  dd/MMM/yyyy:HH:mm:ss Z </span></span><br><span class=\"line\">    match =&gt; [<span class=\"string\">\"log_time\"</span>,<span class=\"string\">\"dd/MMM/yyyy:HH:mm:ss Z\"</span>]</span><br><span class=\"line\">    target =&gt; <span class=\"string\">\"@log_time\"</span></span><br><span class=\"line\">    tag_on_failure =&gt; [<span class=\"string\">\"_dateparsefailure\"</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"drop\"><a href=\"#drop\" class=\"headerlink\" title=\"drop\"></a><code>drop</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-drop.html\" target=\"_blank\" rel=\"noopener\"><code>drop</code></a> </p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> [loglevel] == <span class=\"string\">\"debug\"</span> &#123;</span><br><span class=\"line\">    drop &#123; &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"geoip\"><a href=\"#geoip\" class=\"headerlink\" title=\"geoip\"></a><code>geoip</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-geoip.html\" target=\"_blank\" rel=\"noopener\"><code>geoip</code></a>  Maxmind GeoLite2  IP </p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">database</td>\n<td align=\"center\"> Maxmind GeoLite2 </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">source</td>\n<td align=\"center\"> IP </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">target</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">geoip</td>\n</tr>\n<tr>\n<td align=\"center\">fields</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_geoip_lookup_failure]</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  geoip &#123;</span><br><span class=\"line\">    <span class=\"comment\"># remote_addr  IP ,</span></span><br><span class=\"line\">    source =&gt; <span class=\"string\">\"remote_addr\"</span></span><br><span class=\"line\">    target =&gt; <span class=\"string\">\"geoip\"</span></span><br><span class=\"line\">    database =&gt; <span class=\"string\">\"/home/elk/logstash-6.4.2/config/GeoLite2-City.mmdb\"</span></span><br><span class=\"line\">    fields =&gt; [<span class=\"string\">\"city_name\"</span>,<span class=\"string\">\"country_name\"</span>,<span class=\"string\">\"region_name\"</span>,<span class=\"string\">\"location\"</span>]</span><br><span class=\"line\">    tag_on_failure =&gt; [<span class=\"string\">\"_geoip_lookup_failure\"</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"grok\"><a href=\"#grok\" class=\"headerlink\" title=\"grok\"></a><code>grok</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html\" target=\"_blank\" rel=\"noopener\"><code>grok</code></a> ,.</p>\n<p><code>grok</code>  120 , <a href=\"https://github.com/logstash-plugins/logstash-patterns-core/tree/master/patterns\" target=\"_blank\" rel=\"noopener\">Github</a>  <code>${LOGSTASH_HOME}/vendor/bundle/jruby/2.3.0/gems/logstash-patterns-core-4.1.2/patterns/</code> </p>\n<p><code>grok</code>  <code>%{SYNTAX:SEMANTIC}</code>.<code>SYNTAX</code> ,.<code>SEMANTIC</code> ,,.</p>\n<p>, <code>PATTERN_NAME PATTERN</code> , <code>pattern_definitions</code> ., <code>pattern_dir</code>  <code>patterns_files_glob</code> .</p>\n<p> <a href=\"http://grokdebug.herokuapp.com/\" target=\"_blank\" rel=\"noopener\">http://grokdebug.herokuapp.com/</a> .</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">match</td>\n<td align=\"center\">,</td>\n<td align=\"center\"></td>\n<td align=\"center\">{}</td>\n</tr>\n<tr>\n<td align=\"center\">overwrite</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">pattern_definitions</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">{}</td>\n</tr>\n<tr>\n<td align=\"center\">patterns_dir</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">patterns_files_glob</td>\n<td align=\"center\"> glob  patterns_dir </td>\n<td align=\"center\"></td>\n<td align=\"center\">*</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_grokparsefailure]</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_timeout</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">_groktimeout</td>\n</tr>\n<tr>\n<td align=\"center\">target</td>\n<td align=\"center\">, <code>geoip.target</code></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">break_on_match</td>\n<td align=\"center\">,, false</td>\n<td align=\"center\"></td>\n<td align=\"center\">true</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  grok &#123;</span><br><span class=\"line\">    <span class=\"comment\"># \"message\"  nginx </span></span><br><span class=\"line\">    match =&gt; &#123;</span><br><span class=\"line\">      <span class=\"string\">\"message\"</span> =&gt; <span class=\"string\">\"\\[%&#123;HTTPDATE:log_time&#125;\\] - %&#123;NUMBER:timestamp&#125; - (%&#123;IP_X:remote_addr&#125;|-) - %&#123;USER:remote_user&#125; \\\"%&#123;WORD:request_method&#125; %&#123;URIHOST:server_host&#125;(%&#123;URIPATH:request_uri&#125;|-)(%&#123;NOTSPACE:request_param&#125;)? HTTP\\/%&#123;NUMBER:http_version&#125;\\\" %&#123;NUMBER:response_code&#125; %&#123;NUMBER:response_body_bytes&#125; - %&#123;DATA:ssl_protocol&#125; %&#123;NUMBER:request_time&#125; - (%&#123;HOSTPORT:upstream_addr&#125;|-) (%&#123;NUMBER:upstream_response_time&#125;|-) %&#123;GREEDYDATA:other&#125;\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    remove_field =&gt; [ <span class=\"string\">\"@version\"</span>, <span class=\"string\">\"host\"</span>, <span class=\"string\">\"path\"</span>, <span class=\"string\">\"type\"</span>, <span class=\"string\">\"message\"</span>, <span class=\"string\">\"remote_user\"</span>, <span class=\"string\">\"request_method\"</span>, <span class=\"string\">\"http_version\"</span>, <span class=\"string\">\"request_param\"</span>, <span class=\"string\">\"ssl_protocol\"</span>, <span class=\"string\">\"request_time\"</span>, <span class=\"string\">\"upstream_addr\"</span>, <span class=\"string\">\"upstream_response_time\"</span>, <span class=\"string\">\"other\"</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[19&#x2F;May&#x2F;2020:16:40:04 +0800] - 1589877604.781 - 42.236.82.156 - - &quot;GET reg.cntv.cn&#x2F; HTTP&#x2F;1.1&quot; 302 0 - - 0.003 - 192.168.2.3:8082 0.003 - 100148273 - 1 - Mozilla&#x2F;5.0 (Windows NT 6.1; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;46.0.2490.86 Safari&#x2F;537.36 &quot;-&quot;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"json\"><a href=\"#json\" class=\"headerlink\" title=\"json\"></a><code>json</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-json.html\" target=\"_blank\" rel=\"noopener\"><code>json</code></a>  JSON  Logstash </p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">source</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">target</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_jsonparsefailure]</td>\n</tr>\n<tr>\n<td align=\"center\">skip_on_invalid_json</td>\n<td align=\"center\"> JSON</td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  json &#123;</span><br><span class=\"line\">    <span class=\"comment\"># \"message  json </span></span><br><span class=\"line\">    source =&gt; <span class=\"string\">\"message\"</span></span><br><span class=\"line\">    skip_on_invalid_json =&gt; <span class=\"string\">\"true\"</span></span><br><span class=\"line\">    target =&gt; <span class=\"string\">\"doc\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&quot;method&quot;:[&quot;user.getName&quot;],&quot;client&quot;:[&quot;client&quot;],&quot;snap&quot;:[&quot;120x120&quot;],&quot;userid&quot;:[&quot;12345678&quot;]&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;doc&quot; &#x3D;&gt; &#123;</span><br><span class=\"line\">    &quot;snap&quot; &#x3D;&gt; [</span><br><span class=\"line\">      [0] &quot;120x120&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;client&quot; &#x3D;&gt; [</span><br><span class=\"line\">      [0] &quot;client&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;userid&quot; &#x3D;&gt; [</span><br><span class=\"line\">      [0] &quot;12345678&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;method&quot; &#x3D;&gt; [</span><br><span class=\"line\">      [0] &quot;user.getName&quot;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"urldecode\"><a href=\"#urldecode\" class=\"headerlink\" title=\"urldecode\"></a><code>urldecode</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-urldecode.html\" target=\"_blank\" rel=\"noopener\"><code>urldecode</code></a>  urlencoded </p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">field</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">message</td>\n</tr>\n<tr>\n<td align=\"center\">charset</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">UTF-8</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_urldecodefailure]</td>\n</tr>\n<tr>\n<td align=\"center\">all_field</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  urldecode &#123;</span><br><span class=\"line\">    <span class=\"comment\"># request_url </span></span><br><span class=\"line\">    field =&gt; <span class=\"string\">\"request_url\"</span></span><br><span class=\"line\">    charset =&gt; <span class=\"string\">\"UTF-8\"</span></span><br><span class=\"line\">    tag_on_failure =&gt; [<span class=\"string\">\"_urldecodefailure\"</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;client&#x3D;6&amp;data&#x3D;%7B%22uid%22%3A73023332%2C%22vid%22%3A%2264d68733bd5343d2bc69334e804ce036%22%2C%22position%22%3A%220%22%7D&amp;method&#x3D;videoformobile.setVideoPosition&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&quot;client&#x3D;6&amp;data&#x3D;&#123;\\&quot;uid\\&quot;:73023332,\\&quot;vid\\&quot;:\\&quot;64d68733bd5343d2bc69334e804ce036\\&quot;,\\&quot;position\\&quot;:\\&quot;0\\&quot;&#125;&amp;method&#x3D;videoformobile.setVideoPosition\\&quot;&quot;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"output-\"><a href=\"#output-\" class=\"headerlink\" title=\"output \"></a><code>output</code> </h2><p><a href=\"https://www.elastic.co/guide/en/logstash/current/output-plugins.html\" target=\"_blank\" rel=\"noopener\"><code>output</code></a>,.</p>\n<p>, Logstash .:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">codec</td>\n<td align=\"center\">. rubydebug, json</td>\n</tr>\n<tr>\n<td align=\"center\">id</td>\n<td align=\"center\"> output </td>\n</tr>\n</tbody></table>\n<h3 id=\"elasticsearch\"><a href=\"#elasticsearch\" class=\"headerlink\" title=\"elasticsearch\"></a><code>elasticsearch</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html\" target=\"_blank\" rel=\"noopener\"><code>elasticsearch</code></a>  Logstash  Elasticsearch.</p>\n<p>. <code>20MB</code>,.<code>20MB</code>,.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">hosts</td>\n<td align=\"center\"> Elasticsearch ,</td>\n<td align=\"center\"></td>\n<td align=\"center\">[127.0.0.1:9200]</td>\n</tr>\n<tr>\n<td align=\"center\">user, password</td>\n<td align=\"center\"> Elasticsearch </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">index</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">logstash-%{+yyyy.MM.dd}</td>\n</tr>\n<tr>\n<td align=\"center\">action</td>\n<td align=\"center\">Elasticsearch ,index,delete,create,update</td>\n<td align=\"center\"></td>\n<td align=\"center\">index</td>\n</tr>\n<tr>\n<td align=\"center\">document_id</td>\n<td align=\"center\">,</td>\n<td align=\"center\"> </td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">ssl</td>\n<td align=\"center\"> ssl</td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">cacert</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"mongodb\"><a href=\"#mongodb\" class=\"headerlink\" title=\"mongodb\"></a><code>mongodb</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-outputs-mongodb.html\" target=\"_blank\" rel=\"noopener\"><code>mongodb</code></a>  MongoDB.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">bulk</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">bulk_interval</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">2</td>\n</tr>\n<tr>\n<td align=\"center\">bulk_size</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">900</td>\n</tr>\n<tr>\n<td align=\"center\">collection</td>\n<td align=\"center\"> MongoDB ,</td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">database</td>\n<td align=\"center\"> MongoDB </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">uri</td>\n<td align=\"center\"> MongoDB </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">generateId</td>\n<td align=\"center\"> _id  MongoDB . true,, _id </td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">retry_delay</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">3</td>\n</tr>\n<tr>\n<td align=\"center\">isodate</td>\n<td align=\"center\"> @timestamp  ISODate  MongoDB </td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n</tbody></table>\n<h3 id=\"redis-1\"><a href=\"#redis-1\" class=\"headerlink\" title=\"redis\"></a><code>redis</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-outputs-redis.html\" target=\"_blank\" rel=\"noopener\"><code>redis</code></a>  Redis.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">host</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">[127.0.0.1]</td>\n</tr>\n<tr>\n<td align=\"center\">port</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">6379</td>\n</tr>\n<tr>\n<td align=\"center\">passwd</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">db</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">data_type</td>\n<td align=\"center\"> Redis , list, channel</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">key</td>\n<td align=\"center\">Redis list  channel ,</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">batch</td>\n<td align=\"center\"> RPUSH  Redis list </td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">batch_events</td>\n<td align=\"center\">RPUSH  Redis list </td>\n<td align=\"center\"></td>\n<td align=\"center\">50</td>\n</tr>\n<tr>\n<td align=\"center\">batch_timeout</td>\n<td align=\"center\">RPUSH </td>\n<td align=\"center\"></td>\n<td align=\"center\">5</td>\n</tr>\n<tr>\n<td align=\"center\">reconnect_interval</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">timeout</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">5</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"stdout\"><a href=\"#stdout\" class=\"headerlink\" title=\"stdout\"></a><code>stdout</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-outputs-stdout.html\" target=\"_blank\" rel=\"noopener\"><code>stdout</code></a> ,.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Logstash , <code>input</code>, <code>filter</code>, <code>output</code></p>\n<p>Logstash  <code>input &gt; filter &gt; output</code>., <code>filter</code> </p>\n<h2 id=\"input-\"><a href=\"#input-\" class=\"headerlink\" title=\"input \"></a><code>input</code> </h2><p><a href=\"https://www.elastic.co/guide/en/logstash/current/input-plugins.html\" target=\"_blank\" rel=\"noopener\"><code>input</code></a>  Logstash .</p>\n<p>, Logstash ,.:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">add_field</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">id</td>\n<td align=\"center\"> input </td>\n</tr>\n<tr>\n<td align=\"center\">tags</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">type</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"beats\"><a href=\"#beats\" class=\"headerlink\" title=\"beats\"></a><code>beats</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-inputs-beats.html\" target=\"_blank\" rel=\"noopener\"><code>beats</code></a>  Beats </p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">port</td>\n<td align=\"center\">Logstash </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">host</td>\n<td align=\"center\">Logstash </td>\n<td align=\"center\"></td>\n<td align=\"center\">0.0.0.0</td>\n</tr>\n<tr>\n<td align=\"center\">ssl</td>\n<td align=\"center\"> ssl </td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">ssl_certificate</td>\n<td align=\"center\">ssl </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">ssl_key</td>\n<td align=\"center\">ssl </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">  beats &#123;</span><br><span class=\"line\">    host =&gt; <span class=\"string\">\"0.0.0.0\"</span></span><br><span class=\"line\">    port =&gt; <span class=\"number\">5044</span></span><br><span class=\"line\">    ssl =&gt; <span class=\"literal\">true</span></span><br><span class=\"line\">    ssl_certificate =&gt; <span class=\"string\">\"/path/to/ssl/cert\"</span></span><br><span class=\"line\">    ssl_key =&gt; <span class=\"string\">\"/path/to/ssl/key\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"file\"><a href=\"#file\" class=\"headerlink\" title=\"file\"></a><code>file</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-inputs-file.html\" target=\"_blank\" rel=\"noopener\"><code>file</code></a> . sincedb , Logstash,, Logstash .</p>\n<ul>\n<li></li>\n<li> <code>tail</code> ( EOF) <code>read</code> (EOF)</li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">path</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">close_older</td>\n<td align=\"center\">,</td>\n<td align=\"center\"></td>\n<td align=\"center\">1 hour</td>\n</tr>\n<tr>\n<td align=\"center\">delimiter</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">\\n</td>\n</tr>\n<tr>\n<td align=\"center\">exclude</td>\n<td align=\"center\"> path ,</td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">file_chunk_count</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">4611686018427387903</td>\n</tr>\n<tr>\n<td align=\"center\">file_chunk_size</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">32KB</td>\n</tr>\n<tr>\n<td align=\"center\">file_completed_action</td>\n<td align=\"center\"> EOF ,delete, log, log_and_delete</td>\n<td align=\"center\"></td>\n<td align=\"center\">delete</td>\n</tr>\n<tr>\n<td align=\"center\">file_completed_log_path</td>\n<td align=\"center\"> EOF </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">file_sort_direction</td>\n<td align=\"center\">,asc,desc</td>\n<td align=\"center\"></td>\n<td align=\"center\">asc</td>\n</tr>\n<tr>\n<td align=\"center\">ignore_older</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">mode</td>\n<td align=\"center\">, tail, read</td>\n<td align=\"center\"></td>\n<td align=\"center\">tail</td>\n</tr>\n<tr>\n<td align=\"center\">sincedb_path</td>\n<td align=\"center\"> sincedb , <code>&lt;path.data&gt;/plugins/inputs/file/</code></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">start_position</td>\n<td align=\"center\">,start, end</td>\n<td align=\"center\"></td>\n<td align=\"center\">end</td>\n</tr>\n<tr>\n<td align=\"center\">stat_interval</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">1 second</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li> <code>read</code> , *.gz </li>\n</ul>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">  file &#123;</span><br><span class=\"line\">    path =&gt; [<span class=\"string\">\"/path/to/nginx-80-*.log\"</span>,<span class=\"string\">\"/path/to/nginx-443-*.log\"</span>]</span><br><span class=\"line\">    exclude =&gt; <span class=\"string\">\"*.gz\"</span></span><br><span class=\"line\">    mode =&gt; <span class=\"string\">\"read\"</span></span><br><span class=\"line\">    file_sort_direction =&gt; <span class=\"string\">\"desc\"</span></span><br><span class=\"line\">    ignore_older =&gt; <span class=\"string\">\"1d\"</span></span><br><span class=\"line\">    start_position =&gt; <span class=\"string\">\"beginning\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> <code>tail</code> </li>\n</ul>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">  file &#123;</span><br><span class=\"line\">    path =&gt; [<span class=\"string\">\"/path/to/nginx-80.log\"</span>,<span class=\"string\">\"/path/to/nginx-443.log\"</span>]</span><br><span class=\"line\">    mode =&gt; <span class=\"string\">\"tail\"</span></span><br><span class=\"line\">    stat_interval =&gt; <span class=\"string\">\"5 second\"</span></span><br><span class=\"line\">    close_older =&gt; <span class=\"string\">\"5\"</span></span><br><span class=\"line\">    start_position =&gt; <span class=\"string\">\"end\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a><code>redis</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-inputs-redis.html\" target=\"_blank\" rel=\"noopener\"><code>redis</code></a>  Redis , Redis channels  lists.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">host</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">127.0.0.1</td>\n</tr>\n<tr>\n<td align=\"center\">port</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">6379</td>\n</tr>\n<tr>\n<td align=\"center\">passwd</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">db</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">data_type</td>\n<td align=\"center\"> Redis , list, channel, pattern_channel</td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">key</td>\n<td align=\"center\">Redis list  channel </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">batch_count</td>\n<td align=\"center\"> Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">125</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">  redis &#123;</span><br><span class=\"line\">    host =&gt; <span class=\"string\">\"192.168.1.2\"</span></span><br><span class=\"line\">    port =&gt; <span class=\"number\">6379</span></span><br><span class=\"line\">    passwd =&gt; <span class=\"string\">\"passwd\"</span></span><br><span class=\"line\">    db =&gt; <span class=\"number\">0</span></span><br><span class=\"line\">    data_type =&gt; <span class=\"string\">\"list\"</span></span><br><span class=\"line\">    key =&gt; <span class=\"string\">\"logstash\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"stdin\"><a href=\"#stdin\" class=\"headerlink\" title=\"stdin\"></a><code>stdin</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-inputs-stdin.html\" target=\"_blank\" rel=\"noopener\"><code>stdin</code></a> ,</p>\n<h2 id=\"filter-\"><a href=\"#filter-\" class=\"headerlink\" title=\"filter \"></a><code>filter</code> </h2><p><a href=\"https://www.elastic.co/guide/en/logstash/current/filter-plugins.html\" target=\"_blank\" rel=\"noopener\"><code>filter</code></a>  Logstash .</p>\n<p>, Logstash ,.</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">add_field</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">add_tag</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">id</td>\n<td align=\"center\"> filter </td>\n</tr>\n<tr>\n<td align=\"center\">remove_field</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">remove_tag</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"date\"><a href=\"#date\" class=\"headerlink\" title=\"date\"></a><code>date</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-date.html\" target=\"_blank\" rel=\"noopener\"><code>date</code></a> ,</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">match</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_dateparsefailure]</td>\n</tr>\n<tr>\n<td align=\"center\">target</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">@timestamp</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  date &#123;</span><br><span class=\"line\">    <span class=\"comment\"># log_time  dd/MMM/yyyy:HH:mm:ss Z </span></span><br><span class=\"line\">    match =&gt; [<span class=\"string\">\"log_time\"</span>,<span class=\"string\">\"dd/MMM/yyyy:HH:mm:ss Z\"</span>]</span><br><span class=\"line\">    target =&gt; <span class=\"string\">\"@log_time\"</span></span><br><span class=\"line\">    tag_on_failure =&gt; [<span class=\"string\">\"_dateparsefailure\"</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"drop\"><a href=\"#drop\" class=\"headerlink\" title=\"drop\"></a><code>drop</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-drop.html\" target=\"_blank\" rel=\"noopener\"><code>drop</code></a> </p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> [loglevel] == <span class=\"string\">\"debug\"</span> &#123;</span><br><span class=\"line\">    drop &#123; &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"geoip\"><a href=\"#geoip\" class=\"headerlink\" title=\"geoip\"></a><code>geoip</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-geoip.html\" target=\"_blank\" rel=\"noopener\"><code>geoip</code></a>  Maxmind GeoLite2  IP </p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">database</td>\n<td align=\"center\"> Maxmind GeoLite2 </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">source</td>\n<td align=\"center\"> IP </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">target</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">geoip</td>\n</tr>\n<tr>\n<td align=\"center\">fields</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_geoip_lookup_failure]</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  geoip &#123;</span><br><span class=\"line\">    <span class=\"comment\"># remote_addr  IP ,</span></span><br><span class=\"line\">    source =&gt; <span class=\"string\">\"remote_addr\"</span></span><br><span class=\"line\">    target =&gt; <span class=\"string\">\"geoip\"</span></span><br><span class=\"line\">    database =&gt; <span class=\"string\">\"/home/elk/logstash-6.4.2/config/GeoLite2-City.mmdb\"</span></span><br><span class=\"line\">    fields =&gt; [<span class=\"string\">\"city_name\"</span>,<span class=\"string\">\"country_name\"</span>,<span class=\"string\">\"region_name\"</span>,<span class=\"string\">\"location\"</span>]</span><br><span class=\"line\">    tag_on_failure =&gt; [<span class=\"string\">\"_geoip_lookup_failure\"</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"grok\"><a href=\"#grok\" class=\"headerlink\" title=\"grok\"></a><code>grok</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html\" target=\"_blank\" rel=\"noopener\"><code>grok</code></a> ,.</p>\n<p><code>grok</code>  120 , <a href=\"https://github.com/logstash-plugins/logstash-patterns-core/tree/master/patterns\" target=\"_blank\" rel=\"noopener\">Github</a>  <code>${LOGSTASH_HOME}/vendor/bundle/jruby/2.3.0/gems/logstash-patterns-core-4.1.2/patterns/</code> </p>\n<p><code>grok</code>  <code>%{SYNTAX:SEMANTIC}</code>.<code>SYNTAX</code> ,.<code>SEMANTIC</code> ,,.</p>\n<p>, <code>PATTERN_NAME PATTERN</code> , <code>pattern_definitions</code> ., <code>pattern_dir</code>  <code>patterns_files_glob</code> .</p>\n<p> <a href=\"http://grokdebug.herokuapp.com/\" target=\"_blank\" rel=\"noopener\">http://grokdebug.herokuapp.com/</a> .</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">match</td>\n<td align=\"center\">,</td>\n<td align=\"center\"></td>\n<td align=\"center\">{}</td>\n</tr>\n<tr>\n<td align=\"center\">overwrite</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">pattern_definitions</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">{}</td>\n</tr>\n<tr>\n<td align=\"center\">patterns_dir</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[]</td>\n</tr>\n<tr>\n<td align=\"center\">patterns_files_glob</td>\n<td align=\"center\"> glob  patterns_dir </td>\n<td align=\"center\"></td>\n<td align=\"center\">*</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_grokparsefailure]</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_timeout</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">_groktimeout</td>\n</tr>\n<tr>\n<td align=\"center\">target</td>\n<td align=\"center\">, <code>geoip.target</code></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">break_on_match</td>\n<td align=\"center\">,, false</td>\n<td align=\"center\"></td>\n<td align=\"center\">true</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  grok &#123;</span><br><span class=\"line\">    <span class=\"comment\"># \"message\"  nginx </span></span><br><span class=\"line\">    match =&gt; &#123;</span><br><span class=\"line\">      <span class=\"string\">\"message\"</span> =&gt; <span class=\"string\">\"\\[%&#123;HTTPDATE:log_time&#125;\\] - %&#123;NUMBER:timestamp&#125; - (%&#123;IP_X:remote_addr&#125;|-) - %&#123;USER:remote_user&#125; \\\"%&#123;WORD:request_method&#125; %&#123;URIHOST:server_host&#125;(%&#123;URIPATH:request_uri&#125;|-)(%&#123;NOTSPACE:request_param&#125;)? HTTP\\/%&#123;NUMBER:http_version&#125;\\\" %&#123;NUMBER:response_code&#125; %&#123;NUMBER:response_body_bytes&#125; - %&#123;DATA:ssl_protocol&#125; %&#123;NUMBER:request_time&#125; - (%&#123;HOSTPORT:upstream_addr&#125;|-) (%&#123;NUMBER:upstream_response_time&#125;|-) %&#123;GREEDYDATA:other&#125;\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    remove_field =&gt; [ <span class=\"string\">\"@version\"</span>, <span class=\"string\">\"host\"</span>, <span class=\"string\">\"path\"</span>, <span class=\"string\">\"type\"</span>, <span class=\"string\">\"message\"</span>, <span class=\"string\">\"remote_user\"</span>, <span class=\"string\">\"request_method\"</span>, <span class=\"string\">\"http_version\"</span>, <span class=\"string\">\"request_param\"</span>, <span class=\"string\">\"ssl_protocol\"</span>, <span class=\"string\">\"request_time\"</span>, <span class=\"string\">\"upstream_addr\"</span>, <span class=\"string\">\"upstream_response_time\"</span>, <span class=\"string\">\"other\"</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[19&#x2F;May&#x2F;2020:16:40:04 +0800] - 1589877604.781 - 42.236.82.156 - - &quot;GET reg.cntv.cn&#x2F; HTTP&#x2F;1.1&quot; 302 0 - - 0.003 - 192.168.2.3:8082 0.003 - 100148273 - 1 - Mozilla&#x2F;5.0 (Windows NT 6.1; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;46.0.2490.86 Safari&#x2F;537.36 &quot;-&quot;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"json\"><a href=\"#json\" class=\"headerlink\" title=\"json\"></a><code>json</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-json.html\" target=\"_blank\" rel=\"noopener\"><code>json</code></a>  JSON  Logstash </p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">source</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">target</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_jsonparsefailure]</td>\n</tr>\n<tr>\n<td align=\"center\">skip_on_invalid_json</td>\n<td align=\"center\"> JSON</td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  json &#123;</span><br><span class=\"line\">    <span class=\"comment\"># \"message  json </span></span><br><span class=\"line\">    source =&gt; <span class=\"string\">\"message\"</span></span><br><span class=\"line\">    skip_on_invalid_json =&gt; <span class=\"string\">\"true\"</span></span><br><span class=\"line\">    target =&gt; <span class=\"string\">\"doc\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&quot;method&quot;:[&quot;user.getName&quot;],&quot;client&quot;:[&quot;client&quot;],&quot;snap&quot;:[&quot;120x120&quot;],&quot;userid&quot;:[&quot;12345678&quot;]&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;doc&quot; &#x3D;&gt; &#123;</span><br><span class=\"line\">    &quot;snap&quot; &#x3D;&gt; [</span><br><span class=\"line\">      [0] &quot;120x120&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;client&quot; &#x3D;&gt; [</span><br><span class=\"line\">      [0] &quot;client&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;userid&quot; &#x3D;&gt; [</span><br><span class=\"line\">      [0] &quot;12345678&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;method&quot; &#x3D;&gt; [</span><br><span class=\"line\">      [0] &quot;user.getName&quot;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"urldecode\"><a href=\"#urldecode\" class=\"headerlink\" title=\"urldecode\"></a><code>urldecode</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-urldecode.html\" target=\"_blank\" rel=\"noopener\"><code>urldecode</code></a>  urlencoded </p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">field</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">message</td>\n</tr>\n<tr>\n<td align=\"center\">charset</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">UTF-8</td>\n</tr>\n<tr>\n<td align=\"center\">tag_on_failure</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">[_urldecodefailure]</td>\n</tr>\n<tr>\n<td align=\"center\">all_field</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">filter &#123;</span><br><span class=\"line\">  urldecode &#123;</span><br><span class=\"line\">    <span class=\"comment\"># request_url </span></span><br><span class=\"line\">    field =&gt; <span class=\"string\">\"request_url\"</span></span><br><span class=\"line\">    charset =&gt; <span class=\"string\">\"UTF-8\"</span></span><br><span class=\"line\">    tag_on_failure =&gt; [<span class=\"string\">\"_urldecodefailure\"</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;client&#x3D;6&amp;data&#x3D;%7B%22uid%22%3A73023332%2C%22vid%22%3A%2264d68733bd5343d2bc69334e804ce036%22%2C%22position%22%3A%220%22%7D&amp;method&#x3D;videoformobile.setVideoPosition&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&quot;client&#x3D;6&amp;data&#x3D;&#123;\\&quot;uid\\&quot;:73023332,\\&quot;vid\\&quot;:\\&quot;64d68733bd5343d2bc69334e804ce036\\&quot;,\\&quot;position\\&quot;:\\&quot;0\\&quot;&#125;&amp;method&#x3D;videoformobile.setVideoPosition\\&quot;&quot;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"output-\"><a href=\"#output-\" class=\"headerlink\" title=\"output \"></a><code>output</code> </h2><p><a href=\"https://www.elastic.co/guide/en/logstash/current/output-plugins.html\" target=\"_blank\" rel=\"noopener\"><code>output</code></a>,.</p>\n<p>, Logstash .:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">codec</td>\n<td align=\"center\">. rubydebug, json</td>\n</tr>\n<tr>\n<td align=\"center\">id</td>\n<td align=\"center\"> output </td>\n</tr>\n</tbody></table>\n<h3 id=\"elasticsearch\"><a href=\"#elasticsearch\" class=\"headerlink\" title=\"elasticsearch\"></a><code>elasticsearch</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html\" target=\"_blank\" rel=\"noopener\"><code>elasticsearch</code></a>  Logstash  Elasticsearch.</p>\n<p>. <code>20MB</code>,.<code>20MB</code>,.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">hosts</td>\n<td align=\"center\"> Elasticsearch ,</td>\n<td align=\"center\"></td>\n<td align=\"center\">[127.0.0.1:9200]</td>\n</tr>\n<tr>\n<td align=\"center\">user, password</td>\n<td align=\"center\"> Elasticsearch </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">index</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">logstash-%{+yyyy.MM.dd}</td>\n</tr>\n<tr>\n<td align=\"center\">action</td>\n<td align=\"center\">Elasticsearch ,index,delete,create,update</td>\n<td align=\"center\"></td>\n<td align=\"center\">index</td>\n</tr>\n<tr>\n<td align=\"center\">document_id</td>\n<td align=\"center\">,</td>\n<td align=\"center\"> </td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">ssl</td>\n<td align=\"center\"> ssl</td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">cacert</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"mongodb\"><a href=\"#mongodb\" class=\"headerlink\" title=\"mongodb\"></a><code>mongodb</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-outputs-mongodb.html\" target=\"_blank\" rel=\"noopener\"><code>mongodb</code></a>  MongoDB.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">bulk</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">bulk_interval</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">2</td>\n</tr>\n<tr>\n<td align=\"center\">bulk_size</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">900</td>\n</tr>\n<tr>\n<td align=\"center\">collection</td>\n<td align=\"center\"> MongoDB ,</td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">database</td>\n<td align=\"center\"> MongoDB </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">uri</td>\n<td align=\"center\"> MongoDB </td>\n<td align=\"center\"></td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\">generateId</td>\n<td align=\"center\"> _id  MongoDB . true,, _id </td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">retry_delay</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">3</td>\n</tr>\n<tr>\n<td align=\"center\">isodate</td>\n<td align=\"center\"> @timestamp  ISODate  MongoDB </td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n</tbody></table>\n<h3 id=\"redis-1\"><a href=\"#redis-1\" class=\"headerlink\" title=\"redis\"></a><code>redis</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-outputs-redis.html\" target=\"_blank\" rel=\"noopener\"><code>redis</code></a>  Redis.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">host</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">[127.0.0.1]</td>\n</tr>\n<tr>\n<td align=\"center\">port</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">6379</td>\n</tr>\n<tr>\n<td align=\"center\">passwd</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">db</td>\n<td align=\"center\">Redis </td>\n<td align=\"center\"></td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">data_type</td>\n<td align=\"center\"> Redis , list, channel</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">key</td>\n<td align=\"center\">Redis list  channel ,</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">batch</td>\n<td align=\"center\"> RPUSH  Redis list </td>\n<td align=\"center\"></td>\n<td align=\"center\">false</td>\n</tr>\n<tr>\n<td align=\"center\">batch_events</td>\n<td align=\"center\">RPUSH  Redis list </td>\n<td align=\"center\"></td>\n<td align=\"center\">50</td>\n</tr>\n<tr>\n<td align=\"center\">batch_timeout</td>\n<td align=\"center\">RPUSH </td>\n<td align=\"center\"></td>\n<td align=\"center\">5</td>\n</tr>\n<tr>\n<td align=\"center\">reconnect_interval</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">timeout</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">5</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"stdout\"><a href=\"#stdout\" class=\"headerlink\" title=\"stdout\"></a><code>stdout</code></h3><p><a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-outputs-stdout.html\" target=\"_blank\" rel=\"noopener\"><code>stdout</code></a> ,.</p>\n"},{"title":"GitLab CI/CD ","abbrlink":3551,"description":" GitLab CI/CD  .gitlab-ci.yml .","_content":"\n GitLab , `.gitlab-ci.yml`  YAML  GitLab CI/CD  pipelines ().\n\n`.gitlab-ci.yml`  pipeline ,\n\n- GitLab Runner()\n- GitLab Runner , GitLab Runner\n\n `.gitlab-ci.yml` \n\n- [GitLab CI/CD Examples](https://docs.gitlab.com/ee/ci/examples/README.html)\n- [gitlab  .gitlab-ci.yml ](https://gitlab.com/gitlab-org/gitlab/blob/master/.gitlab-ci.yml)\n\n## \n\npipeline  job(). `.gitlab-ci.yml` .\n\n- ,\n- , `script` \n- \n\n\n\n```yaml\njob1:\n  script: \"execute-script-for-job1\"\n\njob2:\n  script: \"execute-script-for-job2\"\n```\n\n CI/CD ,.,.\n\n Runner  Runner ..\n\n###  `.gitlab-ci.yml`\n\n GitLab CI/CD  Lint , `.gitlab-ci.yml` , `$PATH_TO_PROJECT/-/ci/lint`($PATH_TO_PROJECT=$GitLab_URL/user_or_group_name/project_name). `https://gitlab.example.com/gitlab-org/project-123/-/ci/lint`.\n\n### \n\n,:\n\n```text\nimage\nservices\nstages\ntypes\nbefore_script\nafter_script\nvariables\ncache\ninclude\n```\n\n## \n\n.:\n\n | \n:---: | :---:\n`script` |  Runner \n`image` |  |  docker . `image:name`, `image:entrypoin`\n`services` |  docker . `services:name`, `services:alias`, `services:entrypoint`, `services:command`\n`before_script` | \n`after_script` | \n`stage` | ( `test`)\n`only` | . `only:refs`, `only:kubernetes`, `only:variables`, `only:changes`\n`except` | .  `except:refs`, `except:kubernetes`, `except:variables`, `except:changes`\n`rules` | . `only/except` \n`tags` |  Runner() \n`allow_failure` | \n`when` | .`when:manual`, `when:delayed`\n`environment` | . `environment:name`, `environment:url`, `environment:on_stop`, `environment:auto_stop_in`, `environment:action`\n`cache` | ,. `cache:paths`, `cache:key`, `cache:untracked`, `cache:policy`\n`artifacts` | \n`dependencies` | , `artifacts` \n`coverage` | ,\n`retry` | \n`timeout` | \n`parallel` | \n`trigger` | \n`include` |  yaml . `include:local`, `include:file`, `include:template`, `include:remote`\n`extends` | \n`pages` | , GitLab Pages \n`variables` | \n`interruptible` | \n`resource_group` | \n\n## \n\n,.\n\n `default` ..\n\n```text\nimage\nservices\nbefore_script\nafter_script\ntags\ncache\nartifacts\nretry\ntimeout\ninterruptible\n```\n\n, `image: ruby:2.5` , `rspec 2.6`  `image: ruby:2.6` \n\n```yaml\ndefault:\n  image: ruby:2.5\n\nrspec:\n  script: bundle exec rspec\n\nrspec 2.6:\n  image: ruby:2.6\n  script: bundle exec rspec\n```\n\n### `stages`\n\n`stages` ,\n\n`stages` ,`stages` :\n\n- \n- ,\n\n:\n\n-  `.gitlab-ci.yml`  `stages`, `build`, `test`, `deploy` \n- , `test` \n\n### `include`\n\n`include`  YAML , CI/CD ,.\n\n`include`  YAML  `.yml`  `.yaml` ,\n\n`include` , `local`. include ,`include` . [](https://docs.gitlab.com/ee/ci/yaml/includes.html)\n\n | \n:---: | :---\n`local` | \n`file` | \n`remote` |  URL \n`template` | GitLab \n\n#### `include:local`\n\n`include:local`  `.gitlab-ci.yml` , `.gitlab-ci.yml` \n\n`include:local`  `/` .\n\n```yaml\ninclude:\n  - local: '/templates/.gitlab-ci-template.yml'\n\ninclude: '.gitlab-ci-production.yml'\n```\n\n#### `include:file`\n\n`include:file`  GitLab .  `/` .\n\n `ref`  `HEAD` \n\n```yaml\ninclude:\n  - project: 'my-group/my-project'\n    ref: master\n    file: '/templates/.gitlab-ci-template.yml'\n\n  - project: 'my-group/my-project'\n    ref: v1.0.0\n    file: '/templates/.gitlab-ci-template.yml'\n\n  - project: 'my-group/my-project'\n    ref: 787123b47f14b552955ca2786bc9542ae66fee5b # Git SHA\n    file: '/templates/.gitlab-ci-template.yml'\n```\n\n#### `include:remote`\n\n`include:remote`  HTTP/HTTPS , GET \n\n URL .\n\n```yaml\ninclude:\n  - remote: 'https://gitlab.com/awesome-project/raw/master/.gitlab-ci-template.yml'\n```\n\n#### `include:template`\n\n`include:template`  GitLab  `.gitlab-ci.yml` \n\n```yaml\ninclude:\n  - template: Auto-DevOps.gitlab-ci.yml\n```\n\n## \n\n### `image`\n\n Docker .[ Docker ](https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#define-image-and-services-from-gitlab-ciyml)\n\n### `script`\n\n`script` , Runner  shell .\n\n```yaml\njob:\n  script:\n    - uname -a\n    - bundle exec rspec\n```\n\n 0,,.,:\n\n```yaml\njob:\n  script:\n    - false || exit_code=$?\n    - if [ $exit_code -ne 0 ]; then echo \"Previous command failed\"; fi;\n```\n\n### `before_script`  `after_script`\n\n`before_script` (),`after_script` ().\n\n`before_script` , shell \n\n`after_script` shell, `before_script`  `script` .\n\n:\n\n- \n-  `before_script`  `script` .\n  - `script` \n  -  before_script  `script` \n- , 5 \n- . `script` , `after_script` ,\n\n### `stage`\n\n`stage` , `stages`. ,\n\n```yaml\nstages:\n  - build\n  - test\n  - deploy\n\njob 0:\n  stage: .pre\n  script: make something useful before build stage\n\njob 1:\n  stage: build\n  script: make build dependencies\n\njob 2:\n  stage: build\n  script: make build artifacts\n\njob 3:\n  stage: test\n  script: make test\n\njob 4:\n  stage: deploy\n  script: make deploy\n\njob 5:\n  stage: .post\n  script: make something useful at the end of pipeline\n```\n\n,GitLab Runner . Runner  Runner  `concurrent` .\n\n> (GitLab 12.4 ) `stages`  ,`.per` .`.post` .\n\n### `extends`\n\n`extends`  `extends` ()().`extends` \n\n```yaml\n.tests:\n  script: rake test\n  stage: test\n  only:\n    refs:\n      - branches\n\nrspec:\n  extends: .tests\n  script: rake rspec\n  only:\n    variables:\n      - $RSPEC\n\n# \nrspec:\n  script: rake rspec  #  key \n  stage: test\n  only:\n    refs:             # \n      - branches\n    variables:\n      - $RSPEC\n```\n\n `extends` , `extends` .,.\n\n```yaml\n.only-important:\n  only:\n    - master\n    - stable\n  tags:\n    - production\n\n.in-docker:\n  tags:\n    - docker\n  image: alpine\n\nrspec:\n  extends:\n    - .only-important\n    - .in-docker\n  script:\n    - rake rspec\n\n# \nrspec:\n  only:\n    - master\n    - stable\n  tags:\n    - docker\n  image: alpine\n  script:\n    - rake rspec\n```\n\n### `rules`\n\n> GitLab 12.3 \n\n`rules` ,,.`rules`  `only/except` ,\n\n\n\n- `if`( `only:variables` )\n- `changes` ( `only:changes` )\n- `exists`\n\n#### `rules:if`\n\n`rules:if`  if \n\n`rules:if`  `only:variables` .`only:variables` , `rules:if` ,. `&&`  `||` ,.\n\n, `when:never`,. `rules:when`, `job:when` , `on_success`.\n\n```yaml\njob:\n  script: \"echo Hello, Rules!\"\n  rules:\n    - if: '$NAME =~ /^always/ #  NAME  always, when: always\n      when: always\n    - if: '$NAME =~ /^manual/ #  NAME  manual, when: manual\n      when: manual\n    - if: '$NAME'  #  NAME ,, when: on_success\n\n    # , when: never\n```\n\n#### `rules:changes`\n\n`rules:changes`  `only:changes`  `except:changes` ,,., true\n\n```yaml\ndocker build:\n  script: docker build -t my-image:$CI_COMMIT_REF_SLUG .\n  rules:\n    - changes: #  Dockerfile , `when: manual`\n      - Dockerfile\n      when: manual\n```\n\n#### `rules:exists`\n\n> GitLab 12.4 \n\n`rules:exists` .,,\n\n```yaml\njob:\n  script: bundle exec rspec\n  rules:\n    - exists:\n      - spec/**.rb\n```\n\n#### `rules:allow_failure`\n\n> GitLab 12.8 \n\n `allow_failure: true`,. `allow_failure: false`.\n\n### `only/except`\n\n`only`  `except` .`only` .`except` ,.\n\n- .\n-  fork \n\n`only`  `except` ,, `only`  `['branches', 'tags']`,`except` .\n\n | \n:---: | :---\n`branches` |  git \n`tags` |  git \n`external` |  GitLab  CI \n`pushes` |  git push \n`schedules` | \n`triggers` | \n`web` |  GitLab UI  \"Run\" \n`merge_requests` | \n\n:\n\n```yaml\njob1:\n  only:\n    - /^issue-.*$/i  # ,`i` \n  except:\n    - branches  # ,\n\njob2:\n  only:\n    - branches@gitlab-org/gitlab  #  branches , fork \n  except:\n    - master@gitlab-org/gitlab\n    - /^release/.*$/@gitlab-org/gitlab\n```\n\n- `only:refs/except:refs`: \n- `only:kubernetes/except:kubernetes`:  `active` , kubernetes \n- `only:variables/except:variables`: ,\n- `only:changes/except:changes`: ,,\n\n****,, true.\n\n `only` ,****, true ,. `except` ,****, true ,.\n\n:\n\n```yaml\n# \n# -  `master` \n# - $CI_COMMIT_MESSAGE  /run-end-to-end-tests/\n# - kubernetes \ntest:\n  script: npm run test\n  only:\n    refs:\n      - master\n      - schedules\n    variables:\n      - $CI_COMMIT_MESSAGE =~ /run-end-to-end-tests/\n    kubernetes: active\n```\n\n```yaml\n# \n# -  `master` \n# - README.md \ntest:\n  script: npm run test\n  except:\n    refs:\n      - master\n    changes:\n      - \"README.md\"\n```\n\n### `needs`\n\n`needs`  stages ,.,.\n\n:\n\n```yaml\nlinux:build:\n  stage: build\n\nmac:build:\n  stage: build\n\nlint:\n  stage: test\n  needs: []\n\nlinux:rspec:\n  stage: test\n  needs: [\"linux:build\"]\n\nlinux:rubocop:\n  stage: test\n  needs: [\"linux:build\"]\n\nmac:rspec:\n  stage: test\n  needs: [\"mac:build\"]\n\nmac:rubocop:\n  stage: test\n  needs: [\"mac:build\"]\n\nproduction:\n  stage: deploy\n```\n\n- Linux : `linux:build` , `linux:rspec`  `linux:rubocop` , `mac:build` \n- macOS : `mac:build` , `mac:rspec`  `mac:rubocop` , `linux:build` \n- production  `deploy` \n\n### `tags`\n\n`tags`  Runner  Runner. Runner , Runner , ruby,postgres,development .\n\n`tags` . `osx`  OS X Runner  `windows`  Windows Runner,:\n\n```yaml\nwindows job:\n  stage:\n    - build\n  tags:\n    - windows\n  script:\n    - echo Hello, %USERNAME%!\n\nosx job:\n  stage:\n    - build\n  tags:\n    - osx\n  script:\n    - echo \"Hello, $USER!\"\n```\n\n### `allow_failure`\n\n`allow_failure` ,.\n\n true ,,/,\n\n### `when`\n\n`when` .\n\n- `on_success`: ,.\n- `on_failure`: .\n- `always`: ,\n- `manual`: \n- `delayed`: . `start_in` , **1 **,. seconds,minutes,hours,days,week , seconds\n\n### \n\n- `retry` .,0,2\n- `timeout` ,\n- `parallel` , `job_name 1/N`  `job_name N/N` (2<=N<=50)\n- `trigger` . `trigger` ,\n- `variables`  `.gitlab-ci.yml` ,.\n","source":"_posts/gitlab-ci-pipeline-configuration.md","raw":"---\ntitle: GitLab CI/CD \ntags:\n  - GitLab\n  - CI/CD\ncategories:\n  - CI/CD\nabbrlink: 3551\ndescription:  GitLab CI/CD  .gitlab-ci.yml .\n---\n\n GitLab , `.gitlab-ci.yml`  YAML  GitLab CI/CD  pipelines ().\n\n`.gitlab-ci.yml`  pipeline ,\n\n- GitLab Runner()\n- GitLab Runner , GitLab Runner\n\n `.gitlab-ci.yml` \n\n- [GitLab CI/CD Examples](https://docs.gitlab.com/ee/ci/examples/README.html)\n- [gitlab  .gitlab-ci.yml ](https://gitlab.com/gitlab-org/gitlab/blob/master/.gitlab-ci.yml)\n\n## \n\npipeline  job(). `.gitlab-ci.yml` .\n\n- ,\n- , `script` \n- \n\n\n\n```yaml\njob1:\n  script: \"execute-script-for-job1\"\n\njob2:\n  script: \"execute-script-for-job2\"\n```\n\n CI/CD ,.,.\n\n Runner  Runner ..\n\n###  `.gitlab-ci.yml`\n\n GitLab CI/CD  Lint , `.gitlab-ci.yml` , `$PATH_TO_PROJECT/-/ci/lint`($PATH_TO_PROJECT=$GitLab_URL/user_or_group_name/project_name). `https://gitlab.example.com/gitlab-org/project-123/-/ci/lint`.\n\n### \n\n,:\n\n```text\nimage\nservices\nstages\ntypes\nbefore_script\nafter_script\nvariables\ncache\ninclude\n```\n\n## \n\n.:\n\n | \n:---: | :---:\n`script` |  Runner \n`image` |  |  docker . `image:name`, `image:entrypoin`\n`services` |  docker . `services:name`, `services:alias`, `services:entrypoint`, `services:command`\n`before_script` | \n`after_script` | \n`stage` | ( `test`)\n`only` | . `only:refs`, `only:kubernetes`, `only:variables`, `only:changes`\n`except` | .  `except:refs`, `except:kubernetes`, `except:variables`, `except:changes`\n`rules` | . `only/except` \n`tags` |  Runner() \n`allow_failure` | \n`when` | .`when:manual`, `when:delayed`\n`environment` | . `environment:name`, `environment:url`, `environment:on_stop`, `environment:auto_stop_in`, `environment:action`\n`cache` | ,. `cache:paths`, `cache:key`, `cache:untracked`, `cache:policy`\n`artifacts` | \n`dependencies` | , `artifacts` \n`coverage` | ,\n`retry` | \n`timeout` | \n`parallel` | \n`trigger` | \n`include` |  yaml . `include:local`, `include:file`, `include:template`, `include:remote`\n`extends` | \n`pages` | , GitLab Pages \n`variables` | \n`interruptible` | \n`resource_group` | \n\n## \n\n,.\n\n `default` ..\n\n```text\nimage\nservices\nbefore_script\nafter_script\ntags\ncache\nartifacts\nretry\ntimeout\ninterruptible\n```\n\n, `image: ruby:2.5` , `rspec 2.6`  `image: ruby:2.6` \n\n```yaml\ndefault:\n  image: ruby:2.5\n\nrspec:\n  script: bundle exec rspec\n\nrspec 2.6:\n  image: ruby:2.6\n  script: bundle exec rspec\n```\n\n### `stages`\n\n`stages` ,\n\n`stages` ,`stages` :\n\n- \n- ,\n\n:\n\n-  `.gitlab-ci.yml`  `stages`, `build`, `test`, `deploy` \n- , `test` \n\n### `include`\n\n`include`  YAML , CI/CD ,.\n\n`include`  YAML  `.yml`  `.yaml` ,\n\n`include` , `local`. include ,`include` . [](https://docs.gitlab.com/ee/ci/yaml/includes.html)\n\n | \n:---: | :---\n`local` | \n`file` | \n`remote` |  URL \n`template` | GitLab \n\n#### `include:local`\n\n`include:local`  `.gitlab-ci.yml` , `.gitlab-ci.yml` \n\n`include:local`  `/` .\n\n```yaml\ninclude:\n  - local: '/templates/.gitlab-ci-template.yml'\n\ninclude: '.gitlab-ci-production.yml'\n```\n\n#### `include:file`\n\n`include:file`  GitLab .  `/` .\n\n `ref`  `HEAD` \n\n```yaml\ninclude:\n  - project: 'my-group/my-project'\n    ref: master\n    file: '/templates/.gitlab-ci-template.yml'\n\n  - project: 'my-group/my-project'\n    ref: v1.0.0\n    file: '/templates/.gitlab-ci-template.yml'\n\n  - project: 'my-group/my-project'\n    ref: 787123b47f14b552955ca2786bc9542ae66fee5b # Git SHA\n    file: '/templates/.gitlab-ci-template.yml'\n```\n\n#### `include:remote`\n\n`include:remote`  HTTP/HTTPS , GET \n\n URL .\n\n```yaml\ninclude:\n  - remote: 'https://gitlab.com/awesome-project/raw/master/.gitlab-ci-template.yml'\n```\n\n#### `include:template`\n\n`include:template`  GitLab  `.gitlab-ci.yml` \n\n```yaml\ninclude:\n  - template: Auto-DevOps.gitlab-ci.yml\n```\n\n## \n\n### `image`\n\n Docker .[ Docker ](https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#define-image-and-services-from-gitlab-ciyml)\n\n### `script`\n\n`script` , Runner  shell .\n\n```yaml\njob:\n  script:\n    - uname -a\n    - bundle exec rspec\n```\n\n 0,,.,:\n\n```yaml\njob:\n  script:\n    - false || exit_code=$?\n    - if [ $exit_code -ne 0 ]; then echo \"Previous command failed\"; fi;\n```\n\n### `before_script`  `after_script`\n\n`before_script` (),`after_script` ().\n\n`before_script` , shell \n\n`after_script` shell, `before_script`  `script` .\n\n:\n\n- \n-  `before_script`  `script` .\n  - `script` \n  -  before_script  `script` \n- , 5 \n- . `script` , `after_script` ,\n\n### `stage`\n\n`stage` , `stages`. ,\n\n```yaml\nstages:\n  - build\n  - test\n  - deploy\n\njob 0:\n  stage: .pre\n  script: make something useful before build stage\n\njob 1:\n  stage: build\n  script: make build dependencies\n\njob 2:\n  stage: build\n  script: make build artifacts\n\njob 3:\n  stage: test\n  script: make test\n\njob 4:\n  stage: deploy\n  script: make deploy\n\njob 5:\n  stage: .post\n  script: make something useful at the end of pipeline\n```\n\n,GitLab Runner . Runner  Runner  `concurrent` .\n\n> (GitLab 12.4 ) `stages`  ,`.per` .`.post` .\n\n### `extends`\n\n`extends`  `extends` ()().`extends` \n\n```yaml\n.tests:\n  script: rake test\n  stage: test\n  only:\n    refs:\n      - branches\n\nrspec:\n  extends: .tests\n  script: rake rspec\n  only:\n    variables:\n      - $RSPEC\n\n# \nrspec:\n  script: rake rspec  #  key \n  stage: test\n  only:\n    refs:             # \n      - branches\n    variables:\n      - $RSPEC\n```\n\n `extends` , `extends` .,.\n\n```yaml\n.only-important:\n  only:\n    - master\n    - stable\n  tags:\n    - production\n\n.in-docker:\n  tags:\n    - docker\n  image: alpine\n\nrspec:\n  extends:\n    - .only-important\n    - .in-docker\n  script:\n    - rake rspec\n\n# \nrspec:\n  only:\n    - master\n    - stable\n  tags:\n    - docker\n  image: alpine\n  script:\n    - rake rspec\n```\n\n### `rules`\n\n> GitLab 12.3 \n\n`rules` ,,.`rules`  `only/except` ,\n\n\n\n- `if`( `only:variables` )\n- `changes` ( `only:changes` )\n- `exists`\n\n#### `rules:if`\n\n`rules:if`  if \n\n`rules:if`  `only:variables` .`only:variables` , `rules:if` ,. `&&`  `||` ,.\n\n, `when:never`,. `rules:when`, `job:when` , `on_success`.\n\n```yaml\njob:\n  script: \"echo Hello, Rules!\"\n  rules:\n    - if: '$NAME =~ /^always/ #  NAME  always, when: always\n      when: always\n    - if: '$NAME =~ /^manual/ #  NAME  manual, when: manual\n      when: manual\n    - if: '$NAME'  #  NAME ,, when: on_success\n\n    # , when: never\n```\n\n#### `rules:changes`\n\n`rules:changes`  `only:changes`  `except:changes` ,,., true\n\n```yaml\ndocker build:\n  script: docker build -t my-image:$CI_COMMIT_REF_SLUG .\n  rules:\n    - changes: #  Dockerfile , `when: manual`\n      - Dockerfile\n      when: manual\n```\n\n#### `rules:exists`\n\n> GitLab 12.4 \n\n`rules:exists` .,,\n\n```yaml\njob:\n  script: bundle exec rspec\n  rules:\n    - exists:\n      - spec/**.rb\n```\n\n#### `rules:allow_failure`\n\n> GitLab 12.8 \n\n `allow_failure: true`,. `allow_failure: false`.\n\n### `only/except`\n\n`only`  `except` .`only` .`except` ,.\n\n- .\n-  fork \n\n`only`  `except` ,, `only`  `['branches', 'tags']`,`except` .\n\n | \n:---: | :---\n`branches` |  git \n`tags` |  git \n`external` |  GitLab  CI \n`pushes` |  git push \n`schedules` | \n`triggers` | \n`web` |  GitLab UI  \"Run\" \n`merge_requests` | \n\n:\n\n```yaml\njob1:\n  only:\n    - /^issue-.*$/i  # ,`i` \n  except:\n    - branches  # ,\n\njob2:\n  only:\n    - branches@gitlab-org/gitlab  #  branches , fork \n  except:\n    - master@gitlab-org/gitlab\n    - /^release/.*$/@gitlab-org/gitlab\n```\n\n- `only:refs/except:refs`: \n- `only:kubernetes/except:kubernetes`:  `active` , kubernetes \n- `only:variables/except:variables`: ,\n- `only:changes/except:changes`: ,,\n\n****,, true.\n\n `only` ,****, true ,. `except` ,****, true ,.\n\n:\n\n```yaml\n# \n# -  `master` \n# - $CI_COMMIT_MESSAGE  /run-end-to-end-tests/\n# - kubernetes \ntest:\n  script: npm run test\n  only:\n    refs:\n      - master\n      - schedules\n    variables:\n      - $CI_COMMIT_MESSAGE =~ /run-end-to-end-tests/\n    kubernetes: active\n```\n\n```yaml\n# \n# -  `master` \n# - README.md \ntest:\n  script: npm run test\n  except:\n    refs:\n      - master\n    changes:\n      - \"README.md\"\n```\n\n### `needs`\n\n`needs`  stages ,.,.\n\n:\n\n```yaml\nlinux:build:\n  stage: build\n\nmac:build:\n  stage: build\n\nlint:\n  stage: test\n  needs: []\n\nlinux:rspec:\n  stage: test\n  needs: [\"linux:build\"]\n\nlinux:rubocop:\n  stage: test\n  needs: [\"linux:build\"]\n\nmac:rspec:\n  stage: test\n  needs: [\"mac:build\"]\n\nmac:rubocop:\n  stage: test\n  needs: [\"mac:build\"]\n\nproduction:\n  stage: deploy\n```\n\n- Linux : `linux:build` , `linux:rspec`  `linux:rubocop` , `mac:build` \n- macOS : `mac:build` , `mac:rspec`  `mac:rubocop` , `linux:build` \n- production  `deploy` \n\n### `tags`\n\n`tags`  Runner  Runner. Runner , Runner , ruby,postgres,development .\n\n`tags` . `osx`  OS X Runner  `windows`  Windows Runner,:\n\n```yaml\nwindows job:\n  stage:\n    - build\n  tags:\n    - windows\n  script:\n    - echo Hello, %USERNAME%!\n\nosx job:\n  stage:\n    - build\n  tags:\n    - osx\n  script:\n    - echo \"Hello, $USER!\"\n```\n\n### `allow_failure`\n\n`allow_failure` ,.\n\n true ,,/,\n\n### `when`\n\n`when` .\n\n- `on_success`: ,.\n- `on_failure`: .\n- `always`: ,\n- `manual`: \n- `delayed`: . `start_in` , **1 **,. seconds,minutes,hours,days,week , seconds\n\n### \n\n- `retry` .,0,2\n- `timeout` ,\n- `parallel` , `job_name 1/N`  `job_name N/N` (2<=N<=50)\n- `trigger` . `trigger` ,\n- `variables`  `.gitlab-ci.yml` ,.\n","slug":"gitlab-ci-pipeline-configuration","published":1,"date":"2020-05-22T13:25:30.966Z","updated":"2020-05-22T13:26:32.404Z","_id":"ckai8moy7000bgcu7b89u2j39","comments":1,"layout":"post","photos":[],"link":"","content":"<p> GitLab , <code>.gitlab-ci.yml</code>  YAML  GitLab CI/CD  pipelines ().</p>\n<p><code>.gitlab-ci.yml</code>  pipeline ,</p>\n<ul>\n<li>GitLab Runner()</li>\n<li>GitLab Runner , GitLab Runner</li>\n</ul>\n<p> <code>.gitlab-ci.yml</code> </p>\n<ul>\n<li><a href=\"https://docs.gitlab.com/ee/ci/examples/README.html\" target=\"_blank\" rel=\"noopener\">GitLab CI/CD Examples</a></li>\n<li><a href=\"https://gitlab.com/gitlab-org/gitlab/blob/master/.gitlab-ci.yml\" target=\"_blank\" rel=\"noopener\">gitlab  .gitlab-ci.yml </a></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>pipeline  job(). <code>.gitlab-ci.yml</code> .</p>\n<ul>\n<li>,</li>\n<li>, <code>script</code> </li>\n<li></li>\n</ul>\n<p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job1:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">\"execute-script-for-job1\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job2:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">\"execute-script-for-job2\"</span></span><br></pre></td></tr></table></figure>\n\n<p> CI/CD ,.,.</p>\n<p> Runner  Runner ..</p>\n<h3 id=\"-gitlab-ci-yml\"><a href=\"#-gitlab-ci-yml\" class=\"headerlink\" title=\" .gitlab-ci.yml\"></a> <code>.gitlab-ci.yml</code></h3><p> GitLab CI/CD  Lint , <code>.gitlab-ci.yml</code> , <code>$PATH_TO_PROJECT/-/ci/lint</code>($PATH_TO_PROJECT=$GitLab_URL/user_or_group_name/project_name). <code>https://gitlab.example.com/gitlab-org/project-123/-/ci/lint</code>.</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">image</span><br><span class=\"line\">services</span><br><span class=\"line\">stages</span><br><span class=\"line\">types</span><br><span class=\"line\">before_script</span><br><span class=\"line\">after_script</span><br><span class=\"line\">variables</span><br><span class=\"line\">cache</span><br><span class=\"line\">include</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>.:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>script</code></td>\n<td align=\"center\"> Runner </td>\n</tr>\n<tr>\n<td align=\"center\"><code>image</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>services</code></td>\n<td align=\"center\"> docker . <code>services:name</code>, <code>services:alias</code>, <code>services:entrypoint</code>, <code>services:command</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>before_script</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>after_script</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>stage</code></td>\n<td align=\"center\">( <code>test</code>)</td>\n</tr>\n<tr>\n<td align=\"center\"><code>only</code></td>\n<td align=\"center\">. <code>only:refs</code>, <code>only:kubernetes</code>, <code>only:variables</code>, <code>only:changes</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>except</code></td>\n<td align=\"center\">.  <code>except:refs</code>, <code>except:kubernetes</code>, <code>except:variables</code>, <code>except:changes</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>rules</code></td>\n<td align=\"center\">. <code>only/except</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>tags</code></td>\n<td align=\"center\"> Runner() </td>\n</tr>\n<tr>\n<td align=\"center\"><code>allow_failure</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>when</code></td>\n<td align=\"center\">.<code>when:manual</code>, <code>when:delayed</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>environment</code></td>\n<td align=\"center\">. <code>environment:name</code>, <code>environment:url</code>, <code>environment:on_stop</code>, <code>environment:auto_stop_in</code>, <code>environment:action</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>cache</code></td>\n<td align=\"center\">,. <code>cache:paths</code>, <code>cache:key</code>, <code>cache:untracked</code>, <code>cache:policy</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>artifacts</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>dependencies</code></td>\n<td align=\"center\">, <code>artifacts</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>coverage</code></td>\n<td align=\"center\">,</td>\n</tr>\n<tr>\n<td align=\"center\"><code>retry</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>timeout</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>parallel</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>trigger</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>include</code></td>\n<td align=\"center\"> yaml . <code>include:local</code>, <code>include:file</code>, <code>include:template</code>, <code>include:remote</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>extends</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>pages</code></td>\n<td align=\"center\">, GitLab Pages </td>\n</tr>\n<tr>\n<td align=\"center\"><code>variables</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>interruptible</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>resource_group</code></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,.</p>\n<p> <code>default</code> ..</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">image</span><br><span class=\"line\">services</span><br><span class=\"line\">before_script</span><br><span class=\"line\">after_script</span><br><span class=\"line\">tags</span><br><span class=\"line\">cache</span><br><span class=\"line\">artifacts</span><br><span class=\"line\">retry</span><br><span class=\"line\">timeout</span><br><span class=\"line\">interruptible</span><br></pre></td></tr></table></figure>\n\n<p>, <code>image: ruby:2.5</code> , <code>rspec 2.6</code>  <code>image: ruby:2.6</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">ruby:2.5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">bundle</span> <span class=\"string\">exec</span> <span class=\"string\">rspec</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">rspec 2.6:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">ruby:2.6</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">bundle</span> <span class=\"string\">exec</span> <span class=\"string\">rspec</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"stages\"><a href=\"#stages\" class=\"headerlink\" title=\"stages\"></a><code>stages</code></h3><p><code>stages</code> ,</p>\n<p><code>stages</code> ,<code>stages</code> :</p>\n<ul>\n<li></li>\n<li>,</li>\n</ul>\n<p>:</p>\n<ul>\n<li> <code>.gitlab-ci.yml</code>  <code>stages</code>, <code>build</code>, <code>test</code>, <code>deploy</code> </li>\n<li>, <code>test</code> </li>\n</ul>\n<h3 id=\"include\"><a href=\"#include\" class=\"headerlink\" title=\"include\"></a><code>include</code></h3><p><code>include</code>  YAML , CI/CD ,.</p>\n<p><code>include</code>  YAML  <code>.yml</code>  <code>.yaml</code> ,</p>\n<p><code>include</code> , <code>local</code>. include ,<code>include</code> . <a href=\"https://docs.gitlab.com/ee/ci/yaml/includes.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>local</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>file</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>remote</code></td>\n<td align=\"left\"> URL </td>\n</tr>\n<tr>\n<td align=\"center\"><code>template</code></td>\n<td align=\"left\">GitLab </td>\n</tr>\n</tbody></table>\n<h4 id=\"include-local\"><a href=\"#include-local\" class=\"headerlink\" title=\"include:local\"></a><code>include:local</code></h4><p><code>include:local</code>  <code>.gitlab-ci.yml</code> , <code>.gitlab-ci.yml</code> </p>\n<p><code>include:local</code>  <code>/</code> .</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">include:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">local:</span> <span class=\"string\">'/templates/.gitlab-ci-template.yml'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">include:</span> <span class=\"string\">'.gitlab-ci-production.yml'</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"include-file\"><a href=\"#include-file\" class=\"headerlink\" title=\"include:file\"></a><code>include:file</code></h4><p><code>include:file</code>  GitLab .  <code>/</code> .</p>\n<p> <code>ref</code>  <code>HEAD</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">include:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">project:</span> <span class=\"string\">'my-group/my-project'</span></span><br><span class=\"line\">    <span class=\"attr\">ref:</span> <span class=\"string\">master</span></span><br><span class=\"line\">    <span class=\"attr\">file:</span> <span class=\"string\">'/templates/.gitlab-ci-template.yml'</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">project:</span> <span class=\"string\">'my-group/my-project'</span></span><br><span class=\"line\">    <span class=\"attr\">ref:</span> <span class=\"string\">v1.0.0</span></span><br><span class=\"line\">    <span class=\"attr\">file:</span> <span class=\"string\">'/templates/.gitlab-ci-template.yml'</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">project:</span> <span class=\"string\">'my-group/my-project'</span></span><br><span class=\"line\">    <span class=\"attr\">ref:</span> <span class=\"string\">787123b47f14b552955ca2786bc9542ae66fee5b</span> <span class=\"comment\"># Git SHA</span></span><br><span class=\"line\">    <span class=\"attr\">file:</span> <span class=\"string\">'/templates/.gitlab-ci-template.yml'</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"include-remote\"><a href=\"#include-remote\" class=\"headerlink\" title=\"include:remote\"></a><code>include:remote</code></h4><p><code>include:remote</code>  HTTP/HTTPS , GET </p>\n<p> URL .</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">include:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">remote:</span> <span class=\"string\">'https://gitlab.com/awesome-project/raw/master/.gitlab-ci-template.yml'</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"include-template\"><a href=\"#include-template\" class=\"headerlink\" title=\"include:template\"></a><code>include:template</code></h4><p><code>include:template</code>  GitLab  <code>.gitlab-ci.yml</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">include:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">template:</span> <span class=\"string\">Auto-DevOps.gitlab-ci.yml</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"image\"><a href=\"#image\" class=\"headerlink\" title=\"image\"></a><code>image</code></h3><p> Docker .<a href=\"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#define-image-and-services-from-gitlab-ciyml\" target=\"_blank\" rel=\"noopener\"> Docker </a></p>\n<h3 id=\"script\"><a href=\"#script\" class=\"headerlink\" title=\"script\"></a><code>script</code></h3><p><code>script</code> , Runner  shell .</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">uname</span> <span class=\"string\">-a</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">bundle</span> <span class=\"string\">exec</span> <span class=\"string\">rspec</span></span><br></pre></td></tr></table></figure>\n\n<p> 0,,.,:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"literal\">false</span> <span class=\"string\">||</span> <span class=\"string\">exit_code=$?</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">if</span> <span class=\"string\">[</span> <span class=\"string\">$exit_code</span> <span class=\"string\">-ne</span> <span class=\"number\">0</span> <span class=\"string\">];</span> <span class=\"string\">then</span> <span class=\"string\">echo</span> <span class=\"string\">\"Previous command failed\"</span><span class=\"string\">;</span> <span class=\"string\">fi;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"before-script--after-script\"><a href=\"#before-script--after-script\" class=\"headerlink\" title=\"before_script  after_script\"></a><code>before_script</code>  <code>after_script</code></h3><p><code>before_script</code> (),<code>after_script</code> ().</p>\n<p><code>before_script</code> , shell </p>\n<p><code>after_script</code> shell, <code>before_script</code>  <code>script</code> .</p>\n<p>:</p>\n<ul>\n<li></li>\n<li> <code>before_script</code>  <code>script</code> .<ul>\n<li><code>script</code> </li>\n<li> before_script  <code>script</code> </li>\n</ul>\n</li>\n<li>, 5 </li>\n<li>. <code>script</code> , <code>after_script</code> ,</li>\n</ul>\n<h3 id=\"stage\"><a href=\"#stage\" class=\"headerlink\" title=\"stage\"></a><code>stage</code></h3><p><code>stage</code> , <code>stages</code>. ,</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 0:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">.pre</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">something</span> <span class=\"string\">useful</span> <span class=\"string\">before</span> <span class=\"string\">build</span> <span class=\"string\">stage</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 1:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">build</span> <span class=\"string\">dependencies</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 2:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">build</span> <span class=\"string\">artifacts</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 3:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">test</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 4:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 5:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">.post</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">something</span> <span class=\"string\">useful</span> <span class=\"string\">at</span> <span class=\"string\">the</span> <span class=\"string\">end</span> <span class=\"string\">of</span> <span class=\"string\">pipeline</span></span><br></pre></td></tr></table></figure>\n\n<p>,GitLab Runner . Runner  Runner  <code>concurrent</code> .</p>\n<blockquote>\n<p>(GitLab 12.4 ) <code>stages</code>  ,<code>.per</code> .<code>.post</code> .</p>\n</blockquote>\n<h3 id=\"extends\"><a href=\"#extends\" class=\"headerlink\" title=\"extends\"></a><code>extends</code></h3><p><code>extends</code>  <code>extends</code> ()().<code>extends</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">.tests:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">rake</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"attr\">refs:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">branches</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">extends:</span> <span class=\"string\">.tests</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">rake</span> <span class=\"string\">rspec</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"attr\">variables:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">$RSPEC</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">rake</span> <span class=\"string\">rspec</span>  <span class=\"comment\">#  key </span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"attr\">refs:</span>             <span class=\"comment\"># </span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">branches</span></span><br><span class=\"line\">    <span class=\"attr\">variables:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">$RSPEC</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>extends</code> , <code>extends</code> .,.</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">.only-important:</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">stable</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">production</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">.in-docker:</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">alpine</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">extends:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">.only-important</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">.in-docker</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">rake</span> <span class=\"string\">rspec</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">stable</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">alpine</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">rake</span> <span class=\"string\">rspec</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"rules\"><a href=\"#rules\" class=\"headerlink\" title=\"rules\"></a><code>rules</code></h3><blockquote>\n<p>GitLab 12.3 </p>\n</blockquote>\n<p><code>rules</code> ,,.<code>rules</code>  <code>only/except</code> ,</p>\n<p></p>\n<ul>\n<li><code>if</code>( <code>only:variables</code> )</li>\n<li><code>changes</code> ( <code>only:changes</code> )</li>\n<li><code>exists</code></li>\n</ul>\n<h4 id=\"rules-if\"><a href=\"#rules-if\" class=\"headerlink\" title=\"rules:if\"></a><code>rules:if</code></h4><p><code>rules:if</code>  if </p>\n<p><code>rules:if</code>  <code>only:variables</code> .<code>only:variables</code> , <code>rules:if</code> ,. <code>&amp;&amp;</code>  <code>||</code> ,.</p>\n<p>, <code>when:never</code>,. <code>rules:when</code>, <code>job:when</code> , <code>on_success</code>.</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">\"echo Hello, Rules!\"</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">if:</span> <span class=\"string\">'$NAME =~ /^always/ #  NAME  always, when: always</span></span><br><span class=\"line\"><span class=\"string\">      when: always</span></span><br><span class=\"line\"><span class=\"string\">    - if: '</span><span class=\"string\">$NAME</span> <span class=\"string\">=~</span> <span class=\"string\">/^manual/</span> <span class=\"comment\">#  NAME  manual, when: manual</span></span><br><span class=\"line\">      <span class=\"attr\">when:</span> <span class=\"string\">manual</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">if:</span> <span class=\"string\">'$NAME'</span>  <span class=\"comment\">#  NAME ,, when: on_success</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># , when: never</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"rules-changes\"><a href=\"#rules-changes\" class=\"headerlink\" title=\"rules:changes\"></a><code>rules:changes</code></h4><p><code>rules:changes</code>  <code>only:changes</code>  <code>except:changes</code> ,,., true</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">docker build:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">docker</span> <span class=\"string\">build</span> <span class=\"string\">-t</span> <span class=\"string\">my-image:$CI_COMMIT_REF_SLUG</span> <span class=\"string\">.</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">changes:</span> <span class=\"comment\">#  Dockerfile , `when: manual`</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">Dockerfile</span></span><br><span class=\"line\">      <span class=\"attr\">when:</span> <span class=\"string\">manual</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"rules-exists\"><a href=\"#rules-exists\" class=\"headerlink\" title=\"rules:exists\"></a><code>rules:exists</code></h4><blockquote>\n<p>GitLab 12.4 </p>\n</blockquote>\n<p><code>rules:exists</code> .,,</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">bundle</span> <span class=\"string\">exec</span> <span class=\"string\">rspec</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">exists:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">spec/**.rb</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"rules-allow-failure\"><a href=\"#rules-allow-failure\" class=\"headerlink\" title=\"rules:allow_failure\"></a><code>rules:allow_failure</code></h4><blockquote>\n<p>GitLab 12.8 </p>\n</blockquote>\n<p> <code>allow_failure: true</code>,. <code>allow_failure: false</code>.</p>\n<h3 id=\"only-except\"><a href=\"#only-except\" class=\"headerlink\" title=\"only/except\"></a><code>only/except</code></h3><p><code>only</code>  <code>except</code> .<code>only</code> .<code>except</code> ,.</p>\n<ul>\n<li>.</li>\n<li> fork </li>\n</ul>\n<p><code>only</code>  <code>except</code> ,, <code>only</code>  <code>[&#39;branches&#39;, &#39;tags&#39;]</code>,<code>except</code> .</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>branches</code></td>\n<td align=\"left\"> git </td>\n</tr>\n<tr>\n<td align=\"center\"><code>tags</code></td>\n<td align=\"left\"> git </td>\n</tr>\n<tr>\n<td align=\"center\"><code>external</code></td>\n<td align=\"left\"> GitLab  CI </td>\n</tr>\n<tr>\n<td align=\"center\"><code>pushes</code></td>\n<td align=\"left\"> git push </td>\n</tr>\n<tr>\n<td align=\"center\"><code>schedules</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>triggers</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>web</code></td>\n<td align=\"left\"> GitLab UI  Run </td>\n</tr>\n<tr>\n<td align=\"center\"><code>merge_requests</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<p>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job1:</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">/^issue-.*$/i</span>  <span class=\"comment\"># ,`i` </span></span><br><span class=\"line\">  <span class=\"attr\">except:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">branches</span>  <span class=\"comment\"># ,</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job2:</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">branches@gitlab-org/gitlab</span>  <span class=\"comment\">#  branches , fork </span></span><br><span class=\"line\">  <span class=\"attr\">except:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">master@gitlab-org/gitlab</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">/^release/.*$/@gitlab-org/gitlab</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>only:refs/except:refs</code>: </li>\n<li><code>only:kubernetes/except:kubernetes</code>:  <code>active</code> , kubernetes </li>\n<li><code>only:variables/except:variables</code>: ,</li>\n<li><code>only:changes/except:changes</code>: ,,</li>\n</ul>\n<p><strong></strong>,, true.</p>\n<p> <code>only</code> ,<strong></strong>, true ,. <code>except</code> ,<strong></strong>, true ,.</p>\n<p>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># -  `master` </span></span><br><span class=\"line\"><span class=\"comment\"># - $CI_COMMIT_MESSAGE  /run-end-to-end-tests/</span></span><br><span class=\"line\"><span class=\"comment\"># - kubernetes </span></span><br><span class=\"line\"><span class=\"attr\">test:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">npm</span> <span class=\"string\">run</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"attr\">refs:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">schedules</span></span><br><span class=\"line\">    <span class=\"attr\">variables:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">$CI_COMMIT_MESSAGE</span> <span class=\"string\">=~</span> <span class=\"string\">/run-end-to-end-tests/</span></span><br><span class=\"line\">    <span class=\"attr\">kubernetes:</span> <span class=\"string\">active</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># -  `master` </span></span><br><span class=\"line\"><span class=\"comment\"># - README.md </span></span><br><span class=\"line\"><span class=\"attr\">test:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">npm</span> <span class=\"string\">run</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">except:</span></span><br><span class=\"line\">    <span class=\"attr\">refs:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\">    <span class=\"attr\">changes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"README.md\"</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"needs\"><a href=\"#needs\" class=\"headerlink\" title=\"needs\"></a><code>needs</code></h3><p><code>needs</code>  stages ,.,.</p>\n<p>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">linux:build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">mac:build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">lint:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">linux:rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[\"linux:build\"]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">linux:rubocop:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[\"linux:build\"]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">mac:rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[\"mac:build\"]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">mac:rubocop:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[\"mac:build\"]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">production:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Linux : <code>linux:build</code> , <code>linux:rspec</code>  <code>linux:rubocop</code> , <code>mac:build</code> </li>\n<li>macOS : <code>mac:build</code> , <code>mac:rspec</code>  <code>mac:rubocop</code> , <code>linux:build</code> </li>\n<li>production  <code>deploy</code> </li>\n</ul>\n<h3 id=\"tags\"><a href=\"#tags\" class=\"headerlink\" title=\"tags\"></a><code>tags</code></h3><p><code>tags</code>  Runner  Runner. Runner , Runner , ruby,postgres,development .</p>\n<p><code>tags</code> . <code>osx</code>  OS X Runner  <code>windows</code>  Windows Runner,:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">windows job:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">windows</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">Hello,</span> <span class=\"string\">%USERNAME%!</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">osx job:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">osx</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">\"Hello, $USER!\"</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"allow-failure\"><a href=\"#allow-failure\" class=\"headerlink\" title=\"allow_failure\"></a><code>allow_failure</code></h3><p><code>allow_failure</code> ,.</p>\n<p> true ,,/,</p>\n<h3 id=\"when\"><a href=\"#when\" class=\"headerlink\" title=\"when\"></a><code>when</code></h3><p><code>when</code> .</p>\n<ul>\n<li><code>on_success</code>: ,.</li>\n<li><code>on_failure</code>: .</li>\n<li><code>always</code>: ,</li>\n<li><code>manual</code>: </li>\n<li><code>delayed</code>: . <code>start_in</code> , <strong>1 </strong>,. seconds,minutes,hours,days,week , seconds</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><code>retry</code> .,0,2</li>\n<li><code>timeout</code> ,</li>\n<li><code>parallel</code> , <code>job_name 1/N</code>  <code>job_name N/N</code> (2&lt;=N&lt;=50)</li>\n<li><code>trigger</code> . <code>trigger</code> ,</li>\n<li><code>variables</code>  <code>.gitlab-ci.yml</code> ,.</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p> GitLab , <code>.gitlab-ci.yml</code>  YAML  GitLab CI/CD  pipelines ().</p>\n<p><code>.gitlab-ci.yml</code>  pipeline ,</p>\n<ul>\n<li>GitLab Runner()</li>\n<li>GitLab Runner , GitLab Runner</li>\n</ul>\n<p> <code>.gitlab-ci.yml</code> </p>\n<ul>\n<li><a href=\"https://docs.gitlab.com/ee/ci/examples/README.html\" target=\"_blank\" rel=\"noopener\">GitLab CI/CD Examples</a></li>\n<li><a href=\"https://gitlab.com/gitlab-org/gitlab/blob/master/.gitlab-ci.yml\" target=\"_blank\" rel=\"noopener\">gitlab  .gitlab-ci.yml </a></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>pipeline  job(). <code>.gitlab-ci.yml</code> .</p>\n<ul>\n<li>,</li>\n<li>, <code>script</code> </li>\n<li></li>\n</ul>\n<p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job1:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">\"execute-script-for-job1\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job2:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">\"execute-script-for-job2\"</span></span><br></pre></td></tr></table></figure>\n\n<p> CI/CD ,.,.</p>\n<p> Runner  Runner ..</p>\n<h3 id=\"-gitlab-ci-yml\"><a href=\"#-gitlab-ci-yml\" class=\"headerlink\" title=\" .gitlab-ci.yml\"></a> <code>.gitlab-ci.yml</code></h3><p> GitLab CI/CD  Lint , <code>.gitlab-ci.yml</code> , <code>$PATH_TO_PROJECT/-/ci/lint</code>($PATH_TO_PROJECT=$GitLab_URL/user_or_group_name/project_name). <code>https://gitlab.example.com/gitlab-org/project-123/-/ci/lint</code>.</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">image</span><br><span class=\"line\">services</span><br><span class=\"line\">stages</span><br><span class=\"line\">types</span><br><span class=\"line\">before_script</span><br><span class=\"line\">after_script</span><br><span class=\"line\">variables</span><br><span class=\"line\">cache</span><br><span class=\"line\">include</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>.:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>script</code></td>\n<td align=\"center\"> Runner </td>\n</tr>\n<tr>\n<td align=\"center\"><code>image</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>services</code></td>\n<td align=\"center\"> docker . <code>services:name</code>, <code>services:alias</code>, <code>services:entrypoint</code>, <code>services:command</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>before_script</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>after_script</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>stage</code></td>\n<td align=\"center\">( <code>test</code>)</td>\n</tr>\n<tr>\n<td align=\"center\"><code>only</code></td>\n<td align=\"center\">. <code>only:refs</code>, <code>only:kubernetes</code>, <code>only:variables</code>, <code>only:changes</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>except</code></td>\n<td align=\"center\">.  <code>except:refs</code>, <code>except:kubernetes</code>, <code>except:variables</code>, <code>except:changes</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>rules</code></td>\n<td align=\"center\">. <code>only/except</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>tags</code></td>\n<td align=\"center\"> Runner() </td>\n</tr>\n<tr>\n<td align=\"center\"><code>allow_failure</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>when</code></td>\n<td align=\"center\">.<code>when:manual</code>, <code>when:delayed</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>environment</code></td>\n<td align=\"center\">. <code>environment:name</code>, <code>environment:url</code>, <code>environment:on_stop</code>, <code>environment:auto_stop_in</code>, <code>environment:action</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>cache</code></td>\n<td align=\"center\">,. <code>cache:paths</code>, <code>cache:key</code>, <code>cache:untracked</code>, <code>cache:policy</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>artifacts</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>dependencies</code></td>\n<td align=\"center\">, <code>artifacts</code> </td>\n</tr>\n<tr>\n<td align=\"center\"><code>coverage</code></td>\n<td align=\"center\">,</td>\n</tr>\n<tr>\n<td align=\"center\"><code>retry</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>timeout</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>parallel</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>trigger</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>include</code></td>\n<td align=\"center\"> yaml . <code>include:local</code>, <code>include:file</code>, <code>include:template</code>, <code>include:remote</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>extends</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>pages</code></td>\n<td align=\"center\">, GitLab Pages </td>\n</tr>\n<tr>\n<td align=\"center\"><code>variables</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>interruptible</code></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>resource_group</code></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,.</p>\n<p> <code>default</code> ..</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">image</span><br><span class=\"line\">services</span><br><span class=\"line\">before_script</span><br><span class=\"line\">after_script</span><br><span class=\"line\">tags</span><br><span class=\"line\">cache</span><br><span class=\"line\">artifacts</span><br><span class=\"line\">retry</span><br><span class=\"line\">timeout</span><br><span class=\"line\">interruptible</span><br></pre></td></tr></table></figure>\n\n<p>, <code>image: ruby:2.5</code> , <code>rspec 2.6</code>  <code>image: ruby:2.6</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">ruby:2.5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">bundle</span> <span class=\"string\">exec</span> <span class=\"string\">rspec</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">rspec 2.6:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">ruby:2.6</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">bundle</span> <span class=\"string\">exec</span> <span class=\"string\">rspec</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"stages\"><a href=\"#stages\" class=\"headerlink\" title=\"stages\"></a><code>stages</code></h3><p><code>stages</code> ,</p>\n<p><code>stages</code> ,<code>stages</code> :</p>\n<ul>\n<li></li>\n<li>,</li>\n</ul>\n<p>:</p>\n<ul>\n<li> <code>.gitlab-ci.yml</code>  <code>stages</code>, <code>build</code>, <code>test</code>, <code>deploy</code> </li>\n<li>, <code>test</code> </li>\n</ul>\n<h3 id=\"include\"><a href=\"#include\" class=\"headerlink\" title=\"include\"></a><code>include</code></h3><p><code>include</code>  YAML , CI/CD ,.</p>\n<p><code>include</code>  YAML  <code>.yml</code>  <code>.yaml</code> ,</p>\n<p><code>include</code> , <code>local</code>. include ,<code>include</code> . <a href=\"https://docs.gitlab.com/ee/ci/yaml/includes.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>local</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>file</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>remote</code></td>\n<td align=\"left\"> URL </td>\n</tr>\n<tr>\n<td align=\"center\"><code>template</code></td>\n<td align=\"left\">GitLab </td>\n</tr>\n</tbody></table>\n<h4 id=\"include-local\"><a href=\"#include-local\" class=\"headerlink\" title=\"include:local\"></a><code>include:local</code></h4><p><code>include:local</code>  <code>.gitlab-ci.yml</code> , <code>.gitlab-ci.yml</code> </p>\n<p><code>include:local</code>  <code>/</code> .</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">include:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">local:</span> <span class=\"string\">'/templates/.gitlab-ci-template.yml'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">include:</span> <span class=\"string\">'.gitlab-ci-production.yml'</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"include-file\"><a href=\"#include-file\" class=\"headerlink\" title=\"include:file\"></a><code>include:file</code></h4><p><code>include:file</code>  GitLab .  <code>/</code> .</p>\n<p> <code>ref</code>  <code>HEAD</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">include:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">project:</span> <span class=\"string\">'my-group/my-project'</span></span><br><span class=\"line\">    <span class=\"attr\">ref:</span> <span class=\"string\">master</span></span><br><span class=\"line\">    <span class=\"attr\">file:</span> <span class=\"string\">'/templates/.gitlab-ci-template.yml'</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">project:</span> <span class=\"string\">'my-group/my-project'</span></span><br><span class=\"line\">    <span class=\"attr\">ref:</span> <span class=\"string\">v1.0.0</span></span><br><span class=\"line\">    <span class=\"attr\">file:</span> <span class=\"string\">'/templates/.gitlab-ci-template.yml'</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">project:</span> <span class=\"string\">'my-group/my-project'</span></span><br><span class=\"line\">    <span class=\"attr\">ref:</span> <span class=\"string\">787123b47f14b552955ca2786bc9542ae66fee5b</span> <span class=\"comment\"># Git SHA</span></span><br><span class=\"line\">    <span class=\"attr\">file:</span> <span class=\"string\">'/templates/.gitlab-ci-template.yml'</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"include-remote\"><a href=\"#include-remote\" class=\"headerlink\" title=\"include:remote\"></a><code>include:remote</code></h4><p><code>include:remote</code>  HTTP/HTTPS , GET </p>\n<p> URL .</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">include:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">remote:</span> <span class=\"string\">'https://gitlab.com/awesome-project/raw/master/.gitlab-ci-template.yml'</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"include-template\"><a href=\"#include-template\" class=\"headerlink\" title=\"include:template\"></a><code>include:template</code></h4><p><code>include:template</code>  GitLab  <code>.gitlab-ci.yml</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">include:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">template:</span> <span class=\"string\">Auto-DevOps.gitlab-ci.yml</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"image\"><a href=\"#image\" class=\"headerlink\" title=\"image\"></a><code>image</code></h3><p> Docker .<a href=\"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#define-image-and-services-from-gitlab-ciyml\" target=\"_blank\" rel=\"noopener\"> Docker </a></p>\n<h3 id=\"script\"><a href=\"#script\" class=\"headerlink\" title=\"script\"></a><code>script</code></h3><p><code>script</code> , Runner  shell .</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">uname</span> <span class=\"string\">-a</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">bundle</span> <span class=\"string\">exec</span> <span class=\"string\">rspec</span></span><br></pre></td></tr></table></figure>\n\n<p> 0,,.,:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"literal\">false</span> <span class=\"string\">||</span> <span class=\"string\">exit_code=$?</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">if</span> <span class=\"string\">[</span> <span class=\"string\">$exit_code</span> <span class=\"string\">-ne</span> <span class=\"number\">0</span> <span class=\"string\">];</span> <span class=\"string\">then</span> <span class=\"string\">echo</span> <span class=\"string\">\"Previous command failed\"</span><span class=\"string\">;</span> <span class=\"string\">fi;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"before-script--after-script\"><a href=\"#before-script--after-script\" class=\"headerlink\" title=\"before_script  after_script\"></a><code>before_script</code>  <code>after_script</code></h3><p><code>before_script</code> (),<code>after_script</code> ().</p>\n<p><code>before_script</code> , shell </p>\n<p><code>after_script</code> shell, <code>before_script</code>  <code>script</code> .</p>\n<p>:</p>\n<ul>\n<li></li>\n<li> <code>before_script</code>  <code>script</code> .<ul>\n<li><code>script</code> </li>\n<li> before_script  <code>script</code> </li>\n</ul>\n</li>\n<li>, 5 </li>\n<li>. <code>script</code> , <code>after_script</code> ,</li>\n</ul>\n<h3 id=\"stage\"><a href=\"#stage\" class=\"headerlink\" title=\"stage\"></a><code>stage</code></h3><p><code>stage</code> , <code>stages</code>. ,</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 0:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">.pre</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">something</span> <span class=\"string\">useful</span> <span class=\"string\">before</span> <span class=\"string\">build</span> <span class=\"string\">stage</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 1:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">build</span> <span class=\"string\">dependencies</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 2:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">build</span> <span class=\"string\">artifacts</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 3:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">test</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 4:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job 5:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">.post</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">make</span> <span class=\"string\">something</span> <span class=\"string\">useful</span> <span class=\"string\">at</span> <span class=\"string\">the</span> <span class=\"string\">end</span> <span class=\"string\">of</span> <span class=\"string\">pipeline</span></span><br></pre></td></tr></table></figure>\n\n<p>,GitLab Runner . Runner  Runner  <code>concurrent</code> .</p>\n<blockquote>\n<p>(GitLab 12.4 ) <code>stages</code>  ,<code>.per</code> .<code>.post</code> .</p>\n</blockquote>\n<h3 id=\"extends\"><a href=\"#extends\" class=\"headerlink\" title=\"extends\"></a><code>extends</code></h3><p><code>extends</code>  <code>extends</code> ()().<code>extends</code> </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">.tests:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">rake</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"attr\">refs:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">branches</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">extends:</span> <span class=\"string\">.tests</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">rake</span> <span class=\"string\">rspec</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"attr\">variables:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">$RSPEC</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">rake</span> <span class=\"string\">rspec</span>  <span class=\"comment\">#  key </span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"attr\">refs:</span>             <span class=\"comment\"># </span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">branches</span></span><br><span class=\"line\">    <span class=\"attr\">variables:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">$RSPEC</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>extends</code> , <code>extends</code> .,.</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">.only-important:</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">stable</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">production</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">.in-docker:</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">alpine</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">extends:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">.only-important</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">.in-docker</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">rake</span> <span class=\"string\">rspec</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">stable</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">alpine</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">rake</span> <span class=\"string\">rspec</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"rules\"><a href=\"#rules\" class=\"headerlink\" title=\"rules\"></a><code>rules</code></h3><blockquote>\n<p>GitLab 12.3 </p>\n</blockquote>\n<p><code>rules</code> ,,.<code>rules</code>  <code>only/except</code> ,</p>\n<p></p>\n<ul>\n<li><code>if</code>( <code>only:variables</code> )</li>\n<li><code>changes</code> ( <code>only:changes</code> )</li>\n<li><code>exists</code></li>\n</ul>\n<h4 id=\"rules-if\"><a href=\"#rules-if\" class=\"headerlink\" title=\"rules:if\"></a><code>rules:if</code></h4><p><code>rules:if</code>  if </p>\n<p><code>rules:if</code>  <code>only:variables</code> .<code>only:variables</code> , <code>rules:if</code> ,. <code>&amp;&amp;</code>  <code>||</code> ,.</p>\n<p>, <code>when:never</code>,. <code>rules:when</code>, <code>job:when</code> , <code>on_success</code>.</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">\"echo Hello, Rules!\"</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">if:</span> <span class=\"string\">'$NAME =~ /^always/ #  NAME  always, when: always</span></span><br><span class=\"line\"><span class=\"string\">      when: always</span></span><br><span class=\"line\"><span class=\"string\">    - if: '</span><span class=\"string\">$NAME</span> <span class=\"string\">=~</span> <span class=\"string\">/^manual/</span> <span class=\"comment\">#  NAME  manual, when: manual</span></span><br><span class=\"line\">      <span class=\"attr\">when:</span> <span class=\"string\">manual</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">if:</span> <span class=\"string\">'$NAME'</span>  <span class=\"comment\">#  NAME ,, when: on_success</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># , when: never</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"rules-changes\"><a href=\"#rules-changes\" class=\"headerlink\" title=\"rules:changes\"></a><code>rules:changes</code></h4><p><code>rules:changes</code>  <code>only:changes</code>  <code>except:changes</code> ,,., true</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">docker build:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">docker</span> <span class=\"string\">build</span> <span class=\"string\">-t</span> <span class=\"string\">my-image:$CI_COMMIT_REF_SLUG</span> <span class=\"string\">.</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">changes:</span> <span class=\"comment\">#  Dockerfile , `when: manual`</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">Dockerfile</span></span><br><span class=\"line\">      <span class=\"attr\">when:</span> <span class=\"string\">manual</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"rules-exists\"><a href=\"#rules-exists\" class=\"headerlink\" title=\"rules:exists\"></a><code>rules:exists</code></h4><blockquote>\n<p>GitLab 12.4 </p>\n</blockquote>\n<p><code>rules:exists</code> .,,</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">bundle</span> <span class=\"string\">exec</span> <span class=\"string\">rspec</span></span><br><span class=\"line\">  <span class=\"attr\">rules:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">exists:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">spec/**.rb</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"rules-allow-failure\"><a href=\"#rules-allow-failure\" class=\"headerlink\" title=\"rules:allow_failure\"></a><code>rules:allow_failure</code></h4><blockquote>\n<p>GitLab 12.8 </p>\n</blockquote>\n<p> <code>allow_failure: true</code>,. <code>allow_failure: false</code>.</p>\n<h3 id=\"only-except\"><a href=\"#only-except\" class=\"headerlink\" title=\"only/except\"></a><code>only/except</code></h3><p><code>only</code>  <code>except</code> .<code>only</code> .<code>except</code> ,.</p>\n<ul>\n<li>.</li>\n<li> fork </li>\n</ul>\n<p><code>only</code>  <code>except</code> ,, <code>only</code>  <code>[&#39;branches&#39;, &#39;tags&#39;]</code>,<code>except</code> .</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"><code>branches</code></td>\n<td align=\"left\"> git </td>\n</tr>\n<tr>\n<td align=\"center\"><code>tags</code></td>\n<td align=\"left\"> git </td>\n</tr>\n<tr>\n<td align=\"center\"><code>external</code></td>\n<td align=\"left\"> GitLab  CI </td>\n</tr>\n<tr>\n<td align=\"center\"><code>pushes</code></td>\n<td align=\"left\"> git push </td>\n</tr>\n<tr>\n<td align=\"center\"><code>schedules</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>triggers</code></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"center\"><code>web</code></td>\n<td align=\"left\"> GitLab UI  Run </td>\n</tr>\n<tr>\n<td align=\"center\"><code>merge_requests</code></td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<p>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">job1:</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">/^issue-.*$/i</span>  <span class=\"comment\"># ,`i` </span></span><br><span class=\"line\">  <span class=\"attr\">except:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">branches</span>  <span class=\"comment\"># ,</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">job2:</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">branches@gitlab-org/gitlab</span>  <span class=\"comment\">#  branches , fork </span></span><br><span class=\"line\">  <span class=\"attr\">except:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">master@gitlab-org/gitlab</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">/^release/.*$/@gitlab-org/gitlab</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>only:refs/except:refs</code>: </li>\n<li><code>only:kubernetes/except:kubernetes</code>:  <code>active</code> , kubernetes </li>\n<li><code>only:variables/except:variables</code>: ,</li>\n<li><code>only:changes/except:changes</code>: ,,</li>\n</ul>\n<p><strong></strong>,, true.</p>\n<p> <code>only</code> ,<strong></strong>, true ,. <code>except</code> ,<strong></strong>, true ,.</p>\n<p>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># -  `master` </span></span><br><span class=\"line\"><span class=\"comment\"># - $CI_COMMIT_MESSAGE  /run-end-to-end-tests/</span></span><br><span class=\"line\"><span class=\"comment\"># - kubernetes </span></span><br><span class=\"line\"><span class=\"attr\">test:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">npm</span> <span class=\"string\">run</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">only:</span></span><br><span class=\"line\">    <span class=\"attr\">refs:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">schedules</span></span><br><span class=\"line\">    <span class=\"attr\">variables:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">$CI_COMMIT_MESSAGE</span> <span class=\"string\">=~</span> <span class=\"string\">/run-end-to-end-tests/</span></span><br><span class=\"line\">    <span class=\"attr\">kubernetes:</span> <span class=\"string\">active</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># -  `master` </span></span><br><span class=\"line\"><span class=\"comment\"># - README.md </span></span><br><span class=\"line\"><span class=\"attr\">test:</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span> <span class=\"string\">npm</span> <span class=\"string\">run</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">except:</span></span><br><span class=\"line\">    <span class=\"attr\">refs:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\">    <span class=\"attr\">changes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"README.md\"</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"needs\"><a href=\"#needs\" class=\"headerlink\" title=\"needs\"></a><code>needs</code></h3><p><code>needs</code>  stages ,.,.</p>\n<p>:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">linux:build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">mac:build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">lint:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">linux:rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[\"linux:build\"]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">linux:rubocop:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[\"linux:build\"]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">mac:rspec:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[\"mac:build\"]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">mac:rubocop:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">test</span></span><br><span class=\"line\">  <span class=\"attr\">needs:</span> <span class=\"string\">[\"mac:build\"]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">production:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Linux : <code>linux:build</code> , <code>linux:rspec</code>  <code>linux:rubocop</code> , <code>mac:build</code> </li>\n<li>macOS : <code>mac:build</code> , <code>mac:rspec</code>  <code>mac:rubocop</code> , <code>linux:build</code> </li>\n<li>production  <code>deploy</code> </li>\n</ul>\n<h3 id=\"tags\"><a href=\"#tags\" class=\"headerlink\" title=\"tags\"></a><code>tags</code></h3><p><code>tags</code>  Runner  Runner. Runner , Runner , ruby,postgres,development .</p>\n<p><code>tags</code> . <code>osx</code>  OS X Runner  <code>windows</code>  Windows Runner,:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">windows job:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">windows</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">Hello,</span> <span class=\"string\">%USERNAME%!</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">osx job:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">osx</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">\"Hello, $USER!\"</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"allow-failure\"><a href=\"#allow-failure\" class=\"headerlink\" title=\"allow_failure\"></a><code>allow_failure</code></h3><p><code>allow_failure</code> ,.</p>\n<p> true ,,/,</p>\n<h3 id=\"when\"><a href=\"#when\" class=\"headerlink\" title=\"when\"></a><code>when</code></h3><p><code>when</code> .</p>\n<ul>\n<li><code>on_success</code>: ,.</li>\n<li><code>on_failure</code>: .</li>\n<li><code>always</code>: ,</li>\n<li><code>manual</code>: </li>\n<li><code>delayed</code>: . <code>start_in</code> , <strong>1 </strong>,. seconds,minutes,hours,days,week , seconds</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><code>retry</code> .,0,2</li>\n<li><code>timeout</code> ,</li>\n<li><code>parallel</code> , <code>job_name 1/N</code>  <code>job_name N/N</code> (2&lt;=N&lt;=50)</li>\n<li><code>trigger</code> . <code>trigger</code> ,</li>\n<li><code>variables</code>  <code>.gitlab-ci.yml</code> ,.</li>\n</ul>\n"},{"title":"go  x509 ","abbrlink":42320,"description":" Go crypto/x509 .crypto/x509 X.509","_content":"\n`crypto/x509`  X.509 .\n\n`crypto/x509/pkix`  X.509 ,CRL  OCSP  ASN.1 \n\n Unix , SSL_CERT_FILE  SSL_CERT_DIR \n\n## \n\n```go\n// certificates \ntype CertPool struct {\n    // contains filtered or unexported fields\n}\n\n// X509 \ntype Certificate struct {\n    //  subject , CN,O,L,S,C\n    Subject pkix.Name\n    // contains filtered or unexported fields\n}\n// key \ntype ExtKeyUsage int\n// Key \ntype KeyUsage int\n\n// \ntype CertificateRequest struct {\n    // \n    Signature          []byte\n    // \n    SignatureAlgorithm SignatureAlgorithm\n    // \n    PublicKeyAlgorithm PublicKeyAlgorithm\n    // \n    PublicKey          interface{}\n    //  subject\n    Subject pkix.Name\n    // contains filtered or unexported fields\n}\n\n// \ntype VerifyOptions struct {\n    DNSName       string\n    Intermediates *CertPool\n    Roots         *CertPool // \n    CurrentTime   time.Time // \n    KeyUsages []ExtKeyUsage\n    MaxConstraintComparisions int\n}\n```\n\n## \n\n```go\n// \nconst (\n    UnknownPublicKeyAlgorithm PublicKeyAlgorithm = iota\n    RSA\n    DSA\n    ECDSA\n    Ed25519\n)\n// \nconst (\n    UnknownSignatureAlgorithm SignatureAlgorithm = iota\n    MD2WithRSA\n    MD5WithRSA\n    SHA1WithRSA\n    SHA256WithRSA\n    SHA384WithRSA\n    SHA512WithRSA\n    DSAWithSHA1\n    DSAWithSHA256\n    ECDSAWithSHA1\n    ECDSAWithSHA256\n    ECDSAWithSHA384\n    ECDSAWithSHA512\n    SHA256WithRSAPSS\n    SHA384WithRSAPSS\n    SHA512WithRSAPSS\n    PureEd25519\n)\n//  Key \nconst (\n    ExtKeyUsageAny ExtKeyUsage = iota\n    ExtKeyUsageServerAuth\n    ExtKeyUsageClientAuth\n    ExtKeyUsageCodeSigning\n    ExtKeyUsageEmailProtection\n    ExtKeyUsageIPSECEndSystem\n    ExtKeyUsageIPSECTunnel\n    ExtKeyUsageIPSECUser\n    ExtKeyUsageTimeStamping\n    ExtKeyUsageOCSPSigning\n    ExtKeyUsageMicrosoftServerGatedCrypto\n    ExtKeyUsageNetscapeServerGatedCrypto\n    ExtKeyUsageMicrosoftCommercialCodeSigning\n    ExtKeyUsageMicrosoftKernelCodeSigning\n)\n// key \nconst (\n    KeyUsageDigitalSignature KeyUsage = 1 << iota\n    KeyUsageContentCommitment\n    KeyUsageKeyEncipherment\n    KeyUsageDataEncipherment\n    KeyUsageKeyAgreement\n    KeyUsageCertSign\n    KeyUsageCRLSign\n    KeyUsageEncipherOnly\n    KeyUsageDecipherOnly\n)\n```\n\n## \n\n### `x509` \n\n```go\n//  template  parent  X509 v3 . DER \n//  parent=template,.\n//  AuthorityKeyId  SubjectKeyId , template \n// pub,priv , priv  `crypto.Signal`  `PrivateKey` . *rsa.PublicKey,*ecdsa.PublicKey  *ed25519.PublicKey.\nfunc CreateCertificate(rand io.Reader, template, parent *Certificate, pub, priv interface{}) (cert []byte, err error)\n//  template \n// priv  CSR , CSR ,priv  `crypto.Signal` \nfunc CreateCertificateRequest(rand io.Reader, template *CertificateRequest, priv interface{}) (csr []byte, err error)\n//  password  PEM , DER \nfunc DecryptPEMBlock(b *pem.Block, password []byte) ([]byte, error)\n//  alg  password  DER  data . PEM \nfunc EncryptPEMBlock(rand io.Reader, blockType string, data, password []byte, alg PEMCipher) (*pem.Block, error)\n//  PEM \nfunc IsEncryptedPEMBlock(b *pem.Block) bool\n\n//  CertPool\nfunc NewCertPool() *CertPool\n// .CertPool \nfunc SystemCertPool() (*CertPool, error)\n\n//  ASN.1 .\nfunc ParseCertificate(asn1Data []byte) (*Certificate, error)\nfunc ParseCertificates(asn1Data []byte) ([]*Certificate, error)\n```\n\n### `CertPool` \n\n```go\n// \nfunc (s *CertPool) AddCert(cert *Certificate)\n//  PEM ,\nfunc (s *CertPool) AppendCertsFromPEM(pemCerts []byte) (ok bool)\n//  DER  subject \nfunc (s *CertPool) Subjects() [][]byte\n```\n\n### `Certificate` \n\n```go\n//  crl  c\nfunc (c *Certificate) CheckCRLSignature(crl *pkix.CertificateList) error\n//  algo  signature  c  signed \nfunc (c *Certificate) CheckSignature(algo SignatureAlgorithm, signed, signature []byte) error\n//  c  parent \nfunc (c *Certificate) CheckSignatureFrom(parent *Certificate) error\n//  DER  CRL ,\nfunc (c *Certificate) CreateCRL(rand io.Reader, priv interface{}, revokedCerts []pkix.RevokedCertificate, now, expiry time.Time) (crlBytes []byte, err error)\n//  opts.Roots , c\nfunc (c *Certificate) Verify(opts VerifyOptions) (chains [][]*Certificate, err error)\n//  c \nfunc (c *Certificate) VerifyHostname(h string) error\n```\n\n## \n\n### ,\n\n```go\nimport (\n    \"crypto/rand\"\n    \"crypto/rsa\"\n    \"crypto/x509\"\n    \"crypto/x509/pkix\"\n    \"io/ioutil\"\n    \"log\"\n    \"math/big\"\n    \"time\"\n)\n\nfunc main() {\n    // ca \n    ca := &x509.Certificate{\n        SerialNumber: big.NewInt(1653),\n        Subject: pkix.Name{\n            Country:            []string{\"China\"},\n            Organization:       []string{\"\"},\n            OrganizationalUnit: []string{\"\"},\n        },\n        NotBefore:             time.Now(),\n        NotAfter:              time.Now().AddDate(10, 0, 0),\n        SubjectKeyId:          []byte{1, 2, 3, 4, 5},\n        BasicConstraintsValid: true,\n        IsCA:                  true,\n        ExtKeyUsage:           []x509.ExtKeyUsage{x509.ExtKeyUsageClientAuth, x509.ExtKeyUsageServerAuth},\n        KeyUsage:              x509.KeyUsageDigitalSignature | x509.KeyUsageCertSign,\n    }\n    //  rsa \n    caSelfSignedPrivateKey, _ := rsa.GenerateKey(rand.Reader, 1024)\n    caSelfSignedPublicKey := &caSelfSignedPrivateKey.PublicKey\n    //  []byte\n    caSelfSigned, err := x509.CreateCertificate(rand.Reader, ca, ca, caSelfSignedPublicKey, caSelfSignedPrivateKey)\n    if err != nil {\n        log.Println(\"create ca failed\", err)\n        return\n    }\n    caSelfSignedFile := \"ca.pem\"\n    log.Println(\"write to\", caSelfSignedFile)\n    ioutil.WriteFile(caSelfSignedFile, caSelfSigned, 0777) // \n\n    caSelfSignedPrivateKeyFile := \"ca.key\"\n    caSelfSignedPrivateKeyDER := x509.MarshalPKCS1PrivateKey(caSelfSignedPrivateKey) //  DER \n    log.Println(\"write to\", caSelfSignedPrivateKeyFile)\n    ioutil.WriteFile(caSelfSignedPrivateKeyFile, caSelfSignedPrivateKeyDER, 0777) //  DER \n\n    // \n    cert := &x509.Certificate{\n        SerialNumber: big.NewInt(1658),\n        Subject: pkix.Name{\n            Country:            []string{\"China\"},\n            Organization:       []string{\"\"},\n            OrganizationalUnit: []string{\"\"},\n        },\n        NotBefore:    time.Now(),\n        NotAfter:     time.Now().AddDate(10, 0, 0),\n        SubjectKeyId: []byte{1, 2, 3, 4, 6},\n        ExtKeyUsage:  []x509.ExtKeyUsage{x509.ExtKeyUsageClientAuth, x509.ExtKeyUsageServerAuth},\n        KeyUsage:     x509.KeyUsageDigitalSignature | x509.KeyUsageCertSign,\n    }\n    certPrivateKey, _ := rsa.GenerateKey(rand.Reader, 1024)\n    certPublicKey := &certPrivateKey.PublicKey\n\n    // CA  \n    certSigned, err2 := x509.CreateCertificate(rand.Reader, cert, ca, certPublicKey, caSelfSignedPrivateKey)\n    if err != nil {\n        log.Println(\"create cert2 failed\", err2)\n        return\n    }\n\n    certFile := \"cert.pem\"\n    log.Println(\"write to\", certFile)\n    ioutil.WriteFile(certFile, certSigned, 0777) // cert \n\n    certPrivateKeyFile := \"cert.key\"\n    certPrivateKeyDER := x509.MarshalPKCS1PrivateKey(certPrivateKey) //  DER \n    log.Println(\"write to\", certPrivateKeyFile)\n    ioutil.WriteFile(certPrivateKeyFile, certPrivateKeyDER, 0777) // \n\n    ca_tr, _ := x509.ParseCertificate(caSelfSigned)\n    cert_tr, _ := x509.ParseCertificate(certSigned)\n    err = cert_tr.CheckSignatureFrom(ca_tr)\n    log.Println(\"check signature\", err)\n}\n```\n","source":"_posts/go-study-notes-package-x509.md","raw":"---\ntitle: go  x509 \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 42320\ndescription:  Go crypto/x509 .crypto/x509 X.509\n---\n\n`crypto/x509`  X.509 .\n\n`crypto/x509/pkix`  X.509 ,CRL  OCSP  ASN.1 \n\n Unix , SSL_CERT_FILE  SSL_CERT_DIR \n\n## \n\n```go\n// certificates \ntype CertPool struct {\n    // contains filtered or unexported fields\n}\n\n// X509 \ntype Certificate struct {\n    //  subject , CN,O,L,S,C\n    Subject pkix.Name\n    // contains filtered or unexported fields\n}\n// key \ntype ExtKeyUsage int\n// Key \ntype KeyUsage int\n\n// \ntype CertificateRequest struct {\n    // \n    Signature          []byte\n    // \n    SignatureAlgorithm SignatureAlgorithm\n    // \n    PublicKeyAlgorithm PublicKeyAlgorithm\n    // \n    PublicKey          interface{}\n    //  subject\n    Subject pkix.Name\n    // contains filtered or unexported fields\n}\n\n// \ntype VerifyOptions struct {\n    DNSName       string\n    Intermediates *CertPool\n    Roots         *CertPool // \n    CurrentTime   time.Time // \n    KeyUsages []ExtKeyUsage\n    MaxConstraintComparisions int\n}\n```\n\n## \n\n```go\n// \nconst (\n    UnknownPublicKeyAlgorithm PublicKeyAlgorithm = iota\n    RSA\n    DSA\n    ECDSA\n    Ed25519\n)\n// \nconst (\n    UnknownSignatureAlgorithm SignatureAlgorithm = iota\n    MD2WithRSA\n    MD5WithRSA\n    SHA1WithRSA\n    SHA256WithRSA\n    SHA384WithRSA\n    SHA512WithRSA\n    DSAWithSHA1\n    DSAWithSHA256\n    ECDSAWithSHA1\n    ECDSAWithSHA256\n    ECDSAWithSHA384\n    ECDSAWithSHA512\n    SHA256WithRSAPSS\n    SHA384WithRSAPSS\n    SHA512WithRSAPSS\n    PureEd25519\n)\n//  Key \nconst (\n    ExtKeyUsageAny ExtKeyUsage = iota\n    ExtKeyUsageServerAuth\n    ExtKeyUsageClientAuth\n    ExtKeyUsageCodeSigning\n    ExtKeyUsageEmailProtection\n    ExtKeyUsageIPSECEndSystem\n    ExtKeyUsageIPSECTunnel\n    ExtKeyUsageIPSECUser\n    ExtKeyUsageTimeStamping\n    ExtKeyUsageOCSPSigning\n    ExtKeyUsageMicrosoftServerGatedCrypto\n    ExtKeyUsageNetscapeServerGatedCrypto\n    ExtKeyUsageMicrosoftCommercialCodeSigning\n    ExtKeyUsageMicrosoftKernelCodeSigning\n)\n// key \nconst (\n    KeyUsageDigitalSignature KeyUsage = 1 << iota\n    KeyUsageContentCommitment\n    KeyUsageKeyEncipherment\n    KeyUsageDataEncipherment\n    KeyUsageKeyAgreement\n    KeyUsageCertSign\n    KeyUsageCRLSign\n    KeyUsageEncipherOnly\n    KeyUsageDecipherOnly\n)\n```\n\n## \n\n### `x509` \n\n```go\n//  template  parent  X509 v3 . DER \n//  parent=template,.\n//  AuthorityKeyId  SubjectKeyId , template \n// pub,priv , priv  `crypto.Signal`  `PrivateKey` . *rsa.PublicKey,*ecdsa.PublicKey  *ed25519.PublicKey.\nfunc CreateCertificate(rand io.Reader, template, parent *Certificate, pub, priv interface{}) (cert []byte, err error)\n//  template \n// priv  CSR , CSR ,priv  `crypto.Signal` \nfunc CreateCertificateRequest(rand io.Reader, template *CertificateRequest, priv interface{}) (csr []byte, err error)\n//  password  PEM , DER \nfunc DecryptPEMBlock(b *pem.Block, password []byte) ([]byte, error)\n//  alg  password  DER  data . PEM \nfunc EncryptPEMBlock(rand io.Reader, blockType string, data, password []byte, alg PEMCipher) (*pem.Block, error)\n//  PEM \nfunc IsEncryptedPEMBlock(b *pem.Block) bool\n\n//  CertPool\nfunc NewCertPool() *CertPool\n// .CertPool \nfunc SystemCertPool() (*CertPool, error)\n\n//  ASN.1 .\nfunc ParseCertificate(asn1Data []byte) (*Certificate, error)\nfunc ParseCertificates(asn1Data []byte) ([]*Certificate, error)\n```\n\n### `CertPool` \n\n```go\n// \nfunc (s *CertPool) AddCert(cert *Certificate)\n//  PEM ,\nfunc (s *CertPool) AppendCertsFromPEM(pemCerts []byte) (ok bool)\n//  DER  subject \nfunc (s *CertPool) Subjects() [][]byte\n```\n\n### `Certificate` \n\n```go\n//  crl  c\nfunc (c *Certificate) CheckCRLSignature(crl *pkix.CertificateList) error\n//  algo  signature  c  signed \nfunc (c *Certificate) CheckSignature(algo SignatureAlgorithm, signed, signature []byte) error\n//  c  parent \nfunc (c *Certificate) CheckSignatureFrom(parent *Certificate) error\n//  DER  CRL ,\nfunc (c *Certificate) CreateCRL(rand io.Reader, priv interface{}, revokedCerts []pkix.RevokedCertificate, now, expiry time.Time) (crlBytes []byte, err error)\n//  opts.Roots , c\nfunc (c *Certificate) Verify(opts VerifyOptions) (chains [][]*Certificate, err error)\n//  c \nfunc (c *Certificate) VerifyHostname(h string) error\n```\n\n## \n\n### ,\n\n```go\nimport (\n    \"crypto/rand\"\n    \"crypto/rsa\"\n    \"crypto/x509\"\n    \"crypto/x509/pkix\"\n    \"io/ioutil\"\n    \"log\"\n    \"math/big\"\n    \"time\"\n)\n\nfunc main() {\n    // ca \n    ca := &x509.Certificate{\n        SerialNumber: big.NewInt(1653),\n        Subject: pkix.Name{\n            Country:            []string{\"China\"},\n            Organization:       []string{\"\"},\n            OrganizationalUnit: []string{\"\"},\n        },\n        NotBefore:             time.Now(),\n        NotAfter:              time.Now().AddDate(10, 0, 0),\n        SubjectKeyId:          []byte{1, 2, 3, 4, 5},\n        BasicConstraintsValid: true,\n        IsCA:                  true,\n        ExtKeyUsage:           []x509.ExtKeyUsage{x509.ExtKeyUsageClientAuth, x509.ExtKeyUsageServerAuth},\n        KeyUsage:              x509.KeyUsageDigitalSignature | x509.KeyUsageCertSign,\n    }\n    //  rsa \n    caSelfSignedPrivateKey, _ := rsa.GenerateKey(rand.Reader, 1024)\n    caSelfSignedPublicKey := &caSelfSignedPrivateKey.PublicKey\n    //  []byte\n    caSelfSigned, err := x509.CreateCertificate(rand.Reader, ca, ca, caSelfSignedPublicKey, caSelfSignedPrivateKey)\n    if err != nil {\n        log.Println(\"create ca failed\", err)\n        return\n    }\n    caSelfSignedFile := \"ca.pem\"\n    log.Println(\"write to\", caSelfSignedFile)\n    ioutil.WriteFile(caSelfSignedFile, caSelfSigned, 0777) // \n\n    caSelfSignedPrivateKeyFile := \"ca.key\"\n    caSelfSignedPrivateKeyDER := x509.MarshalPKCS1PrivateKey(caSelfSignedPrivateKey) //  DER \n    log.Println(\"write to\", caSelfSignedPrivateKeyFile)\n    ioutil.WriteFile(caSelfSignedPrivateKeyFile, caSelfSignedPrivateKeyDER, 0777) //  DER \n\n    // \n    cert := &x509.Certificate{\n        SerialNumber: big.NewInt(1658),\n        Subject: pkix.Name{\n            Country:            []string{\"China\"},\n            Organization:       []string{\"\"},\n            OrganizationalUnit: []string{\"\"},\n        },\n        NotBefore:    time.Now(),\n        NotAfter:     time.Now().AddDate(10, 0, 0),\n        SubjectKeyId: []byte{1, 2, 3, 4, 6},\n        ExtKeyUsage:  []x509.ExtKeyUsage{x509.ExtKeyUsageClientAuth, x509.ExtKeyUsageServerAuth},\n        KeyUsage:     x509.KeyUsageDigitalSignature | x509.KeyUsageCertSign,\n    }\n    certPrivateKey, _ := rsa.GenerateKey(rand.Reader, 1024)\n    certPublicKey := &certPrivateKey.PublicKey\n\n    // CA  \n    certSigned, err2 := x509.CreateCertificate(rand.Reader, cert, ca, certPublicKey, caSelfSignedPrivateKey)\n    if err != nil {\n        log.Println(\"create cert2 failed\", err2)\n        return\n    }\n\n    certFile := \"cert.pem\"\n    log.Println(\"write to\", certFile)\n    ioutil.WriteFile(certFile, certSigned, 0777) // cert \n\n    certPrivateKeyFile := \"cert.key\"\n    certPrivateKeyDER := x509.MarshalPKCS1PrivateKey(certPrivateKey) //  DER \n    log.Println(\"write to\", certPrivateKeyFile)\n    ioutil.WriteFile(certPrivateKeyFile, certPrivateKeyDER, 0777) // \n\n    ca_tr, _ := x509.ParseCertificate(caSelfSigned)\n    cert_tr, _ := x509.ParseCertificate(certSigned)\n    err = cert_tr.CheckSignatureFrom(ca_tr)\n    log.Println(\"check signature\", err)\n}\n```\n","slug":"go-study-notes-package-x509","published":1,"date":"2020-05-22T13:25:30.928Z","updated":"2020-05-22T13:26:32.411Z","_id":"ckai8moy8000cgcu7f9pr1h6n","comments":1,"layout":"post","photos":[],"link":"","content":"<p><code>crypto/x509</code>  X.509 .</p>\n<p><code>crypto/x509/pkix</code>  X.509 ,CRL  OCSP  ASN.1 </p>\n<p> Unix , SSL_CERT_FILE  SSL_CERT_DIR </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// certificates </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> CertPool <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// X509 </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Certificate <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  subject , CN,O,L,S,C</span></span><br><span class=\"line\">    Subject pkix.Name</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// key </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ExtKeyUsage <span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"comment\">// Key </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> KeyUsage <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> CertificateRequest <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Signature          []<span class=\"keyword\">byte</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SignatureAlgorithm SignatureAlgorithm</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    PublicKeyAlgorithm PublicKeyAlgorithm</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    PublicKey          <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">//  subject</span></span><br><span class=\"line\">    Subject pkix.Name</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> VerifyOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    DNSName       <span class=\"keyword\">string</span></span><br><span class=\"line\">    Intermediates *CertPool</span><br><span class=\"line\">    Roots         *CertPool <span class=\"comment\">// </span></span><br><span class=\"line\">    CurrentTime   time.Time <span class=\"comment\">// </span></span><br><span class=\"line\">    KeyUsages []ExtKeyUsage</span><br><span class=\"line\">    MaxConstraintComparisions <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    UnknownPublicKeyAlgorithm PublicKeyAlgorithm = <span class=\"literal\">iota</span></span><br><span class=\"line\">    RSA</span><br><span class=\"line\">    DSA</span><br><span class=\"line\">    ECDSA</span><br><span class=\"line\">    Ed25519</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    UnknownSignatureAlgorithm SignatureAlgorithm = <span class=\"literal\">iota</span></span><br><span class=\"line\">    MD2WithRSA</span><br><span class=\"line\">    MD5WithRSA</span><br><span class=\"line\">    SHA1WithRSA</span><br><span class=\"line\">    SHA256WithRSA</span><br><span class=\"line\">    SHA384WithRSA</span><br><span class=\"line\">    SHA512WithRSA</span><br><span class=\"line\">    DSAWithSHA1</span><br><span class=\"line\">    DSAWithSHA256</span><br><span class=\"line\">    ECDSAWithSHA1</span><br><span class=\"line\">    ECDSAWithSHA256</span><br><span class=\"line\">    ECDSAWithSHA384</span><br><span class=\"line\">    ECDSAWithSHA512</span><br><span class=\"line\">    SHA256WithRSAPSS</span><br><span class=\"line\">    SHA384WithRSAPSS</span><br><span class=\"line\">    SHA512WithRSAPSS</span><br><span class=\"line\">    PureEd25519</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">//  Key </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    ExtKeyUsageAny ExtKeyUsage = <span class=\"literal\">iota</span></span><br><span class=\"line\">    ExtKeyUsageServerAuth</span><br><span class=\"line\">    ExtKeyUsageClientAuth</span><br><span class=\"line\">    ExtKeyUsageCodeSigning</span><br><span class=\"line\">    ExtKeyUsageEmailProtection</span><br><span class=\"line\">    ExtKeyUsageIPSECEndSystem</span><br><span class=\"line\">    ExtKeyUsageIPSECTunnel</span><br><span class=\"line\">    ExtKeyUsageIPSECUser</span><br><span class=\"line\">    ExtKeyUsageTimeStamping</span><br><span class=\"line\">    ExtKeyUsageOCSPSigning</span><br><span class=\"line\">    ExtKeyUsageMicrosoftServerGatedCrypto</span><br><span class=\"line\">    ExtKeyUsageNetscapeServerGatedCrypto</span><br><span class=\"line\">    ExtKeyUsageMicrosoftCommercialCodeSigning</span><br><span class=\"line\">    ExtKeyUsageMicrosoftKernelCodeSigning</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// key </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    KeyUsageDigitalSignature KeyUsage = <span class=\"number\">1</span> &lt;&lt; <span class=\"literal\">iota</span></span><br><span class=\"line\">    KeyUsageContentCommitment</span><br><span class=\"line\">    KeyUsageKeyEncipherment</span><br><span class=\"line\">    KeyUsageDataEncipherment</span><br><span class=\"line\">    KeyUsageKeyAgreement</span><br><span class=\"line\">    KeyUsageCertSign</span><br><span class=\"line\">    KeyUsageCRLSign</span><br><span class=\"line\">    KeyUsageEncipherOnly</span><br><span class=\"line\">    KeyUsageDecipherOnly</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"x509-\"><a href=\"#x509-\" class=\"headerlink\" title=\"x509 \"></a><code>x509</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  template  parent  X509 v3 . DER </span></span><br><span class=\"line\"><span class=\"comment\">//  parent=template,.</span></span><br><span class=\"line\"><span class=\"comment\">//  AuthorityKeyId  SubjectKeyId , template </span></span><br><span class=\"line\"><span class=\"comment\">// pub,priv , priv  `crypto.Signal`  `PrivateKey` . *rsa.PublicKey,*ecdsa.PublicKey  *ed25519.PublicKey.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">CreateCertificate</span><span class=\"params\">(rand io.Reader, template, parent *Certificate, pub, priv <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(cert []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  template </span></span><br><span class=\"line\"><span class=\"comment\">// priv  CSR , CSR ,priv  `crypto.Signal` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">CreateCertificateRequest</span><span class=\"params\">(rand io.Reader, template *CertificateRequest, priv <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(csr []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  password  PEM , DER </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DecryptPEMBlock</span><span class=\"params\">(b *pem.Block, password []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  alg  password  DER  data . PEM </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">EncryptPEMBlock</span><span class=\"params\">(rand io.Reader, blockType <span class=\"keyword\">string</span>, data, password []<span class=\"keyword\">byte</span>, alg PEMCipher)</span> <span class=\"params\">(*pem.Block, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  PEM </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsEncryptedPEMBlock</span><span class=\"params\">(b *pem.Block)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  CertPool</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCertPool</span><span class=\"params\">()</span> *<span class=\"title\">CertPool</span></span></span><br><span class=\"line\"><span class=\"comment\">// .CertPool </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SystemCertPool</span><span class=\"params\">()</span> <span class=\"params\">(*CertPool, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  ASN.1 .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseCertificate</span><span class=\"params\">(asn1Data []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(*Certificate, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseCertificates</span><span class=\"params\">(asn1Data []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]*Certificate, error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"CertPool-\"><a href=\"#CertPool-\" class=\"headerlink\" title=\"CertPool \"></a><code>CertPool</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *CertPool)</span> <span class=\"title\">AddCert</span><span class=\"params\">(cert *Certificate)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  PEM ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *CertPool)</span> <span class=\"title\">AppendCertsFromPEM</span><span class=\"params\">(pemCerts []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(ok <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  DER  subject </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *CertPool)</span> <span class=\"title\">Subjects</span><span class=\"params\">()</span> [][]<span class=\"title\">byte</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Certificate-\"><a href=\"#Certificate-\" class=\"headerlink\" title=\"Certificate \"></a><code>Certificate</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  crl  c</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">CheckCRLSignature</span><span class=\"params\">(crl *pkix.CertificateList)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  algo  signature  c  signed </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">CheckSignature</span><span class=\"params\">(algo SignatureAlgorithm, signed, signature []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  c  parent </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">CheckSignatureFrom</span><span class=\"params\">(parent *Certificate)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  DER  CRL ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">CreateCRL</span><span class=\"params\">(rand io.Reader, priv <span class=\"keyword\">interface</span>&#123;&#125;, revokedCerts []pkix.RevokedCertificate, now, expiry time.Time)</span> <span class=\"params\">(crlBytes []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  opts.Roots , c</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">Verify</span><span class=\"params\">(opts VerifyOptions)</span> <span class=\"params\">(chains [][]*Certificate, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  c </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">VerifyHostname</span><span class=\"params\">(h <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\",\"></a>,</h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rsa\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/x509\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/x509/pkix\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"math/big\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ca </span></span><br><span class=\"line\">    ca := &amp;x509.Certificate&#123;</span><br><span class=\"line\">        SerialNumber: big.NewInt(<span class=\"number\">1653</span>),</span><br><span class=\"line\">        Subject: pkix.Name&#123;</span><br><span class=\"line\">            Country:            []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"China\"</span>&#125;,</span><br><span class=\"line\">            Organization:       []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">            OrganizationalUnit: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        NotBefore:             time.Now(),</span><br><span class=\"line\">        NotAfter:              time.Now().AddDate(<span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">        SubjectKeyId:          []<span class=\"keyword\">byte</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>&#125;,</span><br><span class=\"line\">        BasicConstraintsValid: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        IsCA:                  <span class=\"literal\">true</span>,</span><br><span class=\"line\">        ExtKeyUsage:           []x509.ExtKeyUsage&#123;x509.ExtKeyUsageClientAuth, x509.ExtKeyUsageServerAuth&#125;,</span><br><span class=\"line\">        KeyUsage:              x509.KeyUsageDigitalSignature | x509.KeyUsageCertSign,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  rsa </span></span><br><span class=\"line\">    caSelfSignedPrivateKey, _ := rsa.GenerateKey(rand.Reader, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    caSelfSignedPublicKey := &amp;caSelfSignedPrivateKey.PublicKey</span><br><span class=\"line\">    <span class=\"comment\">//  []byte</span></span><br><span class=\"line\">    caSelfSigned, err := x509.CreateCertificate(rand.Reader, ca, ca, caSelfSignedPublicKey, caSelfSignedPrivateKey)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Println(<span class=\"string\">\"create ca failed\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    caSelfSignedFile := <span class=\"string\">\"ca.pem\"</span></span><br><span class=\"line\">    log.Println(<span class=\"string\">\"write to\"</span>, caSelfSignedFile)</span><br><span class=\"line\">    ioutil.WriteFile(caSelfSignedFile, caSelfSigned, <span class=\"number\">0777</span>) <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    caSelfSignedPrivateKeyFile := <span class=\"string\">\"ca.key\"</span></span><br><span class=\"line\">    caSelfSignedPrivateKeyDER := x509.MarshalPKCS1PrivateKey(caSelfSignedPrivateKey) <span class=\"comment\">//  DER </span></span><br><span class=\"line\">    log.Println(<span class=\"string\">\"write to\"</span>, caSelfSignedPrivateKeyFile)</span><br><span class=\"line\">    ioutil.WriteFile(caSelfSignedPrivateKeyFile, caSelfSignedPrivateKeyDER, <span class=\"number\">0777</span>) <span class=\"comment\">//  DER </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    cert := &amp;x509.Certificate&#123;</span><br><span class=\"line\">        SerialNumber: big.NewInt(<span class=\"number\">1658</span>),</span><br><span class=\"line\">        Subject: pkix.Name&#123;</span><br><span class=\"line\">            Country:            []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"China\"</span>&#125;,</span><br><span class=\"line\">            Organization:       []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">            OrganizationalUnit: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        NotBefore:    time.Now(),</span><br><span class=\"line\">        NotAfter:     time.Now().AddDate(<span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">        SubjectKeyId: []<span class=\"keyword\">byte</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>&#125;,</span><br><span class=\"line\">        ExtKeyUsage:  []x509.ExtKeyUsage&#123;x509.ExtKeyUsageClientAuth, x509.ExtKeyUsageServerAuth&#125;,</span><br><span class=\"line\">        KeyUsage:     x509.KeyUsageDigitalSignature | x509.KeyUsageCertSign,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    certPrivateKey, _ := rsa.GenerateKey(rand.Reader, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    certPublicKey := &amp;certPrivateKey.PublicKey</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// CA  </span></span><br><span class=\"line\">    certSigned, err2 := x509.CreateCertificate(rand.Reader, cert, ca, certPublicKey, caSelfSignedPrivateKey)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Println(<span class=\"string\">\"create cert2 failed\"</span>, err2)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    certFile := <span class=\"string\">\"cert.pem\"</span></span><br><span class=\"line\">    log.Println(<span class=\"string\">\"write to\"</span>, certFile)</span><br><span class=\"line\">    ioutil.WriteFile(certFile, certSigned, <span class=\"number\">0777</span>) <span class=\"comment\">// cert </span></span><br><span class=\"line\"></span><br><span class=\"line\">    certPrivateKeyFile := <span class=\"string\">\"cert.key\"</span></span><br><span class=\"line\">    certPrivateKeyDER := x509.MarshalPKCS1PrivateKey(certPrivateKey) <span class=\"comment\">//  DER </span></span><br><span class=\"line\">    log.Println(<span class=\"string\">\"write to\"</span>, certPrivateKeyFile)</span><br><span class=\"line\">    ioutil.WriteFile(certPrivateKeyFile, certPrivateKeyDER, <span class=\"number\">0777</span>) <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    ca_tr, _ := x509.ParseCertificate(caSelfSigned)</span><br><span class=\"line\">    cert_tr, _ := x509.ParseCertificate(certSigned)</span><br><span class=\"line\">    err = cert_tr.CheckSignatureFrom(ca_tr)</span><br><span class=\"line\">    log.Println(<span class=\"string\">\"check signature\"</span>, err)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><code>crypto/x509</code>  X.509 .</p>\n<p><code>crypto/x509/pkix</code>  X.509 ,CRL  OCSP  ASN.1 </p>\n<p> Unix , SSL_CERT_FILE  SSL_CERT_DIR </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// certificates </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> CertPool <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// X509 </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Certificate <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  subject , CN,O,L,S,C</span></span><br><span class=\"line\">    Subject pkix.Name</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// key </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ExtKeyUsage <span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"comment\">// Key </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> KeyUsage <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> CertificateRequest <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Signature          []<span class=\"keyword\">byte</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SignatureAlgorithm SignatureAlgorithm</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    PublicKeyAlgorithm PublicKeyAlgorithm</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    PublicKey          <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">//  subject</span></span><br><span class=\"line\">    Subject pkix.Name</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> VerifyOptions <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    DNSName       <span class=\"keyword\">string</span></span><br><span class=\"line\">    Intermediates *CertPool</span><br><span class=\"line\">    Roots         *CertPool <span class=\"comment\">// </span></span><br><span class=\"line\">    CurrentTime   time.Time <span class=\"comment\">// </span></span><br><span class=\"line\">    KeyUsages []ExtKeyUsage</span><br><span class=\"line\">    MaxConstraintComparisions <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    UnknownPublicKeyAlgorithm PublicKeyAlgorithm = <span class=\"literal\">iota</span></span><br><span class=\"line\">    RSA</span><br><span class=\"line\">    DSA</span><br><span class=\"line\">    ECDSA</span><br><span class=\"line\">    Ed25519</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    UnknownSignatureAlgorithm SignatureAlgorithm = <span class=\"literal\">iota</span></span><br><span class=\"line\">    MD2WithRSA</span><br><span class=\"line\">    MD5WithRSA</span><br><span class=\"line\">    SHA1WithRSA</span><br><span class=\"line\">    SHA256WithRSA</span><br><span class=\"line\">    SHA384WithRSA</span><br><span class=\"line\">    SHA512WithRSA</span><br><span class=\"line\">    DSAWithSHA1</span><br><span class=\"line\">    DSAWithSHA256</span><br><span class=\"line\">    ECDSAWithSHA1</span><br><span class=\"line\">    ECDSAWithSHA256</span><br><span class=\"line\">    ECDSAWithSHA384</span><br><span class=\"line\">    ECDSAWithSHA512</span><br><span class=\"line\">    SHA256WithRSAPSS</span><br><span class=\"line\">    SHA384WithRSAPSS</span><br><span class=\"line\">    SHA512WithRSAPSS</span><br><span class=\"line\">    PureEd25519</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">//  Key </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    ExtKeyUsageAny ExtKeyUsage = <span class=\"literal\">iota</span></span><br><span class=\"line\">    ExtKeyUsageServerAuth</span><br><span class=\"line\">    ExtKeyUsageClientAuth</span><br><span class=\"line\">    ExtKeyUsageCodeSigning</span><br><span class=\"line\">    ExtKeyUsageEmailProtection</span><br><span class=\"line\">    ExtKeyUsageIPSECEndSystem</span><br><span class=\"line\">    ExtKeyUsageIPSECTunnel</span><br><span class=\"line\">    ExtKeyUsageIPSECUser</span><br><span class=\"line\">    ExtKeyUsageTimeStamping</span><br><span class=\"line\">    ExtKeyUsageOCSPSigning</span><br><span class=\"line\">    ExtKeyUsageMicrosoftServerGatedCrypto</span><br><span class=\"line\">    ExtKeyUsageNetscapeServerGatedCrypto</span><br><span class=\"line\">    ExtKeyUsageMicrosoftCommercialCodeSigning</span><br><span class=\"line\">    ExtKeyUsageMicrosoftKernelCodeSigning</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// key </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    KeyUsageDigitalSignature KeyUsage = <span class=\"number\">1</span> &lt;&lt; <span class=\"literal\">iota</span></span><br><span class=\"line\">    KeyUsageContentCommitment</span><br><span class=\"line\">    KeyUsageKeyEncipherment</span><br><span class=\"line\">    KeyUsageDataEncipherment</span><br><span class=\"line\">    KeyUsageKeyAgreement</span><br><span class=\"line\">    KeyUsageCertSign</span><br><span class=\"line\">    KeyUsageCRLSign</span><br><span class=\"line\">    KeyUsageEncipherOnly</span><br><span class=\"line\">    KeyUsageDecipherOnly</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"x509-\"><a href=\"#x509-\" class=\"headerlink\" title=\"x509 \"></a><code>x509</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  template  parent  X509 v3 . DER </span></span><br><span class=\"line\"><span class=\"comment\">//  parent=template,.</span></span><br><span class=\"line\"><span class=\"comment\">//  AuthorityKeyId  SubjectKeyId , template </span></span><br><span class=\"line\"><span class=\"comment\">// pub,priv , priv  `crypto.Signal`  `PrivateKey` . *rsa.PublicKey,*ecdsa.PublicKey  *ed25519.PublicKey.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">CreateCertificate</span><span class=\"params\">(rand io.Reader, template, parent *Certificate, pub, priv <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(cert []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  template </span></span><br><span class=\"line\"><span class=\"comment\">// priv  CSR , CSR ,priv  `crypto.Signal` </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">CreateCertificateRequest</span><span class=\"params\">(rand io.Reader, template *CertificateRequest, priv <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(csr []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  password  PEM , DER </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DecryptPEMBlock</span><span class=\"params\">(b *pem.Block, password []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  alg  password  DER  data . PEM </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">EncryptPEMBlock</span><span class=\"params\">(rand io.Reader, blockType <span class=\"keyword\">string</span>, data, password []<span class=\"keyword\">byte</span>, alg PEMCipher)</span> <span class=\"params\">(*pem.Block, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  PEM </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsEncryptedPEMBlock</span><span class=\"params\">(b *pem.Block)</span> <span class=\"title\">bool</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  CertPool</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewCertPool</span><span class=\"params\">()</span> *<span class=\"title\">CertPool</span></span></span><br><span class=\"line\"><span class=\"comment\">// .CertPool </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">SystemCertPool</span><span class=\"params\">()</span> <span class=\"params\">(*CertPool, error)</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  ASN.1 .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseCertificate</span><span class=\"params\">(asn1Data []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(*Certificate, error)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ParseCertificates</span><span class=\"params\">(asn1Data []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">([]*Certificate, error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"CertPool-\"><a href=\"#CertPool-\" class=\"headerlink\" title=\"CertPool \"></a><code>CertPool</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *CertPool)</span> <span class=\"title\">AddCert</span><span class=\"params\">(cert *Certificate)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  PEM ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *CertPool)</span> <span class=\"title\">AppendCertsFromPEM</span><span class=\"params\">(pemCerts []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(ok <span class=\"keyword\">bool</span>)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  DER  subject </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *CertPool)</span> <span class=\"title\">Subjects</span><span class=\"params\">()</span> [][]<span class=\"title\">byte</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Certificate-\"><a href=\"#Certificate-\" class=\"headerlink\" title=\"Certificate \"></a><code>Certificate</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  crl  c</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">CheckCRLSignature</span><span class=\"params\">(crl *pkix.CertificateList)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  algo  signature  c  signed </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">CheckSignature</span><span class=\"params\">(algo SignatureAlgorithm, signed, signature []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  c  parent </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">CheckSignatureFrom</span><span class=\"params\">(parent *Certificate)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  DER  CRL ,</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">CreateCRL</span><span class=\"params\">(rand io.Reader, priv <span class=\"keyword\">interface</span>&#123;&#125;, revokedCerts []pkix.RevokedCertificate, now, expiry time.Time)</span> <span class=\"params\">(crlBytes []<span class=\"keyword\">byte</span>, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  opts.Roots , c</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">Verify</span><span class=\"params\">(opts VerifyOptions)</span> <span class=\"params\">(chains [][]*Certificate, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  c </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Certificate)</span> <span class=\"title\">VerifyHostname</span><span class=\"params\">(h <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\",\"></a>,</h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"crypto/rand\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/rsa\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/x509\"</span></span><br><span class=\"line\">    <span class=\"string\">\"crypto/x509/pkix\"</span></span><br><span class=\"line\">    <span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"math/big\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ca </span></span><br><span class=\"line\">    ca := &amp;x509.Certificate&#123;</span><br><span class=\"line\">        SerialNumber: big.NewInt(<span class=\"number\">1653</span>),</span><br><span class=\"line\">        Subject: pkix.Name&#123;</span><br><span class=\"line\">            Country:            []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"China\"</span>&#125;,</span><br><span class=\"line\">            Organization:       []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">            OrganizationalUnit: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        NotBefore:             time.Now(),</span><br><span class=\"line\">        NotAfter:              time.Now().AddDate(<span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">        SubjectKeyId:          []<span class=\"keyword\">byte</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>&#125;,</span><br><span class=\"line\">        BasicConstraintsValid: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        IsCA:                  <span class=\"literal\">true</span>,</span><br><span class=\"line\">        ExtKeyUsage:           []x509.ExtKeyUsage&#123;x509.ExtKeyUsageClientAuth, x509.ExtKeyUsageServerAuth&#125;,</span><br><span class=\"line\">        KeyUsage:              x509.KeyUsageDigitalSignature | x509.KeyUsageCertSign,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  rsa </span></span><br><span class=\"line\">    caSelfSignedPrivateKey, _ := rsa.GenerateKey(rand.Reader, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    caSelfSignedPublicKey := &amp;caSelfSignedPrivateKey.PublicKey</span><br><span class=\"line\">    <span class=\"comment\">//  []byte</span></span><br><span class=\"line\">    caSelfSigned, err := x509.CreateCertificate(rand.Reader, ca, ca, caSelfSignedPublicKey, caSelfSignedPrivateKey)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Println(<span class=\"string\">\"create ca failed\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    caSelfSignedFile := <span class=\"string\">\"ca.pem\"</span></span><br><span class=\"line\">    log.Println(<span class=\"string\">\"write to\"</span>, caSelfSignedFile)</span><br><span class=\"line\">    ioutil.WriteFile(caSelfSignedFile, caSelfSigned, <span class=\"number\">0777</span>) <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    caSelfSignedPrivateKeyFile := <span class=\"string\">\"ca.key\"</span></span><br><span class=\"line\">    caSelfSignedPrivateKeyDER := x509.MarshalPKCS1PrivateKey(caSelfSignedPrivateKey) <span class=\"comment\">//  DER </span></span><br><span class=\"line\">    log.Println(<span class=\"string\">\"write to\"</span>, caSelfSignedPrivateKeyFile)</span><br><span class=\"line\">    ioutil.WriteFile(caSelfSignedPrivateKeyFile, caSelfSignedPrivateKeyDER, <span class=\"number\">0777</span>) <span class=\"comment\">//  DER </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    cert := &amp;x509.Certificate&#123;</span><br><span class=\"line\">        SerialNumber: big.NewInt(<span class=\"number\">1658</span>),</span><br><span class=\"line\">        Subject: pkix.Name&#123;</span><br><span class=\"line\">            Country:            []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"China\"</span>&#125;,</span><br><span class=\"line\">            Organization:       []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">            OrganizationalUnit: []<span class=\"keyword\">string</span>&#123;<span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        NotBefore:    time.Now(),</span><br><span class=\"line\">        NotAfter:     time.Now().AddDate(<span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">        SubjectKeyId: []<span class=\"keyword\">byte</span>&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>&#125;,</span><br><span class=\"line\">        ExtKeyUsage:  []x509.ExtKeyUsage&#123;x509.ExtKeyUsageClientAuth, x509.ExtKeyUsageServerAuth&#125;,</span><br><span class=\"line\">        KeyUsage:     x509.KeyUsageDigitalSignature | x509.KeyUsageCertSign,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    certPrivateKey, _ := rsa.GenerateKey(rand.Reader, <span class=\"number\">1024</span>)</span><br><span class=\"line\">    certPublicKey := &amp;certPrivateKey.PublicKey</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// CA  </span></span><br><span class=\"line\">    certSigned, err2 := x509.CreateCertificate(rand.Reader, cert, ca, certPublicKey, caSelfSignedPrivateKey)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Println(<span class=\"string\">\"create cert2 failed\"</span>, err2)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    certFile := <span class=\"string\">\"cert.pem\"</span></span><br><span class=\"line\">    log.Println(<span class=\"string\">\"write to\"</span>, certFile)</span><br><span class=\"line\">    ioutil.WriteFile(certFile, certSigned, <span class=\"number\">0777</span>) <span class=\"comment\">// cert </span></span><br><span class=\"line\"></span><br><span class=\"line\">    certPrivateKeyFile := <span class=\"string\">\"cert.key\"</span></span><br><span class=\"line\">    certPrivateKeyDER := x509.MarshalPKCS1PrivateKey(certPrivateKey) <span class=\"comment\">//  DER </span></span><br><span class=\"line\">    log.Println(<span class=\"string\">\"write to\"</span>, certPrivateKeyFile)</span><br><span class=\"line\">    ioutil.WriteFile(certPrivateKeyFile, certPrivateKeyDER, <span class=\"number\">0777</span>) <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    ca_tr, _ := x509.ParseCertificate(caSelfSigned)</span><br><span class=\"line\">    cert_tr, _ := x509.ParseCertificate(certSigned)</span><br><span class=\"line\">    err = cert_tr.CheckSignatureFrom(ca_tr)</span><br><span class=\"line\">    log.Println(<span class=\"string\">\"check signature\"</span>, err)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"go  tls ","abbrlink":24693,"description":" Go crypto/tls .crypto/tls  TLS1.2  TLS1.3 ","_content":"\ntls  TLS 1.2  TLS 1.3 ,,,.\n\n## \n\n```go\n// tls \ntype Certificate struct {\n    Certificate [][]byte\n    // PrivateKey  Leaf . RSA,ECDSA  Ed25519  crypto.Signer \n    //  TLS1.2 , RSA PublicKey  crypto.Decrypter \n    PrivateKey crypto.PrivateKey\n    // PrivateKey \n    SupportedSignatureAlgorithms []SignatureScheme // Go 1.14\n    //  OCSP \n    OCSPStaple []byte\n    // \n    SignedCertificateTimestamps [][]byte // Go 1.5\n    // , x509.ParseCertificate ,. nil,\n    Leaf *x509.Certificate\n}\n\n//  CertificateRequest ,\ntype CertificateRequestInfo struct {\n    // 0 DER  X.501 .\n    //  CA \n    // \n    AcceptableCAs [][]byte\n    // \n    SignatureSchemes []SignatureScheme\n    //  TLS .\n    Version uint16 // Go 1.14\n}\n\n//  TLS \ntype ClientSessionState struct {\n    // \n}\n\n//  TLS \ntype ClientAuthType int\n\n//  ClientHello \ntype ClientHelloInfo struct {\n    // \n    CipherSuites []uint16\n    //  ServerName\n    ServerName string\n\n    SupportedCurves []CurveID\n    SupportedPoints []uint8\n\n    // \n    SignatureSchemes []SignatureScheme // Go 1.8\n    // \n    SupportedProtos []string // Go 1.8\n    //  TLS \n    SupportedVersions []uint16 // Go 1.8\n    // ,net.Conn \n    Conn net.Conn // Go 1.8\n    // \n}\n\n// ClientSessionState \ntype ClientSessionCache interface {\n    // Get*ClientSessionStateok\n    Get(sessionKey string) (session *ClientSessionState, ok bool)\n    // Put*ClientSessionState\n    Put(sessionKey string, cs *ClientSessionState)\n}\n\n// tls \ntype Config struct {\n    // , `crypto/rand` \n    //  goroutine  \n    Rand io.Reader\n    // . time.Now\n    Time func() time.Time\n    // .\n    //  Certificates,GetCertificate  GetConfigForClient \n    //  Certificates  GetCertificate\n    // : , Leaf ,\n    Certificates []Certificate\n    //  Certificates \n    NameToCertificate map[string]*Certificate\n    //  ClientHelloInfo . SNI  Certificates ,\n    GetCertificate func(*ClientHelloInfo) (*Certificate, error) // Go 1.4\n    // ,.,Certificates \n    GetClientCertificate func(*CertificateRequestInfo) (*Certificate, error) // Go 1.8\n    //  ClientHello \n    GetConfigForClient func(*ClientHelloInfo) (*Config, error) // Go 1.8\n    // TLS , TLS \n    VerifyPeerCertificate func(rawCerts [][]byte, verifiedChains [][]*x509.Certificate) error // Go 1.8\n    //  CA\n    //  nil, CA \n    RootCAs *x509.CertPool\n    // \n    NextProtos []string\n    // TLS ,. InsecureSkipVerify \n    ServerName string\n    // TLS , NoClientCert,\n    ClientAuth ClientAuthType\n    // , ClientAuth ,\n    ClientCAs *x509.CertPool\n    // \n    InsecureSkipVerify bool\n    //  TLS1.2 \n    CipherSuites []uint16\n    // \n    PreferServerCipherSuites bool // Go 1.1\n    //  ticket  PSK \n    SessionTicketsDisabled bool // Go 1.1\n    //  SessionTicketKey \n    SessionTicketKey [32]byte // Go 1.1\n    //  ClientSessionState \n    ClientSessionCache ClientSessionCache // Go 1.3\n    // ,TLs 1.0 \n    MinVersion uint16 // Go 1.2\n    // ,TLS 1.3 \n    MaxVersion uint16 // Go 1.2\n\n    CurvePreferences []CurveID // Go 1.3\n    DynamicRecordSizingDisabled bool // Go 1.7\n    Renegotiation RenegotiationSupport // Go 1.7\n    KeyLogWriter io.Writer // Go 1.8\n    // \n}\n\n// . `net.Conn` \ntype Conn struct {\n    // contains filtered or unexported fields\n}\n\n// \ntype ConnectionState struct {\n    //  TLS \n    Version uint16\n    // TLS \n    HandshakeComplete bool\n    // TLS\n    DidResume bool\n    // \n    CipherSuite uint16\n    // \n    NegotiatedProtocol string\n    NegotiatedProtocolIsMutual bool\n    // \n    ServerName string\n    PeerCertificates []*x509.Certificate\n    VerifiedChains [][]*x509.Certificate\n    SignedCertificateTimestamps [][]byte\n    OCSPResponse []byte\n    TLSUnique []byte // Go 1.4\n    // \n}\n// \ntype SignatureScheme uint16\n```\n\n## \n\n```go\n// \nconst (\n    // TLS 1.0 - 1.2 cipher suites.\n    TLS_RSA_WITH_RC4_128_SHA                      uint16 = 0x0005\n    TLS_RSA_WITH_3DES_EDE_CBC_SHA                 uint16 = 0x000a\n    TLS_RSA_WITH_AES_128_CBC_SHA                  uint16 = 0x002f\n    TLS_RSA_WITH_AES_256_CBC_SHA                  uint16 = 0x0035\n    TLS_RSA_WITH_AES_128_CBC_SHA256               uint16 = 0x003c\n    TLS_RSA_WITH_AES_128_GCM_SHA256               uint16 = 0x009c\n    TLS_RSA_WITH_AES_256_GCM_SHA384               uint16 = 0x009d\n    TLS_ECDHE_ECDSA_WITH_RC4_128_SHA              uint16 = 0xc007\n    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA          uint16 = 0xc009\n    TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA          uint16 = 0xc00a\n    TLS_ECDHE_RSA_WITH_RC4_128_SHA                uint16 = 0xc011\n    TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA           uint16 = 0xc012\n    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA            uint16 = 0xc013\n    TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA            uint16 = 0xc014\n    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256       uint16 = 0xc023\n    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256         uint16 = 0xc027\n    TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256         uint16 = 0xc02f\n    TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256       uint16 = 0xc02b\n    TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384         uint16 = 0xc030\n    TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384       uint16 = 0xc02c\n    TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256   uint16 = 0xcca8\n    TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 uint16 = 0xcca9\n\n    // TLS 1.3 cipher suites.\n    TLS_AES_128_GCM_SHA256       uint16 = 0x1301\n    TLS_AES_256_GCM_SHA384       uint16 = 0x1302\n    TLS_CHACHA20_POLY1305_SHA256 uint16 = 0x1303\n\n    // TLS_FALLBACK_SCSV isn't a standard cipher suite but an indicator\n    // that the client is doing version fallback. See RFC 7507.\n    TLS_FALLBACK_SCSV uint16 = 0x5600\n\n    // Legacy names for the corresponding cipher suites with the correct _SHA256\n    // suffix, retained for backward compatibility.\n    TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305   = TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256\n    TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305 = TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256\n)\n// TLS \nconst (\n    VersionTLS10 = 0x0301\n    VersionTLS11 = 0x0302\n    VersionTLS12 = 0x0303\n    VersionTLS13 = 0x0304\n    // \n    VersionSSL30 = 0x0300\n)\n// \nconst (\n    NoClientCert ClientAuthType = iota\n    RequestClientCert\n    RequireAnyClientCert\n    VerifyClientCertIfGiven\n    RequireAndVerifyClientCert\n)\n// \nconst (\n    // RSASSA-PKCS1-v1_5 algorithms.\n    PKCS1WithSHA256 SignatureScheme = 0x0401\n    PKCS1WithSHA384 SignatureScheme = 0x0501\n    PKCS1WithSHA512 SignatureScheme = 0x0601\n\n    // RSASSA-PSS algorithms with public key OID rsaEncryption.\n    PSSWithSHA256 SignatureScheme = 0x0804\n    PSSWithSHA384 SignatureScheme = 0x0805\n    PSSWithSHA512 SignatureScheme = 0x0806\n\n    // ECDSA algorithms. Only constrained to a specific curve in TLS 1.3.\n    ECDSAWithP256AndSHA256 SignatureScheme = 0x0403\n    ECDSAWithP384AndSHA384 SignatureScheme = 0x0503\n    ECDSAWithP521AndSHA512 SignatureScheme = 0x0603\n\n    // EdDSA algorithms.\n    Ed25519 SignatureScheme = 0x0807\n\n    // Legacy signature and hash algorithms for TLS 1.2.\n    PKCS1WithSHA1 SignatureScheme = 0x0201\n    ECDSAWithSHA1 SignatureScheme = 0x0203\n)\n\n```\n\n## \n\n### `tls` \n\n```go\n//  Network  addr  TLS , config \nfunc Listen(network, laddr string, config *Config) (net.Listener, error)\n//  inner ,.\nfunc NewListener(inner net.Listener, config *Config) net.Listener\n// .  pem .\nfunc LoadX509KeyPair(certFile, keyFile string) (cert Certificate, err error)\n//  pem .\nfunc X509KeyPair(certPEMBlock, keyPEMBlock []byte) (cert Certificate, err error)\n//  LRU()  ClientSessionState. capacity<1 \nfunc NewLRUClientSessionCache(capacity int) ClientSessionCache\n\n//  conn  TL S.config  nil  ServerName  InsecureSkipVerify \nfunc Client(conn net.Conn, config *Config) *Conn\n//  conn  TLS .config  nil \nfunc Server(conn net.Conn, config *Config) *Conn\n//  net.Dial  network() addr(), config  TLS . TLS \nfunc Dial(network, addr string, config *Config) (*Conn, error)\n//  net.Dialer , TLS , TLS \nfunc DialWithDialer(dialer *net.Dialer, network, addr string, config *Config) (*Conn, error)\n```\n\n### `Conn` \n\n```go\n// \nfunc (c *Conn) Close() error\n// \nfunc (c *Conn) ConnectionState() ConnectionState\n// ., Read  Write \nfunc (c *Conn) Handshake() error\n// \nfunc (c *Conn) LocalAddr() net.Addr\n//  TLS  OCSP \nfunc (c *Conn) OCSPResponse() []byte\n//  b. net.Error\nfunc (c *Conn) Read(b []byte) (int, error)\n// \nfunc (c *Conn) RemoteAddr() net.Addr\n// .t=0\nfunc (c *Conn) SetDeadline(t time.Time) error\nfunc (c *Conn) SetReadDeadline(t time.Time) error\nfunc (c *Conn) SetWriteDeadline(t time.Time) error\n//  host .\nfunc (c *Conn) VerifyHostname(host string) error\n// \nfunc (c *Conn) Write(b []byte) (int, error)\n```\n","source":"_posts/go-study-notes-package-tls.md","raw":"---\ntitle: go  tls \ntags:\n  - go\n  - \ncategories:\n  - go\nabbrlink: 24693\ndescription:  Go crypto/tls .crypto/tls  TLS1.2  TLS1.3 \n---\n\ntls  TLS 1.2  TLS 1.3 ,,,.\n\n## \n\n```go\n// tls \ntype Certificate struct {\n    Certificate [][]byte\n    // PrivateKey  Leaf . RSA,ECDSA  Ed25519  crypto.Signer \n    //  TLS1.2 , RSA PublicKey  crypto.Decrypter \n    PrivateKey crypto.PrivateKey\n    // PrivateKey \n    SupportedSignatureAlgorithms []SignatureScheme // Go 1.14\n    //  OCSP \n    OCSPStaple []byte\n    // \n    SignedCertificateTimestamps [][]byte // Go 1.5\n    // , x509.ParseCertificate ,. nil,\n    Leaf *x509.Certificate\n}\n\n//  CertificateRequest ,\ntype CertificateRequestInfo struct {\n    // 0 DER  X.501 .\n    //  CA \n    // \n    AcceptableCAs [][]byte\n    // \n    SignatureSchemes []SignatureScheme\n    //  TLS .\n    Version uint16 // Go 1.14\n}\n\n//  TLS \ntype ClientSessionState struct {\n    // \n}\n\n//  TLS \ntype ClientAuthType int\n\n//  ClientHello \ntype ClientHelloInfo struct {\n    // \n    CipherSuites []uint16\n    //  ServerName\n    ServerName string\n\n    SupportedCurves []CurveID\n    SupportedPoints []uint8\n\n    // \n    SignatureSchemes []SignatureScheme // Go 1.8\n    // \n    SupportedProtos []string // Go 1.8\n    //  TLS \n    SupportedVersions []uint16 // Go 1.8\n    // ,net.Conn \n    Conn net.Conn // Go 1.8\n    // \n}\n\n// ClientSessionState \ntype ClientSessionCache interface {\n    // Get*ClientSessionStateok\n    Get(sessionKey string) (session *ClientSessionState, ok bool)\n    // Put*ClientSessionState\n    Put(sessionKey string, cs *ClientSessionState)\n}\n\n// tls \ntype Config struct {\n    // , `crypto/rand` \n    //  goroutine  \n    Rand io.Reader\n    // . time.Now\n    Time func() time.Time\n    // .\n    //  Certificates,GetCertificate  GetConfigForClient \n    //  Certificates  GetCertificate\n    // : , Leaf ,\n    Certificates []Certificate\n    //  Certificates \n    NameToCertificate map[string]*Certificate\n    //  ClientHelloInfo . SNI  Certificates ,\n    GetCertificate func(*ClientHelloInfo) (*Certificate, error) // Go 1.4\n    // ,.,Certificates \n    GetClientCertificate func(*CertificateRequestInfo) (*Certificate, error) // Go 1.8\n    //  ClientHello \n    GetConfigForClient func(*ClientHelloInfo) (*Config, error) // Go 1.8\n    // TLS , TLS \n    VerifyPeerCertificate func(rawCerts [][]byte, verifiedChains [][]*x509.Certificate) error // Go 1.8\n    //  CA\n    //  nil, CA \n    RootCAs *x509.CertPool\n    // \n    NextProtos []string\n    // TLS ,. InsecureSkipVerify \n    ServerName string\n    // TLS , NoClientCert,\n    ClientAuth ClientAuthType\n    // , ClientAuth ,\n    ClientCAs *x509.CertPool\n    // \n    InsecureSkipVerify bool\n    //  TLS1.2 \n    CipherSuites []uint16\n    // \n    PreferServerCipherSuites bool // Go 1.1\n    //  ticket  PSK \n    SessionTicketsDisabled bool // Go 1.1\n    //  SessionTicketKey \n    SessionTicketKey [32]byte // Go 1.1\n    //  ClientSessionState \n    ClientSessionCache ClientSessionCache // Go 1.3\n    // ,TLs 1.0 \n    MinVersion uint16 // Go 1.2\n    // ,TLS 1.3 \n    MaxVersion uint16 // Go 1.2\n\n    CurvePreferences []CurveID // Go 1.3\n    DynamicRecordSizingDisabled bool // Go 1.7\n    Renegotiation RenegotiationSupport // Go 1.7\n    KeyLogWriter io.Writer // Go 1.8\n    // \n}\n\n// . `net.Conn` \ntype Conn struct {\n    // contains filtered or unexported fields\n}\n\n// \ntype ConnectionState struct {\n    //  TLS \n    Version uint16\n    // TLS \n    HandshakeComplete bool\n    // TLS\n    DidResume bool\n    // \n    CipherSuite uint16\n    // \n    NegotiatedProtocol string\n    NegotiatedProtocolIsMutual bool\n    // \n    ServerName string\n    PeerCertificates []*x509.Certificate\n    VerifiedChains [][]*x509.Certificate\n    SignedCertificateTimestamps [][]byte\n    OCSPResponse []byte\n    TLSUnique []byte // Go 1.4\n    // \n}\n// \ntype SignatureScheme uint16\n```\n\n## \n\n```go\n// \nconst (\n    // TLS 1.0 - 1.2 cipher suites.\n    TLS_RSA_WITH_RC4_128_SHA                      uint16 = 0x0005\n    TLS_RSA_WITH_3DES_EDE_CBC_SHA                 uint16 = 0x000a\n    TLS_RSA_WITH_AES_128_CBC_SHA                  uint16 = 0x002f\n    TLS_RSA_WITH_AES_256_CBC_SHA                  uint16 = 0x0035\n    TLS_RSA_WITH_AES_128_CBC_SHA256               uint16 = 0x003c\n    TLS_RSA_WITH_AES_128_GCM_SHA256               uint16 = 0x009c\n    TLS_RSA_WITH_AES_256_GCM_SHA384               uint16 = 0x009d\n    TLS_ECDHE_ECDSA_WITH_RC4_128_SHA              uint16 = 0xc007\n    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA          uint16 = 0xc009\n    TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA          uint16 = 0xc00a\n    TLS_ECDHE_RSA_WITH_RC4_128_SHA                uint16 = 0xc011\n    TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA           uint16 = 0xc012\n    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA            uint16 = 0xc013\n    TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA            uint16 = 0xc014\n    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256       uint16 = 0xc023\n    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256         uint16 = 0xc027\n    TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256         uint16 = 0xc02f\n    TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256       uint16 = 0xc02b\n    TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384         uint16 = 0xc030\n    TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384       uint16 = 0xc02c\n    TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256   uint16 = 0xcca8\n    TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 uint16 = 0xcca9\n\n    // TLS 1.3 cipher suites.\n    TLS_AES_128_GCM_SHA256       uint16 = 0x1301\n    TLS_AES_256_GCM_SHA384       uint16 = 0x1302\n    TLS_CHACHA20_POLY1305_SHA256 uint16 = 0x1303\n\n    // TLS_FALLBACK_SCSV isn't a standard cipher suite but an indicator\n    // that the client is doing version fallback. See RFC 7507.\n    TLS_FALLBACK_SCSV uint16 = 0x5600\n\n    // Legacy names for the corresponding cipher suites with the correct _SHA256\n    // suffix, retained for backward compatibility.\n    TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305   = TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256\n    TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305 = TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256\n)\n// TLS \nconst (\n    VersionTLS10 = 0x0301\n    VersionTLS11 = 0x0302\n    VersionTLS12 = 0x0303\n    VersionTLS13 = 0x0304\n    // \n    VersionSSL30 = 0x0300\n)\n// \nconst (\n    NoClientCert ClientAuthType = iota\n    RequestClientCert\n    RequireAnyClientCert\n    VerifyClientCertIfGiven\n    RequireAndVerifyClientCert\n)\n// \nconst (\n    // RSASSA-PKCS1-v1_5 algorithms.\n    PKCS1WithSHA256 SignatureScheme = 0x0401\n    PKCS1WithSHA384 SignatureScheme = 0x0501\n    PKCS1WithSHA512 SignatureScheme = 0x0601\n\n    // RSASSA-PSS algorithms with public key OID rsaEncryption.\n    PSSWithSHA256 SignatureScheme = 0x0804\n    PSSWithSHA384 SignatureScheme = 0x0805\n    PSSWithSHA512 SignatureScheme = 0x0806\n\n    // ECDSA algorithms. Only constrained to a specific curve in TLS 1.3.\n    ECDSAWithP256AndSHA256 SignatureScheme = 0x0403\n    ECDSAWithP384AndSHA384 SignatureScheme = 0x0503\n    ECDSAWithP521AndSHA512 SignatureScheme = 0x0603\n\n    // EdDSA algorithms.\n    Ed25519 SignatureScheme = 0x0807\n\n    // Legacy signature and hash algorithms for TLS 1.2.\n    PKCS1WithSHA1 SignatureScheme = 0x0201\n    ECDSAWithSHA1 SignatureScheme = 0x0203\n)\n\n```\n\n## \n\n### `tls` \n\n```go\n//  Network  addr  TLS , config \nfunc Listen(network, laddr string, config *Config) (net.Listener, error)\n//  inner ,.\nfunc NewListener(inner net.Listener, config *Config) net.Listener\n// .  pem .\nfunc LoadX509KeyPair(certFile, keyFile string) (cert Certificate, err error)\n//  pem .\nfunc X509KeyPair(certPEMBlock, keyPEMBlock []byte) (cert Certificate, err error)\n//  LRU()  ClientSessionState. capacity<1 \nfunc NewLRUClientSessionCache(capacity int) ClientSessionCache\n\n//  conn  TL S.config  nil  ServerName  InsecureSkipVerify \nfunc Client(conn net.Conn, config *Config) *Conn\n//  conn  TLS .config  nil \nfunc Server(conn net.Conn, config *Config) *Conn\n//  net.Dial  network() addr(), config  TLS . TLS \nfunc Dial(network, addr string, config *Config) (*Conn, error)\n//  net.Dialer , TLS , TLS \nfunc DialWithDialer(dialer *net.Dialer, network, addr string, config *Config) (*Conn, error)\n```\n\n### `Conn` \n\n```go\n// \nfunc (c *Conn) Close() error\n// \nfunc (c *Conn) ConnectionState() ConnectionState\n// ., Read  Write \nfunc (c *Conn) Handshake() error\n// \nfunc (c *Conn) LocalAddr() net.Addr\n//  TLS  OCSP \nfunc (c *Conn) OCSPResponse() []byte\n//  b. net.Error\nfunc (c *Conn) Read(b []byte) (int, error)\n// \nfunc (c *Conn) RemoteAddr() net.Addr\n// .t=0\nfunc (c *Conn) SetDeadline(t time.Time) error\nfunc (c *Conn) SetReadDeadline(t time.Time) error\nfunc (c *Conn) SetWriteDeadline(t time.Time) error\n//  host .\nfunc (c *Conn) VerifyHostname(host string) error\n// \nfunc (c *Conn) Write(b []byte) (int, error)\n```\n","slug":"go-study-notes-package-tls","published":1,"date":"2020-05-22T13:25:30.974Z","updated":"2020-05-22T13:26:32.417Z","_id":"ckai8moy9000dgcu75uzy2qu3","comments":1,"layout":"post","photos":[],"link":"","content":"<p>tls  TLS 1.2  TLS 1.3 ,,,.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// tls </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Certificate <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Certificate [][]<span class=\"keyword\">byte</span></span><br><span class=\"line\">    <span class=\"comment\">// PrivateKey  Leaf . RSA,ECDSA  Ed25519  crypto.Signer </span></span><br><span class=\"line\">    <span class=\"comment\">//  TLS1.2 , RSA PublicKey  crypto.Decrypter </span></span><br><span class=\"line\">    PrivateKey crypto.PrivateKey</span><br><span class=\"line\">    <span class=\"comment\">// PrivateKey </span></span><br><span class=\"line\">    SupportedSignatureAlgorithms []SignatureScheme <span class=\"comment\">// Go 1.14</span></span><br><span class=\"line\">    <span class=\"comment\">//  OCSP </span></span><br><span class=\"line\">    OCSPStaple []<span class=\"keyword\">byte</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SignedCertificateTimestamps [][]<span class=\"keyword\">byte</span> <span class=\"comment\">// Go 1.5</span></span><br><span class=\"line\">    <span class=\"comment\">// , x509.ParseCertificate ,. nil,</span></span><br><span class=\"line\">    Leaf *x509.Certificate</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  CertificateRequest ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> CertificateRequestInfo <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 0 DER  X.501 .</span></span><br><span class=\"line\">    <span class=\"comment\">//  CA </span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    AcceptableCAs [][]<span class=\"keyword\">byte</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SignatureSchemes []SignatureScheme</span><br><span class=\"line\">    <span class=\"comment\">//  TLS .</span></span><br><span class=\"line\">    Version <span class=\"keyword\">uint16</span> <span class=\"comment\">// Go 1.14</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  TLS </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ClientSessionState <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  TLS </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ClientAuthType <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  ClientHello </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ClientHelloInfo <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    CipherSuites []<span class=\"keyword\">uint16</span></span><br><span class=\"line\">    <span class=\"comment\">//  ServerName</span></span><br><span class=\"line\">    ServerName <span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\">    SupportedCurves []CurveID</span><br><span class=\"line\">    SupportedPoints []<span class=\"keyword\">uint8</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SignatureSchemes []SignatureScheme <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SupportedProtos []<span class=\"keyword\">string</span> <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">//  TLS </span></span><br><span class=\"line\">    SupportedVersions []<span class=\"keyword\">uint16</span> <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// ,net.Conn </span></span><br><span class=\"line\">    Conn net.Conn <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ClientSessionState </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ClientSessionCache <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Get*ClientSessionStateok</span></span><br><span class=\"line\">    Get(sessionKey <span class=\"keyword\">string</span>) (session *ClientSessionState, ok <span class=\"keyword\">bool</span>)</span><br><span class=\"line\">    <span class=\"comment\">// Put*ClientSessionState</span></span><br><span class=\"line\">    Put(sessionKey <span class=\"keyword\">string</span>, cs *ClientSessionState)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// tls </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Config <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// , `crypto/rand` </span></span><br><span class=\"line\">    <span class=\"comment\">//  goroutine  </span></span><br><span class=\"line\">    Rand io.Reader</span><br><span class=\"line\">    <span class=\"comment\">// . time.Now</span></span><br><span class=\"line\">    Time <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span> <span class=\"title\">time</span>.<span class=\"title\">Time</span></span></span><br><span class=\"line\">    <span class=\"comment\">// .</span></span><br><span class=\"line\">    <span class=\"comment\">//  Certificates,GetCertificate  GetConfigForClient </span></span><br><span class=\"line\">    <span class=\"comment\">//  Certificates  GetCertificate</span></span><br><span class=\"line\">    <span class=\"comment\">// : , Leaf ,</span></span><br><span class=\"line\">    Certificates []Certificate</span><br><span class=\"line\">    <span class=\"comment\">//  Certificates </span></span><br><span class=\"line\">    NameToCertificate <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]*Certificate</span><br><span class=\"line\">    <span class=\"comment\">//  ClientHelloInfo . SNI  Certificates ,</span></span><br><span class=\"line\">    GetCertificate <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(*ClientHelloInfo)</span> <span class=\"params\">(*Certificate, error)</span> // <span class=\"title\">Go</span> 1.4</span></span><br><span class=\"line\">    <span class=\"comment\">// ,.,Certificates </span></span><br><span class=\"line\">    GetClientCertificate <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(*CertificateRequestInfo)</span> <span class=\"params\">(*Certificate, error)</span> // <span class=\"title\">Go</span> 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">//  ClientHello </span></span><br><span class=\"line\">    GetConfigForClient <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(*ClientHelloInfo)</span> <span class=\"params\">(*Config, error)</span> // <span class=\"title\">Go</span> 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS , TLS </span></span><br><span class=\"line\">    VerifyPeerCertificate <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(rawCerts [][]<span class=\"keyword\">byte</span>, verifiedChains [][]*x509.Certificate)</span> <span class=\"title\">error</span> // <span class=\"title\">Go</span> 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">//  CA</span></span><br><span class=\"line\">    <span class=\"comment\">//  nil, CA </span></span><br><span class=\"line\">    RootCAs *x509.CertPool</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    NextProtos []<span class=\"keyword\">string</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS ,. InsecureSkipVerify </span></span><br><span class=\"line\">    ServerName <span class=\"keyword\">string</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS , NoClientCert,</span></span><br><span class=\"line\">    ClientAuth ClientAuthType</span><br><span class=\"line\">    <span class=\"comment\">// , ClientAuth ,</span></span><br><span class=\"line\">    ClientCAs *x509.CertPool</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    InsecureSkipVerify <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">//  TLS1.2 </span></span><br><span class=\"line\">    CipherSuites []<span class=\"keyword\">uint16</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    PreferServerCipherSuites <span class=\"keyword\">bool</span> <span class=\"comment\">// Go 1.1</span></span><br><span class=\"line\">    <span class=\"comment\">//  ticket  PSK </span></span><br><span class=\"line\">    SessionTicketsDisabled <span class=\"keyword\">bool</span> <span class=\"comment\">// Go 1.1</span></span><br><span class=\"line\">    <span class=\"comment\">//  SessionTicketKey </span></span><br><span class=\"line\">    SessionTicketKey [<span class=\"number\">32</span>]<span class=\"keyword\">byte</span> <span class=\"comment\">// Go 1.1</span></span><br><span class=\"line\">    <span class=\"comment\">//  ClientSessionState </span></span><br><span class=\"line\">    ClientSessionCache ClientSessionCache <span class=\"comment\">// Go 1.3</span></span><br><span class=\"line\">    <span class=\"comment\">// ,TLs 1.0 </span></span><br><span class=\"line\">    MinVersion <span class=\"keyword\">uint16</span> <span class=\"comment\">// Go 1.2</span></span><br><span class=\"line\">    <span class=\"comment\">// ,TLS 1.3 </span></span><br><span class=\"line\">    MaxVersion <span class=\"keyword\">uint16</span> <span class=\"comment\">// Go 1.2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    CurvePreferences []CurveID <span class=\"comment\">// Go 1.3</span></span><br><span class=\"line\">    DynamicRecordSizingDisabled <span class=\"keyword\">bool</span> <span class=\"comment\">// Go 1.7</span></span><br><span class=\"line\">    Renegotiation RenegotiationSupport <span class=\"comment\">// Go 1.7</span></span><br><span class=\"line\">    KeyLogWriter io.Writer <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// . `net.Conn` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Conn <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ConnectionState <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  TLS </span></span><br><span class=\"line\">    Version <span class=\"keyword\">uint16</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS </span></span><br><span class=\"line\">    HandshakeComplete <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS</span></span><br><span class=\"line\">    DidResume <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    CipherSuite <span class=\"keyword\">uint16</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    NegotiatedProtocol <span class=\"keyword\">string</span></span><br><span class=\"line\">    NegotiatedProtocolIsMutual <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ServerName <span class=\"keyword\">string</span></span><br><span class=\"line\">    PeerCertificates []*x509.Certificate</span><br><span class=\"line\">    VerifiedChains [][]*x509.Certificate</span><br><span class=\"line\">    SignedCertificateTimestamps [][]<span class=\"keyword\">byte</span></span><br><span class=\"line\">    OCSPResponse []<span class=\"keyword\">byte</span></span><br><span class=\"line\">    TLSUnique []<span class=\"keyword\">byte</span> <span class=\"comment\">// Go 1.4</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> SignatureScheme <span class=\"keyword\">uint16</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    <span class=\"comment\">// TLS 1.0 - 1.2 cipher suites.</span></span><br><span class=\"line\">    TLS_RSA_WITH_RC4_128_SHA                      <span class=\"keyword\">uint16</span> = <span class=\"number\">0x0005</span></span><br><span class=\"line\">    TLS_RSA_WITH_3DES_EDE_CBC_SHA                 <span class=\"keyword\">uint16</span> = <span class=\"number\">0x000a</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_128_CBC_SHA                  <span class=\"keyword\">uint16</span> = <span class=\"number\">0x002f</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_256_CBC_SHA                  <span class=\"keyword\">uint16</span> = <span class=\"number\">0x0035</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_128_CBC_SHA256               <span class=\"keyword\">uint16</span> = <span class=\"number\">0x003c</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_128_GCM_SHA256               <span class=\"keyword\">uint16</span> = <span class=\"number\">0x009c</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_256_GCM_SHA384               <span class=\"keyword\">uint16</span> = <span class=\"number\">0x009d</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_RC4_128_SHA              <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc007</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA          <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc009</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA          <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc00a</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_RC4_128_SHA                <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc011</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA           <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc012</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA            <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc013</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA            <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc014</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256       <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc023</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256         <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc027</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256         <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc02f</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256       <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc02b</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384         <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc030</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384       <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc02c</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256   <span class=\"keyword\">uint16</span> = <span class=\"number\">0xcca8</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 <span class=\"keyword\">uint16</span> = <span class=\"number\">0xcca9</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// TLS 1.3 cipher suites.</span></span><br><span class=\"line\">    TLS_AES_128_GCM_SHA256       <span class=\"keyword\">uint16</span> = <span class=\"number\">0x1301</span></span><br><span class=\"line\">    TLS_AES_256_GCM_SHA384       <span class=\"keyword\">uint16</span> = <span class=\"number\">0x1302</span></span><br><span class=\"line\">    TLS_CHACHA20_POLY1305_SHA256 <span class=\"keyword\">uint16</span> = <span class=\"number\">0x1303</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// TLS_FALLBACK_SCSV isn't a standard cipher suite but an indicator</span></span><br><span class=\"line\">    <span class=\"comment\">// that the client is doing version fallback. See RFC 7507.</span></span><br><span class=\"line\">    TLS_FALLBACK_SCSV <span class=\"keyword\">uint16</span> = <span class=\"number\">0x5600</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Legacy names for the corresponding cipher suites with the correct _SHA256</span></span><br><span class=\"line\">    <span class=\"comment\">// suffix, retained for backward compatibility.</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305   = TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305 = TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// TLS </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    VersionTLS10 = <span class=\"number\">0x0301</span></span><br><span class=\"line\">    VersionTLS11 = <span class=\"number\">0x0302</span></span><br><span class=\"line\">    VersionTLS12 = <span class=\"number\">0x0303</span></span><br><span class=\"line\">    VersionTLS13 = <span class=\"number\">0x0304</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    VersionSSL30 = <span class=\"number\">0x0300</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    NoClientCert ClientAuthType = <span class=\"literal\">iota</span></span><br><span class=\"line\">    RequestClientCert</span><br><span class=\"line\">    RequireAnyClientCert</span><br><span class=\"line\">    VerifyClientCertIfGiven</span><br><span class=\"line\">    RequireAndVerifyClientCert</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    <span class=\"comment\">// RSASSA-PKCS1-v1_5 algorithms.</span></span><br><span class=\"line\">    PKCS1WithSHA256 SignatureScheme = <span class=\"number\">0x0401</span></span><br><span class=\"line\">    PKCS1WithSHA384 SignatureScheme = <span class=\"number\">0x0501</span></span><br><span class=\"line\">    PKCS1WithSHA512 SignatureScheme = <span class=\"number\">0x0601</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// RSASSA-PSS algorithms with public key OID rsaEncryption.</span></span><br><span class=\"line\">    PSSWithSHA256 SignatureScheme = <span class=\"number\">0x0804</span></span><br><span class=\"line\">    PSSWithSHA384 SignatureScheme = <span class=\"number\">0x0805</span></span><br><span class=\"line\">    PSSWithSHA512 SignatureScheme = <span class=\"number\">0x0806</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ECDSA algorithms. Only constrained to a specific curve in TLS 1.3.</span></span><br><span class=\"line\">    ECDSAWithP256AndSHA256 SignatureScheme = <span class=\"number\">0x0403</span></span><br><span class=\"line\">    ECDSAWithP384AndSHA384 SignatureScheme = <span class=\"number\">0x0503</span></span><br><span class=\"line\">    ECDSAWithP521AndSHA512 SignatureScheme = <span class=\"number\">0x0603</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// EdDSA algorithms.</span></span><br><span class=\"line\">    Ed25519 SignatureScheme = <span class=\"number\">0x0807</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Legacy signature and hash algorithms for TLS 1.2.</span></span><br><span class=\"line\">    PKCS1WithSHA1 SignatureScheme = <span class=\"number\">0x0201</span></span><br><span class=\"line\">    ECDSAWithSHA1 SignatureScheme = <span class=\"number\">0x0203</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"tls-\"><a href=\"#tls-\" class=\"headerlink\" title=\"tls \"></a><code>tls</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Network  addr  TLS , config </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Listen</span><span class=\"params\">(network, laddr <span class=\"keyword\">string</span>, config *Config)</span> <span class=\"params\">(net.Listener, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  inner ,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewListener</span><span class=\"params\">(inner net.Listener, config *Config)</span> <span class=\"title\">net</span>.<span class=\"title\">Listener</span></span></span><br><span class=\"line\"><span class=\"comment\">// .  pem .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">LoadX509KeyPair</span><span class=\"params\">(certFile, keyFile <span class=\"keyword\">string</span>)</span> <span class=\"params\">(cert Certificate, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  pem .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">X509KeyPair</span><span class=\"params\">(certPEMBlock, keyPEMBlock []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(cert Certificate, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  LRU()  ClientSessionState. capacity&lt;1 </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewLRUClientSessionCache</span><span class=\"params\">(capacity <span class=\"keyword\">int</span>)</span> <span class=\"title\">ClientSessionCache</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  conn  TL S.config  nil  ServerName  InsecureSkipVerify </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Client</span><span class=\"params\">(conn net.Conn, config *Config)</span> *<span class=\"title\">Conn</span></span></span><br><span class=\"line\"><span class=\"comment\">//  conn  TLS .config  nil </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Server</span><span class=\"params\">(conn net.Conn, config *Config)</span> *<span class=\"title\">Conn</span></span></span><br><span class=\"line\"><span class=\"comment\">//  net.Dial  network() addr(), config  TLS . TLS </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Dial</span><span class=\"params\">(network, addr <span class=\"keyword\">string</span>, config *Config)</span> <span class=\"params\">(*Conn, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  net.Dialer , TLS , TLS </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DialWithDialer</span><span class=\"params\">(dialer *net.Dialer, network, addr <span class=\"keyword\">string</span>, config *Config)</span> <span class=\"params\">(*Conn, error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Conn-\"><a href=\"#Conn-\" class=\"headerlink\" title=\"Conn \"></a><code>Conn</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">ConnectionState</span><span class=\"params\">()</span> <span class=\"title\">ConnectionState</span></span></span><br><span class=\"line\"><span class=\"comment\">// ., Read  Write </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">Handshake</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">LocalAddr</span><span class=\"params\">()</span> <span class=\"title\">net</span>.<span class=\"title\">Addr</span></span></span><br><span class=\"line\"><span class=\"comment\">//  TLS  OCSP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">OCSPResponse</span><span class=\"params\">()</span> []<span class=\"title\">byte</span></span></span><br><span class=\"line\"><span class=\"comment\">//  b. net.Error</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">Read</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(<span class=\"keyword\">int</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">RemoteAddr</span><span class=\"params\">()</span> <span class=\"title\">net</span>.<span class=\"title\">Addr</span></span></span><br><span class=\"line\"><span class=\"comment\">// .t=0</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">SetDeadline</span><span class=\"params\">(t time.Time)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">SetReadDeadline</span><span class=\"params\">(t time.Time)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">SetWriteDeadline</span><span class=\"params\">(t time.Time)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  host .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">VerifyHostname</span><span class=\"params\">(host <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">Write</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(<span class=\"keyword\">int</span>, error)</span></span></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>tls  TLS 1.2  TLS 1.3 ,,,.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// tls </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Certificate <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Certificate [][]<span class=\"keyword\">byte</span></span><br><span class=\"line\">    <span class=\"comment\">// PrivateKey  Leaf . RSA,ECDSA  Ed25519  crypto.Signer </span></span><br><span class=\"line\">    <span class=\"comment\">//  TLS1.2 , RSA PublicKey  crypto.Decrypter </span></span><br><span class=\"line\">    PrivateKey crypto.PrivateKey</span><br><span class=\"line\">    <span class=\"comment\">// PrivateKey </span></span><br><span class=\"line\">    SupportedSignatureAlgorithms []SignatureScheme <span class=\"comment\">// Go 1.14</span></span><br><span class=\"line\">    <span class=\"comment\">//  OCSP </span></span><br><span class=\"line\">    OCSPStaple []<span class=\"keyword\">byte</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SignedCertificateTimestamps [][]<span class=\"keyword\">byte</span> <span class=\"comment\">// Go 1.5</span></span><br><span class=\"line\">    <span class=\"comment\">// , x509.ParseCertificate ,. nil,</span></span><br><span class=\"line\">    Leaf *x509.Certificate</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  CertificateRequest ,</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> CertificateRequestInfo <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 0 DER  X.501 .</span></span><br><span class=\"line\">    <span class=\"comment\">//  CA </span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    AcceptableCAs [][]<span class=\"keyword\">byte</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SignatureSchemes []SignatureScheme</span><br><span class=\"line\">    <span class=\"comment\">//  TLS .</span></span><br><span class=\"line\">    Version <span class=\"keyword\">uint16</span> <span class=\"comment\">// Go 1.14</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  TLS </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ClientSessionState <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  TLS </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ClientAuthType <span class=\"keyword\">int</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  ClientHello </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ClientHelloInfo <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    CipherSuites []<span class=\"keyword\">uint16</span></span><br><span class=\"line\">    <span class=\"comment\">//  ServerName</span></span><br><span class=\"line\">    ServerName <span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\">    SupportedCurves []CurveID</span><br><span class=\"line\">    SupportedPoints []<span class=\"keyword\">uint8</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SignatureSchemes []SignatureScheme <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    SupportedProtos []<span class=\"keyword\">string</span> <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">//  TLS </span></span><br><span class=\"line\">    SupportedVersions []<span class=\"keyword\">uint16</span> <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// ,net.Conn </span></span><br><span class=\"line\">    Conn net.Conn <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ClientSessionState </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ClientSessionCache <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Get*ClientSessionStateok</span></span><br><span class=\"line\">    Get(sessionKey <span class=\"keyword\">string</span>) (session *ClientSessionState, ok <span class=\"keyword\">bool</span>)</span><br><span class=\"line\">    <span class=\"comment\">// Put*ClientSessionState</span></span><br><span class=\"line\">    Put(sessionKey <span class=\"keyword\">string</span>, cs *ClientSessionState)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// tls </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Config <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// , `crypto/rand` </span></span><br><span class=\"line\">    <span class=\"comment\">//  goroutine  </span></span><br><span class=\"line\">    Rand io.Reader</span><br><span class=\"line\">    <span class=\"comment\">// . time.Now</span></span><br><span class=\"line\">    Time <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span> <span class=\"title\">time</span>.<span class=\"title\">Time</span></span></span><br><span class=\"line\">    <span class=\"comment\">// .</span></span><br><span class=\"line\">    <span class=\"comment\">//  Certificates,GetCertificate  GetConfigForClient </span></span><br><span class=\"line\">    <span class=\"comment\">//  Certificates  GetCertificate</span></span><br><span class=\"line\">    <span class=\"comment\">// : , Leaf ,</span></span><br><span class=\"line\">    Certificates []Certificate</span><br><span class=\"line\">    <span class=\"comment\">//  Certificates </span></span><br><span class=\"line\">    NameToCertificate <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]*Certificate</span><br><span class=\"line\">    <span class=\"comment\">//  ClientHelloInfo . SNI  Certificates ,</span></span><br><span class=\"line\">    GetCertificate <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(*ClientHelloInfo)</span> <span class=\"params\">(*Certificate, error)</span> // <span class=\"title\">Go</span> 1.4</span></span><br><span class=\"line\">    <span class=\"comment\">// ,.,Certificates </span></span><br><span class=\"line\">    GetClientCertificate <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(*CertificateRequestInfo)</span> <span class=\"params\">(*Certificate, error)</span> // <span class=\"title\">Go</span> 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">//  ClientHello </span></span><br><span class=\"line\">    GetConfigForClient <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(*ClientHelloInfo)</span> <span class=\"params\">(*Config, error)</span> // <span class=\"title\">Go</span> 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS , TLS </span></span><br><span class=\"line\">    VerifyPeerCertificate <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(rawCerts [][]<span class=\"keyword\">byte</span>, verifiedChains [][]*x509.Certificate)</span> <span class=\"title\">error</span> // <span class=\"title\">Go</span> 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">//  CA</span></span><br><span class=\"line\">    <span class=\"comment\">//  nil, CA </span></span><br><span class=\"line\">    RootCAs *x509.CertPool</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    NextProtos []<span class=\"keyword\">string</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS ,. InsecureSkipVerify </span></span><br><span class=\"line\">    ServerName <span class=\"keyword\">string</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS , NoClientCert,</span></span><br><span class=\"line\">    ClientAuth ClientAuthType</span><br><span class=\"line\">    <span class=\"comment\">// , ClientAuth ,</span></span><br><span class=\"line\">    ClientCAs *x509.CertPool</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    InsecureSkipVerify <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">//  TLS1.2 </span></span><br><span class=\"line\">    CipherSuites []<span class=\"keyword\">uint16</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    PreferServerCipherSuites <span class=\"keyword\">bool</span> <span class=\"comment\">// Go 1.1</span></span><br><span class=\"line\">    <span class=\"comment\">//  ticket  PSK </span></span><br><span class=\"line\">    SessionTicketsDisabled <span class=\"keyword\">bool</span> <span class=\"comment\">// Go 1.1</span></span><br><span class=\"line\">    <span class=\"comment\">//  SessionTicketKey </span></span><br><span class=\"line\">    SessionTicketKey [<span class=\"number\">32</span>]<span class=\"keyword\">byte</span> <span class=\"comment\">// Go 1.1</span></span><br><span class=\"line\">    <span class=\"comment\">//  ClientSessionState </span></span><br><span class=\"line\">    ClientSessionCache ClientSessionCache <span class=\"comment\">// Go 1.3</span></span><br><span class=\"line\">    <span class=\"comment\">// ,TLs 1.0 </span></span><br><span class=\"line\">    MinVersion <span class=\"keyword\">uint16</span> <span class=\"comment\">// Go 1.2</span></span><br><span class=\"line\">    <span class=\"comment\">// ,TLS 1.3 </span></span><br><span class=\"line\">    MaxVersion <span class=\"keyword\">uint16</span> <span class=\"comment\">// Go 1.2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    CurvePreferences []CurveID <span class=\"comment\">// Go 1.3</span></span><br><span class=\"line\">    DynamicRecordSizingDisabled <span class=\"keyword\">bool</span> <span class=\"comment\">// Go 1.7</span></span><br><span class=\"line\">    Renegotiation RenegotiationSupport <span class=\"comment\">// Go 1.7</span></span><br><span class=\"line\">    KeyLogWriter io.Writer <span class=\"comment\">// Go 1.8</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// . `net.Conn` </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Conn <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// contains filtered or unexported fields</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> ConnectionState <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  TLS </span></span><br><span class=\"line\">    Version <span class=\"keyword\">uint16</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS </span></span><br><span class=\"line\">    HandshakeComplete <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">// TLS</span></span><br><span class=\"line\">    DidResume <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    CipherSuite <span class=\"keyword\">uint16</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    NegotiatedProtocol <span class=\"keyword\">string</span></span><br><span class=\"line\">    NegotiatedProtocolIsMutual <span class=\"keyword\">bool</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ServerName <span class=\"keyword\">string</span></span><br><span class=\"line\">    PeerCertificates []*x509.Certificate</span><br><span class=\"line\">    VerifiedChains [][]*x509.Certificate</span><br><span class=\"line\">    SignedCertificateTimestamps [][]<span class=\"keyword\">byte</span></span><br><span class=\"line\">    OCSPResponse []<span class=\"keyword\">byte</span></span><br><span class=\"line\">    TLSUnique []<span class=\"keyword\">byte</span> <span class=\"comment\">// Go 1.4</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> SignatureScheme <span class=\"keyword\">uint16</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    <span class=\"comment\">// TLS 1.0 - 1.2 cipher suites.</span></span><br><span class=\"line\">    TLS_RSA_WITH_RC4_128_SHA                      <span class=\"keyword\">uint16</span> = <span class=\"number\">0x0005</span></span><br><span class=\"line\">    TLS_RSA_WITH_3DES_EDE_CBC_SHA                 <span class=\"keyword\">uint16</span> = <span class=\"number\">0x000a</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_128_CBC_SHA                  <span class=\"keyword\">uint16</span> = <span class=\"number\">0x002f</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_256_CBC_SHA                  <span class=\"keyword\">uint16</span> = <span class=\"number\">0x0035</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_128_CBC_SHA256               <span class=\"keyword\">uint16</span> = <span class=\"number\">0x003c</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_128_GCM_SHA256               <span class=\"keyword\">uint16</span> = <span class=\"number\">0x009c</span></span><br><span class=\"line\">    TLS_RSA_WITH_AES_256_GCM_SHA384               <span class=\"keyword\">uint16</span> = <span class=\"number\">0x009d</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_RC4_128_SHA              <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc007</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA          <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc009</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA          <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc00a</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_RC4_128_SHA                <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc011</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA           <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc012</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA            <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc013</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA            <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc014</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256       <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc023</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256         <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc027</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256         <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc02f</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256       <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc02b</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384         <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc030</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384       <span class=\"keyword\">uint16</span> = <span class=\"number\">0xc02c</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256   <span class=\"keyword\">uint16</span> = <span class=\"number\">0xcca8</span></span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 <span class=\"keyword\">uint16</span> = <span class=\"number\">0xcca9</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// TLS 1.3 cipher suites.</span></span><br><span class=\"line\">    TLS_AES_128_GCM_SHA256       <span class=\"keyword\">uint16</span> = <span class=\"number\">0x1301</span></span><br><span class=\"line\">    TLS_AES_256_GCM_SHA384       <span class=\"keyword\">uint16</span> = <span class=\"number\">0x1302</span></span><br><span class=\"line\">    TLS_CHACHA20_POLY1305_SHA256 <span class=\"keyword\">uint16</span> = <span class=\"number\">0x1303</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// TLS_FALLBACK_SCSV isn't a standard cipher suite but an indicator</span></span><br><span class=\"line\">    <span class=\"comment\">// that the client is doing version fallback. See RFC 7507.</span></span><br><span class=\"line\">    TLS_FALLBACK_SCSV <span class=\"keyword\">uint16</span> = <span class=\"number\">0x5600</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Legacy names for the corresponding cipher suites with the correct _SHA256</span></span><br><span class=\"line\">    <span class=\"comment\">// suffix, retained for backward compatibility.</span></span><br><span class=\"line\">    TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305   = TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span><br><span class=\"line\">    TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305 = TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// TLS </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    VersionTLS10 = <span class=\"number\">0x0301</span></span><br><span class=\"line\">    VersionTLS11 = <span class=\"number\">0x0302</span></span><br><span class=\"line\">    VersionTLS12 = <span class=\"number\">0x0303</span></span><br><span class=\"line\">    VersionTLS13 = <span class=\"number\">0x0304</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    VersionSSL30 = <span class=\"number\">0x0300</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    NoClientCert ClientAuthType = <span class=\"literal\">iota</span></span><br><span class=\"line\">    RequestClientCert</span><br><span class=\"line\">    RequireAnyClientCert</span><br><span class=\"line\">    VerifyClientCertIfGiven</span><br><span class=\"line\">    RequireAndVerifyClientCert</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">    <span class=\"comment\">// RSASSA-PKCS1-v1_5 algorithms.</span></span><br><span class=\"line\">    PKCS1WithSHA256 SignatureScheme = <span class=\"number\">0x0401</span></span><br><span class=\"line\">    PKCS1WithSHA384 SignatureScheme = <span class=\"number\">0x0501</span></span><br><span class=\"line\">    PKCS1WithSHA512 SignatureScheme = <span class=\"number\">0x0601</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// RSASSA-PSS algorithms with public key OID rsaEncryption.</span></span><br><span class=\"line\">    PSSWithSHA256 SignatureScheme = <span class=\"number\">0x0804</span></span><br><span class=\"line\">    PSSWithSHA384 SignatureScheme = <span class=\"number\">0x0805</span></span><br><span class=\"line\">    PSSWithSHA512 SignatureScheme = <span class=\"number\">0x0806</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ECDSA algorithms. Only constrained to a specific curve in TLS 1.3.</span></span><br><span class=\"line\">    ECDSAWithP256AndSHA256 SignatureScheme = <span class=\"number\">0x0403</span></span><br><span class=\"line\">    ECDSAWithP384AndSHA384 SignatureScheme = <span class=\"number\">0x0503</span></span><br><span class=\"line\">    ECDSAWithP521AndSHA512 SignatureScheme = <span class=\"number\">0x0603</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// EdDSA algorithms.</span></span><br><span class=\"line\">    Ed25519 SignatureScheme = <span class=\"number\">0x0807</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Legacy signature and hash algorithms for TLS 1.2.</span></span><br><span class=\"line\">    PKCS1WithSHA1 SignatureScheme = <span class=\"number\">0x0201</span></span><br><span class=\"line\">    ECDSAWithSHA1 SignatureScheme = <span class=\"number\">0x0203</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"tls-\"><a href=\"#tls-\" class=\"headerlink\" title=\"tls \"></a><code>tls</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Network  addr  TLS , config </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Listen</span><span class=\"params\">(network, laddr <span class=\"keyword\">string</span>, config *Config)</span> <span class=\"params\">(net.Listener, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  inner ,.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewListener</span><span class=\"params\">(inner net.Listener, config *Config)</span> <span class=\"title\">net</span>.<span class=\"title\">Listener</span></span></span><br><span class=\"line\"><span class=\"comment\">// .  pem .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">LoadX509KeyPair</span><span class=\"params\">(certFile, keyFile <span class=\"keyword\">string</span>)</span> <span class=\"params\">(cert Certificate, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  pem .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">X509KeyPair</span><span class=\"params\">(certPEMBlock, keyPEMBlock []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(cert Certificate, err error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  LRU()  ClientSessionState. capacity&lt;1 </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewLRUClientSessionCache</span><span class=\"params\">(capacity <span class=\"keyword\">int</span>)</span> <span class=\"title\">ClientSessionCache</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  conn  TL S.config  nil  ServerName  InsecureSkipVerify </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Client</span><span class=\"params\">(conn net.Conn, config *Config)</span> *<span class=\"title\">Conn</span></span></span><br><span class=\"line\"><span class=\"comment\">//  conn  TLS .config  nil </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Server</span><span class=\"params\">(conn net.Conn, config *Config)</span> *<span class=\"title\">Conn</span></span></span><br><span class=\"line\"><span class=\"comment\">//  net.Dial  network() addr(), config  TLS . TLS </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Dial</span><span class=\"params\">(network, addr <span class=\"keyword\">string</span>, config *Config)</span> <span class=\"params\">(*Conn, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">//  net.Dialer , TLS , TLS </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">DialWithDialer</span><span class=\"params\">(dialer *net.Dialer, network, addr <span class=\"keyword\">string</span>, config *Config)</span> <span class=\"params\">(*Conn, error)</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Conn-\"><a href=\"#Conn-\" class=\"headerlink\" title=\"Conn \"></a><code>Conn</code> </h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">Close</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">ConnectionState</span><span class=\"params\">()</span> <span class=\"title\">ConnectionState</span></span></span><br><span class=\"line\"><span class=\"comment\">// ., Read  Write </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">Handshake</span><span class=\"params\">()</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">LocalAddr</span><span class=\"params\">()</span> <span class=\"title\">net</span>.<span class=\"title\">Addr</span></span></span><br><span class=\"line\"><span class=\"comment\">//  TLS  OCSP </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">OCSPResponse</span><span class=\"params\">()</span> []<span class=\"title\">byte</span></span></span><br><span class=\"line\"><span class=\"comment\">//  b. net.Error</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">Read</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(<span class=\"keyword\">int</span>, error)</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">RemoteAddr</span><span class=\"params\">()</span> <span class=\"title\">net</span>.<span class=\"title\">Addr</span></span></span><br><span class=\"line\"><span class=\"comment\">// .t=0</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">SetDeadline</span><span class=\"params\">(t time.Time)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">SetReadDeadline</span><span class=\"params\">(t time.Time)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">SetWriteDeadline</span><span class=\"params\">(t time.Time)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">//  host .</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">VerifyHostname</span><span class=\"params\">(host <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(c *Conn)</span> <span class=\"title\">Write</span><span class=\"params\">(b []<span class=\"keyword\">byte</span>)</span> <span class=\"params\">(<span class=\"keyword\">int</span>, error)</span></span></span><br></pre></td></tr></table></figure>\n"},{"title":"ELK  Elasticsearch ","abbrlink":26757,"description":" ELK Elasticsearch  API , DSL ..","_content":"\nElasticsearch(ES) [Apache Lucene(TM)](https://lucene.apache.org/) . RESTful API  Lucene ,.,.\n\nElasticsearch :\n\n- ,.\n-  RESTful  API ,\n- ., PB \n\n## \n\n### \n\n- `index` \n\n.ES ,\n\n- `type` \n\n.,\n\n- `document` \n\n, JSON ,.\n\n ES :\n\nElasticsearch | \n:---: | :---:\nindex  | database \ntype  | table \ndocument  | row \nfield  | column \nmapping  | data_type \n\n### \n\n- `node` \n\n Elasticsearch .,., `node.name` \n\n- `cluster` \n\n Elasticsearch .,.\n\n- `shard` \n\nElasticsearch ,.,\n\n `index.number_of_shards` ,. 5\n\n- `replica` \n  \nES ,.,.,\n\n `index.number_of_replicas` ,\n\n## ES Cluster \n\n### \n\n1. ES ,() tcp/9300 ,\n2. ,.,\n3. ,,,., yellow ,.\n4. ,,.,.,,,.\n\n: green(), yellow(,), red()\n\n### \n\n,,.``.\n\n,. `_search` API ,.``\n\n> - \n\n ES ,..\n\n,,. n . `from`  `size` , `from + size`\n\n> - \n\n, GET .,.,.\n\n## Document APIs\n\n., `_index`, `_type`, `_id`, `_version` ,  `_index`, `_type`, `_id` .`_version` . `_source` , JSON .\n\n### \n\n, API .\n\n- `index`: .\n- `_id`: .PUT,GET,HEAD,DELETE .POST ,.\n\n### Index API\n\n JSON ,,\n\n```text\nPUT /<index>/_doc/<_id>\nPOST /<index>/_doc/\nPUT /<index>/_create/<_id>\nPOST /<index>/_create/<_id>\n```\n\n### Get API\n\n Get , HEAD .  `_source` .\n\n```text\nGET <index>/_doc/<_id>\nHEAD <index>/_doc/<_id>\nGET <index>/_source/<_id>\nHEAD <index>/_source/<_id>\n```\n\n> \n\n- `routing`: . `routing` ()., `routing` .\n- `_source`:  _source , true\n- `_source_excludes`:  _source \n- `_source_includes`:  _source \n\n### Delete API\n\n\n\n```text\nDELETE /<index>/_doc/<_id>\n```\n\n### Delete by query API\n\n,`<index>` ,, `_all`\n\n```text\nPOST /<index>/_delete_by_query\n```\n\n> \n\n- `from`: . 0\n- `max_docs`: ,\n- `q`:  Lucene \n- `routing`: \n- `scroll_size`: , 100\n- `sort`: , `<field>:<direction>` \n- `_source`:  _source , true\n- `_source_excludes`:  _source \n- `_source_includes`:  _source \n\n> \n\n- `query`: `Query DSL` ,\n\n### Update API\n\n\n\n```text\nPOST /<index>/_update/<_id>\n```\n","source":"_posts/ELK-Stack-Elasticsearch-search.md","raw":"---\ntitle: ELK  Elasticsearch \ntags:\n  - ELK\n  - \ncategories:\n  - ELK\nabbrlink: 26757\ndescription: ' ELK Elasticsearch  API , DSL ..'\n---\n\nElasticsearch(ES) [Apache Lucene(TM)](https://lucene.apache.org/) . RESTful API  Lucene ,.,.\n\nElasticsearch :\n\n- ,.\n-  RESTful  API ,\n- ., PB \n\n## \n\n### \n\n- `index` \n\n.ES ,\n\n- `type` \n\n.,\n\n- `document` \n\n, JSON ,.\n\n ES :\n\nElasticsearch | \n:---: | :---:\nindex  | database \ntype  | table \ndocument  | row \nfield  | column \nmapping  | data_type \n\n### \n\n- `node` \n\n Elasticsearch .,., `node.name` \n\n- `cluster` \n\n Elasticsearch .,.\n\n- `shard` \n\nElasticsearch ,.,\n\n `index.number_of_shards` ,. 5\n\n- `replica` \n  \nES ,.,.,\n\n `index.number_of_replicas` ,\n\n## ES Cluster \n\n### \n\n1. ES ,() tcp/9300 ,\n2. ,.,\n3. ,,,., yellow ,.\n4. ,,.,.,,,.\n\n: green(), yellow(,), red()\n\n### \n\n,,.``.\n\n,. `_search` API ,.``\n\n> - \n\n ES ,..\n\n,,. n . `from`  `size` , `from + size`\n\n> - \n\n, GET .,.,.\n\n## Document APIs\n\n., `_index`, `_type`, `_id`, `_version` ,  `_index`, `_type`, `_id` .`_version` . `_source` , JSON .\n\n### \n\n, API .\n\n- `index`: .\n- `_id`: .PUT,GET,HEAD,DELETE .POST ,.\n\n### Index API\n\n JSON ,,\n\n```text\nPUT /<index>/_doc/<_id>\nPOST /<index>/_doc/\nPUT /<index>/_create/<_id>\nPOST /<index>/_create/<_id>\n```\n\n### Get API\n\n Get , HEAD .  `_source` .\n\n```text\nGET <index>/_doc/<_id>\nHEAD <index>/_doc/<_id>\nGET <index>/_source/<_id>\nHEAD <index>/_source/<_id>\n```\n\n> \n\n- `routing`: . `routing` ()., `routing` .\n- `_source`:  _source , true\n- `_source_excludes`:  _source \n- `_source_includes`:  _source \n\n### Delete API\n\n\n\n```text\nDELETE /<index>/_doc/<_id>\n```\n\n### Delete by query API\n\n,`<index>` ,, `_all`\n\n```text\nPOST /<index>/_delete_by_query\n```\n\n> \n\n- `from`: . 0\n- `max_docs`: ,\n- `q`:  Lucene \n- `routing`: \n- `scroll_size`: , 100\n- `sort`: , `<field>:<direction>` \n- `_source`:  _source , true\n- `_source_excludes`:  _source \n- `_source_includes`:  _source \n\n> \n\n- `query`: `Query DSL` ,\n\n### Update API\n\n\n\n```text\nPOST /<index>/_update/<_id>\n```\n","slug":"ELK-Stack-Elasticsearch-search","published":1,"date":"2020-05-22T13:25:30.951Z","updated":"2020-05-22T13:26:32.422Z","_id":"ckai8moyb000hgcu7fe9w1ikr","comments":1,"layout":"post","photos":[],"link":"","content":"<p>Elasticsearch(ES) <a href=\"https://lucene.apache.org/\" target=\"_blank\" rel=\"noopener\">Apache Lucene(TM)</a> . RESTful API  Lucene ,.,.</p>\n<p>Elasticsearch :</p>\n<ul>\n<li>,.</li>\n<li> RESTful  API ,</li>\n<li>., PB </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><code>index</code> </li>\n</ul>\n<p>.ES ,</p>\n<ul>\n<li><code>type</code> </li>\n</ul>\n<p>.,</p>\n<ul>\n<li><code>document</code> </li>\n</ul>\n<p>, JSON ,.</p>\n<p> ES :</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Elasticsearch</th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">index </td>\n<td align=\"center\">database </td>\n</tr>\n<tr>\n<td align=\"center\">type </td>\n<td align=\"center\">table </td>\n</tr>\n<tr>\n<td align=\"center\">document </td>\n<td align=\"center\">row </td>\n</tr>\n<tr>\n<td align=\"center\">field </td>\n<td align=\"center\">column </td>\n</tr>\n<tr>\n<td align=\"center\">mapping </td>\n<td align=\"center\">data_type </td>\n</tr>\n</tbody></table>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><code>node</code> </li>\n</ul>\n<p> Elasticsearch .,., <code>node.name</code> </p>\n<ul>\n<li><code>cluster</code> </li>\n</ul>\n<p> Elasticsearch .,.</p>\n<ul>\n<li><code>shard</code> </li>\n</ul>\n<p>Elasticsearch ,.,</p>\n<p> <code>index.number_of_shards</code> ,. 5</p>\n<ul>\n<li><code>replica</code> </li>\n</ul>\n<p>ES ,.,.,</p>\n<p> <code>index.number_of_replicas</code> ,</p>\n<h2 id=\"ES-Cluster-\"><a href=\"#ES-Cluster-\" class=\"headerlink\" title=\"ES Cluster \"></a>ES Cluster </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>ES ,() tcp/9300 ,</li>\n<li>,.,</li>\n<li>,,,., yellow ,.</li>\n<li>,,.,.,,,.</li>\n</ol>\n<p>: green(), yellow(,), red()</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,,.<code></code>.</p>\n<p>,. <code>_search</code> API ,.<code></code></p>\n<blockquote>\n<ul>\n<li></li>\n</ul>\n</blockquote>\n<p> ES ,..</p>\n<p>,,. n . <code>from</code>  <code>size</code> , <code>from + size</code></p>\n<blockquote>\n<ul>\n<li></li>\n</ul>\n</blockquote>\n<p>, GET .,.,.</p>\n<h2 id=\"Document-APIs\"><a href=\"#Document-APIs\" class=\"headerlink\" title=\"Document APIs\"></a>Document APIs</h2><p>., <code>_index</code>, <code>_type</code>, <code>_id</code>, <code>_version</code> ,  <code>_index</code>, <code>_type</code>, <code>_id</code> .<code>_version</code> . <code>_source</code> , JSON .</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>, API .</p>\n<ul>\n<li><code>index</code>: .</li>\n<li><code>_id</code>: .PUT,GET,HEAD,DELETE .POST ,.</li>\n</ul>\n<h3 id=\"Index-API\"><a href=\"#Index-API\" class=\"headerlink\" title=\"Index API\"></a>Index API</h3><p> JSON ,,</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PUT &#x2F;&lt;index&gt;&#x2F;_doc&#x2F;&lt;_id&gt;</span><br><span class=\"line\">POST &#x2F;&lt;index&gt;&#x2F;_doc&#x2F;</span><br><span class=\"line\">PUT &#x2F;&lt;index&gt;&#x2F;_create&#x2F;&lt;_id&gt;</span><br><span class=\"line\">POST &#x2F;&lt;index&gt;&#x2F;_create&#x2F;&lt;_id&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Get-API\"><a href=\"#Get-API\" class=\"headerlink\" title=\"Get API\"></a>Get API</h3><p> Get , HEAD .  <code>_source</code> .</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET &lt;index&gt;&#x2F;_doc&#x2F;&lt;_id&gt;</span><br><span class=\"line\">HEAD &lt;index&gt;&#x2F;_doc&#x2F;&lt;_id&gt;</span><br><span class=\"line\">GET &lt;index&gt;&#x2F;_source&#x2F;&lt;_id&gt;</span><br><span class=\"line\">HEAD &lt;index&gt;&#x2F;_source&#x2F;&lt;_id&gt;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li><code>routing</code>: . <code>routing</code> ()., <code>routing</code> .</li>\n<li><code>_source</code>:  _source , true</li>\n<li><code>_source_excludes</code>:  _source </li>\n<li><code>_source_includes</code>:  _source </li>\n</ul>\n<h3 id=\"Delete-API\"><a href=\"#Delete-API\" class=\"headerlink\" title=\"Delete API\"></a>Delete API</h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DELETE &#x2F;&lt;index&gt;&#x2F;_doc&#x2F;&lt;_id&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Delete-by-query-API\"><a href=\"#Delete-by-query-API\" class=\"headerlink\" title=\"Delete by query API\"></a>Delete by query API</h3><p>,<code>&lt;index&gt;</code> ,, <code>_all</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST &#x2F;&lt;index&gt;&#x2F;_delete_by_query</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li><code>from</code>: . 0</li>\n<li><code>max_docs</code>: ,</li>\n<li><code>q</code>:  Lucene </li>\n<li><code>routing</code>: </li>\n<li><code>scroll_size</code>: , 100</li>\n<li><code>sort</code>: , <code>&lt;field&gt;:&lt;direction&gt;</code> </li>\n<li><code>_source</code>:  _source , true</li>\n<li><code>_source_excludes</code>:  _source </li>\n<li><code>_source_includes</code>:  _source </li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li><code>query</code>: <code>Query DSL</code> ,</li>\n</ul>\n<h3 id=\"Update-API\"><a href=\"#Update-API\" class=\"headerlink\" title=\"Update API\"></a>Update API</h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST &#x2F;&lt;index&gt;&#x2F;_update&#x2F;&lt;_id&gt;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>Elasticsearch(ES) <a href=\"https://lucene.apache.org/\" target=\"_blank\" rel=\"noopener\">Apache Lucene(TM)</a> . RESTful API  Lucene ,.,.</p>\n<p>Elasticsearch :</p>\n<ul>\n<li>,.</li>\n<li> RESTful  API ,</li>\n<li>., PB </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><code>index</code> </li>\n</ul>\n<p>.ES ,</p>\n<ul>\n<li><code>type</code> </li>\n</ul>\n<p>.,</p>\n<ul>\n<li><code>document</code> </li>\n</ul>\n<p>, JSON ,.</p>\n<p> ES :</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Elasticsearch</th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">index </td>\n<td align=\"center\">database </td>\n</tr>\n<tr>\n<td align=\"center\">type </td>\n<td align=\"center\">table </td>\n</tr>\n<tr>\n<td align=\"center\">document </td>\n<td align=\"center\">row </td>\n</tr>\n<tr>\n<td align=\"center\">field </td>\n<td align=\"center\">column </td>\n</tr>\n<tr>\n<td align=\"center\">mapping </td>\n<td align=\"center\">data_type </td>\n</tr>\n</tbody></table>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><code>node</code> </li>\n</ul>\n<p> Elasticsearch .,., <code>node.name</code> </p>\n<ul>\n<li><code>cluster</code> </li>\n</ul>\n<p> Elasticsearch .,.</p>\n<ul>\n<li><code>shard</code> </li>\n</ul>\n<p>Elasticsearch ,.,</p>\n<p> <code>index.number_of_shards</code> ,. 5</p>\n<ul>\n<li><code>replica</code> </li>\n</ul>\n<p>ES ,.,.,</p>\n<p> <code>index.number_of_replicas</code> ,</p>\n<h2 id=\"ES-Cluster-\"><a href=\"#ES-Cluster-\" class=\"headerlink\" title=\"ES Cluster \"></a>ES Cluster </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>ES ,() tcp/9300 ,</li>\n<li>,.,</li>\n<li>,,,., yellow ,.</li>\n<li>,,.,.,,,.</li>\n</ol>\n<p>: green(), yellow(,), red()</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,,.<code></code>.</p>\n<p>,. <code>_search</code> API ,.<code></code></p>\n<blockquote>\n<ul>\n<li></li>\n</ul>\n</blockquote>\n<p> ES ,..</p>\n<p>,,. n . <code>from</code>  <code>size</code> , <code>from + size</code></p>\n<blockquote>\n<ul>\n<li></li>\n</ul>\n</blockquote>\n<p>, GET .,.,.</p>\n<h2 id=\"Document-APIs\"><a href=\"#Document-APIs\" class=\"headerlink\" title=\"Document APIs\"></a>Document APIs</h2><p>., <code>_index</code>, <code>_type</code>, <code>_id</code>, <code>_version</code> ,  <code>_index</code>, <code>_type</code>, <code>_id</code> .<code>_version</code> . <code>_source</code> , JSON .</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>, API .</p>\n<ul>\n<li><code>index</code>: .</li>\n<li><code>_id</code>: .PUT,GET,HEAD,DELETE .POST ,.</li>\n</ul>\n<h3 id=\"Index-API\"><a href=\"#Index-API\" class=\"headerlink\" title=\"Index API\"></a>Index API</h3><p> JSON ,,</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PUT &#x2F;&lt;index&gt;&#x2F;_doc&#x2F;&lt;_id&gt;</span><br><span class=\"line\">POST &#x2F;&lt;index&gt;&#x2F;_doc&#x2F;</span><br><span class=\"line\">PUT &#x2F;&lt;index&gt;&#x2F;_create&#x2F;&lt;_id&gt;</span><br><span class=\"line\">POST &#x2F;&lt;index&gt;&#x2F;_create&#x2F;&lt;_id&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Get-API\"><a href=\"#Get-API\" class=\"headerlink\" title=\"Get API\"></a>Get API</h3><p> Get , HEAD .  <code>_source</code> .</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET &lt;index&gt;&#x2F;_doc&#x2F;&lt;_id&gt;</span><br><span class=\"line\">HEAD &lt;index&gt;&#x2F;_doc&#x2F;&lt;_id&gt;</span><br><span class=\"line\">GET &lt;index&gt;&#x2F;_source&#x2F;&lt;_id&gt;</span><br><span class=\"line\">HEAD &lt;index&gt;&#x2F;_source&#x2F;&lt;_id&gt;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li><code>routing</code>: . <code>routing</code> ()., <code>routing</code> .</li>\n<li><code>_source</code>:  _source , true</li>\n<li><code>_source_excludes</code>:  _source </li>\n<li><code>_source_includes</code>:  _source </li>\n</ul>\n<h3 id=\"Delete-API\"><a href=\"#Delete-API\" class=\"headerlink\" title=\"Delete API\"></a>Delete API</h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DELETE &#x2F;&lt;index&gt;&#x2F;_doc&#x2F;&lt;_id&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Delete-by-query-API\"><a href=\"#Delete-by-query-API\" class=\"headerlink\" title=\"Delete by query API\"></a>Delete by query API</h3><p>,<code>&lt;index&gt;</code> ,, <code>_all</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST &#x2F;&lt;index&gt;&#x2F;_delete_by_query</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li><code>from</code>: . 0</li>\n<li><code>max_docs</code>: ,</li>\n<li><code>q</code>:  Lucene </li>\n<li><code>routing</code>: </li>\n<li><code>scroll_size</code>: , 100</li>\n<li><code>sort</code>: , <code>&lt;field&gt;:&lt;direction&gt;</code> </li>\n<li><code>_source</code>:  _source , true</li>\n<li><code>_source_excludes</code>:  _source </li>\n<li><code>_source_includes</code>:  _source </li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li><code>query</code>: <code>Query DSL</code> ,</li>\n</ul>\n<h3 id=\"Update-API\"><a href=\"#Update-API\" class=\"headerlink\" title=\"Update API\"></a>Update API</h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST &#x2F;&lt;index&gt;&#x2F;_update&#x2F;&lt;_id&gt;</span><br></pre></td></tr></table></figure>\n"},{"title":"docker ","abbrlink":7303,"description":" docker ,, Dockerfile . Dockerfile  docker , docker .","_content":"\n## docker \n\ndocker  [daemon.json](https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file) .[](https://docs.docker.com/engine/reference/commandline/dockerd/#daemon).:\n\n```text\n# \n--config-file string: , `/etc/docker/daemon.json`\n-p, --pidfile string:  PID . `/var/run/docker.pid`\n--containerd string:  grpc \n--data-root string:  docker . `/var/lib/docker`\n--log-driver string: . `json-file`\n--log-level string: . debug,info,warn,error,fatal. `info`\n\nlog-opts: ,.`max-size` ,`max-file` \n\n# \n--insecure-registry list: \n--registry-mirror list: . `registry-mirrors`\n\n# \n--bip string:  docker0  IP \n--default-gateway string:  IPv4 \n--default-gateway-v6 string:  IPv6 \n--fixed-cidr string:  IPv4 \n--fixed-cidr-v6 string:  IPv6 \n--mtu int: \n--dns list:  DNS \n\n# \n-D, --debug:  debug ,\n```\n\n## docker \n\ndocker  Go , Linux .\n\n### Namespaces \n\ndocker  `namespaces` .,docker \n\n | \n:---: | :---\nPID | .\nNetwork | ., IPv4, IPv6 ,,\nIPC | . Linux ,,,\nMount | . `/` \nUTS | ., ID\nUser | .,\n\n### Control groups\n\n(cgroups),:\n\n- Resource limitation,,,CPU \n- Prioritization,\n- Accounting,\n- Controll,,\n\n,,,.,., CGroup :\n\n- ,\n- ,\n- \n\n### Union file systems\n\nUnion file systems(),. overlay2 aufs\n\noverlay2 :\n\n- lowerdir: ,\n- uperdir: .,\n- merged: ,\n\n## docker \n\n `docker run --net=xxx` \n\n- `bridge`: ,.,IP ,(docker0)\n- `host`: , IP \n- `overlay`: , lo \n- `none`: ,,\n- `macvlan`:  MAC ,. MAC .\n\n## docker \n\n### \n\n-  `ENV`  `ARG`  Dockerfile \n\n-  Dockerfile  RUN \n\n```Dockerfile\nRUN mkdir /data\nRUN touch /data/index.html\n```\n\n```Dockerfile\nRUN mkdir /data && touch /data/index.html\n```\n\n- ., JDK, openjdk , ubuntu , openjdk  Dockerfile \n-  Dockerfile ,,[Linux](https://docs.lvrui.io/2018/10/19/%E4%B8%BA%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E5%AE%9A%E5%88%B6%E5%AE%89%E8%A3%85Linux%E5%B7%A5%E5%85%B7/).\n\n```Dockerfile\n# ,\n#  CentOS 7.5.1804, centos:centos7.5.1804  lsof .\n#  lsof , ldd  `ldd $(which lsof)`\n#  centos:centos7.5.1804  lsof ,.\nFROM centos:centos7.5.1804\nADD lsof /usr/sbin/\n```\n\n- ., maven  Java , tomcat  Java ..\n\n```Dockerfile\nFROM golang:1.13.6-alpine3.10 as builder\nWORKDIR $GOPATH/src/demo\nCOPY . $GOPATH/src/demo\nRUN CGO_ENABLED=0 GOOS=linux go build -o /demo\nEXPOSE 8080\nENTRYPOINT [\"./demo\"]\n#  go ,,.\n# .\n```\n\n```Dockerfile\nFROM golang:1.13.6-alpine3.10 as builder\nWORKDIR $GOPATH/src/demo\nCOPY . $GOPATH/src/demo\nRUN CGO_ENABLED=0 GOOS=linux go build -o /demo\n\nFROM alpine:3.6\nCOPY --from=builder /demo .\nEXPOSE 8080\nENTRYPOINT [\"./demo\"]\n# . builder .\n```\n\n- ,.Docker ,,. Tomcat , Tomcat , Tomcat \n-  `tzdate`  `TZ` ,`/etc/localtime``/etc/localtime`\n\n### \n\n- ,, volumes  bind \n- bind ., volumes\n\n## Dockerfile\n\n```bash\ndocker build [OPTIONS] PATH | URL | -`\n```\n\n`docker build`  `Dockerfile` , `PATH`  `URL` .`PATH` ,`URL` Git .\n\n. `PATH` ,`URL` .\n\n Docker ..,, Dockerfile  Dockerfile .\n\n### .dockerignore\n\n `.dockerignore` .\n\n`.dockerignore`  `#` ,, `*`,`?`,`**` .,,.\n\n `*` , `!` \n\n### \n\n#### ARG\n\n`ARG` , `--build-arg <varname>=<value>` . Dockerfile ,.\n\n```Dockerfile\nARG <name>[=<default value>]\n```\n\n#### FROM\n\n`FROM` , Dockerfile  `FROM` . `ARG` \n\n```Dockerfile\nFROM [--platform=<platform>] <image> [AS <name>]\nFROM [--platform=<platform>] <image>[:<tag>] [AS <name>]\nFROM [--platform=<platform>] <image>[@<digest>] [AS <name>]\n```\n\n#### RUN\n\n`RUN` . Dockerfile .\n\n```Dockerfile\nRUN COMMAND\n```\n\n#### LABEL\n\n`LABEL` \n\n```Dockerfile\nLABEL <key>=<value> <key>=<value> <key>=<value> ...\n```\n\n#### EXPOSE\n\n`EXPOSE`  Docker \n\n```Dockerfile\nEXPOSE <port> [<port>/<protocol>...]\n```\n\n#### ENV\n\n`ENV` \n\n```Dockerfile\nENV <key> <value>\nENV <key>=<value> <key>=<value>\n```\n\n#### WORKDIR\n\n`WORKDIR` , `cd`\n\n```Dockerfile\nWORKDIR /path/to/workdir\n```\n\n#### USER\n\n`USER` \n\n```Dockerfile\nUSER <user>[:<group>]\nUSER <UID>[:<GID>]\n```\n\n#### VOLUME\n\n`VOLUME` \n\n```Dockerfile\nVOLUME [\"/path\"]\n```\n\n#### ADD\n\n- `ADD` ,\n- `ADD` URL,\n\n```Dockerfile\nADD [--chown=<user>:<group>] <src>... <dest>\nADD [--chown=<user>:<group>] [\"<src>\",... \"<dest>\"]\n```\n\n#### COPY\n\n```Dockerfile\nCOPY [--chown=<user>:<group>] <src>... <dest>\nCOPY [--chown=<user>:<group>] [\"<src>\",... \"<dest>\"]\n```\n\n#### ENTRYPOINT\n\n`ENTRYPOINT` . `--entrypoint` .\n\n`--entrypoint` \n\n```Dockerfile\n# exec ,\nENTRYPOINT [\"executable\", \"param1\", \"param2\"]\n\n# shell .  `/bin/sh -c command param1 param2`,\nENTRYPOINT command param1 param2\n```\n\n#### CMD\n\n`CMD` ., `ENTRYPOINT` . `CMD` ,.\n\n`docker run [command]`  `CMD` , `ENTRYPOINT` \n\n`CMD`  3 \n\n```Dockerfile\n# exec ,.. `executable`  ID  1\nCMD [\"executable\",\"param1\",\"param2\"]\n\n# shell .  `/bin/sh -c command param1 param2` ,\nCMD command param1 param2\n\n#  ENTRYPOINT , ENTRYPOINT  exec \nCMD [\"param1\",\"param2\"]\n```\n\n `ENTRYPOINT`  `CMD` :\n\n|  | No ENTRYPOINT | `ENTRYPOINT exec_entry p_entry` | `ENTRYPOINT [\"exec_entry\", \"p_entry\"]`\n:---: | :---: | :---: | :---:\nNo CMD | error | `/bin/sh -c exec_entry p_entry` | `exec_entry p_entry`\n`CMD [\"exec_cmd p_cmd\"]` | `exec_cmd p_c` | `/bin/sh -c exec_entry p_entry` | `exec_entry p_entry exec_cmd p_cmd`\n`CMD [\"p1_cmd\", \"p2_cmd\"]` | `p1_cmd p2_cmd` | `/bin/sh -c exec_entry p_entry` | `exec_entry p_entry p1_cmd p2_cmd`\n`CMD exec_cmd p_cmd` | `exec_cmd p_cmd` | `/bin/sh -c exec_entry p_entry` | `exec_entry p_entry /bin/sh -c exec_cmd _cmd`\n\n [GitHub](https://github.com/docker-library/)  Dockerfile\n","source":"_posts/docker-need-to-know.md","raw":"---\ntitle: docker \ntags:\n  - docker\ncategories:\n  - docker\nabbrlink: 7303\ndescription:  docker ,, Dockerfile . Dockerfile  docker , docker .\n---\n\n## docker \n\ndocker  [daemon.json](https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file) .[](https://docs.docker.com/engine/reference/commandline/dockerd/#daemon).:\n\n```text\n# \n--config-file string: , `/etc/docker/daemon.json`\n-p, --pidfile string:  PID . `/var/run/docker.pid`\n--containerd string:  grpc \n--data-root string:  docker . `/var/lib/docker`\n--log-driver string: . `json-file`\n--log-level string: . debug,info,warn,error,fatal. `info`\n\nlog-opts: ,.`max-size` ,`max-file` \n\n# \n--insecure-registry list: \n--registry-mirror list: . `registry-mirrors`\n\n# \n--bip string:  docker0  IP \n--default-gateway string:  IPv4 \n--default-gateway-v6 string:  IPv6 \n--fixed-cidr string:  IPv4 \n--fixed-cidr-v6 string:  IPv6 \n--mtu int: \n--dns list:  DNS \n\n# \n-D, --debug:  debug ,\n```\n\n## docker \n\ndocker  Go , Linux .\n\n### Namespaces \n\ndocker  `namespaces` .,docker \n\n | \n:---: | :---\nPID | .\nNetwork | ., IPv4, IPv6 ,,\nIPC | . Linux ,,,\nMount | . `/` \nUTS | ., ID\nUser | .,\n\n### Control groups\n\n(cgroups),:\n\n- Resource limitation,,,CPU \n- Prioritization,\n- Accounting,\n- Controll,,\n\n,,,.,., CGroup :\n\n- ,\n- ,\n- \n\n### Union file systems\n\nUnion file systems(),. overlay2 aufs\n\noverlay2 :\n\n- lowerdir: ,\n- uperdir: .,\n- merged: ,\n\n## docker \n\n `docker run --net=xxx` \n\n- `bridge`: ,.,IP ,(docker0)\n- `host`: , IP \n- `overlay`: , lo \n- `none`: ,,\n- `macvlan`:  MAC ,. MAC .\n\n## docker \n\n### \n\n-  `ENV`  `ARG`  Dockerfile \n\n-  Dockerfile  RUN \n\n```Dockerfile\nRUN mkdir /data\nRUN touch /data/index.html\n```\n\n```Dockerfile\nRUN mkdir /data && touch /data/index.html\n```\n\n- ., JDK, openjdk , ubuntu , openjdk  Dockerfile \n-  Dockerfile ,,[Linux](https://docs.lvrui.io/2018/10/19/%E4%B8%BA%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E5%AE%9A%E5%88%B6%E5%AE%89%E8%A3%85Linux%E5%B7%A5%E5%85%B7/).\n\n```Dockerfile\n# ,\n#  CentOS 7.5.1804, centos:centos7.5.1804  lsof .\n#  lsof , ldd  `ldd $(which lsof)`\n#  centos:centos7.5.1804  lsof ,.\nFROM centos:centos7.5.1804\nADD lsof /usr/sbin/\n```\n\n- ., maven  Java , tomcat  Java ..\n\n```Dockerfile\nFROM golang:1.13.6-alpine3.10 as builder\nWORKDIR $GOPATH/src/demo\nCOPY . $GOPATH/src/demo\nRUN CGO_ENABLED=0 GOOS=linux go build -o /demo\nEXPOSE 8080\nENTRYPOINT [\"./demo\"]\n#  go ,,.\n# .\n```\n\n```Dockerfile\nFROM golang:1.13.6-alpine3.10 as builder\nWORKDIR $GOPATH/src/demo\nCOPY . $GOPATH/src/demo\nRUN CGO_ENABLED=0 GOOS=linux go build -o /demo\n\nFROM alpine:3.6\nCOPY --from=builder /demo .\nEXPOSE 8080\nENTRYPOINT [\"./demo\"]\n# . builder .\n```\n\n- ,.Docker ,,. Tomcat , Tomcat , Tomcat \n-  `tzdate`  `TZ` ,`/etc/localtime``/etc/localtime`\n\n### \n\n- ,, volumes  bind \n- bind ., volumes\n\n## Dockerfile\n\n```bash\ndocker build [OPTIONS] PATH | URL | -`\n```\n\n`docker build`  `Dockerfile` , `PATH`  `URL` .`PATH` ,`URL` Git .\n\n. `PATH` ,`URL` .\n\n Docker ..,, Dockerfile  Dockerfile .\n\n### .dockerignore\n\n `.dockerignore` .\n\n`.dockerignore`  `#` ,, `*`,`?`,`**` .,,.\n\n `*` , `!` \n\n### \n\n#### ARG\n\n`ARG` , `--build-arg <varname>=<value>` . Dockerfile ,.\n\n```Dockerfile\nARG <name>[=<default value>]\n```\n\n#### FROM\n\n`FROM` , Dockerfile  `FROM` . `ARG` \n\n```Dockerfile\nFROM [--platform=<platform>] <image> [AS <name>]\nFROM [--platform=<platform>] <image>[:<tag>] [AS <name>]\nFROM [--platform=<platform>] <image>[@<digest>] [AS <name>]\n```\n\n#### RUN\n\n`RUN` . Dockerfile .\n\n```Dockerfile\nRUN COMMAND\n```\n\n#### LABEL\n\n`LABEL` \n\n```Dockerfile\nLABEL <key>=<value> <key>=<value> <key>=<value> ...\n```\n\n#### EXPOSE\n\n`EXPOSE`  Docker \n\n```Dockerfile\nEXPOSE <port> [<port>/<protocol>...]\n```\n\n#### ENV\n\n`ENV` \n\n```Dockerfile\nENV <key> <value>\nENV <key>=<value> <key>=<value>\n```\n\n#### WORKDIR\n\n`WORKDIR` , `cd`\n\n```Dockerfile\nWORKDIR /path/to/workdir\n```\n\n#### USER\n\n`USER` \n\n```Dockerfile\nUSER <user>[:<group>]\nUSER <UID>[:<GID>]\n```\n\n#### VOLUME\n\n`VOLUME` \n\n```Dockerfile\nVOLUME [\"/path\"]\n```\n\n#### ADD\n\n- `ADD` ,\n- `ADD` URL,\n\n```Dockerfile\nADD [--chown=<user>:<group>] <src>... <dest>\nADD [--chown=<user>:<group>] [\"<src>\",... \"<dest>\"]\n```\n\n#### COPY\n\n```Dockerfile\nCOPY [--chown=<user>:<group>] <src>... <dest>\nCOPY [--chown=<user>:<group>] [\"<src>\",... \"<dest>\"]\n```\n\n#### ENTRYPOINT\n\n`ENTRYPOINT` . `--entrypoint` .\n\n`--entrypoint` \n\n```Dockerfile\n# exec ,\nENTRYPOINT [\"executable\", \"param1\", \"param2\"]\n\n# shell .  `/bin/sh -c command param1 param2`,\nENTRYPOINT command param1 param2\n```\n\n#### CMD\n\n`CMD` ., `ENTRYPOINT` . `CMD` ,.\n\n`docker run [command]`  `CMD` , `ENTRYPOINT` \n\n`CMD`  3 \n\n```Dockerfile\n# exec ,.. `executable`  ID  1\nCMD [\"executable\",\"param1\",\"param2\"]\n\n# shell .  `/bin/sh -c command param1 param2` ,\nCMD command param1 param2\n\n#  ENTRYPOINT , ENTRYPOINT  exec \nCMD [\"param1\",\"param2\"]\n```\n\n `ENTRYPOINT`  `CMD` :\n\n|  | No ENTRYPOINT | `ENTRYPOINT exec_entry p_entry` | `ENTRYPOINT [\"exec_entry\", \"p_entry\"]`\n:---: | :---: | :---: | :---:\nNo CMD | error | `/bin/sh -c exec_entry p_entry` | `exec_entry p_entry`\n`CMD [\"exec_cmd p_cmd\"]` | `exec_cmd p_c` | `/bin/sh -c exec_entry p_entry` | `exec_entry p_entry exec_cmd p_cmd`\n`CMD [\"p1_cmd\", \"p2_cmd\"]` | `p1_cmd p2_cmd` | `/bin/sh -c exec_entry p_entry` | `exec_entry p_entry p1_cmd p2_cmd`\n`CMD exec_cmd p_cmd` | `exec_cmd p_cmd` | `/bin/sh -c exec_entry p_entry` | `exec_entry p_entry /bin/sh -c exec_cmd _cmd`\n\n [GitHub](https://github.com/docker-library/)  Dockerfile\n","slug":"docker-need-to-know","published":1,"date":"2020-05-29T12:33:40.861Z","updated":"2020-05-29T13:44:16.959Z","_id":"ckas9752e0000dwu7c4zqhzhp","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h2><p>docker  <a href=\"https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file\" target=\"_blank\" rel=\"noopener\">daemon.json</a> .<a href=\"https://docs.docker.com/engine/reference/commandline/dockerd/#daemon\" target=\"_blank\" rel=\"noopener\"></a>.:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\">--config-file string: , &#96;&#x2F;etc&#x2F;docker&#x2F;daemon.json&#96;</span><br><span class=\"line\">-p, --pidfile string:  PID . &#96;&#x2F;var&#x2F;run&#x2F;docker.pid&#96;</span><br><span class=\"line\">--containerd string:  grpc </span><br><span class=\"line\">--data-root string:  docker . &#96;&#x2F;var&#x2F;lib&#x2F;docker&#96;</span><br><span class=\"line\">--log-driver string: . &#96;json-file&#96;</span><br><span class=\"line\">--log-level string: . debug,info,warn,error,fatal. &#96;info&#96;</span><br><span class=\"line\"></span><br><span class=\"line\">log-opts: ,.&#96;max-size&#96; ,&#96;max-file&#96; </span><br><span class=\"line\"></span><br><span class=\"line\"># </span><br><span class=\"line\">--insecure-registry list: </span><br><span class=\"line\">--registry-mirror list: . &#96;registry-mirrors&#96;</span><br><span class=\"line\"></span><br><span class=\"line\"># </span><br><span class=\"line\">--bip string:  docker0  IP </span><br><span class=\"line\">--default-gateway string:  IPv4 </span><br><span class=\"line\">--default-gateway-v6 string:  IPv6 </span><br><span class=\"line\">--fixed-cidr string:  IPv4 </span><br><span class=\"line\">--fixed-cidr-v6 string:  IPv6 </span><br><span class=\"line\">--mtu int: </span><br><span class=\"line\">--dns list:  DNS </span><br><span class=\"line\"></span><br><span class=\"line\"># </span><br><span class=\"line\">-D, --debug:  debug ,</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h2><p>docker  Go , Linux .</p>\n<h3 id=\"Namespaces-\"><a href=\"#Namespaces-\" class=\"headerlink\" title=\"Namespaces \"></a>Namespaces </h3><p>docker  <code>namespaces</code> .,docker </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">PID</td>\n<td align=\"left\">.</td>\n</tr>\n<tr>\n<td align=\"center\">Network</td>\n<td align=\"left\">., IPv4, IPv6 ,,</td>\n</tr>\n<tr>\n<td align=\"center\">IPC</td>\n<td align=\"left\">. Linux ,,,</td>\n</tr>\n<tr>\n<td align=\"center\">Mount</td>\n<td align=\"left\">. <code>/</code> </td>\n</tr>\n<tr>\n<td align=\"center\">UTS</td>\n<td align=\"left\">., ID</td>\n</tr>\n<tr>\n<td align=\"center\">User</td>\n<td align=\"left\">.,</td>\n</tr>\n</tbody></table>\n<h3 id=\"Control-groups\"><a href=\"#Control-groups\" class=\"headerlink\" title=\"Control groups\"></a>Control groups</h3><p>(cgroups),:</p>\n<ul>\n<li>Resource limitation,,,CPU </li>\n<li>Prioritization,</li>\n<li>Accounting,</li>\n<li>Controll,,</li>\n</ul>\n<p>,,,.,., CGroup :</p>\n<ul>\n<li>,</li>\n<li>,</li>\n<li></li>\n</ul>\n<h3 id=\"Union-file-systems\"><a href=\"#Union-file-systems\" class=\"headerlink\" title=\"Union file systems\"></a>Union file systems</h3><p>Union file systems(),. overlay2 aufs</p>\n<p>overlay2 :</p>\n<ul>\n<li>lowerdir: ,</li>\n<li>uperdir: .,</li>\n<li>merged: ,</li>\n</ul>\n<h2 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h2><p> <code>docker run --net=xxx</code> </p>\n<ul>\n<li><code>bridge</code>: ,.,IP ,(docker0)</li>\n<li><code>host</code>: , IP </li>\n<li><code>overlay</code>: , lo </li>\n<li><code>none</code>: ,,</li>\n<li><code>macvlan</code>:  MAC ,. MAC .</li>\n</ul>\n<h2 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> <code>ENV</code>  <code>ARG</code>  Dockerfile </p>\n</li>\n<li><p> Dockerfile  RUN </p>\n</li>\n</ul>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> mkdir /data</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> touch /data/index.html</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> mkdir /data &amp;&amp; touch /data/index.html</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>., JDK, openjdk , ubuntu , openjdk  Dockerfile </li>\n<li> Dockerfile ,,<a href=\"https://docs.lvrui.io/2018/10/19/%E4%B8%BA%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E5%AE%9A%E5%88%B6%E5%AE%89%E8%A3%85Linux%E5%B7%A5%E5%85%B7/\" target=\"_blank\" rel=\"noopener\">Linux</a>.</li>\n</ul>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ,</span></span><br><span class=\"line\"><span class=\"comment\">#  CentOS 7.5.1804, centos:centos7.5.1804  lsof .</span></span><br><span class=\"line\"><span class=\"comment\">#  lsof , ldd  `ldd $(which lsof)`</span></span><br><span class=\"line\"><span class=\"comment\">#  centos:centos7.5.1804  lsof ,.</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> centos:centos7.<span class=\"number\">5.1804</span></span><br><span class=\"line\"><span class=\"keyword\">ADD</span><span class=\"bash\"> lsof /usr/sbin/</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>., maven  Java , tomcat  Java ..</li>\n</ul>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> golang:<span class=\"number\">1.13</span>.<span class=\"number\">6</span>-alpine3.<span class=\"number\">10</span> as builder</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> <span class=\"variable\">$GOPATH</span>/src/demo</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> . <span class=\"variable\">$GOPATH</span>/src/demo</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> CGO_ENABLED=0 GOOS=linux go build -o /demo</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">8080</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> [<span class=\"string\">\"./demo\"</span>]</span></span><br><span class=\"line\"><span class=\"comment\">#  go ,,.</span></span><br><span class=\"line\"><span class=\"comment\"># .</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> golang:<span class=\"number\">1.13</span>.<span class=\"number\">6</span>-alpine3.<span class=\"number\">10</span> as builder</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> <span class=\"variable\">$GOPATH</span>/src/demo</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> . <span class=\"variable\">$GOPATH</span>/src/demo</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> CGO_ENABLED=0 GOOS=linux go build -o /demo</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> alpine:<span class=\"number\">3.6</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> --from=builder /demo .</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">8080</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> [<span class=\"string\">\"./demo\"</span>]</span></span><br><span class=\"line\"><span class=\"comment\"># . builder .</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>,.Docker ,,. Tomcat , Tomcat , Tomcat </li>\n<li> <code>tzdate</code>  <code>TZ</code> ,<code>/etc/localtime</code><code>/etc/localtime</code></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>,, volumes  bind </li>\n<li>bind ., volumes</li>\n</ul>\n<h2 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker build [OPTIONS] PATH | URL | -`</span><br></pre></td></tr></table></figure>\n\n<p><code>docker build</code>  <code>Dockerfile</code> , <code>PATH</code>  <code>URL</code> .<code>PATH</code> ,<code>URL</code> Git .</p>\n<p>. <code>PATH</code> ,<code>URL</code> .</p>\n<p> Docker ..,, Dockerfile  Dockerfile .</p>\n<h3 id=\"dockerignore\"><a href=\"#dockerignore\" class=\"headerlink\" title=\".dockerignore\"></a>.dockerignore</h3><p> <code>.dockerignore</code> .</p>\n<p><code>.dockerignore</code>  <code>#</code> ,, <code>*</code>,<code>?</code>,<code>**</code> .,,.</p>\n<p> <code>*</code> , <code>!</code> </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"ARG\"><a href=\"#ARG\" class=\"headerlink\" title=\"ARG\"></a>ARG</h4><p><code>ARG</code> , <code>--build-arg &lt;varname&gt;=&lt;value&gt;</code> . Dockerfile ,.</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ARG</span> &lt;name&gt;[=&lt;default value&gt;]</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"FROM\"><a href=\"#FROM\" class=\"headerlink\" title=\"FROM\"></a>FROM</h4><p><code>FROM</code> , Dockerfile  <code>FROM</code> . <code>ARG</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt; [AS &lt;name&gt;]</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt;[:&lt;tag&gt;] [AS &lt;name&gt;]</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt;[@&lt;digest&gt;] [AS &lt;name&gt;]</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"RUN\"><a href=\"#RUN\" class=\"headerlink\" title=\"RUN\"></a>RUN</h4><p><code>RUN</code> . Dockerfile .</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> COMMAND</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"LABEL\"><a href=\"#LABEL\" class=\"headerlink\" title=\"LABEL\"></a>LABEL</h4><p><code>LABEL</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">LABEL</span><span class=\"bash\"> &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"EXPOSE\"><a href=\"#EXPOSE\" class=\"headerlink\" title=\"EXPOSE\"></a>EXPOSE</h4><p><code>EXPOSE</code>  Docker </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">EXPOSE</span> &lt;port&gt; [&lt;port&gt;/&lt;protocol&gt;...]</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ENV\"><a href=\"#ENV\" class=\"headerlink\" title=\"ENV\"></a>ENV</h4><p><code>ENV</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ENV</span> &lt;key&gt; &lt;value&gt;</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"WORKDIR\"><a href=\"#WORKDIR\" class=\"headerlink\" title=\"WORKDIR\"></a>WORKDIR</h4><p><code>WORKDIR</code> , <code>cd</code></p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> /path/to/workdir</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"USER\"><a href=\"#USER\" class=\"headerlink\" title=\"USER\"></a>USER</h4><p><code>USER</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">USER</span> &lt;<span class=\"keyword\">user</span>&gt;[:&lt;group&gt;]</span><br><span class=\"line\"><span class=\"keyword\">USER</span> &lt;UID&gt;[:&lt;GID&gt;]</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"VOLUME\"><a href=\"#VOLUME\" class=\"headerlink\" title=\"VOLUME\"></a>VOLUME</h4><p><code>VOLUME</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">VOLUME</span><span class=\"bash\"> [<span class=\"string\">\"/path\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ADD\"><a href=\"#ADD\" class=\"headerlink\" title=\"ADD\"></a>ADD</h4><ul>\n<li><code>ADD</code> ,</li>\n<li><code>ADD</code> URL,</li>\n</ul>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ADD</span><span class=\"bash\"> [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">ADD</span><span class=\"bash\"> [--chown=&lt;user&gt;:&lt;group&gt;] [<span class=\"string\">\"&lt;src&gt;\"</span>,... <span class=\"string\">\"&lt;dest&gt;\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"COPY\"><a href=\"#COPY\" class=\"headerlink\" title=\"COPY\"></a>COPY</h4><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> [--chown=&lt;user&gt;:&lt;group&gt;] [<span class=\"string\">\"&lt;src&gt;\"</span>,... <span class=\"string\">\"&lt;dest&gt;\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ENTRYPOINT\"><a href=\"#ENTRYPOINT\" class=\"headerlink\" title=\"ENTRYPOINT\"></a>ENTRYPOINT</h4><p><code>ENTRYPOINT</code> . <code>--entrypoint</code> .</p>\n<p><code>--entrypoint</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># exec ,</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> [<span class=\"string\">\"executable\"</span>, <span class=\"string\">\"param1\"</span>, <span class=\"string\">\"param2\"</span>]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># shell .  `/bin/sh -c command param1 param2`,</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> <span class=\"built_in\">command</span> param1 param2</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"CMD\"><a href=\"#CMD\" class=\"headerlink\" title=\"CMD\"></a>CMD</h4><p><code>CMD</code> ., <code>ENTRYPOINT</code> . <code>CMD</code> ,.</p>\n<p><code>docker run [command]</code>  <code>CMD</code> , <code>ENTRYPOINT</code> </p>\n<p><code>CMD</code>  3 </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># exec ,.. `executable`  ID  1</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [<span class=\"string\">\"executable\"</span>,<span class=\"string\">\"param1\"</span>,<span class=\"string\">\"param2\"</span>]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># shell .  `/bin/sh -c command param1 param2` ,</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> <span class=\"built_in\">command</span> param1 param2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#  ENTRYPOINT , ENTRYPOINT  exec </span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [<span class=\"string\">\"param1\"</span>,<span class=\"string\">\"param2\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>ENTRYPOINT</code>  <code>CMD</code> :</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">No ENTRYPOINT</th>\n<th align=\"center\"><code>ENTRYPOINT exec_entry p_entry</code></th>\n<th align=\"center\"><code>ENTRYPOINT [&quot;exec_entry&quot;, &quot;p_entry&quot;]</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">No CMD</td>\n<td align=\"center\">error</td>\n<td align=\"center\"><code>/bin/sh -c exec_entry p_entry</code></td>\n<td align=\"center\"><code>exec_entry p_entry</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>CMD [&quot;exec_cmd p_cmd&quot;]</code></td>\n<td align=\"center\"><code>exec_cmd p_c</code></td>\n<td align=\"center\"><code>/bin/sh -c exec_entry p_entry</code></td>\n<td align=\"center\"><code>exec_entry p_entry exec_cmd p_cmd</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>CMD [&quot;p1_cmd&quot;, &quot;p2_cmd&quot;]</code></td>\n<td align=\"center\"><code>p1_cmd p2_cmd</code></td>\n<td align=\"center\"><code>/bin/sh -c exec_entry p_entry</code></td>\n<td align=\"center\"><code>exec_entry p_entry p1_cmd p2_cmd</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>CMD exec_cmd p_cmd</code></td>\n<td align=\"center\"><code>exec_cmd p_cmd</code></td>\n<td align=\"center\"><code>/bin/sh -c exec_entry p_entry</code></td>\n<td align=\"center\"><code>exec_entry p_entry /bin/sh -c exec_cmd _cmd</code></td>\n</tr>\n</tbody></table>\n<p> <a href=\"https://github.com/docker-library/\" target=\"_blank\" rel=\"noopener\">GitHub</a>  Dockerfile</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h2><p>docker  <a href=\"https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file\" target=\"_blank\" rel=\"noopener\">daemon.json</a> .<a href=\"https://docs.docker.com/engine/reference/commandline/dockerd/#daemon\" target=\"_blank\" rel=\"noopener\"></a>.:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># </span><br><span class=\"line\">--config-file string: , &#96;&#x2F;etc&#x2F;docker&#x2F;daemon.json&#96;</span><br><span class=\"line\">-p, --pidfile string:  PID . &#96;&#x2F;var&#x2F;run&#x2F;docker.pid&#96;</span><br><span class=\"line\">--containerd string:  grpc </span><br><span class=\"line\">--data-root string:  docker . &#96;&#x2F;var&#x2F;lib&#x2F;docker&#96;</span><br><span class=\"line\">--log-driver string: . &#96;json-file&#96;</span><br><span class=\"line\">--log-level string: . debug,info,warn,error,fatal. &#96;info&#96;</span><br><span class=\"line\"></span><br><span class=\"line\">log-opts: ,.&#96;max-size&#96; ,&#96;max-file&#96; </span><br><span class=\"line\"></span><br><span class=\"line\"># </span><br><span class=\"line\">--insecure-registry list: </span><br><span class=\"line\">--registry-mirror list: . &#96;registry-mirrors&#96;</span><br><span class=\"line\"></span><br><span class=\"line\"># </span><br><span class=\"line\">--bip string:  docker0  IP </span><br><span class=\"line\">--default-gateway string:  IPv4 </span><br><span class=\"line\">--default-gateway-v6 string:  IPv6 </span><br><span class=\"line\">--fixed-cidr string:  IPv4 </span><br><span class=\"line\">--fixed-cidr-v6 string:  IPv6 </span><br><span class=\"line\">--mtu int: </span><br><span class=\"line\">--dns list:  DNS </span><br><span class=\"line\"></span><br><span class=\"line\"># </span><br><span class=\"line\">-D, --debug:  debug ,</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h2><p>docker  Go , Linux .</p>\n<h3 id=\"Namespaces-\"><a href=\"#Namespaces-\" class=\"headerlink\" title=\"Namespaces \"></a>Namespaces </h3><p>docker  <code>namespaces</code> .,docker </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">PID</td>\n<td align=\"left\">.</td>\n</tr>\n<tr>\n<td align=\"center\">Network</td>\n<td align=\"left\">., IPv4, IPv6 ,,</td>\n</tr>\n<tr>\n<td align=\"center\">IPC</td>\n<td align=\"left\">. Linux ,,,</td>\n</tr>\n<tr>\n<td align=\"center\">Mount</td>\n<td align=\"left\">. <code>/</code> </td>\n</tr>\n<tr>\n<td align=\"center\">UTS</td>\n<td align=\"left\">., ID</td>\n</tr>\n<tr>\n<td align=\"center\">User</td>\n<td align=\"left\">.,</td>\n</tr>\n</tbody></table>\n<h3 id=\"Control-groups\"><a href=\"#Control-groups\" class=\"headerlink\" title=\"Control groups\"></a>Control groups</h3><p>(cgroups),:</p>\n<ul>\n<li>Resource limitation,,,CPU </li>\n<li>Prioritization,</li>\n<li>Accounting,</li>\n<li>Controll,,</li>\n</ul>\n<p>,,,.,., CGroup :</p>\n<ul>\n<li>,</li>\n<li>,</li>\n<li></li>\n</ul>\n<h3 id=\"Union-file-systems\"><a href=\"#Union-file-systems\" class=\"headerlink\" title=\"Union file systems\"></a>Union file systems</h3><p>Union file systems(),. overlay2 aufs</p>\n<p>overlay2 :</p>\n<ul>\n<li>lowerdir: ,</li>\n<li>uperdir: .,</li>\n<li>merged: ,</li>\n</ul>\n<h2 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h2><p> <code>docker run --net=xxx</code> </p>\n<ul>\n<li><code>bridge</code>: ,.,IP ,(docker0)</li>\n<li><code>host</code>: , IP </li>\n<li><code>overlay</code>: , lo </li>\n<li><code>none</code>: ,,</li>\n<li><code>macvlan</code>:  MAC ,. MAC .</li>\n</ul>\n<h2 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> <code>ENV</code>  <code>ARG</code>  Dockerfile </p>\n</li>\n<li><p> Dockerfile  RUN </p>\n</li>\n</ul>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> mkdir /data</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> touch /data/index.html</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> mkdir /data &amp;&amp; touch /data/index.html</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>., JDK, openjdk , ubuntu , openjdk  Dockerfile </li>\n<li> Dockerfile ,,<a href=\"https://docs.lvrui.io/2018/10/19/%E4%B8%BA%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E5%AE%9A%E5%88%B6%E5%AE%89%E8%A3%85Linux%E5%B7%A5%E5%85%B7/\" target=\"_blank\" rel=\"noopener\">Linux</a>.</li>\n</ul>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ,</span></span><br><span class=\"line\"><span class=\"comment\">#  CentOS 7.5.1804, centos:centos7.5.1804  lsof .</span></span><br><span class=\"line\"><span class=\"comment\">#  lsof , ldd  `ldd $(which lsof)`</span></span><br><span class=\"line\"><span class=\"comment\">#  centos:centos7.5.1804  lsof ,.</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> centos:centos7.<span class=\"number\">5.1804</span></span><br><span class=\"line\"><span class=\"keyword\">ADD</span><span class=\"bash\"> lsof /usr/sbin/</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>., maven  Java , tomcat  Java ..</li>\n</ul>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> golang:<span class=\"number\">1.13</span>.<span class=\"number\">6</span>-alpine3.<span class=\"number\">10</span> as builder</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> <span class=\"variable\">$GOPATH</span>/src/demo</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> . <span class=\"variable\">$GOPATH</span>/src/demo</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> CGO_ENABLED=0 GOOS=linux go build -o /demo</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">8080</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> [<span class=\"string\">\"./demo\"</span>]</span></span><br><span class=\"line\"><span class=\"comment\">#  go ,,.</span></span><br><span class=\"line\"><span class=\"comment\"># .</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> golang:<span class=\"number\">1.13</span>.<span class=\"number\">6</span>-alpine3.<span class=\"number\">10</span> as builder</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> <span class=\"variable\">$GOPATH</span>/src/demo</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> . <span class=\"variable\">$GOPATH</span>/src/demo</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> CGO_ENABLED=0 GOOS=linux go build -o /demo</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> alpine:<span class=\"number\">3.6</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> --from=builder /demo .</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">8080</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> [<span class=\"string\">\"./demo\"</span>]</span></span><br><span class=\"line\"><span class=\"comment\"># . builder .</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>,.Docker ,,. Tomcat , Tomcat , Tomcat </li>\n<li> <code>tzdate</code>  <code>TZ</code> ,<code>/etc/localtime</code><code>/etc/localtime</code></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>,, volumes  bind </li>\n<li>bind ., volumes</li>\n</ul>\n<h2 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker build [OPTIONS] PATH | URL | -`</span><br></pre></td></tr></table></figure>\n\n<p><code>docker build</code>  <code>Dockerfile</code> , <code>PATH</code>  <code>URL</code> .<code>PATH</code> ,<code>URL</code> Git .</p>\n<p>. <code>PATH</code> ,<code>URL</code> .</p>\n<p> Docker ..,, Dockerfile  Dockerfile .</p>\n<h3 id=\"dockerignore\"><a href=\"#dockerignore\" class=\"headerlink\" title=\".dockerignore\"></a>.dockerignore</h3><p> <code>.dockerignore</code> .</p>\n<p><code>.dockerignore</code>  <code>#</code> ,, <code>*</code>,<code>?</code>,<code>**</code> .,,.</p>\n<p> <code>*</code> , <code>!</code> </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"ARG\"><a href=\"#ARG\" class=\"headerlink\" title=\"ARG\"></a>ARG</h4><p><code>ARG</code> , <code>--build-arg &lt;varname&gt;=&lt;value&gt;</code> . Dockerfile ,.</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ARG</span> &lt;name&gt;[=&lt;default value&gt;]</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"FROM\"><a href=\"#FROM\" class=\"headerlink\" title=\"FROM\"></a>FROM</h4><p><code>FROM</code> , Dockerfile  <code>FROM</code> . <code>ARG</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt; [AS &lt;name&gt;]</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt;[:&lt;tag&gt;] [AS &lt;name&gt;]</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt;[@&lt;digest&gt;] [AS &lt;name&gt;]</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"RUN\"><a href=\"#RUN\" class=\"headerlink\" title=\"RUN\"></a>RUN</h4><p><code>RUN</code> . Dockerfile .</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> COMMAND</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"LABEL\"><a href=\"#LABEL\" class=\"headerlink\" title=\"LABEL\"></a>LABEL</h4><p><code>LABEL</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">LABEL</span><span class=\"bash\"> &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"EXPOSE\"><a href=\"#EXPOSE\" class=\"headerlink\" title=\"EXPOSE\"></a>EXPOSE</h4><p><code>EXPOSE</code>  Docker </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">EXPOSE</span> &lt;port&gt; [&lt;port&gt;/&lt;protocol&gt;...]</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ENV\"><a href=\"#ENV\" class=\"headerlink\" title=\"ENV\"></a>ENV</h4><p><code>ENV</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ENV</span> &lt;key&gt; &lt;value&gt;</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"WORKDIR\"><a href=\"#WORKDIR\" class=\"headerlink\" title=\"WORKDIR\"></a>WORKDIR</h4><p><code>WORKDIR</code> , <code>cd</code></p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> /path/to/workdir</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"USER\"><a href=\"#USER\" class=\"headerlink\" title=\"USER\"></a>USER</h4><p><code>USER</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">USER</span> &lt;<span class=\"keyword\">user</span>&gt;[:&lt;group&gt;]</span><br><span class=\"line\"><span class=\"keyword\">USER</span> &lt;UID&gt;[:&lt;GID&gt;]</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"VOLUME\"><a href=\"#VOLUME\" class=\"headerlink\" title=\"VOLUME\"></a>VOLUME</h4><p><code>VOLUME</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">VOLUME</span><span class=\"bash\"> [<span class=\"string\">\"/path\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ADD\"><a href=\"#ADD\" class=\"headerlink\" title=\"ADD\"></a>ADD</h4><ul>\n<li><code>ADD</code> ,</li>\n<li><code>ADD</code> URL,</li>\n</ul>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ADD</span><span class=\"bash\"> [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">ADD</span><span class=\"bash\"> [--chown=&lt;user&gt;:&lt;group&gt;] [<span class=\"string\">\"&lt;src&gt;\"</span>,... <span class=\"string\">\"&lt;dest&gt;\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"COPY\"><a href=\"#COPY\" class=\"headerlink\" title=\"COPY\"></a>COPY</h4><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> [--chown=&lt;user&gt;:&lt;group&gt;] [<span class=\"string\">\"&lt;src&gt;\"</span>,... <span class=\"string\">\"&lt;dest&gt;\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ENTRYPOINT\"><a href=\"#ENTRYPOINT\" class=\"headerlink\" title=\"ENTRYPOINT\"></a>ENTRYPOINT</h4><p><code>ENTRYPOINT</code> . <code>--entrypoint</code> .</p>\n<p><code>--entrypoint</code> </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># exec ,</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> [<span class=\"string\">\"executable\"</span>, <span class=\"string\">\"param1\"</span>, <span class=\"string\">\"param2\"</span>]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># shell .  `/bin/sh -c command param1 param2`,</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"bash\"> <span class=\"built_in\">command</span> param1 param2</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"CMD\"><a href=\"#CMD\" class=\"headerlink\" title=\"CMD\"></a>CMD</h4><p><code>CMD</code> ., <code>ENTRYPOINT</code> . <code>CMD</code> ,.</p>\n<p><code>docker run [command]</code>  <code>CMD</code> , <code>ENTRYPOINT</code> </p>\n<p><code>CMD</code>  3 </p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># exec ,.. `executable`  ID  1</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [<span class=\"string\">\"executable\"</span>,<span class=\"string\">\"param1\"</span>,<span class=\"string\">\"param2\"</span>]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># shell .  `/bin/sh -c command param1 param2` ,</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> <span class=\"built_in\">command</span> param1 param2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#  ENTRYPOINT , ENTRYPOINT  exec </span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [<span class=\"string\">\"param1\"</span>,<span class=\"string\">\"param2\"</span>]</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>ENTRYPOINT</code>  <code>CMD</code> :</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">No ENTRYPOINT</th>\n<th align=\"center\"><code>ENTRYPOINT exec_entry p_entry</code></th>\n<th align=\"center\"><code>ENTRYPOINT [&quot;exec_entry&quot;, &quot;p_entry&quot;]</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">No CMD</td>\n<td align=\"center\">error</td>\n<td align=\"center\"><code>/bin/sh -c exec_entry p_entry</code></td>\n<td align=\"center\"><code>exec_entry p_entry</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>CMD [&quot;exec_cmd p_cmd&quot;]</code></td>\n<td align=\"center\"><code>exec_cmd p_c</code></td>\n<td align=\"center\"><code>/bin/sh -c exec_entry p_entry</code></td>\n<td align=\"center\"><code>exec_entry p_entry exec_cmd p_cmd</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>CMD [&quot;p1_cmd&quot;, &quot;p2_cmd&quot;]</code></td>\n<td align=\"center\"><code>p1_cmd p2_cmd</code></td>\n<td align=\"center\"><code>/bin/sh -c exec_entry p_entry</code></td>\n<td align=\"center\"><code>exec_entry p_entry p1_cmd p2_cmd</code></td>\n</tr>\n<tr>\n<td align=\"center\"><code>CMD exec_cmd p_cmd</code></td>\n<td align=\"center\"><code>exec_cmd p_cmd</code></td>\n<td align=\"center\"><code>/bin/sh -c exec_entry p_entry</code></td>\n<td align=\"center\"><code>exec_entry p_entry /bin/sh -c exec_cmd _cmd</code></td>\n</tr>\n</tbody></table>\n<p> <a href=\"https://github.com/docker-library/\" target=\"_blank\" rel=\"noopener\">GitHub</a>  Dockerfile</p>\n"}],"PostAsset":[{"_id":"source/_posts/go-study-notes-basis/difference_between_valueType_and_referenceType.jpg","slug":"difference_between_valueType_and_referenceType.jpg","post":"ckab8ihuo0000k8u7at72964z","modified":0,"renderable":0},{"_id":"source/_posts/go-study-notes-package/package_initialization_process_in_go.jpg","slug":"package_initialization_process_in_go.jpg","post":"ckab8ihvt0027k8u736ychkpd","modified":0,"renderable":0},{"_id":"source/_posts/go-study-notes-reflect/conversion_between_actual_type_and_reflection.jpg","slug":"conversion_between_actual_type_and_reflection.jpg","post":"ckab8ihvw002ik8u74l2hg06r","modified":0,"renderable":0},{"_id":"source/_posts/istio-sidecar/istio_traffic_flow.png","slug":"istio_traffic_flow.png","post":"ckab8ihvz002ok8u72ryz432i","modified":0,"renderable":0},{"_id":"source/_posts/istio-first-step/istio_working_mechanism_and_architecture.jpg","slug":"istio_working_mechanism_and_architecture.jpg","post":"ckab8ihvv002dk8u7dd7j2v6p","modified":0,"renderable":0},{"_id":"source/_posts/istio-first-step/service_discovery_on_pilot.png","slug":"service_discovery_on_pilot.png","post":"ckab8ihvv002dk8u7dd7j2v6p","modified":0,"renderable":0},{"_id":"source/_posts/ELK-Stack/beat-for-data-collection.png","slug":"beat-for-data-collection.png","post":"ckai8moy40007gcu72f0x8fen","modified":0,"renderable":0},{"_id":"source/_posts/ELK-Stack/introduce-message-queue.png","slug":"introduce-message-queue.png","post":"ckai8moy40007gcu72f0x8fen","modified":0,"renderable":0},{"_id":"source/_posts/ELK-Stack/multi-logstash.png","slug":"multi-logstash.png","post":"ckai8moy40007gcu72f0x8fen","modified":0,"renderable":0},{"_id":"source/_posts/ELK-Stack/the-simplest-architecture.png","slug":"the-simplest-architecture.png","post":"ckai8moy40007gcu72f0x8fen","modified":0,"renderable":0}],"PostCategory":[{"post_id":"ckab8ihuy0007k8u70hph3y0y","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihv4000dk8u71muobe2f"},{"post_id":"ckab8ihuo0000k8u7at72964z","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihv6000ik8u734cy9ml5"},{"post_id":"ckab8ihuz0008k8u722x23wge","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihv7000lk8u7b2wk3up5"},{"post_id":"ckab8ihv2000bk8u76o5mgp80","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvb000pk8u70jmn0h6t"},{"post_id":"ckab8ihut0002k8u72pbb0z9o","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvc000sk8u7f6w0344v"},{"post_id":"ckab8ihv3000ck8u7e1qadem6","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihve000wk8u79c0k4rlh"},{"post_id":"ckab8ihv5000hk8u72jpcgkdc","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvf000zk8u74m1rbl38"},{"post_id":"ckab8ihux0006k8u7ctlba8yk","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvg0013k8u71ft39dug"},{"post_id":"ckab8ihv6000kk8u703ga1bn6","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvh0016k8u7fgfcdn7p"},{"post_id":"ckab8ihv8000ok8u715dl9fsl","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvi001ak8u7eg411wxw"},{"post_id":"ckab8ihvc000rk8u70i0b1s06","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvj001dk8u73jd589yv"},{"post_id":"ckab8ihvd000vk8u76tvmhrl9","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvk001hk8u7bla1ausa"},{"post_id":"ckab8ihve000yk8u71qgmhaht","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvk001kk8u72aql1tyc"},{"post_id":"ckab8ihvf0012k8u766c63pn3","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvn001nk8u7gsmc3jwf"},{"post_id":"ckab8ihvg0015k8u70qbb74x3","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvo001qk8u796sd28wn"},{"post_id":"ckab8ihvh0019k8u79ti564pp","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvp001tk8u78gwd4h27"},{"post_id":"ckab8ihvi001ck8u76lyd2acy","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvq001wk8u70izy2sny"},{"post_id":"ckab8ihvj001gk8u77i4pdkdj","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvq001zk8u722603tph"},{"post_id":"ckab8ihvk001jk8u764me09lm","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvr0022k8u7efl16vna"},{"post_id":"ckab8ihvl001mk8u7eh56b50t","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvs0025k8u7hky2hkgi"},{"post_id":"ckab8ihvo001pk8u7hum9c4ix","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvu0028k8u78hxd9i8c"},{"post_id":"ckab8ihvo001sk8u7harkby37","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvv002bk8u76eq144t5"},{"post_id":"ckab8ihvp001vk8u705880786","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvw002ek8u760jwhacz"},{"post_id":"ckab8ihvq001yk8u771qba60k","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvx002jk8u78qdna01z"},{"post_id":"ckab8ihvr0021k8u7ezxjepkk","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvy002mk8u7eub9ezf6"},{"post_id":"ckab8ihvs0024k8u7hqdy8jub","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihvz002rk8u767wpgutr"},{"post_id":"ckab8ihvt0027k8u736ychkpd","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihw0002uk8u7h010bdww"},{"post_id":"ckab8ihvw002ik8u74l2hg06r","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckab8ihw1002yk8u720lpb7wl"},{"post_id":"ckab8ihw1002wk8u7534pghqp","category_id":"ckab8ihvw002fk8u7cn0s6lq8","_id":"ckab8ihw30035k8u7cdeffx9w"},{"post_id":"ckab8ihvy002lk8u739s7ff2y","category_id":"ckab8ihvw002fk8u7cn0s6lq8","_id":"ckab8ihw40038k8u784ws362c"},{"post_id":"ckab8ihvy002lk8u739s7ff2y","category_id":"ckab8ihw1002xk8u79gefgeu4","_id":"ckab8ihw5003bk8u71xpugfpt"},{"post_id":"ckab8ihvu002ak8u779kibbly","category_id":"ckab8ihvw002fk8u7cn0s6lq8","_id":"ckab8ihw5003ek8u7dlqiaa3z"},{"post_id":"ckab8ihvu002ak8u779kibbly","category_id":"ckab8ihw1002xk8u79gefgeu4","_id":"ckab8ihw6003hk8u7eang8j39"},{"post_id":"ckab8ihvz002ok8u72ryz432i","category_id":"ckab8ihvw002fk8u7cn0s6lq8","_id":"ckab8ihw7003kk8u7gfpufd76"},{"post_id":"ckab8ihvz002ok8u72ryz432i","category_id":"ckab8ihw1002xk8u79gefgeu4","_id":"ckab8ihw7003nk8u771yw8e6l"},{"post_id":"ckab8ihw0002tk8u77oohce9l","category_id":"ckab8ihvw002fk8u7cn0s6lq8","_id":"ckab8ihw8003pk8u7036d02gq"},{"post_id":"ckab8ihw0002tk8u77oohce9l","category_id":"ckab8ihw1002xk8u79gefgeu4","_id":"ckab8ihw8003sk8u76pd27uhj"},{"post_id":"ckab8ihvv002dk8u7dd7j2v6p","category_id":"ckab8ihvw002fk8u7cn0s6lq8","_id":"ckab8ihw8003uk8u7evla2797"},{"post_id":"ckab8ihvv002dk8u7dd7j2v6p","category_id":"ckab8ihw1002xk8u79gefgeu4","_id":"ckab8ihw9003wk8u7hagpau9g"},{"post_id":"ckab8ihx4004pk8u7gda1d2tg","category_id":"ckab8ihvw002fk8u7cn0s6lq8","_id":"ckab8ihx9004uk8u79900d8b8"},{"post_id":"ckab8ihx4004pk8u7gda1d2tg","category_id":"ckab8ihx8004rk8u781oq15zn","_id":"ckab8ihxa004wk8u7dlre4kse"},{"post_id":"ckai8moxe0000gcu70k2xaxav","category_id":"ckai8moxl0001gcu718jr2szh","_id":"ckai8moxx0004gcu772k7764o"},{"post_id":"ckai8moy8000cgcu7f9pr1h6n","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckai8moyd000jgcu7crqhagfj"},{"post_id":"ckai8moy40007gcu72f0x8fen","category_id":"ckai8moy60009gcu7cn5hhn56","_id":"ckai8moye000ngcu70c4get42"},{"post_id":"ckai8moy9000dgcu75uzy2qu3","category_id":"ckab8ihuv0004k8u75s6getlk","_id":"ckai8moyf000pgcu78cgth6hg"},{"post_id":"ckai8moyb000hgcu7fe9w1ikr","category_id":"ckai8moy60009gcu7cn5hhn56","_id":"ckai8moyf000sgcu72eir06n9"},{"post_id":"ckai8moy50008gcu7fcg9h4yh","category_id":"ckai8moy60009gcu7cn5hhn56","_id":"ckai8moyf000ugcu784h15r1b"},{"post_id":"ckai8moy7000bgcu7b89u2j39","category_id":"ckai8moyd000kgcu7bnnh8wt9","_id":"ckai8moyg000xgcu78ncc0i4w"},{"post_id":"ckas9752e0000dwu7c4zqhzhp","category_id":"ckas9752j0001dwu7htrq3883","_id":"ckas9752s0004dwu73s1rb7yf"}],"PostTag":[{"post_id":"ckab8ihv2000bk8u76o5mgp80","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihv5000gk8u7740yc9jq"},{"post_id":"ckab8ihv2000bk8u76o5mgp80","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihv6000jk8u74tpm3kkf"},{"post_id":"ckab8ihuo0000k8u7at72964z","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihv8000nk8u70lju3icz"},{"post_id":"ckab8ihuo0000k8u7at72964z","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvc000qk8u73g914o94"},{"post_id":"ckab8ihv3000ck8u7e1qadem6","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvd000uk8u7g6039bqk"},{"post_id":"ckab8ihv3000ck8u7e1qadem6","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihve000xk8u7cal6f5w0"},{"post_id":"ckab8ihv5000hk8u72jpcgkdc","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvf0011k8u722uq0msv"},{"post_id":"ckab8ihv5000hk8u72jpcgkdc","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvg0014k8u7d88k4497"},{"post_id":"ckab8ihv6000kk8u703ga1bn6","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvh0018k8u756227ia2"},{"post_id":"ckab8ihv6000kk8u703ga1bn6","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvi001bk8u75ilwgnq9"},{"post_id":"ckab8ihv8000ok8u715dl9fsl","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvj001fk8u71bng3vi4"},{"post_id":"ckab8ihv8000ok8u715dl9fsl","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvk001ik8u7d6vxbpsr"},{"post_id":"ckab8ihut0002k8u72pbb0z9o","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvl001lk8u73blgc0te"},{"post_id":"ckab8ihut0002k8u72pbb0z9o","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvn001ok8u75a0o08nw"},{"post_id":"ckab8ihvc000rk8u70i0b1s06","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvo001rk8u7b2szdtd7"},{"post_id":"ckab8ihvc000rk8u70i0b1s06","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvp001uk8u7g8bnd6jo"},{"post_id":"ckab8ihvd000vk8u76tvmhrl9","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvq001xk8u77oxt7ngd"},{"post_id":"ckab8ihvd000vk8u76tvmhrl9","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvr0020k8u74lhicv1e"},{"post_id":"ckab8ihve000yk8u71qgmhaht","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvs0023k8u7bac5c8hg"},{"post_id":"ckab8ihve000yk8u71qgmhaht","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvt0026k8u7akng77op"},{"post_id":"ckab8ihvf0012k8u766c63pn3","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvu0029k8u7g38w67k0"},{"post_id":"ckab8ihvf0012k8u766c63pn3","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvv002ck8u7bj04dwgy"},{"post_id":"ckab8ihux0006k8u7ctlba8yk","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvw002hk8u751a41hui"},{"post_id":"ckab8ihux0006k8u7ctlba8yk","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihvy002kk8u7bkm5dygt"},{"post_id":"ckab8ihvg0015k8u70qbb74x3","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihvy002nk8u7ayd108bz"},{"post_id":"ckab8ihvg0015k8u70qbb74x3","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihw0002sk8u7207ccyl0"},{"post_id":"ckab8ihvh0019k8u79ti564pp","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihw1002vk8u7h5so7g4p"},{"post_id":"ckab8ihvh0019k8u79ti564pp","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihw20030k8u7fq4cb20n"},{"post_id":"ckab8ihuy0007k8u70hph3y0y","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihw20031k8u74fc554hz"},{"post_id":"ckab8ihuy0007k8u70hph3y0y","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihw30034k8u74474dcdp"},{"post_id":"ckab8ihvi001ck8u76lyd2acy","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihw30036k8u78j37f25n"},{"post_id":"ckab8ihvi001ck8u76lyd2acy","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihw5003ak8u7hoss88xn"},{"post_id":"ckab8ihvj001gk8u77i4pdkdj","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihw5003ck8u7ed523dcn"},{"post_id":"ckab8ihvj001gk8u77i4pdkdj","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihw6003gk8u7ewqw9lob"},{"post_id":"ckab8ihuz0008k8u722x23wge","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihw6003ik8u731hz80ug"},{"post_id":"ckab8ihuz0008k8u722x23wge","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihw7003mk8u79hbx4k1n"},{"post_id":"ckab8ihvk001jk8u764me09lm","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihw7003ok8u79qsqddg4"},{"post_id":"ckab8ihvk001jk8u764me09lm","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihw8003rk8u72v217mtc"},{"post_id":"ckab8ihvl001mk8u7eh56b50t","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihw8003tk8u7dng8fxca"},{"post_id":"ckab8ihvl001mk8u7eh56b50t","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihw9003vk8u756nh2g7m"},{"post_id":"ckab8ihvo001pk8u7hum9c4ix","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihw9003xk8u7hgtw0eg8"},{"post_id":"ckab8ihvo001pk8u7hum9c4ix","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihw9003yk8u76yxk2po8"},{"post_id":"ckab8ihvo001sk8u7harkby37","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihw9003zk8u7h0rifcy8"},{"post_id":"ckab8ihvo001sk8u7harkby37","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihwa0040k8u7bmukf2cw"},{"post_id":"ckab8ihvp001vk8u705880786","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihwa0041k8u70auoaxdb"},{"post_id":"ckab8ihvp001vk8u705880786","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihwa0042k8u7ayjk2r9u"},{"post_id":"ckab8ihvq001yk8u771qba60k","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihwa0043k8u7ckajfwgu"},{"post_id":"ckab8ihvq001yk8u771qba60k","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihwa0044k8u720cl66xb"},{"post_id":"ckab8ihvr0021k8u7ezxjepkk","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihwa0045k8u7587w3nc0"},{"post_id":"ckab8ihvr0021k8u7ezxjepkk","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihwa0046k8u75mngcdoy"},{"post_id":"ckab8ihvs0024k8u7hqdy8jub","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihwa0047k8u7dhx24mpn"},{"post_id":"ckab8ihvs0024k8u7hqdy8jub","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihwb0048k8u788fu29k2"},{"post_id":"ckab8ihvt0027k8u736ychkpd","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihwb0049k8u703izcke6"},{"post_id":"ckab8ihvt0027k8u736ychkpd","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihwb004ak8u7el156apf"},{"post_id":"ckab8ihvw002ik8u74l2hg06r","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckab8ihwb004bk8u754y6cpmn"},{"post_id":"ckab8ihvw002ik8u74l2hg06r","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckab8ihwb004ck8u76tgp5sv5"},{"post_id":"ckab8ihw0002tk8u77oohce9l","tag_id":"ckab8ihvw002gk8u7f3kp1wwo","_id":"ckab8ihwb004dk8u71prg34n9"},{"post_id":"ckab8ihw0002tk8u77oohce9l","tag_id":"ckab8ihvz002qk8u78xe1ecn1","_id":"ckab8ihwb004ek8u76o6r59ro"},{"post_id":"ckab8ihvu002ak8u779kibbly","tag_id":"ckab8ihvw002gk8u7f3kp1wwo","_id":"ckab8ihwb004fk8u79wtr3r2u"},{"post_id":"ckab8ihvu002ak8u779kibbly","tag_id":"ckab8ihvz002qk8u78xe1ecn1","_id":"ckab8ihwb004gk8u7dqib0tov"},{"post_id":"ckab8ihvv002dk8u7dd7j2v6p","tag_id":"ckab8ihvw002gk8u7f3kp1wwo","_id":"ckab8ihwb004hk8u7euoe7ko2"},{"post_id":"ckab8ihvv002dk8u7dd7j2v6p","tag_id":"ckab8ihvz002qk8u78xe1ecn1","_id":"ckab8ihwb004ik8u77fka3ud1"},{"post_id":"ckab8ihvy002lk8u739s7ff2y","tag_id":"ckab8ihvw002gk8u7f3kp1wwo","_id":"ckab8ihwb004jk8u7aswp4bvb"},{"post_id":"ckab8ihvy002lk8u739s7ff2y","tag_id":"ckab8ihvz002qk8u78xe1ecn1","_id":"ckab8ihwb004kk8u72s3gajkw"},{"post_id":"ckab8ihvz002ok8u72ryz432i","tag_id":"ckab8ihvw002gk8u7f3kp1wwo","_id":"ckab8ihwb004lk8u70al0cty8"},{"post_id":"ckab8ihvz002ok8u72ryz432i","tag_id":"ckab8ihvz002qk8u78xe1ecn1","_id":"ckab8ihwb004mk8u70yaq5vek"},{"post_id":"ckab8ihw1002wk8u7534pghqp","tag_id":"ckab8ihw7003lk8u70d4xbpdy","_id":"ckab8ihwb004nk8u7huts034x"},{"post_id":"ckab8ihw1002wk8u7534pghqp","tag_id":"ckab8ihw8003qk8u73nh42bne","_id":"ckab8ihwb004ok8u7ffimgxgw"},{"post_id":"ckab8ihx4004pk8u7gda1d2tg","tag_id":"ckab8ihw7003lk8u70d4xbpdy","_id":"ckab8ihx9004sk8u7fb4h3axf"},{"post_id":"ckab8ihx4004pk8u7gda1d2tg","tag_id":"ckab8ihx7004qk8u7161259hd","_id":"ckab8ihx9004tk8u7ato5104a"},{"post_id":"ckab8ihx4004pk8u7gda1d2tg","tag_id":"ckab8ihw8003qk8u73nh42bne","_id":"ckab8ihxa004vk8u7f4ak7qip"},{"post_id":"ckai8moxe0000gcu70k2xaxav","tag_id":"ckai8moxs0002gcu70bbm8ra5","_id":"ckai8moxx0005gcu7etpr3et5"},{"post_id":"ckai8moxe0000gcu70k2xaxav","tag_id":"ckai8moxw0003gcu71lzfc7ab","_id":"ckai8moxx0006gcu70her0j1u"},{"post_id":"ckai8moy8000cgcu7f9pr1h6n","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckai8moyb000ggcu7bx3udgpw"},{"post_id":"ckai8moy8000cgcu7f9pr1h6n","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckai8moyd000igcu76de123c0"},{"post_id":"ckai8moy9000dgcu75uzy2qu3","tag_id":"ckab8ihuw0005k8u7e097c82c","_id":"ckai8moye000mgcu7hm2476vq"},{"post_id":"ckai8moy9000dgcu75uzy2qu3","tag_id":"ckab8ihv0000ak8u77ay3gucw","_id":"ckai8moyf000ogcu75uk3fipn"},{"post_id":"ckai8moyb000hgcu7fe9w1ikr","tag_id":"ckai8moy6000agcu71neidmw2","_id":"ckai8moyf000rgcu72q7eeq4k"},{"post_id":"ckai8moyb000hgcu7fe9w1ikr","tag_id":"ckai8moy9000fgcu724rr3r3l","_id":"ckai8moyf000tgcu7hokgdfye"},{"post_id":"ckai8moy40007gcu72f0x8fen","tag_id":"ckai8moy6000agcu71neidmw2","_id":"ckai8moyg000wgcu78ydbctq1"},{"post_id":"ckai8moy40007gcu72f0x8fen","tag_id":"ckai8moy9000fgcu724rr3r3l","_id":"ckai8moyg000ygcu73ophdf9l"},{"post_id":"ckai8moy50008gcu7fcg9h4yh","tag_id":"ckai8moy6000agcu71neidmw2","_id":"ckai8moyg0010gcu7dki26k42"},{"post_id":"ckai8moy50008gcu7fcg9h4yh","tag_id":"ckai8moy9000fgcu724rr3r3l","_id":"ckai8moyg0011gcu706itbhq0"},{"post_id":"ckai8moy7000bgcu7b89u2j39","tag_id":"ckai8moyf000vgcu70z9t4f9p","_id":"ckai8moyh0012gcu71smf1dca"},{"post_id":"ckai8moy7000bgcu7b89u2j39","tag_id":"ckai8moyg000zgcu77z4o1a4k","_id":"ckai8moyh0013gcu71nf2ezq4"},{"post_id":"ckas9752e0000dwu7c4zqhzhp","tag_id":"ckas9752r0002dwu77k1o64eo","_id":"ckas9752s0003dwu753sd1tlj"}],"Tag":[{"name":"go","_id":"ckab8ihuw0005k8u7e097c82c"},{"name":"","_id":"ckab8ihv0000ak8u77ay3gucw"},{"name":"istio","_id":"ckab8ihvw002gk8u7f3kp1wwo"},{"name":"","_id":"ckab8ihvz002qk8u78xe1ecn1"},{"name":"kubernetes","_id":"ckab8ihw7003lk8u70d4xbpdy"},{"name":"etcd","_id":"ckab8ihw8003qk8u73nh42bne"},{"name":"prometheus","_id":"ckab8ihx7004qk8u7161259hd"},{"name":"","_id":"ckai8moxs0002gcu70bbm8ra5"},{"name":"","_id":"ckai8moxw0003gcu71lzfc7ab"},{"name":"ELK","_id":"ckai8moy6000agcu71neidmw2"},{"name":"","_id":"ckai8moy9000fgcu724rr3r3l"},{"name":"GitLab","_id":"ckai8moyf000vgcu70z9t4f9p"},{"name":"CI/CD","_id":"ckai8moyg000zgcu77z4o1a4k"},{"name":"docker","_id":"ckas9752r0002dwu77k1o64eo"}]}}